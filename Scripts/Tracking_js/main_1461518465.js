var permitionall = $(".permition-system").val();
 var html = "";
    html += "<ul class='sidebar-nav'>";

    //map
    if (permitionall.indexOf("ac_map") !== -1) {
        html += "<li><a data-key='weareaboutnew' onclick='activeMenu(this)' class='js-goto' href='#'><i class='glyphicon glyphicon-th'></i> Map</a></li>";
        html += "<li><a data-key='weareaboutnewRealtime' onclick='weareaboutnewRealtime(this)'   class='js-goto' href='#'><i class='glyphicon glyphicon-th'></i> Map 2</a></li>";
    }
      
    
    //report
    if (permitionall.indexOf("ac_menurp") !== -1) {
        html += "<li>";
        html += "<a href='#' class='sidebar-nav-menu'><i class='fa fa-angle-left sidebar-nav-indicator'></i><i class='glyphicon glyphicon-th'></i> Report</a>";
        html += "<ul>";
        if (permitionall.indexOf("ac_rpbytracked") !== -1) {
            html += "<li><a data-key='bytrackedtag' onclick='activeMenu(this)' href='#'>By tracked tag </a> </li>";
            html += "<li><a data-key='bytrackedtagF' onclick='activeMenu(this)' href='#'>By tracked tag 2 </a> </li>";

        } 
        if (permitionall.indexOf("ac_rpbytracked1") !== -1)
            html += "<li><a data-key='bytrackedtagF1' onclick='activeMenu(this)' href='#'>By tracked tag 3 </a> </li>";
        if (permitionall.indexOf("ac_rpbygroup") !== -1)
            html += "<li><a data-key='Rp_By_group' onclick='activeMenu(this)' href='#'>By group </a> </li>";
        if (permitionall.indexOf("ac_compare") !== -1)
            html += "<li><a data-key='Rp_Comparetrackedtag' onclick='activeMenu(this)' href='#'>Compare 2 tracked tag</a> </li>";
        if (permitionall.indexOf("ac_animation") !== -1)
            html += "<li><a data-key='bytrackedtagami' onclick='activeMenu(this)' href='#'>Report animation</a> </li>";

        if (permitionall.indexOf("ac_Simulation") !== -1)
            html += "<li><a data-key='Rp_Simulation' onclick='activeMenu(this)' href='#'>Distance estimation</a> </li>";

        html += "<li><a data-key='Rp_logtime' onclick='activeMenu(this)' href='#'>Smart tag - status realtime</a> </li>";
        if (permitionall.indexOf("ac_router") !== -1) {
            html += "<li><a data-key='GroupFindgprint' onclick='activeMenu(this)' href='#'>Set group findgprint</a> </li>";
            html += "<li><a data-key='AutoFindAddress' onclick='activeMenu(this)' href='#'>Auto find the way</a> </li>";
        }
           
        html += "</ul>";
        html += "</li>";
    }
   
    //System management
    if (permitionall.indexOf("ac_mensys") !== -1) {
        html += "<li>";
        html += "<a href='#' class='sidebar-nav-menu'><i class='fa fa-angle-left sidebar-nav-indicator'></i><i class='glyphicon glyphicon-th'></i> System management</a>";
        html += "<ul>";
        if (permitionall.indexOf("ac_onclound") !== -1)
            html += "<li><a href='#' data-href='#wearabouts/devices' onclick='activeMenunone(this)' class='js-goto'>On-cloud tracked tag</a></li>";
        if (permitionall.indexOf("ac_groupdevice") !== -1)
            html += "<li> <a href='#' data-key='manager-groupdevice' onclick='activeMenu(this)' class='js-goto'>Group management</a></li>";
        if (permitionall.indexOf("ac_trackedtag") !== -1)
            html += "<li><a href='#' data-key='manager-device' onclick='activeMenu(this)' class='js-goto'>Tracked tag management</a></li>";
        if (permitionall.indexOf("ac_usergroup") !== -1)
            html += "<li> <a data-key='usermanagergroup'  onclick='activeMenu(this)' href='#'>User group permission </a> </li>";
        if (permitionall.indexOf("ac_user") !== -1)
            html += "<li> <a data-key='usermanager'  onclick='activeMenu(this)' href='#'>Local user management </a> </li>";
        if (permitionall.indexOf("ac_config") !== -1)
            html += "<li><a href='#' onclick='activeMenunone(this)' data-href='#wearabouts/config' class='js-goto'>Configuration</a> </li>";
        if (permitionall.indexOf("ac_findger") !== -1)
            html += "<li><a href='#' data-key='Fingerprints'  onclick='activeMenu(this)' class='js-goto'>Fingerprints</a></li>";
        html += "</ul>";
        html += "</li>";
    }    

    //General
    if (permitionall.indexOf("ac_menugeneral") !== -1) {
        html += "<li>";
        html += "<a href='#' class='sidebar-nav-menu open'><i class='fa fa-angle-left sidebar-nav-indicator'></i><i class='hi hi-th sidebar-nav-icon'></i>General</a>";
        html += "<ul>";
        if (permitionall.indexOf("ac_level") !== -1)
            html += "<li><a onclick='activeMenunone(this)' href='#' data-href='#general/levels' class='js-goto'>Levels</a> </li>";
        if (permitionall.indexOf("ac_floor") !== -1)
            html += "<li><a onclick='activeMenunone(this)' href='#' data-href='#general/floorplans' class='js-goto'>Floor Plans</a></li>";
        if (permitionall.indexOf("ac_login") !== -1)
            html += "<li><li><a onclick='activeMenunone(this)' data-href='#login' class='js-goto' href='#'> Login</a> </li></li>";
        if (permitionall.indexOf("ac_change") !== -1)
            html += "<li><li><a data-key='ChangePassword'  onclick='activeMenu(this)' class='js-goto' href='#'> Change Password</a> </li></li>";
        if (permitionall.indexOf("ac_logout") !== -1)
            html += "<li><li><a href='/Home/Logout'> Logout</a> </li></li>";
        html += "</ul>";
        html += "</li>";
    }


    html += "</ul>";















// Add the correct copyright year at the footer

function dtmlXMLLoaderObject(t,e,n,i){return this.xmlDoc="",this.async="undefined"!=typeof n?n:!0,this.onloadAction=t||null,this.mainObject=e||null,this.waitCall=null,this.rSeed=i||!1,this}function callerFunction(t,e){return this.handler=function(n){return n||(n=window.event),t(n,e),!0}}function getAbsoluteLeft(t){return getOffset(t).left}function getAbsoluteTop(t){return getOffset(t).top}function getOffsetSum(t){for(var e=0,n=0;t;)e+=parseInt(t.offsetTop),n+=parseInt(t.offsetLeft),t=t.offsetParent;return{top:e,left:n}}function getOffsetRect(t){var e=t.getBoundingClientRect(),n=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||n.scrollTop,s=window.pageXOffset||i.scrollLeft||n.scrollLeft,a=i.clientTop||n.clientTop||0,r=i.clientLeft||n.clientLeft||0,l=e.top+o-a,c=e.left+s-r;return{top:Math.round(l),left:Math.round(c)}}function getOffset(t){return t.getBoundingClientRect?getOffsetRect(t):getOffsetSum(t)}function convertStringToBoolean(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(t){return-1!=t.indexOf("?")?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.dragStartObject=this.dragStartNode=this.dragNode=this.lastLanding=0,this.tempDOMM=this.tempDOMU=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function j(){return this.catches||(this.catches=[]),this}function dhtmlXHeir(t,e){for(var n in e)"function"==typeof e[n]&&(t[n]=e[n]);return t}function dhtmlxEvent(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function dhtmlXToolbarObject(t,e){var n=this;for(this.cont="object"!=typeof t?document.getElementById(t):t;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);return this.cont.dir="ltr",this.cont.innerHTML+="<div class='dhxtoolbar_hdrline_ll'></div><div class='dhxtoolbar_hdrline_rr'></div><div class='dhxtoolbar_hdrline_l'></div><div class='dhxtoolbar_hdrline_r'></div>",this.base=document.createElement("DIV"),this.base.className="float_left",this.cont.appendChild(this.base),this.align="left",this.setAlign=function(t){this.align="right"==t?"right":"left",this.base.className="right"==t?"float_right":"float_left",this._spacer&&(this._spacer.className="dhxtoolbar_spacer "+("right"==t?" float_left":" float_right"))},this._isIE6=!1,_isIE&&(this._isIE6=null==window.XMLHttpRequest?!0:!1),(this._isIPad=navigator.userAgent.search(/iPad/gi)>=0)&&(this.cont.ontouchstart=function(t){return t=t||event,"input"==String(t.target.tagName||"").toLowerCase()?!0:(t.returnValue=!1,t.cancelBubble=!0,!1)}),this.iconSize=18,this.setIconSize=function(t){this.iconSize={18:!0,24:!0,32:!0,48:!0}[t]?t:18,this.setSkin(this.skin,!0),this.callEvent("_onIconSizeChange",[this.iconSize])},this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=0,this._improveTerraceSkin=function(){var t=[],e={buttonInput:!0,separator:!0,text:!0},n=[this.base];null!=this._spacer&&n.push(this._spacer);for(var i=0;i<n.length;i++){t[i]=[];for(var o=0;o<n[i].childNodes.length;o++)if(null!=n[i].childNodes[o].idd&&"none"!=n[i].childNodes[o].style.display){var s=this.idPrefix+n[i].childNodes[o].idd;null!=this.objPull[s]&&this.objPull[s].obj==n[i].childNodes[o]&&t[i].push({a:s,type:this.objPull[s].type,node:this.objPull[s]["buttonSelect"==this.objPull[s].type?"arw":"obj"]})}n[i]=null}for(i=0;i<t.length;i++)for(o=0;o<t[i].length;o++){var a=t[i][o];"buttonInput"==a.type&&(a.node.className=a.node.className.replace(/dhx_toolbar_btn/,"dhx_toolbar_inp"));var r=!1,l=!1;e[a.type]||((o==t[i].length-1||null!=t[i][o+1]&&e[t[i][o+1].type])&&(r=!0),(0==o||o-1>=0&&null!=t[i][o-1]&&e[t[i][o-1].type])&&(l=!0)),a.node.style.borderRight=r?"1px solid #cecece":"0px solid white",a.node.style.borderTopRightRadius=a.node.style.borderBottomRightRadius=r?"5px":"0px","buttonSelect"==a.type?(a.node.previousSibling.style.borderTopLeftRadius=a.node.previousSibling.style.borderBottomLeftRadius=l?"5px":"0px",a.node.previousSibling._br=r,a.node.previousSibling._bl=l):a.node.style.borderTopLeftRadius=a.node.style.borderBottomLeftRadius=l?"5px":"0px",a.node._br=r,a.node._bl=l}for(i=0;i<t.length;i++){for(o=0;o<t[i].length;o++){for(s in t[i][o])t[i][o][s]=null;t[i][o]=null}t[i]=null}t=n=null},this._improveTerraceButtonSelect=function(t,e){var n=this.objPull[t];1==e?(n.obj.style.borderBottomLeftRadius=n.obj._bl?"5px":"0px",n.arw.style.borderBottomRightRadius=n.obj._br?"5px":"0px"):(n.obj.style.borderBottomLeftRadius="0px",n.arw.style.borderBottomRightRadius="0px"),n=null},this.setSkin=function(t,e){e===!0?this.cont.className=this.cont.className.replace(/dhx_toolbar_base_\d{1,}_/,"dhx_toolbar_base_"+this.iconSize+"_"):(this.skin=t,"dhx_skyblue"==this.skin&&(this.selectPolygonOffsetTop=1),"dhx_web"==this.skin&&(this.selectPolygonOffsetLeft=this.selectPolygonOffsetTop=1),"dhx_terrace"==this.skin&&(this.selectPolygonOffsetTop=-1,this.selectPolygonOffsetLeft=0),this.cont.className="dhx_toolbar_base_"+this.iconSize+"_"+this.skin+(this.rtl?" rtl":""));for(var n in this.objPull){var i=this.objPull[n];"slider"==i.type&&(i.pen._detectLimits(),i.pen._definePos(),i.label.className="dhx_toolbar_slider_label_"+this.skin+(this.rtl?" rtl":"")),"buttonSelect"==i.type&&(i.polygon.className="dhx_toolbar_poly_"+this.iconSize+"_"+this.skin+(this.rtl?" rtl":""))}"dhx_terrace"==t&&this._improveTerraceSkin()},this.setSkin(null!=e?e:"undefined"!=typeof dhtmlx&&"string"==typeof dhtmlx.skin?dhtmlx.skin:"dhx_skyblue"),this.objPull={},this.anyUsed="none",this.imagePath="",this.setIconPath=this.setIconsPath=function(t){this.imagePath=t},this._doOnLoad=function(){},this.loadXML=function(t,e){null!=e&&(this._doOnLoad=function(){e()}),this.callEvent("onXLS",[]),this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window),this._xmlLoader.loadXML(t)},this.loadXMLString=function(t,e){null!=e&&(this._doOnLoad=function(){e()}),this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window),this._xmlLoader.loadXMLString(t)},this._xmlParser=function(){for(var t=this.getXMLTopNode("toolbar"),e="id,type,hidden,title,text,enabled,img,imgdis,action,openAll,renderSelect,mode,maxOpen,width,value,selected,length,textMin,textMax,toolTip,valueMin,valueMax,valueNow".split(","),i="id,type,enabled,disabled,action,selected,img,text".split(","),o=0;o<t.childNodes.length;o++)if("item"==t.childNodes[o].tagName){for(var s={},a=0;a<e.length;a++)s[e[a]]=t.childNodes[o].getAttribute(e[a]);s.items=[],s.userdata=[];for(var r=0;r<t.childNodes[o].childNodes.length;r++){if("item"==t.childNodes[o].childNodes[r].tagName&&"buttonSelect"==s.type){for(var l={},a=0;a<i.length;a++)l[i[a]]=t.childNodes[o].childNodes[r].getAttribute(i[a]);var c=t.childNodes[o].childNodes[r].getElementsByTagName("itemText");null!=c&&null!=c[0]&&(l.itemText=c[0].firstChild.nodeValue);for(var u=t.childNodes[o].childNodes[r].getElementsByTagName("userdata"),a=0;a<u.length;a++){l.userdata||(l.userdata={});var d={};try{d.name=u[a].getAttribute("name")}catch(h){d.name=""}try{d.value=u[a].firstChild.nodeValue}catch(p){d.value=""}""!=d.name&&(l.userdata[d.name]=d.value)}s.items[s.items.length]=l}if("userdata"==t.childNodes[o].childNodes[r].tagName){l={};try{l.name=t.childNodes[o].childNodes[r].getAttribute("name")}catch(f){l.name=""}try{l.value=t.childNodes[o].childNodes[r].firstChild.nodeValue}catch(g){l.value=""}s.userdata[s.userdata.length]=l}}n._addItemToStorage(s)}"dhx_terrace"==n.skin&&n._improveTerraceSkin(),n.callEvent("onXLE",[]),n._doOnLoad(),this.destructor()},this._addItemToStorage=function(t,e){var n=t.id||this._genStr(24),i=t.type||"";if(""!=i&&null!=this["_"+i+"Object"]&&("undefined"!=typeof t.openAll&&null!=t.openAll||"dhx_terrace"!=this.skin||(t.openAll=!0),this.objPull[this.idPrefix+n]=new this["_"+i+"Object"](this,n,t),this.objPull[this.idPrefix+n].type=i,this.setPosition(n,e)),t.userdata)for(var o=0;o<t.userdata.length;o++)this.setUserData(n,t.userdata[o].name,t.userdata[o].value)},this._genStr=function(t){for(var e="",n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=0;t>i;i++)e+=n.charAt(Math.round(Math.random()*(n.length-1)));return e},this.rootTypes="button,buttonSelect,buttonTwoState,separator,label,slider,text,buttonInput".split(","),this.idPrefix=this._genStr(12),dhtmlxEventable(this),this._getObj=function(t,e){for(var n=null,i=0;i<t.childNodes.length;i++)null!=t.childNodes[i].tagName&&String(t.childNodes[i].tagName).toLowerCase()==String(e).toLowerCase()&&(n=t.childNodes[i]);return n},this._addImgObj=function(t){var e=document.createElement("IMG");return t.childNodes.length>0?t.insertBefore(e,t.childNodes[0]):t.appendChild(e),e},this._setItemImage=function(t,e,n){if(1==n?t.imgEn=e:t.imgDis=e,!(!t.state&&1==n||t.state&&0==n)){var i=this._getObj(t.obj,"img");null==i&&(i=this._addImgObj(t.obj)),i.src=this.imagePath+e}},this._clearItemImage=function(t,e){if(1==e?t.imgEn="":t.imgDis="",!(!t.state&&1==e||t.state&&0==e)){var n=this._getObj(t.obj,"img");null!=n&&n.parentNode.removeChild(n)}},this._setItemText=function(t,e){var n=this._getObj(t.obj,"div");null==e||0==e.length?null!=n&&n.parentNode.removeChild(n):(null==n&&(n=document.createElement("DIV"),t.obj.appendChild(n)),n.innerHTML=e)},this._getItemText=function(t){var e=this._getObj(t.obj,"div");return null!=e?e.innerHTML:""},this._enableItem=function(t){if(!t.state){t.state=!0,"buttonTwoState"==this.objPull[t.id].type&&1==this.objPull[t.id].obj.pressed?(t.obj.className="dhx_toolbar_btn pres",t.obj.renderAs="dhx_toolbar_btn over"):(t.obj.className="dhx_toolbar_btn def",t.obj.renderAs=t.obj.className),t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgEn?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.imagePath+t.imgEn):null!=e&&e.parentNode.removeChild(e)}},this._disableItem=function(t){if(t.state){t.state=!1,t.obj.className="dhx_toolbar_btn "+("buttonTwoState"==this.objPull[t.id].type&&t.obj.pressed?"pres_":"")+"dis",t.obj.renderAs="dhx_toolbar_btn def",t.arw&&(t.arw.className=String(t.obj.className).replace("btn","arw"));var e=this._getObj(t.obj,"img");""!=t.imgDis?(null==e&&(e=this._addImgObj(t.obj)),e.src=this.imagePath+t.imgDis):null!=e&&e.parentNode.removeChild(e),null!=t.polygon&&"none"!=t.polygon.style.display&&(t.polygon.style.display="none",t.polygon._ie6cover&&(t.polygon._ie6cover.style.display="none"),"dhx_terrace"==this.skin&&this._improveTerraceButtonSelect(t.id,!0)),this.anyUsed="none"}},this.clearAll=function(){for(var t in this.objPull)this._removeItem(String(t).replace(this.idPrefix,""))},this._isWebToolbar=!0,this._doOnClick=function(){n&&n.forEachItem&&n.forEachItem(function(t){if("buttonSelect"==n.objPull[n.idPrefix+t].type){var e=n.objPull[n.idPrefix+t];e.arw._skip===!0?e.arw._skip=!1:"none"!=e.polygon.style.display&&(e.obj.renderAs="dhx_toolbar_btn def",e.obj.className=e.obj.renderAs,e.arw.className=String(e.obj.renderAs).replace("btn","arw"),n.anyUsed="none",e.polygon.style.display="none",e.polygon._ie6cover&&(e.polygon._ie6cover.style.display="none"),"dhx_terrace"==n.skin&&n._improveTerraceButtonSelect(e.id,!0))}})},this._isIPad?document.addEventListener("touchstart",this._doOnClick,!1):"undefined"!=typeof window.addEventListener?window.addEventListener("mousedown",this._doOnClick,!1):document.body.attachEvent("onmousedown",this._doOnClick),this}+function(t){"use strict";var e='[data-dismiss="alert"]',n=function(n){t(n).on("click",e,this.close)};n.prototype.close=function(e){function n(){s.trigger("closed.bs.alert").remove()}var i=t(this),o=i.attr("data-target");o||(o=i.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,""));var s=t(o);e&&e.preventDefault(),s.length||(s=i.hasClass("alert")?i:i.parent()),s.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one(t.support.transition.end,n).emulateTransitionEnd(150):n())};var i=t.fn.alert;t.fn.alert=function(e){return this.each(function(){var i=t(this),o=i.data("bs.alert");o||i.data("bs.alert",o=new n(this)),"string"==typeof e&&o[e].call(i)})},t.fn.alert.Constructor=n,t.fn.alert.noConflict=function(){return t.fn.alert=i,this},t(document).on("click.bs.alert.data-api",e,n.prototype.close)}(jQuery),+function(t){"use strict";var e=function(n,i){this.$element=t(n),this.options=t.extend({},e.DEFAULTS,i),this.isLoading=!1};e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(e){var n="disabled",i=this.$element,o=i.is("input")?"val":"html",s=i.data();e+="Text",s.resetText||i.data("resetText",i[o]()),i[o](s[e]||this.options[e]),setTimeout(t.proxy(function(){"loadingText"==e?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},e.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")&&(n.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}t&&this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=function(n){return this.each(function(){var i=t(this),o=i.data("bs.button"),s="object"==typeof n&&n;o||i.data("bs.button",o=new e(this,s)),"toggle"==n?o.toggle():n&&o.setState(n)})},t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api","[data-toggle^=button]",function(e){var n=t(e.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle"),e.preventDefault()})}(jQuery),+function(t){"use strict";var e=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",t.proxy(this.pause,this)).on("mouseleave",t.proxy(this.cycle,this))};e.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},e.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},e.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},e.prototype.to=function(e){var n=this,i=this.getActiveIndex();if(!(e>this.$items.length-1||0>e))return this.sliding?this.$element.one("slid.bs.carousel",function(){n.to(e)}):i==e?this.pause().cycle():this.slide(e>i?"next":"prev",t(this.$items[e]))},e.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},e.prototype.next=function(){return this.sliding?void 0:this.slide("next")},e.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},e.prototype.slide=function(e,n){var i=this.$element.find(".item.active"),o=n||i[e](),s=this.interval,a="next"==e?"left":"right",r="next"==e?"first":"last",l=this;if(!o.length){if(!this.options.wrap)return;o=this.$element.find(".item")[r]()}if(o.hasClass("active"))return this.sliding=!1;var c=t.Event("slide.bs.carousel",{relatedTarget:o[0],direction:a});return this.$element.trigger(c),c.isDefaultPrevented()?void 0:(this.sliding=!0,s&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var e=t(l.$indicators.children()[l.getActiveIndex()]);e&&e.addClass("active")})),t.support.transition&&this.$element.hasClass("slide")?(o.addClass(e),o[0].offsetWidth,i.addClass(a),o.addClass(a),i.one(t.support.transition.end,function(){o.removeClass([e,a].join(" ")).addClass("active"),i.removeClass(["active",a].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(1e3*i.css("transition-duration").slice(0,-1))):(i.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")),s&&this.cycle(),this)};var n=t.fn.carousel;t.fn.carousel=function(n){return this.each(function(){var i=t(this),o=i.data("bs.carousel"),s=t.extend({},e.DEFAULTS,i.data(),"object"==typeof n&&n),a="string"==typeof n?n:s.slide;o||i.data("bs.carousel",o=new e(this,s)),"number"==typeof n?o.to(n):a?o[a]():s.interval&&o.pause().cycle()})},t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=n,this},t(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(e){var n,i=t(this),o=t(i.attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),s=t.extend({},o.data(),i.data()),a=i.attr("data-slide-to");a&&(s.interval=!1),o.carousel(s),(a=i.attr("data-slide-to"))&&o.data("bs.carousel").to(a),e.preventDefault()}),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var e=t(this);e.carousel(e.data())})})}(jQuery),+function(t){function e(e){t(i).remove(),t(o).each(function(){var i=n(t(this)),o={relatedTarget:this};i.hasClass("open")&&(i.trigger(e=t.Event("hide.bs.dropdown",o)),e.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",o))})}function n(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}var i=".dropdown-backdrop",o="[data-toggle=dropdown]",s=function(e){t(e).on("click.bs.dropdown",this.toggle)};s.prototype.toggle=function(i){var o=t(this);if(!o.is(".disabled, :disabled")){var s=n(o),a=s.hasClass("open");if(e(),!a){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e);var r={relatedTarget:this};if(s.trigger(i=t.Event("show.bs.dropdown",r)),i.isDefaultPrevented())return;s.toggleClass("open").trigger("shown.bs.dropdown",r),o.focus()}return!1}},s.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var i=t(this);if(e.preventDefault(),e.stopPropagation(),!i.is(".disabled, :disabled")){var s=n(i),a=s.hasClass("open");if(!a||a&&27==e.keyCode)return 27==e.which&&s.find(o).focus(),i.click();var r=" li:not(.divider):visible a",l=s.find("[role=menu]"+r+", [role=listbox]"+r);if(l.length){var c=l.index(l.filter(":focus"));38==e.keyCode&&c>0&&c--,40==e.keyCode&&c<l.length-1&&c++,~c||(c=0),l.eq(c).focus()}}}};var a=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new s(this)),"string"==typeof e&&i[e].call(n)})},t.fn.dropdown.Constructor=s,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",o,s.prototype.toggle).on("keydown.bs.dropdown.data-api",o+", [role=menu], [role=listbox]",s.prototype.keydown)}(jQuery),+function(t){"use strict";var e=function(e,n){this.options=n,this.$element=t(e),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this[this.isShown?"hide":"show"](t)},e.prototype.show=function(e){var n=this,i=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.backdrop(function(){var i=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show().scrollTop(0),i&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:e});i?n.$element.find(".modal-dialog").one(t.support.transition.end,function(){n.$element.focus().trigger(o)}).emulateTransitionEnd(300):n.$element.focus().trigger(o)}))},e.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one(t.support.transition.end,t.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},e.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]!==t.target&&!this.$element.has(t.target).length&&this.$element.focus()},this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden.bs.modal")})},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(e){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=t.support.transition&&n;if(this.$backdrop=t('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;i?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()):e&&e()};var n=t.fn.modal;t.fn.modal=function(n,i){return this.each(function(){var o=t(this),s=o.data("bs.modal"),a=t.extend({},e.DEFAULTS,o.data(),"object"==typeof n&&n);s||o.data("bs.modal",s=new e(this,a)),"string"==typeof n?s[n](i):a.show&&s.show(i)})},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var n=t(this),i=n.attr("href"),o=t(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),s=o.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(i)&&i},o.data(),n.data());n.is("a")&&e.preventDefault(),o.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),t(document).on("show.bs.modal",".modal",function(){t(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){t(document.body).removeClass("modal-open")})}(jQuery),+function(t){"use strict";var e=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.prototype.init=function(e,n,i){this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i);for(var o=this.options.trigger.split(" "),s=o.length;s--;){var a=o[s];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var r="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},e.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},e.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show()},e.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},e.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;var n=this,i=this.tip();this.setContent(),this.options.animation&&i.addClass("fade");var o="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,a=s.test(o);a&&(o=o.replace(s,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(o),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var r=this.getPosition(),l=i[0].offsetWidth,c=i[0].offsetHeight;if(a){var u=this.$element.parent(),d=o,h=document.documentElement.scrollTop||document.body.scrollTop,p="body"==this.options.container?window.innerWidth:u.outerWidth(),f="body"==this.options.container?window.innerHeight:u.outerHeight(),g="body"==this.options.container?0:u.offset().left;o="bottom"==o&&r.top+r.height+c-h>f?"top":"top"==o&&r.top-h-c<0?"bottom":"right"==o&&r.right+l>p?"left":"left"==o&&r.left-l<g?"right":o,i.removeClass(d).addClass(o)}var m=this.getCalculatedOffset(o,r,l,c);this.applyPlacement(m,o),this.hoverState=null;var v=function(){n.$element.trigger("shown.bs."+n.type)};t.support.transition&&this.$tip.hasClass("fade")?i.one(t.support.transition.end,v).emulateTransitionEnd(150):v()}},e.prototype.applyPlacement=function(e,n){var i,o=this.tip(),s=o[0].offsetWidth,a=o[0].offsetHeight,r=parseInt(o.css("margin-top"),10),l=parseInt(o.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(l)&&(l=0),e.top=e.top+r,e.left=e.left+l,t.offset.setOffset(o[0],t.extend({using:function(t){o.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),o.addClass("in");var c=o[0].offsetWidth,u=o[0].offsetHeight;if("top"==n&&u!=a&&(i=!0,e.top=e.top+a-u),/bottom|top/.test(n)){var d=0;e.left<0&&(d=-2*e.left,e.left=0,o.offset(e),c=o[0].offsetWidth,u=o[0].offsetHeight),this.replaceArrow(d-s+c,c,"left")}else this.replaceArrow(u-a,u,"top");i&&o.offset(e)},e.prototype.replaceArrow=function(t,e,n){this.arrow().css(n,t?50*(1-t/e)+"%":"")},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},e.prototype.hide=function(){function e(){"in"!=n.hoverState&&i.detach(),n.$element.trigger("hidden.bs."+n.type)}var n=this,i=this.tip(),o=t.Event("hide.bs."+this.type);return this.$element.trigger(o),o.isDefaultPrevented()?void 0:(i.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?i.one(t.support.transition.end,e).emulateTransitionEnd(150):e(),this.hoverState=null,this)},e.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(){var e=this.$element[0];return t.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},e.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},e.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},e.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(e){var n=e?t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("in")?n.leave(n):n.enter(n)},e.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=t.fn.tooltip;t.fn.tooltip=function(n){return this.each(function(){var i=t(this),o=i.data("bs.tooltip"),s="object"==typeof n&&n;(o||"destroy"!=n)&&(o||i.data("bs.tooltip",o=new e(this,s)),"string"==typeof n&&o[n]())})},t.fn.tooltip.Constructor=e,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=n,this}}(jQuery),+function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),e.prototype.constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},e.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var n=t.fn.popover;t.fn.popover=function(n){return this.each(function(){var i=t(this),o=i.data("bs.popover"),s="object"==typeof n&&n;(o||"destroy"!=n)&&(o||i.data("bs.popover",o=new e(this,s)),"string"==typeof n&&o[n]())})},t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=n,this}}(jQuery),+function(t){"use strict";var e=function(e){this.element=t(e)};e.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=e.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=n.find(".active:last a")[0],s=t.Event("show.bs.tab",{relatedTarget:o});if(e.trigger(s),!s.isDefaultPrevented()){var a=t(i);this.activate(e.parent("li"),n),this.activate(a,a.parent(),function(){e.trigger({type:"shown.bs.tab",relatedTarget:o})})}}},e.prototype.activate=function(e,n,i){function o(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),i&&i()
}var s=n.find("> .active"),a=i&&t.support.transition&&s.hasClass("fade");a?s.one(t.support.transition.end,o).emulateTransitionEnd(150):o(),s.removeClass("in")};var n=t.fn.tab;t.fn.tab=function(n){return this.each(function(){var i=t(this),o=i.data("bs.tab");o||i.data("bs.tab",o=new e(this)),"string"==typeof n&&o[n]()})},t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=n,this},t(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),t(this).tab("show")})}(jQuery),+function(t){"use strict";var e=function(n,i){this.options=t.extend({},e.DEFAULTS,i),this.$window=t(window).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$window.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var n=t(document).height(),i=this.$window.scrollTop(),o=this.$element.offset(),s=this.options.offset,a=s.top,r=s.bottom;"top"==this.affixed&&(o.top+=i),"object"!=typeof s&&(r=a=s),"function"==typeof a&&(a=s.top(this.$element)),"function"==typeof r&&(r=s.bottom(this.$element));var l=null!=this.unpin&&i+this.unpin<=o.top?!1:null!=r&&o.top+this.$element.height()>=n-r?"bottom":null!=a&&a>=i?"top":!1;if(this.affixed!==l){this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),u=t.Event(c+".bs.affix");this.$element.trigger(u),u.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(c).trigger(t.Event(c.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:n-r-this.$element.height()}))}}};var n=t.fn.affix;t.fn.affix=function(n){return this.each(function(){var i=t(this),o=i.data("bs.affix"),s="object"==typeof n&&n;o||i.data("bs.affix",o=new e(this,s)),"string"==typeof n&&o[n]()})},t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=n,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),n=e.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),e.affix(n)})})}(jQuery),+function(t){"use strict";var e=function(n,i){this.$element=t(n),this.options=t.extend({},e.DEFAULTS,i),this.transitioning=null,this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};e.DEFAULTS={toggle:!0},e.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},e.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e=t.Event("show.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var i=n.data("bs.collapse");if(i&&i.transitioning)return;n.collapse("hide"),i||n.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return s.call(this);var a=t.camelCase(["scroll",o].join("-"));this.$element.one(t.support.transition.end,t.proxy(s,this)).emulateTransitionEnd(350)[o](this.$element[0][a])}}},e.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return t.support.transition?void this.$element[n](0).one(t.support.transition.end,t.proxy(i,this)).emulateTransitionEnd(350):i.call(this)}}},e.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=t.fn.collapse;t.fn.collapse=function(n){return this.each(function(){var i=t(this),o=i.data("bs.collapse"),s=t.extend({},e.DEFAULTS,i.data(),"object"==typeof n&&n);!o&&s.toggle&&"show"==n&&(n=!n),o||i.data("bs.collapse",o=new e(this,s)),"string"==typeof n&&o[n]()})},t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=n,this},t(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(e){var n,i=t(this),o=i.attr("data-target")||e.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),s=t(o),a=s.data("bs.collapse"),r=a?"toggle":i.data(),l=i.attr("data-parent"),c=l&&t(l);a&&a.transitioning||(c&&c.find('[data-toggle=collapse][data-parent="'+l+'"]').not(i).addClass("collapsed"),i[s.hasClass("in")?"addClass":"removeClass"]("collapsed")),s.collapse(r)})}(jQuery),+function(t){function e(n,i){var o,s=t.proxy(this.process,this);this.$element=t(t(n).is("body")?window:n),this.$body=t("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",s),this.options=t.extend({},e.DEFAULTS,i),this.selector=(this.options.target||(o=t(n).attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=t([]),this.targets=t([]),this.activeTarget=null,this.refresh(),this.process()}e.DEFAULTS={offset:10},e.prototype.refresh=function(){var e=this.$element[0]==window?"offset":"position";this.offsets=t([]),this.targets=t([]);{var n=this;this.$body.find(this.selector).map(function(){var i=t(this),o=i.data("target")||i.attr("href"),s=/^#./.test(o)&&t(o);return s&&s.length&&s.is(":visible")&&[[s[e]().top+(!t.isWindow(n.$scrollElement.get(0))&&n.$scrollElement.scrollTop()),o]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})}},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,i=n-this.$scrollElement.height(),o=this.offsets,s=this.targets,a=this.activeTarget;if(e>=i)return a!=(t=s.last()[0])&&this.activate(t);if(a&&e<=o[0])return a!=(t=s[0])&&this.activate(t);for(t=o.length;t--;)a!=s[t]&&e>=o[t]&&(!o[t+1]||e<=o[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,t(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")};var n=t.fn.scrollspy;t.fn.scrollspy=function(n){return this.each(function(){var i=t(this),o=i.data("bs.scrollspy"),s="object"==typeof n&&n;o||i.data("bs.scrollspy",o=new e(this,s)),"string"==typeof n&&o[n]()})},t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=n,this},t(window).on("load",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);e.scrollspy(e.data())})})}(jQuery),+function(t){function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one(t.support.transition.end,function(){n=!0});var o=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(o,e),this},t(function(){t.support.transition=e()})}(jQuery),define("bootstrap",function(){}),function(){var t=this,e=t._,n=Array.prototype,i=Object.prototype,o=Function.prototype,s=n.push,a=n.slice,r=n.concat,l=i.toString,c=i.hasOwnProperty,u=Array.isArray,d=Object.keys,h=o.bind,p=function(t){return t instanceof p?t:this instanceof p?void(this._wrapped=t):new p(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):t._=p,p.VERSION="1.7.0";var f=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)};case 4:return function(n,i,o,s){return t.call(e,n,i,o,s)}}return function(){return t.apply(e,arguments)}};p.iteratee=function(t,e,n){return null==t?p.identity:p.isFunction(t)?f(t,e,n):p.isObject(t)?p.matches(t):p.property(t)},p.each=p.forEach=function(t,e,n){if(null==t)return t;e=f(e,n);var i,o=t.length;if(o===+o)for(i=0;o>i;i++)e(t[i],i,t);else{var s=p.keys(t);for(i=0,o=s.length;o>i;i++)e(t[s[i]],s[i],t)}return t},p.map=p.collect=function(t,e,n){if(null==t)return[];e=p.iteratee(e,n);for(var i,o=t.length!==+t.length&&p.keys(t),s=(o||t).length,a=Array(s),r=0;s>r;r++)i=o?o[r]:r,a[r]=e(t[i],i,t);return a};var g="Reduce of empty array with no initial value";p.reduce=p.foldl=p.inject=function(t,e,n,i){null==t&&(t=[]),e=f(e,i,4);var o,s=t.length!==+t.length&&p.keys(t),a=(s||t).length,r=0;if(arguments.length<3){if(!a)throw new TypeError(g);n=t[s?s[r++]:r++]}for(;a>r;r++)o=s?s[r]:r,n=e(n,t[o],o,t);return n},p.reduceRight=p.foldr=function(t,e,n,i){null==t&&(t=[]),e=f(e,i,4);var o,s=t.length!==+t.length&&p.keys(t),a=(s||t).length;if(arguments.length<3){if(!a)throw new TypeError(g);n=t[s?s[--a]:--a]}for(;a--;)o=s?s[a]:a,n=e(n,t[o],o,t);return n},p.find=p.detect=function(t,e,n){var i;return e=p.iteratee(e,n),p.some(t,function(t,n,o){return e(t,n,o)?(i=t,!0):void 0}),i},p.filter=p.select=function(t,e,n){var i=[];return null==t?i:(e=p.iteratee(e,n),p.each(t,function(t,n,o){e(t,n,o)&&i.push(t)}),i)},p.reject=function(t,e,n){return p.filter(t,p.negate(p.iteratee(e)),n)},p.every=p.all=function(t,e,n){if(null==t)return!0;e=p.iteratee(e,n);var i,o,s=t.length!==+t.length&&p.keys(t),a=(s||t).length;for(i=0;a>i;i++)if(o=s?s[i]:i,!e(t[o],o,t))return!1;return!0},p.some=p.any=function(t,e,n){if(null==t)return!1;e=p.iteratee(e,n);var i,o,s=t.length!==+t.length&&p.keys(t),a=(s||t).length;for(i=0;a>i;i++)if(o=s?s[i]:i,e(t[o],o,t))return!0;return!1},p.contains=p.include=function(t,e){return null==t?!1:(t.length!==+t.length&&(t=p.values(t)),p.indexOf(t,e)>=0)},p.invoke=function(t,e){var n=a.call(arguments,2),i=p.isFunction(e);return p.map(t,function(t){return(i?e:t[e]).apply(t,n)})},p.pluck=function(t,e){return p.map(t,p.property(e))},p.where=function(t,e){return p.filter(t,p.matches(e))},p.findWhere=function(t,e){return p.find(t,p.matches(e))},p.max=function(t,e,n){var i,o,s=-1/0,a=-1/0;if(null==e&&null!=t){t=t.length===+t.length?t:p.values(t);for(var r=0,l=t.length;l>r;r++)i=t[r],i>s&&(s=i)}else e=p.iteratee(e,n),p.each(t,function(t,n,i){o=e(t,n,i),(o>a||o===-1/0&&s===-1/0)&&(s=t,a=o)});return s},p.min=function(t,e,n){var i,o,s=1/0,a=1/0;if(null==e&&null!=t){t=t.length===+t.length?t:p.values(t);for(var r=0,l=t.length;l>r;r++)i=t[r],s>i&&(s=i)}else e=p.iteratee(e,n),p.each(t,function(t,n,i){o=e(t,n,i),(a>o||1/0===o&&1/0===s)&&(s=t,a=o)});return s},p.shuffle=function(t){for(var e,n=t&&t.length===+t.length?t:p.values(t),i=n.length,o=Array(i),s=0;i>s;s++)e=p.random(0,s),e!==s&&(o[s]=o[e]),o[e]=n[s];return o},p.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=p.values(t)),t[p.random(t.length-1)]):p.shuffle(t).slice(0,Math.max(0,e))},p.sortBy=function(t,e,n){return e=p.iteratee(e,n),p.pluck(p.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var m=function(t){return function(e,n,i){var o={};return n=p.iteratee(n,i),p.each(e,function(i,s){var a=n(i,s,e);t(o,i,a)}),o}};p.groupBy=m(function(t,e,n){p.has(t,n)?t[n].push(e):t[n]=[e]}),p.indexBy=m(function(t,e,n){t[n]=e}),p.countBy=m(function(t,e,n){p.has(t,n)?t[n]++:t[n]=1}),p.sortedIndex=function(t,e,n,i){n=p.iteratee(n,i,1);for(var o=n(e),s=0,a=t.length;a>s;){var r=s+a>>>1;n(t[r])<o?s=r+1:a=r}return s},p.toArray=function(t){return t?p.isArray(t)?a.call(t):t.length===+t.length?p.map(t,p.identity):p.values(t):[]},p.size=function(t){return null==t?0:t.length===+t.length?t.length:p.keys(t).length},p.partition=function(t,e,n){e=p.iteratee(e,n);var i=[],o=[];return p.each(t,function(t,n,s){(e(t,n,s)?i:o).push(t)}),[i,o]},p.first=p.head=p.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:a.call(t,0,e)},p.initial=function(t,e,n){return a.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},p.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},p.rest=p.tail=p.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},p.compact=function(t){return p.filter(t,p.identity)};var v=function(t,e,n,i){if(e&&p.every(t,p.isArray))return r.apply(i,t);for(var o=0,a=t.length;a>o;o++){var l=t[o];p.isArray(l)||p.isArguments(l)?e?s.apply(i,l):v(l,e,n,i):n||i.push(l)}return i};p.flatten=function(t,e){return v(t,e,!1,[])},p.without=function(t){return p.difference(t,a.call(arguments,1))},p.uniq=p.unique=function(t,e,n,i){if(null==t)return[];p.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=p.iteratee(n,i));for(var o=[],s=[],a=0,r=t.length;r>a;a++){var l=t[a];if(e)a&&s===l||o.push(l),s=l;else if(n){var c=n(l,a,t);p.indexOf(s,c)<0&&(s.push(c),o.push(l))}else p.indexOf(o,l)<0&&o.push(l)}return o},p.union=function(){return p.uniq(v(arguments,!0,!0,[]))},p.intersection=function(t){if(null==t)return[];for(var e=[],n=arguments.length,i=0,o=t.length;o>i;i++){var s=t[i];if(!p.contains(e,s)){for(var a=1;n>a&&p.contains(arguments[a],s);a++);a===n&&e.push(s)}}return e},p.difference=function(t){var e=v(a.call(arguments,1),!0,!0,[]);return p.filter(t,function(t){return!p.contains(e,t)})},p.zip=function(t){if(null==t)return[];for(var e=p.max(arguments,"length").length,n=Array(e),i=0;e>i;i++)n[i]=p.pluck(arguments,i);return n},p.object=function(t,e){if(null==t)return{};for(var n={},i=0,o=t.length;o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},p.indexOf=function(t,e,n){if(null==t)return-1;var i=0,o=t.length;if(n){if("number"!=typeof n)return i=p.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,o+n):n}for(;o>i;i++)if(t[i]===e)return i;return-1},p.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=t.length;for("number"==typeof n&&(i=0>n?i+n+1:Math.min(i,n+1));--i>=0;)if(t[i]===e)return i;return-1},p.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=Array(i),s=0;i>s;s++,t+=n)o[s]=t;return o};var b=function(){};p.bind=function(t,e){var n,i;if(h&&t.bind===h)return h.apply(t,a.call(arguments,1));if(!p.isFunction(t))throw new TypeError("Bind must be called on a function");return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));b.prototype=t.prototype;var o=new b;b.prototype=null;var s=t.apply(o,n.concat(a.call(arguments)));return p.isObject(s)?s:o}},p.partial=function(t){var e=a.call(arguments,1);return function(){for(var n=0,i=e.slice(),o=0,s=i.length;s>o;o++)i[o]===p&&(i[o]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},p.bindAll=function(t){var e,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(e=1;i>e;e++)n=arguments[e],t[n]=p.bind(t[n],t);return t},p.memoize=function(t,e){var n=function(i){var o=n.cache,s=e?e.apply(this,arguments):i;return p.has(o,s)||(o[s]=t.apply(this,arguments)),o[s]};return n.cache={},n},p.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},p.defer=function(t){return p.delay.apply(p,[t,1].concat(a.call(arguments,1)))},p.throttle=function(t,e,n){var i,o,s,a=null,r=0;n||(n={});var l=function(){r=n.leading===!1?0:p.now(),a=null,s=t.apply(i,o),a||(i=o=null)};return function(){var c=p.now();r||n.leading!==!1||(r=c);var u=e-(c-r);return i=this,o=arguments,0>=u||u>e?(clearTimeout(a),a=null,r=c,s=t.apply(i,o),a||(i=o=null)):a||n.trailing===!1||(a=setTimeout(l,u)),s}},p.debounce=function(t,e,n){var i,o,s,a,r,l=function(){var c=p.now()-a;e>c&&c>0?i=setTimeout(l,e-c):(i=null,n||(r=t.apply(s,o),i||(s=o=null)))};return function(){s=this,o=arguments,a=p.now();var c=n&&!i;return i||(i=setTimeout(l,e)),c&&(r=t.apply(s,o),s=o=null),r}},p.wrap=function(t,e){return p.partial(e,t)},p.negate=function(t){return function(){return!t.apply(this,arguments)}},p.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},p.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},p.before=function(t,e){var n;return function(){return--t>0?n=e.apply(this,arguments):e=null,n}},p.once=p.partial(p.before,2),p.keys=function(t){if(!p.isObject(t))return[];if(d)return d(t);var e=[];for(var n in t)p.has(t,n)&&e.push(n);return e},p.values=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=t[e[o]];return i},p.pairs=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),o=0;n>o;o++)i[o]=[e[o],t[e[o]]];return i},p.invert=function(t){for(var e={},n=p.keys(t),i=0,o=n.length;o>i;i++)e[t[n[i]]]=n[i];return e},p.functions=p.methods=function(t){var e=[];for(var n in t)p.isFunction(t[n])&&e.push(n);return e.sort()},p.extend=function(t){if(!p.isObject(t))return t;for(var e,n,i=1,o=arguments.length;o>i;i++){e=arguments[i];for(n in e)c.call(e,n)&&(t[n]=e[n])}return t},p.pick=function(t,e,n){var i,o={};if(null==t)return o;if(p.isFunction(e)){e=f(e,n);for(i in t){var s=t[i];e(s,i,t)&&(o[i]=s)}}else{var l=r.apply([],a.call(arguments,1));t=new Object(t);for(var c=0,u=l.length;u>c;c++)i=l[c],i in t&&(o[i]=t[i])}return o},p.omit=function(t,e,n){if(p.isFunction(e))e=p.negate(e);else{var i=p.map(r.apply([],a.call(arguments,1)),String);e=function(t,e){return!p.contains(i,e)}}return p.pick(t,e,n)},p.defaults=function(t){if(!p.isObject(t))return t;for(var e=1,n=arguments.length;n>e;e++){var i=arguments[e];for(var o in i)void 0===t[o]&&(t[o]=i[o])}return t},p.clone=function(t){return p.isObject(t)?p.isArray(t)?t.slice():p.extend({},t):t},p.tap=function(t,e){return e(t),t};var y=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof p&&(t=t._wrapped),e instanceof p&&(e=e._wrapped);var o=l.call(t);if(o!==l.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=n.length;s--;)if(n[s]===t)return i[s]===e;var a=t.constructor,r=e.constructor;if(a!==r&&"constructor"in t&&"constructor"in e&&!(p.isFunction(a)&&a instanceof a&&p.isFunction(r)&&r instanceof r))return!1;n.push(t),i.push(e);var c,u;if("[object Array]"===o){if(c=t.length,u=c===e.length)for(;c--&&(u=y(t[c],e[c],n,i)););}else{var d,h=p.keys(t);if(c=h.length,u=p.keys(e).length===c)for(;c--&&(d=h[c],u=p.has(e,d)&&y(t[d],e[d],n,i)););}return n.pop(),i.pop(),u};p.isEqual=function(t,e){return y(t,e,[],[])},p.isEmpty=function(t){if(null==t)return!0;if(p.isArray(t)||p.isString(t)||p.isArguments(t))return 0===t.length;for(var e in t)if(p.has(t,e))return!1;return!0},p.isElement=function(t){return!(!t||1!==t.nodeType)},p.isArray=u||function(t){return"[object Array]"===l.call(t)},p.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},p.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){p["is"+t]=function(e){return l.call(e)==="[object "+t+"]"}}),p.isArguments(arguments)||(p.isArguments=function(t){return p.has(t,"callee")}),"function"!=typeof/./&&(p.isFunction=function(t){return"function"==typeof t||!1}),p.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},p.isNaN=function(t){return p.isNumber(t)&&t!==+t},p.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===l.call(t)},p.isNull=function(t){return null===t},p.isUndefined=function(t){return void 0===t},p.has=function(t,e){return null!=t&&c.call(t,e)},p.noConflict=function(){return t._=e,this},p.identity=function(t){return t},p.constant=function(t){return function(){return t}},p.noop=function(){},p.property=function(t){return function(e){return e[t]}},p.matches=function(t){var e=p.pairs(t),n=e.length;return function(t){if(null==t)return!n;t=new Object(t);for(var i=0;n>i;i++){var o=e[i],s=o[0];if(o[1]!==t[s]||!(s in t))return!1}return!0}},p.times=function(t,e,n){var i=Array(Math.max(0,t));e=f(e,n,1);for(var o=0;t>o;o++)i[o]=e(o);return i},p.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},p.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},_=p.invert(w),x=function(t){var e=function(e){return t[e]},n="(?:"+p.keys(t).join("|")+")",i=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(o,e):t}};p.escape=x(w),p.unescape=x(_),p.result=function(t,e){if(null==t)return void 0;var n=t[e];return p.isFunction(n)?t[e]():n};var C=0;p.uniqueId=function(t){var e=++C+"";return t?t+e:e},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var S=/(.)^/,T={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,k=function(t){return"\\"+T[t]};p.template=function(t,e,n){!e&&n&&(e=n),e=p.defaults({},e,p.templateSettings);var i=RegExp([(e.escape||S).source,(e.interpolate||S).source,(e.evaluate||S).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,function(e,n,i,a,r){return s+=t.slice(o,r).replace(D,k),o=r+e.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?s+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(s+="';\n"+a+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var a=new Function(e.variable||"obj","_",s)}catch(r){throw r.source=s,r}var l=function(t){return a.call(this,t,p)},c=e.variable||"obj";return l.source="function("+c+"){\n"+s+"}",l},p.chain=function(t){var e=p(t);return e._chain=!0,e};var I=function(t){return this._chain?p(t).chain():t};p.mixin=function(t){p.each(p.functions(t),function(e){var n=p[e]=t[e];p.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),I.call(this,n.apply(p,t))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];p.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],I.call(this,n)}}),p.each(["concat","join","slice"],function(t){var e=n[t];p.prototype[t]=function(){return I.call(this,e.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}.call(this),function(t,e){function n(t){var e=t.length,n=se.type(t);return se.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===n||"function"!==n&&(0===e||"number"==typeof e&&e>0&&e-1 in t)}function i(t){var e=fe[t]={};return se.each(t.match(re)||[],function(t,n){e[n]=!0}),e}function o(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=se.expando+Math.random()}function s(t,n,i){var o;if(i===e&&1===t.nodeType)if(o="data-"+n.replace(be,"-$1").toLowerCase(),i=t.getAttribute(o),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:ve.test(i)?JSON.parse(i):i}catch(s){}ge.set(t,n,i)}else i=e;return i}function a(){return!0}function r(){return!1}function l(){try{return q.activeElement}catch(t){}}function c(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function u(t,e,n){if(se.isFunction(e))return se.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return se.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(Ie.test(e))return se.filter(e,t,n);e=se.filter(e,t)}return se.grep(t,function(t){return ee.call(e,t)>=0!==n})}function d(t,e){return se.nodeName(t,"table")&&se.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function h(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function p(t){var e=Fe.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function f(t,e){for(var n=t.length,i=0;n>i;i++)me.set(t[i],"globalEval",!e||me.get(e[i],"globalEval"))}function g(t,e){var n,i,o,s,a,r,l,c;if(1===e.nodeType){if(me.hasData(t)&&(s=me.access(t),a=se.extend({},s),c=s.events,me.set(e,a),c)){delete a.handle,a.events={};for(o in c)for(n=0,i=c[o].length;i>n;n++)se.event.add(e,o,c[o][n])}ge.hasData(t)&&(r=ge.access(t),l=se.extend({},r),ge.set(e,l))}}function m(t,n){var i=t.getElementsByTagName?t.getElementsByTagName(n||"*"):t.querySelectorAll?t.querySelectorAll(n||"*"):[];return n===e||n&&se.nodeName(t,n)?se.merge([t],i):i}function v(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Ae.test(t.type)?e.checked=t.checked:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}function b(t,e){if(e in t)return e;for(var n=e.charAt(0).toUpperCase()+e.slice(1),i=e,o=Qe.length;o--;)if(e=Qe[o]+n,e in t)return e;return i}function y(t,e){return t=e||t,"none"===se.css(t,"display")||!se.contains(t.ownerDocument,t)}function w(e){return t.getComputedStyle(e,null)}function _(t,e){for(var n,i,o,s=[],a=0,r=t.length;r>a;a++)i=t[a],i.style&&(s[a]=me.get(i,"olddisplay"),n=i.style.display,e?(s[a]||"none"!==n||(i.style.display=""),""===i.style.display&&y(i)&&(s[a]=me.access(i,"olddisplay",T(i.nodeName)))):s[a]||(o=y(i),(n&&"none"!==n||!o)&&me.set(i,"olddisplay",o?n:se.css(i,"display"))));for(a=0;r>a;a++)i=t[a],i.style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?s[a]||"":"none"));return t}function x(t,e,n){var i=qe.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function C(t,e,n,i,o){for(var s=n===(i?"border":"content")?4:"width"===e?1:0,a=0;4>s;s+=2)"margin"===n&&(a+=se.css(t,n+Ke[s],!0,o)),i?("content"===n&&(a-=se.css(t,"padding"+Ke[s],!0,o)),"margin"!==n&&(a-=se.css(t,"border"+Ke[s]+"Width",!0,o))):(a+=se.css(t,"padding"+Ke[s],!0,o),"padding"!==n&&(a+=se.css(t,"border"+Ke[s]+"Width",!0,o)));return a}function S(t,e,n){var i=!0,o="width"===e?t.offsetWidth:t.offsetHeight,s=w(t),a=se.support.boxSizing&&"border-box"===se.css(t,"boxSizing",!1,s);if(0>=o||null==o){if(o=Be(t,e,s),(0>o||null==o)&&(o=t.style[e]),Ue.test(o))return o;i=a&&(se.support.boxSizingReliable||o===t.style[e]),o=parseFloat(o)||0}return o+C(t,e,n||(a?"border":"content"),i,s)+"px"}function T(t){var e=q,n=Ge[t];return n||(n=D(t,e),"none"!==n&&n||(He=(He||se("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(He[0].contentWindow||He[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),n=D(t,e),He.detach()),Ge[t]=n),n}function D(t,e){var n=se(e.createElement(t)).appendTo(e.body),i=se.css(n[0],"display");return n.remove(),i}function k(t,e,n,i){var o;if(se.isArray(e))se.each(e,function(e,o){n||tn.test(t)?i(t,o):k(t+"["+("object"==typeof o?e:"")+"]",o,n,i)});else if(n||"object"!==se.type(e))i(t,e);else for(o in e)k(t+"["+o+"]",e[o],n,i)}function I(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,o=0,s=e.toLowerCase().match(re)||[];if(se.isFunction(n))for(;i=s[o++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function M(t,n,i,o){function s(l){var c;return a[l]=!0,se.each(t[l]||[],function(t,l){var u=l(n,i,o);return"string"!=typeof u||r||a[u]?r?!(c=u):e:(n.dataTypes.unshift(u),s(u),!1)}),c}var a={},r=t===bn;return s(n.dataTypes[0])||!a["*"]&&s("*")}function L(t,n){var i,o,s=se.ajaxSettings.flatOptions||{};for(i in n)n[i]!==e&&((s[i]?t:o||(o={}))[i]=n[i]);return o&&se.extend(!0,t,o),t}function j(t,n,i){for(var o,s,a,r,l=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),o===e&&(o=t.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){c.unshift(s);break}if(c[0]in i)a=c[0];else{for(s in i){if(!c[0]||t.converters[s+" "+c[0]]){a=s;break}r||(r=s)}a=a||r}return a?(a!==c[0]&&c.unshift(a),i[a]):e}function N(t,e,n,i){var o,s,a,r,l,c={},u=t.dataTypes.slice();if(u[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(s=u.shift();s;)if(t.responseFields[s]&&(n[t.responseFields[s]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=u.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(a=c[l+" "+s]||c["* "+s],!a)for(o in c)if(r=o.split(" "),r[1]===s&&(a=c[l+" "+r[0]]||c["* "+r[0]])){a===!0?a=c[o]:c[o]!==!0&&(s=r[0],u.unshift(r[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}function E(){return setTimeout(function(){kn=e}),kn=se.now()}function O(t,e){se.each(e,function(e,n){for(var i=(En[e]||[]).concat(En["*"]),o=0,s=i.length;s>o;o++)if(i[o].call(t,e,n))return})}function A(t,e,n){var i,o,s=0,a=Nn.length,r=se.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=kn||E(),n=Math.max(0,c.startTime+c.duration-e),i=n/c.duration||0,s=1-i,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(s);return r.notifyWith(t,[c,s,n]),1>s&&l?n:(r.resolveWith(t,[c]),!1)},c=r.promise({elem:t,props:se.extend({},e),opts:se.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:kn||E(),duration:n.duration,tweens:[],createTween:function(e,n){var i=se.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)c.tweens[n].run(1);return e?r.resolveWith(t,[c,e]):r.rejectWith(t,[c,e]),this}}),u=c.props;for(P(u,c.opts.specialEasing);a>s;s++)if(i=Nn[s].call(c,t,u,c.opts))return i;return O(c,u),se.isFunction(c.opts.start)&&c.opts.start.call(t,c),se.fx.timer(se.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function P(t,e){var n,i,o,s,a;for(n in t)if(i=se.camelCase(n),o=e[i],s=t[n],se.isArray(s)&&(o=s[1],s=t[n]=s[0]),n!==i&&(t[i]=s,delete t[n]),a=se.cssHooks[i],a&&"expand"in a){s=a.expand(s),delete t[i];for(n in s)n in t||(t[n]=s[n],e[n]=o)}else e[i]=o}function R(t,n,i){var o,s,a,r,l,c,u,d,h,p=this,f=t.style,g={},m=[],v=t.nodeType&&y(t);i.queue||(d=se._queueHooks(t,"fx"),null==d.unqueued&&(d.unqueued=0,h=d.empty.fire,d.empty.fire=function(){d.unqueued||h()}),d.unqueued++,p.always(function(){p.always(function(){d.unqueued--,se.queue(t,"fx").length||d.empty.fire()})})),1===t.nodeType&&("height"in n||"width"in n)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===se.css(t,"display")&&"none"===se.css(t,"float")&&(f.display="inline-block")),i.overflow&&(f.overflow="hidden",p.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),l=me.get(t,"fxshow");for(o in n)if(a=n[o],Mn.exec(a)){if(delete n[o],c=c||"toggle"===a,a===(v?"hide":"show")){if("show"!==a||l===e||l[o]===e)continue;v=!0}m.push(o)}if(r=m.length){l=me.get(t,"fxshow")||me.access(t,"fxshow",{}),"hidden"in l&&(v=l.hidden),c&&(l.hidden=!v),v?se(t).show():p.done(function(){se(t).hide()}),p.done(function(){var e;me.remove(t,"fxshow");for(e in g)se.style(t,e,g[e])});for(o=0;r>o;o++)s=m[o],u=p.createTween(s,v?l[s]:0),g[s]=l[s]||se.style(t,s),s in l||(l[s]=u.start,v&&(u.end=u.start,u.start="width"===s||"height"===s?1:0))
}}function F(t,e,n,i,o){return new F.prototype.init(t,e,n,i,o)}function z(t,e){var n,i={height:t},o=0;for(e=e?1:0;4>o;o+=2-e)n=Ke[o],i["margin"+n]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function V(t){return se.isWindow(t)?t:9===t.nodeType&&t.defaultView}var B,H,W=typeof e,$=t.location,q=t.document,U=q.documentElement,X=t.jQuery,G=t.$,J={},Y=[],K="2.0.0",Q=Y.concat,Z=Y.push,te=Y.slice,ee=Y.indexOf,ne=J.toString,ie=J.hasOwnProperty,oe=K.trim,se=function(t,e){return new se.fn.init(t,e,B)},ae=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,re=/\S+/g,le=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,ce=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ue=/^-ms-/,de=/-([\da-z])/gi,he=function(t,e){return e.toUpperCase()},pe=function(){q.removeEventListener("DOMContentLoaded",pe,!1),t.removeEventListener("load",pe,!1),se.ready()};se.fn=se.prototype={jquery:K,constructor:se,init:function(t,n,i){var o,s;if(!t)return this;if("string"==typeof t){if(o="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:le.exec(t),!o||!o[1]&&n)return!n||n.jquery?(n||i).find(t):this.constructor(n).find(t);if(o[1]){if(n=n instanceof se?n[0]:n,se.merge(this,se.parseHTML(o[1],n&&n.nodeType?n.ownerDocument||n:q,!0)),ce.test(o[1])&&se.isPlainObject(n))for(o in n)se.isFunction(this[o])?this[o](n[o]):this.attr(o,n[o]);return this}return s=q.getElementById(o[2]),s&&s.parentNode&&(this.length=1,this[0]=s),this.context=q,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):se.isFunction(t)?i.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),se.makeArray(t,this))},selector:"",length:0,toArray:function(){return te.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=se.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return se.each(this,t,e)},ready:function(t){return se.ready.promise().done(t),this},slice:function(){return this.pushStack(te.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},map:function(t){return this.pushStack(se.map(this,function(e,n){return t.call(e,n,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:Z,sort:[].sort,splice:[].splice},se.fn.init.prototype=se.fn,se.extend=se.fn.extend=function(){var t,n,i,o,s,a,r=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof r&&(u=r,r=arguments[1]||{},l=2),"object"==typeof r||se.isFunction(r)||(r={}),c===l&&(r=this,--l);c>l;l++)if(null!=(t=arguments[l]))for(n in t)i=r[n],o=t[n],r!==o&&(u&&o&&(se.isPlainObject(o)||(s=se.isArray(o)))?(s?(s=!1,a=i&&se.isArray(i)?i:[]):a=i&&se.isPlainObject(i)?i:{},r[n]=se.extend(u,a,o)):o!==e&&(r[n]=o));return r},se.extend({expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===se&&(t.$=G),e&&t.jQuery===se&&(t.jQuery=X),se},isReady:!1,readyWait:1,holdReady:function(t){t?se.readyWait++:se.ready(!0)},ready:function(t){(t===!0?--se.readyWait:se.isReady)||(se.isReady=!0,t!==!0&&--se.readyWait>0||(H.resolveWith(q,[se]),se.fn.trigger&&se(q).trigger("ready").off("ready")))},isFunction:function(t){return"function"===se.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?J[ne.call(t)]||"object":typeof t},isPlainObject:function(t){if("object"!==se.type(t)||t.nodeType||se.isWindow(t))return!1;try{if(t.constructor&&!ie.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw Error(t)},parseHTML:function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||q;var i=ce.exec(t),o=!n&&[];return i?[e.createElement(i[1])]:(i=se.buildFragment([t],e,o),o&&se(o).remove(),se.merge([],i.childNodes))},parseJSON:JSON.parse,parseXML:function(t){var n,i;if(!t||"string"!=typeof t)return null;try{i=new DOMParser,n=i.parseFromString(t,"text/xml")}catch(o){n=e}return(!n||n.getElementsByTagName("parsererror").length)&&se.error("Invalid XML: "+t),n},noop:function(){},globalEval:function(t){var e,n=eval;t=se.trim(t),t&&(1===t.indexOf("use strict")?(e=q.createElement("script"),e.text=t,q.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(ue,"ms-").replace(de,he)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var o,s=0,a=t.length,r=n(t);if(i){if(r)for(;a>s&&(o=e.apply(t[s],i),o!==!1);s++);else for(s in t)if(o=e.apply(t[s],i),o===!1)break}else if(r)for(;a>s&&(o=e.call(t[s],s,t[s]),o!==!1);s++);else for(s in t)if(o=e.call(t[s],s,t[s]),o===!1)break;return t},trim:function(t){return null==t?"":oe.call(t)},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?se.merge(i,"string"==typeof t?[t]:t):Z.call(i,t)),i},inArray:function(t,e,n){return null==e?-1:ee.call(e,t,n)},merge:function(t,n){var i=n.length,o=t.length,s=0;if("number"==typeof i)for(;i>s;s++)t[o++]=n[s];else for(;n[s]!==e;)t[o++]=n[s++];return t.length=o,t},grep:function(t,e,n){var i,o=[],s=0,a=t.length;for(n=!!n;a>s;s++)i=!!e(t[s],s),n!==i&&o.push(t[s]);return o},map:function(t,e,i){var o,s=0,a=t.length,r=n(t),l=[];if(r)for(;a>s;s++)o=e(t[s],s,i),null!=o&&(l[l.length]=o);else for(s in t)o=e(t[s],s,i),null!=o&&(l[l.length]=o);return Q.apply([],l)},guid:1,proxy:function(t,n){var i,o,s;return"string"==typeof n&&(i=t[n],n=t,t=i),se.isFunction(t)?(o=te.call(arguments,2),s=function(){return t.apply(n||this,o.concat(te.call(arguments)))},s.guid=t.guid=t.guid||se.guid++,s):e},access:function(t,n,i,o,s,a,r){var l=0,c=t.length,u=null==i;if("object"===se.type(i)){s=!0;for(l in i)se.access(t,n,l,i[l],!0,a,r)}else if(o!==e&&(s=!0,se.isFunction(o)||(r=!0),u&&(r?(n.call(t,o),n=null):(u=n,n=function(t,e,n){return u.call(se(t),n)})),n))for(;c>l;l++)n(t[l],i,r?o:o.call(t[l],l,n(t[l],i)));return s?t:u?n.call(t):c?n(t[0],i):a},now:Date.now,swap:function(t,e,n,i){var o,s,a={};for(s in e)a[s]=t.style[s],t.style[s]=e[s];o=n.apply(t,i||[]);for(s in e)t.style[s]=a[s];return o}}),se.ready.promise=function(e){return H||(H=se.Deferred(),"complete"===q.readyState?setTimeout(se.ready):(q.addEventListener("DOMContentLoaded",pe,!1),t.addEventListener("load",pe,!1))),H.promise(e)},se.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){J["[object "+e+"]"]=e.toLowerCase()}),B=se(q),function(t,e){function n(t){return ye.test(t+"")}function i(){var t,e=[];return t=function(n,i){return e.push(n+=" ")>D.cacheLength&&delete t[e.shift()],t[n]=i}}function o(t){return t[V]=!0,t}function s(t){var e=E.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function a(t,e,n,i){var o,s,a,r,l,c,u,d,h,g;if((e?e.ownerDocument||e:B)!==E&&N(e),e=e||E,n=n||[],!t||"string"!=typeof t)return n;if(1!==(r=e.nodeType)&&9!==r)return[];if(A&&!i){if(o=we.exec(t))if(a=o[1]){if(9===r){if(s=e.getElementById(a),!s||!s.parentNode)return n;if(s.id===a)return n.push(s),n}else if(e.ownerDocument&&(s=e.ownerDocument.getElementById(a))&&z(e,s)&&s.id===a)return n.push(s),n}else{if(o[2])return ee.apply(n,e.getElementsByTagName(t)),n;if((a=o[3])&&H.getElementsByClassName&&e.getElementsByClassName)return ee.apply(n,e.getElementsByClassName(a)),n}if(H.qsa&&(!P||!P.test(t))){if(d=u=V,h=e,g=9===r&&t,1===r&&"object"!==e.nodeName.toLowerCase()){for(c=p(t),(u=e.getAttribute("id"))?d=u.replace(Ce,"\\$&"):e.setAttribute("id",d),d="[id='"+d+"'] ",l=c.length;l--;)c[l]=d+f(c[l]);h=fe.test(t)&&e.parentNode||e,g=c.join(",")}if(g)try{return ee.apply(n,h.querySelectorAll(g)),n}catch(m){}finally{u||e.removeAttribute("id")}}}return x(t.replace(de,"$1"),e,n,i)}function r(t,e){var n=e&&t,i=n&&(~e.sourceIndex||K)-(~t.sourceIndex||K);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function l(t,n,i){var o;return i?e:(o=t.getAttributeNode(n))&&o.specified?o.value:t[n]===!0?n.toLowerCase():null}function c(t,n,i){var o;return i?e:o=t.getAttribute(n,"type"===n.toLowerCase()?1:2)}function u(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function d(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function h(t){return o(function(e){return e=+e,o(function(n,i){for(var o,s=t([],n.length,e),a=s.length;a--;)n[o=s[a]]&&(n[o]=!(i[o]=n[o]))})})}function p(t,e){var n,i,o,s,r,l,c,u=U[t+" "];if(u)return e?0:u.slice(0);for(r=t,l=[],c=D.preFilter;r;){(!n||(i=he.exec(r)))&&(i&&(r=r.slice(i[0].length)||r),l.push(o=[])),n=!1,(i=pe.exec(r))&&(n=i.shift(),o.push({value:n,type:i[0].replace(de," ")}),r=r.slice(n.length));for(s in D.filter)!(i=be[s].exec(r))||c[s]&&!(i=c[s](i))||(n=i.shift(),o.push({value:n,type:s,matches:i}),r=r.slice(n.length));if(!n)break}return e?r.length:r?a.error(t):U(t,l).slice(0)}function f(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function g(t,e,n){var i=e.dir,o=n&&"parentNode"===i,s=$++;return e.first?function(e,n,s){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,s)}:function(e,n,a){var r,l,c,u=W+" "+s;if(a){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||o)if(c=e[V]||(e[V]={}),(l=c[i])&&l[0]===u){if((r=l[1])===!0||r===T)return r===!0}else if(l=c[i]=[u],l[1]=t(e,n,a)||T,l[1]===!0)return!0}}function m(t){return t.length>1?function(e,n,i){for(var o=t.length;o--;)if(!t[o](e,n,i))return!1;return!0}:t[0]}function v(t,e,n,i,o){for(var s,a=[],r=0,l=t.length,c=null!=e;l>r;r++)(s=t[r])&&(!n||n(s,i,o))&&(a.push(s),c&&e.push(r));return a}function b(t,e,n,i,s,a){return i&&!i[V]&&(i=b(i)),s&&!s[V]&&(s=b(s,a)),o(function(o,a,r,l){var c,u,d,h=[],p=[],f=a.length,g=o||_(e||"*",r.nodeType?[r]:r,[]),m=!t||!o&&e?g:v(g,h,t,r,l),b=n?s||(o?t:f||i)?[]:a:m;if(n&&n(m,b,r,l),i)for(c=v(b,p),i(c,[],r,l),u=c.length;u--;)(d=c[u])&&(b[p[u]]=!(m[p[u]]=d));if(o){if(s||t){if(s){for(c=[],u=b.length;u--;)(d=b[u])&&c.push(m[u]=d);s(null,b=[],c,l)}for(u=b.length;u--;)(d=b[u])&&(c=s?ie.call(o,d):h[u])>-1&&(o[c]=!(a[c]=d))}}else b=v(b===a?b.splice(f,b.length):b),s?s(null,a,b,l):ee.apply(a,b)})}function y(t){for(var e,n,i,o=t.length,s=D.relative[t[0].type],a=s||D.relative[" "],r=s?1:0,l=g(function(t){return t===e},a,!0),c=g(function(t){return ie.call(e,t)>-1},a,!0),u=[function(t,n,i){return!s&&(i||n!==L)||((e=n).nodeType?l(t,n,i):c(t,n,i))}];o>r;r++)if(n=D.relative[t[r].type])u=[g(m(u),n)];else{if(n=D.filter[t[r].type].apply(null,t[r].matches),n[V]){for(i=++r;o>i&&!D.relative[t[i].type];i++);return b(r>1&&m(u),r>1&&f(t.slice(0,r-1)).replace(de,"$1"),n,i>r&&y(t.slice(r,i)),o>i&&y(t=t.slice(i)),o>i&&f(t))}u.push(n)}return m(u)}function w(t,e){var n=0,i=e.length>0,s=t.length>0,r=function(o,r,l,c,u){var d,h,p,f=[],g=0,m="0",b=o&&[],y=null!=u,w=L,_=o||s&&D.find.TAG("*",u&&r.parentNode||r),x=W+=null==w?1:Math.random()||.1;for(y&&(L=r!==E&&r,T=n);null!=(d=_[m]);m++){if(s&&d){for(h=0;p=t[h++];)if(p(d,r,l)){c.push(d);break}y&&(W=x,T=++n)}i&&((d=!p&&d)&&g--,o&&b.push(d))}if(g+=m,i&&m!==g){for(h=0;p=e[h++];)p(b,f,r,l);if(o){if(g>0)for(;m--;)b[m]||f[m]||(f[m]=Z.call(c));f=v(f)}ee.apply(c,f),y&&!o&&f.length>0&&g+e.length>1&&a.uniqueSort(c)}return y&&(W=x,L=w),b};return i?o(r):r}function _(t,e,n){for(var i=0,o=e.length;o>i;i++)a(t,e[i],n);return n}function x(t,e,n,i){var o,s,a,r,l,c=p(t);if(!i&&1===c.length){if(s=c[0]=c[0].slice(0),s.length>2&&"ID"===(a=s[0]).type&&9===e.nodeType&&A&&D.relative[s[1].type]){if(e=(D.find.ID(a.matches[0].replace(Se,Te),e)||[])[0],!e)return n;t=t.slice(s.shift().value.length)}for(o=be.needsContext.test(t)?0:s.length;o--&&(a=s[o],!D.relative[r=a.type]);)if((l=D.find[r])&&(i=l(a.matches[0].replace(Se,Te),fe.test(s[0].type)&&e.parentNode||e))){if(s.splice(o,1),t=i.length&&f(s),!t)return ee.apply(n,i),n;break}}return M(t,c)(i,e,!A,n,fe.test(t)),n}function C(){}var S,T,D,k,I,M,L,j,N,E,O,A,P,R,F,z,V="sizzle"+-new Date,B=t.document,H={},W=0,$=0,q=i(),U=i(),X=i(),G=!1,J=function(){return 0},Y=typeof e,K=1<<31,Q=[],Z=Q.pop,te=Q.push,ee=Q.push,ne=Q.slice,ie=Q.indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1},oe="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ae="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",le=re.replace("w","w#"),ce="\\["+ae+"*("+re+")"+ae+"*(?:([*^$|!~]?=)"+ae+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+le+")|)|)"+ae+"*\\]",ue=":("+re+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ce.replace(3,8)+")*)|.*)\\)|)",de=RegExp("^"+ae+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ae+"+$","g"),he=RegExp("^"+ae+"*,"+ae+"*"),pe=RegExp("^"+ae+"*([>+~]|"+ae+")"+ae+"*"),fe=RegExp(ae+"*[+~]"),ge=RegExp("="+ae+"*([^\\]'\"]*)"+ae+"*\\]","g"),me=RegExp(ue),ve=RegExp("^"+le+"$"),be={ID:RegExp("^#("+re+")"),CLASS:RegExp("^\\.("+re+")"),TAG:RegExp("^("+re.replace("w","w*")+")"),ATTR:RegExp("^"+ce),PSEUDO:RegExp("^"+ue),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ae+"*(even|odd|(([+-]|)(\\d*)n|)"+ae+"*(?:([+-]|)"+ae+"*(\\d+)|))"+ae+"*\\)|)","i"),"boolean":RegExp("^(?:"+oe+")$","i"),needsContext:RegExp("^"+ae+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ae+"*((?:-\\d)?\\d*)"+ae+"*\\)|)(?=[^-]|$)","i")},ye=/^[^{]+\{\s*\[native \w/,we=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_e=/^(?:input|select|textarea|button)$/i,xe=/^h\d$/i,Ce=/'|\\/g,Se=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,Te=function(t,e){var n="0x"+e-65536;return n!==n?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{ee.apply(Q=ne.call(B.childNodes),B.childNodes),Q[B.childNodes.length].nodeType}catch(De){ee={apply:Q.length?function(t,e){te.apply(t,ne.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}I=a.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},N=a.setDocument=function(t){var i=t?t.ownerDocument||t:B;return i!==E&&9===i.nodeType&&i.documentElement?(E=i,O=i.documentElement,A=!I(i),H.getElementsByTagName=s(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),H.attributes=s(function(t){return t.className="i",!t.getAttribute("className")}),H.getElementsByClassName=s(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),H.sortDetached=s(function(t){return 1&t.compareDocumentPosition(E.createElement("div"))}),H.getById=s(function(t){return O.appendChild(t).id=V,!i.getElementsByName||!i.getElementsByName(V).length}),H.getById?(D.find.ID=function(t,e){if(typeof e.getElementById!==Y&&A){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},D.filter.ID=function(t){var e=t.replace(Se,Te);return function(t){return t.getAttribute("id")===e}}):(D.find.ID=function(t,n){if(typeof n.getElementById!==Y&&A){var i=n.getElementById(t);return i?i.id===t||typeof i.getAttributeNode!==Y&&i.getAttributeNode("id").value===t?[i]:e:[]}},D.filter.ID=function(t){var e=t.replace(Se,Te);return function(t){var n=typeof t.getAttributeNode!==Y&&t.getAttributeNode("id");return n&&n.value===e}}),D.find.TAG=H.getElementsByTagName?function(t,n){return typeof n.getElementsByTagName!==Y?n.getElementsByTagName(t):e}:function(t,e){var n,i=[],o=0,s=e.getElementsByTagName(t);if("*"===t){for(;n=s[o++];)1===n.nodeType&&i.push(n);return i}return s},D.find.CLASS=H.getElementsByClassName&&function(t,n){return typeof n.getElementsByClassName!==Y&&A?n.getElementsByClassName(t):e},R=[],P=[],(H.qsa=n(i.querySelectorAll))&&(s(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||P.push("\\["+ae+"*(?:value|"+oe+")"),t.querySelectorAll(":checked").length||P.push(":checked")}),s(function(t){var e=E.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&P.push("[*^$]="+ae+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||P.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),P.push(",.*:")})),(H.matchesSelector=n(F=O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&s(function(t){H.disconnectedMatch=F.call(t,"div"),F.call(t,"[s!='']:x"),R.push("!=",ue)}),P=P.length&&RegExp(P.join("|")),R=R.length&&RegExp(R.join("|")),z=n(O.contains)||O.compareDocumentPosition?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},J=O.compareDocumentPosition?function(t,e){if(t===e)return G=!0,0;var n=e.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(e);return n?1&n||!H.sortDetached&&e.compareDocumentPosition(t)===n?t===i||z(B,t)?-1:e===i||z(B,e)?1:j?ie.call(j,t)-ie.call(j,e):0:4&n?-1:1:t.compareDocumentPosition?-1:1}:function(t,e){var n,o=0,s=t.parentNode,a=e.parentNode,l=[t],c=[e];if(t===e)return G=!0,0;if(!s||!a)return t===i?-1:e===i?1:s?-1:a?1:j?ie.call(j,t)-ie.call(j,e):0;if(s===a)return r(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)c.unshift(n);for(;l[o]===c[o];)o++;return o?r(l[o],c[o]):l[o]===B?-1:c[o]===B?1:0},E):E},a.matches=function(t,e){return a(t,null,null,e)},a.matchesSelector=function(t,e){if((t.ownerDocument||t)!==E&&N(t),e=e.replace(ge,"='$1']"),!(!H.matchesSelector||!A||R&&R.test(e)||P&&P.test(e)))try{var n=F.call(t,e);if(n||H.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(i){}return a(e,E,null,[t]).length>0},a.contains=function(t,e){return(t.ownerDocument||t)!==E&&N(t),z(t,e)},a.attr=function(t,n){(t.ownerDocument||t)!==E&&N(t);var i=D.attrHandle[n.toLowerCase()],o=i&&i(t,n,!A);return o===e?H.attributes||!A?t.getAttribute(n):(o=t.getAttributeNode(n))&&o.specified?o.value:null:o},a.error=function(t){throw Error("Syntax error, unrecognized expression: "+t)},a.uniqueSort=function(t){var e,n=[],i=0,o=0;if(G=!H.detectDuplicates,j=!H.sortStable&&t.slice(0),t.sort(J),G){for(;e=t[o++];)e===t[o]&&(i=n.push(o));for(;i--;)t.splice(n[i],1)}return t},k=a.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=k(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i];i++)n+=k(e);return n},D=a.selectors={cacheLength:50,createPseudo:o,match:be,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Se,Te),t[3]=(t[4]||t[5]||"").replace(Se,Te),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||a.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&a.error(t[0]),t},PSEUDO:function(t){var e,n=!t[5]&&t[2];return be.CHILD.test(t[0])?null:(t[4]?t[2]=t[4]:n&&me.test(n)&&(e=p(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Se,Te).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=q[t+" "];return e||(e=RegExp("(^|"+ae+")"+t+"("+ae+"|$)"))&&q(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==Y&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(i){var o=a.attr(i,t);return null==o?"!="===e:e?(o+="","="===e?o===n:"!="===e?o!==n:"^="===e?n&&0===o.indexOf(n):"*="===e?n&&o.indexOf(n)>-1:"$="===e?n&&o.slice(-n.length)===n:"~="===e?(" "+o+" ").indexOf(n)>-1:"|="===e?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,n,i,o){var s="nth"!==t.slice(0,3),a="last"!==t.slice(-4),r="of-type"===e;return 1===i&&0===o?function(t){return!!t.parentNode}:function(e,n,l){var c,u,d,h,p,f,g=s!==a?"nextSibling":"previousSibling",m=e.parentNode,v=r&&e.nodeName.toLowerCase(),b=!l&&!r;if(m){if(s){for(;g;){for(d=e;d=d[g];)if(r?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?m.firstChild:m.lastChild],a&&b){for(u=m[V]||(m[V]={}),c=u[t]||[],p=c[0]===W&&c[1],h=c[0]===W&&c[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(h=p=0)||f.pop();)if(1===d.nodeType&&++h&&d===e){u[t]=[W,p,h];break}}else if(b&&(c=(e[V]||(e[V]={}))[t])&&c[0]===W)h=c[1];else for(;(d=++p&&d&&d[g]||(h=p=0)||f.pop())&&((r?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++h||(b&&((d[V]||(d[V]={}))[t]=[W,h]),d!==e)););return h-=o,h===i||0===h%i&&h/i>=0}}},PSEUDO:function(t,e){var n,i=D.pseudos[t]||D.setFilters[t.toLowerCase()]||a.error("unsupported pseudo: "+t);return i[V]?i(e):i.length>1?(n=[t,t,"",e],D.setFilters.hasOwnProperty(t.toLowerCase())?o(function(t,n){for(var o,s=i(t,e),a=s.length;a--;)o=ie.call(t,s[a]),t[o]=!(n[o]=s[a])}):function(t){return i(t,0,n)}):i}},pseudos:{not:o(function(t){var e=[],n=[],i=M(t.replace(de,"$1"));return i[V]?o(function(t,e,n,o){for(var s,a=i(t,null,o,[]),r=t.length;r--;)(s=a[r])&&(t[r]=!(e[r]=s))}):function(t,o,s){return e[0]=t,i(e,null,s,n),!n.pop()}}),has:o(function(t){return function(e){return a(t,e).length>0}}),contains:o(function(t){return function(e){return(e.textContent||e.innerText||k(e)).indexOf(t)>-1}}),lang:o(function(t){return ve.test(t||"")||a.error("unsupported lang: "+t),t=t.replace(Se,Te).toLowerCase(),function(e){var n;do if(n=A?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===O},focus:function(t){return t===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!D.pseudos.empty(t)},header:function(t){return xe.test(t.nodeName)},input:function(t){return _e.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:h(function(){return[0]}),last:h(function(t,e){return[e-1]}),eq:h(function(t,e,n){return[0>n?n+e:n]}),even:h(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:h(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:h(function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t}),gt:h(function(t,e,n){for(var i=0>n?n+e:n;e>++i;)t.push(i);return t})}};for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})D.pseudos[S]=u(S);for(S in{submit:!0,reset:!0})D.pseudos[S]=d(S);M=a.compile=function(t,e){var n,i=[],o=[],s=X[t+" "];if(!s){for(e||(e=p(t)),n=e.length;n--;)s=y(e[n]),s[V]?i.push(s):o.push(s);s=X(t,w(o,i))}return s},D.pseudos.nth=D.pseudos.eq,C.prototype=D.filters=D.pseudos,D.setFilters=new C,H.sortStable=V.split("").sort(J).join("")===V,N(),[0,0].sort(J),H.detectDuplicates=G,s(function(t){if(t.innerHTML="<a href='#'></a>","#"!==t.firstChild.getAttribute("href"))for(var e="type|href|height|width".split("|"),n=e.length;n--;)D.attrHandle[e[n]]=c}),s(function(t){if(null!=t.getAttribute("disabled"))for(var e=oe.split("|"),n=e.length;n--;)D.attrHandle[e[n]]=l}),se.find=a,se.expr=a.selectors,se.expr[":"]=se.expr.pseudos,se.unique=a.uniqueSort,se.text=a.getText,se.isXMLDoc=a.isXML,se.contains=a.contains}(t);var fe={};se.Callbacks=function(t){t="string"==typeof t?fe[t]||i(t):se.extend({},t);var n,o,s,a,r,l,c=[],u=!t.once&&[],d=function(e){for(n=t.memory&&e,o=!0,l=a||0,a=0,r=c.length,s=!0;c&&r>l;l++)if(c[l].apply(e[0],e[1])===!1&&t.stopOnFalse){n=!1;break}s=!1,c&&(u?u.length&&d(u.shift()):n?c=[]:h.disable())},h={add:function(){if(c){var e=c.length;!function i(e){se.each(e,function(e,n){var o=se.type(n);"function"===o?t.unique&&h.has(n)||c.push(n):n&&n.length&&"string"!==o&&i(n)})}(arguments),s?r=c.length:n&&(a=e,d(n))}return this},remove:function(){return c&&se.each(arguments,function(t,e){for(var n;(n=se.inArray(e,c,n))>-1;)c.splice(n,1),s&&(r>=n&&r--,l>=n&&l--)}),this},has:function(t){return t?se.inArray(t,c)>-1:!(!c||!c.length)},empty:function(){return c=[],r=0,this},disable:function(){return c=u=n=e,this},disabled:function(){return!c},lock:function(){return u=e,n||h.disable(),this},locked:function(){return!u},fireWith:function(t,e){return e=e||[],e=[t,e.slice?e.slice():e],!c||o&&!u||(s?u.push(e):d(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},se.extend({Deferred:function(t){var e=[["resolve","done",se.Callbacks("once memory"),"resolved"],["reject","fail",se.Callbacks("once memory"),"rejected"],["notify","progress",se.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return se.Deferred(function(n){se.each(e,function(e,s){var a=s[0],r=se.isFunction(t[e])&&t[e];o[s[1]](function(){var t=r&&r.apply(this,arguments);t&&se.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===i?n.promise():this,r?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?se.extend(t,i):i}},o={};return i.pipe=i.then,se.each(e,function(t,s){var a=s[2],r=s[3];i[s[1]]=a.add,r&&a.add(function(){n=r},e[1^t][2].disable,e[2][2].lock),o[s[0]]=function(){return o[s[0]+"With"](this===o?i:this,arguments),this},o[s[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(t){var e,n,i,o=0,s=te.call(arguments),a=s.length,r=1!==a||t&&se.isFunction(t.promise)?a:0,l=1===r?t:se.Deferred(),c=function(t,n,i){return function(o){n[t]=this,i[t]=arguments.length>1?te.call(arguments):o,i===e?l.notifyWith(n,i):--r||l.resolveWith(n,i)}};if(a>1)for(e=Array(a),n=Array(a),i=Array(a);a>o;o++)s[o]&&se.isFunction(s[o].promise)?s[o].promise().done(c(o,i,s)).fail(l.reject).progress(c(o,n,e)):--r;return r||l.resolveWith(i,s),l.promise()}}),se.support=function(e){var n=q.createElement("input"),i=q.createDocumentFragment(),o=q.createElement("div"),s=q.createElement("select"),a=s.appendChild(q.createElement("option"));return n.type?(n.type="checkbox",e.checkOn=""!==n.value,e.optSelected=a.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=!1,n.checked=!0,e.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,e.optDisabled=!a.disabled,n=q.createElement("input"),n.value="t",n.type="radio",e.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),i.appendChild(n),e.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in t,o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===o.style.backgroundClip,se(function(){var n,i,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=q.getElementsByTagName("body")[0];a&&(n=q.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(o),o.innerHTML="",o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",se.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===o.offsetWidth}),t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(o,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(o,null)||{width:"4px"}).width,i=o.appendChild(q.createElement("div")),i.style.cssText=o.style.cssText=s,i.style.marginRight=i.style.width="0",o.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(i,null)||{}).marginRight)),a.removeChild(n))}),e):e}({});var ge,me,ve=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,be=/([A-Z])/g;o.uid=1,o.accepts=function(t){return t.nodeType?1===t.nodeType||9===t.nodeType:!0},o.prototype={key:function(t){if(!o.accepts(t))return 0;var e={},n=t[this.expando];if(!n){n=o.uid++;try{e[this.expando]={value:n},Object.defineProperties(t,e)}catch(i){e[this.expando]=n,se.extend(t,e)}}return this.cache[n]||(this.cache[n]={}),n},set:function(t,e,n){var i,o=this.key(t),s=this.cache[o];if("string"==typeof e)s[e]=n;else if(se.isEmptyObject(s))this.cache[o]=e;else for(i in e)s[i]=e[i]},get:function(t,n){var i=this.cache[this.key(t)];return n===e?i:i[n]},access:function(t,n,i){return n===e||n&&"string"==typeof n&&i===e?this.get(t,n):(this.set(t,n,i),i!==e?i:n)},remove:function(t,n){var i,o,s=this.key(t),a=this.cache[s];if(n===e)this.cache[s]={};else{se.isArray(n)?o=n.concat(n.map(se.camelCase)):n in a?o=[n]:(o=se.camelCase(n),o=o in a?[o]:o.match(re)||[]),i=o.length;for(;i--;)delete a[o[i]]}},hasData:function(t){return!se.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){delete this.cache[this.key(t)]}},ge=new o,me=new o,se.extend({acceptData:o.accepts,hasData:function(t){return ge.hasData(t)||me.hasData(t)},data:function(t,e,n){return ge.access(t,e,n)},removeData:function(t,e){ge.remove(t,e)},_data:function(t,e,n){return me.access(t,e,n)},_removeData:function(t,e){me.remove(t,e)}}),se.fn.extend({data:function(t,n){var i,o,a=this[0],r=0,l=null;if(t===e){if(this.length&&(l=ge.get(a),1===a.nodeType&&!me.get(a,"hasDataAttrs"))){for(i=a.attributes;i.length>r;r++)o=i[r].name,0===o.indexOf("data-")&&(o=se.camelCase(o.substring(5)),s(a,o,l[o]));me.set(a,"hasDataAttrs",!0)}return l}return"object"==typeof t?this.each(function(){ge.set(this,t)}):se.access(this,function(n){var i,o=se.camelCase(t);if(a&&n===e){if(i=ge.get(a,t),i!==e)return i;if(i=ge.get(a,o),i!==e)return i;if(i=s(a,o,e),i!==e)return i}else this.each(function(){var i=ge.get(this,o);ge.set(this,o,n),-1!==t.indexOf("-")&&i!==e&&ge.set(this,t,n)})},null,n,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){ge.remove(this,t)})}}),se.extend({queue:function(t,n,i){var o;return t?(n=(n||"fx")+"queue",o=me.get(t,n),i&&(!o||se.isArray(i)?o=me.access(t,n,se.makeArray(i)):o.push(i)),o||[]):e},dequeue:function(t,e){e=e||"fx";var n=se.queue(t,e),i=n.length,o=n.shift(),s=se._queueHooks(t,e),a=function(){se.dequeue(t,e)};"inprogress"===o&&(o=n.shift(),i--),s.cur=o,o&&("fx"===e&&n.unshift("inprogress"),delete s.stop,o.call(t,a,s)),!i&&s&&s.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return me.get(t,n)||me.access(t,n,{empty:se.Callbacks("once memory").add(function(){me.remove(t,[e+"queue",n])})})}}),se.fn.extend({queue:function(t,n){var i=2;return"string"!=typeof t&&(n=t,t="fx",i--),i>arguments.length?se.queue(this[0],t):n===e?this:this.each(function(){var e=se.queue(this,t,n);se._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&se.dequeue(this,t)})},dequeue:function(t){return this.each(function(){se.dequeue(this,t)})},delay:function(t,e){return t=se.fx?se.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var i=setTimeout(e,t);n.stop=function(){clearTimeout(i)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,n){var i,o=1,s=se.Deferred(),a=this,r=this.length,l=function(){--o||s.resolveWith(a,[a])
};for("string"!=typeof t&&(n=t,t=e),t=t||"fx";r--;)i=me.get(a[r],t+"queueHooks"),i&&i.empty&&(o++,i.empty.add(l));return l(),s.promise(n)}});var ye,we,_e=/[\t\r\n]/g,xe=/\r/g,Ce=/^(?:input|select|textarea|button)$/i;se.fn.extend({attr:function(t,e){return se.access(this,se.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){se.removeAttr(this,t)})},prop:function(t,e){return se.access(this,se.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[se.propFix[t]||t]})},addClass:function(t){var e,n,i,o,s,a=0,r=this.length,l="string"==typeof t&&t;if(se.isFunction(t))return this.each(function(e){se(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(re)||[];r>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(_e," "):" ")){for(s=0;o=e[s++];)0>i.indexOf(" "+o+" ")&&(i+=o+" ");n.className=se.trim(i)}return this},removeClass:function(t){var e,n,i,o,s,a=0,r=this.length,l=0===arguments.length||"string"==typeof t&&t;if(se.isFunction(t))return this.each(function(e){se(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(re)||[];r>a;a++)if(n=this[a],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(_e," "):"")){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");n.className=t?se.trim(i):""}return this},toggleClass:function(t,e){var n=typeof t,i="boolean"==typeof e;return this.each(se.isFunction(t)?function(n){se(this).toggleClass(t.call(this,n,this.className,e),e)}:function(){if("string"===n)for(var o,s=0,a=se(this),r=e,l=t.match(re)||[];o=l[s++];)r=i?r:!a.hasClass(o),a[r?"addClass":"removeClass"](o);else(n===W||"boolean"===n)&&(this.className&&me.set(this,"__className__",this.className),this.className=this.className||t===!1?"":me.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(_e," ").indexOf(e)>=0)return!0;return!1},val:function(t){var n,i,o,s=this[0];return arguments.length?(o=se.isFunction(t),this.each(function(i){var s,a=se(this);1===this.nodeType&&(s=o?t.call(this,i,a.val()):t,null==s?s="":"number"==typeof s?s+="":se.isArray(s)&&(s=se.map(s,function(t){return null==t?"":t+""})),n=se.valHooks[this.type]||se.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,s,"value")!==e||(this.value=s))})):s?(n=se.valHooks[s.type]||se.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(s,"value"))!==e?i:(i=s.value,"string"==typeof i?i.replace(xe,""):null==i?"":i)):void 0}}),se.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){for(var e,n,i=t.options,o=t.selectedIndex,s="select-one"===t.type||0>o,a=s?null:[],r=s?o+1:i.length,l=0>o?r:s?o:0;r>l;l++)if(n=i[l],!(!n.selected&&l!==o||(se.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&se.nodeName(n.parentNode,"optgroup"))){if(e=se(n).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var n,i,o=t.options,s=se.makeArray(e),a=o.length;a--;)i=o[a],(i.selected=se.inArray(se(i).val(),s)>=0)&&(n=!0);return n||(t.selectedIndex=-1),s}}},attr:function(t,n,i){var o,s,a=t.nodeType;return t&&3!==a&&8!==a&&2!==a?typeof t.getAttribute===W?se.prop(t,n,i):(1===a&&se.isXMLDoc(t)||(n=n.toLowerCase(),o=se.attrHooks[n]||(se.expr.match["boolean"].test(n)?we:ye)),i===e?o&&"get"in o&&null!==(s=o.get(t,n))?s:(s=se.find.attr(t,n),null==s?e:s):null!==i?o&&"set"in o&&(s=o.set(t,i,n))!==e?s:(t.setAttribute(n,i+""),i):(se.removeAttr(t,n),e)):void 0},removeAttr:function(t,e){var n,i,o=0,s=e&&e.match(re);if(s&&1===t.nodeType)for(;n=s[o++];)i=se.propFix[n]||n,se.expr.match["boolean"].test(n)&&(t[i]=!1),t.removeAttribute(n)},attrHooks:{type:{set:function(t,e){if(!se.support.radioValue&&"radio"===e&&se.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(t,n,i){var o,s,a,r=t.nodeType;return t&&3!==r&&8!==r&&2!==r?(a=1!==r||!se.isXMLDoc(t),a&&(n=se.propFix[n]||n,s=se.propHooks[n]),i!==e?s&&"set"in s&&(o=s.set(t,i,n))!==e?o:t[n]=i:s&&"get"in s&&null!==(o=s.get(t,n))?o:t[n]):void 0},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||Ce.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),we={set:function(t,e,n){return e===!1?se.removeAttr(t,n):t.setAttribute(n,n),n}},se.each(se.expr.match["boolean"].source.match(/\w+/g),function(t,n){var i=se.expr.attrHandle[n]||se.find.attr;se.expr.attrHandle[n]=function(t,n,o){var s=se.expr.attrHandle[n],a=o?e:(se.expr.attrHandle[n]=e)!=i(t,n,o)?n.toLowerCase():null;return se.expr.attrHandle[n]=s,a}}),se.support.optSelected||(se.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),se.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){se.propFix[this.toLowerCase()]=this}),se.each(["radio","checkbox"],function(){se.valHooks[this]={set:function(t,n){return se.isArray(n)?t.checked=se.inArray(se(t).val(),n)>=0:e}},se.support.checkOn||(se.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Se=/^key/,Te=/^(?:mouse|contextmenu)|click/,De=/^(?:focusinfocus|focusoutblur)$/,ke=/^([^.]*)(?:\.(.+)|)$/;se.event={global:{},add:function(t,n,i,o,s){var a,r,l,c,u,d,h,p,f,g,m,v=me.get(t);if(v){for(i.handler&&(a=i,i=a.handler,s=a.selector),i.guid||(i.guid=se.guid++),(c=v.events)||(c=v.events={}),(r=v.handle)||(r=v.handle=function(t){return typeof se===W||t&&se.event.triggered===t.type?e:se.event.dispatch.apply(r.elem,arguments)},r.elem=t),n=(n||"").match(re)||[""],u=n.length;u--;)l=ke.exec(n[u])||[],f=m=l[1],g=(l[2]||"").split(".").sort(),f&&(h=se.event.special[f]||{},f=(s?h.delegateType:h.bindType)||f,h=se.event.special[f]||{},d=se.extend({type:f,origType:m,data:o,handler:i,guid:i.guid,selector:s,needsContext:s&&se.expr.match.needsContext.test(s),namespace:g.join(".")},a),(p=c[f])||(p=c[f]=[],p.delegateCount=0,h.setup&&h.setup.call(t,o,g,r)!==!1||t.addEventListener&&t.addEventListener(f,r,!1)),h.add&&(h.add.call(t,d),d.handler.guid||(d.handler.guid=i.guid)),s?p.splice(p.delegateCount++,0,d):p.push(d),se.event.global[f]=!0);t=null}},remove:function(t,e,n,i,o){var s,a,r,l,c,u,d,h,p,f,g,m=me.hasData(t)&&me.get(t);if(m&&(l=m.events)){for(e=(e||"").match(re)||[""],c=e.length;c--;)if(r=ke.exec(e[c])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p){for(d=se.event.special[p]||{},p=(i?d.delegateType:d.bindType)||p,h=l[p]||[],r=r[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;s--;)u=h[s],!o&&g!==u.origType||n&&n.guid!==u.guid||r&&!r.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(h.splice(s,1),u.selector&&h.delegateCount--,d.remove&&d.remove.call(t,u));a&&!h.length&&(d.teardown&&d.teardown.call(t,f,m.handle)!==!1||se.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)se.event.remove(t,p+e[c],n,i,!0);se.isEmptyObject(l)&&(delete m.handle,me.remove(t,"events"))}},trigger:function(n,i,o,s){var a,r,l,c,u,d,h,p=[o||q],f=ie.call(n,"type")?n.type:n,g=ie.call(n,"namespace")?n.namespace.split("."):[];if(r=l=o=o||q,3!==o.nodeType&&8!==o.nodeType&&!De.test(f+se.event.triggered)&&(f.indexOf(".")>=0&&(g=f.split("."),f=g.shift(),g.sort()),u=0>f.indexOf(":")&&"on"+f,n=n[se.expando]?n:new se.Event(f,"object"==typeof n&&n),n.isTrigger=s?2:3,n.namespace=g.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=e,n.target||(n.target=o),i=null==i?[n]:se.makeArray(i,[n]),h=se.event.special[f]||{},s||!h.trigger||h.trigger.apply(o,i)!==!1)){if(!s&&!h.noBubble&&!se.isWindow(o)){for(c=h.delegateType||f,De.test(c+f)||(r=r.parentNode);r;r=r.parentNode)p.push(r),l=r;l===(o.ownerDocument||q)&&p.push(l.defaultView||l.parentWindow||t)}for(a=0;(r=p[a++])&&!n.isPropagationStopped();)n.type=a>1?c:h.bindType||f,d=(me.get(r,"events")||{})[n.type]&&me.get(r,"handle"),d&&d.apply(r,i),d=u&&r[u],d&&se.acceptData(r)&&d.apply&&d.apply(r,i)===!1&&n.preventDefault();return n.type=f,s||n.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),i)!==!1||!se.acceptData(o)||u&&se.isFunction(o[f])&&!se.isWindow(o)&&(l=o[u],l&&(o[u]=null),se.event.triggered=f,o[f](),se.event.triggered=e,l&&(o[u]=l)),n.result}},dispatch:function(t){t=se.event.fix(t);var n,i,o,s,a,r=[],l=te.call(arguments),c=(me.get(this,"events")||{})[t.type]||[],u=se.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,t)!==!1){for(r=se.event.handlers.call(this,t,c),n=0;(s=r[n++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,i=0;(a=s.handlers[i++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(a.namespace))&&(t.handleObj=a,t.data=a.data,o=((se.event.special[a.origType]||{}).handle||a.handler).apply(s.elem,l),o!==e&&(t.result=o)===!1&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,n){var i,o,s,a,r=[],l=n.delegateCount,c=t.target;if(l&&c.nodeType&&(!t.button||"click"!==t.type))for(;c!==this;c=c.parentNode||this)if(c.disabled!==!0||"click"!==t.type){for(o=[],i=0;l>i;i++)a=n[i],s=a.selector+" ",o[s]===e&&(o[s]=a.needsContext?se(s,this).index(c)>=0:se.find(s,this,null,[c]).length),o[s]&&o.push(a);o.length&&r.push({elem:c,handlers:o})}return n.length>l&&r.push({elem:this,handlers:n.slice(l)}),r},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,n){var i,o,s,a=n.button;return null==t.pageX&&null!=n.clientX&&(i=t.target.ownerDocument||q,o=i.documentElement,s=i.body,t.pageX=n.clientX+(o&&o.scrollLeft||s&&s.scrollLeft||0)-(o&&o.clientLeft||s&&s.clientLeft||0),t.pageY=n.clientY+(o&&o.scrollTop||s&&s.scrollTop||0)-(o&&o.clientTop||s&&s.clientTop||0)),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(t){if(t[se.expando])return t;var e,n,i,o=t.type,s=t,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Te.test(o)?this.mouseHooks:Se.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,t=new se.Event(s),e=i.length;e--;)n=i[e],t[n]=s[n];return 3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,s):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):e},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):e},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&se.nodeName(this,"input")?(this.click(),!1):e},_default:function(t){return se.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,i){var o=se.extend(new se.Event,n,{type:t,isSimulated:!0,originalEvent:{}});i?se.event.trigger(o,null,e):se.event.dispatch.call(e,o),o.isDefaultPrevented()&&n.preventDefault()}},se.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},se.Event=function(t,n){return this instanceof se.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.getPreventDefault&&t.getPreventDefault()?a:r):this.type=t,n&&se.extend(this,n),this.timeStamp=t&&t.timeStamp||se.now(),this[se.expando]=!0,e):new se.Event(t,n)},se.Event.prototype={isDefaultPrevented:r,isPropagationStopped:r,isImmediatePropagationStopped:r,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=a,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=a,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},se.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){se.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,o=t.relatedTarget,s=t.handleObj;return(!o||o!==i&&!se.contains(i,o))&&(t.type=s.origType,n=s.handler.apply(this,arguments),t.type=e),n}}}),se.support.focusinBubbles||se.each({focus:"focusin",blur:"focusout"},function(t,e){var n=0,i=function(t){se.event.simulate(e,t.target,se.event.fix(t),!0)};se.event.special[e]={setup:function(){0===n++&&q.addEventListener(t,i,!0)},teardown:function(){0===--n&&q.removeEventListener(t,i,!0)}}}),se.fn.extend({on:function(t,n,i,o,s){var a,l;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=e);for(l in t)this.on(l,n,i,t[l],s);return this}if(null==i&&null==o?(o=n,i=n=e):null==o&&("string"==typeof n?(o=i,i=e):(o=i,i=n,n=e)),o===!1)o=r;else if(!o)return this;return 1===s&&(a=o,o=function(t){return se().off(t),a.apply(this,arguments)},o.guid=a.guid||(a.guid=se.guid++)),this.each(function(){se.event.add(this,t,o,i,n)})},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(t,n,i){var o,s;if(t&&t.preventDefault&&t.handleObj)return o=t.handleObj,se(t.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof t){for(s in t)this.off(s,n,t[s]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=e),i===!1&&(i=r),this.each(function(){se.event.remove(this,t,i,n)})},trigger:function(t,e){return this.each(function(){se.event.trigger(t,e,this)})},triggerHandler:function(t,n){var i=this[0];return i?se.event.trigger(t,n,i,!0):e}});var Ie=/^.[^:#\[\.,]*$/,Me=se.expr.match.needsContext,Le={children:!0,contents:!0,next:!0,prev:!0};se.fn.extend({find:function(t){var e,n,i,o=this.length;if("string"!=typeof t)return e=this,this.pushStack(se(t).filter(function(){for(i=0;o>i;i++)if(se.contains(e[i],this))return!0}));for(n=[],i=0;o>i;i++)se.find(t,this[i],n);return n=this.pushStack(o>1?se.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+t,n},has:function(t){var e=se(t,this),n=e.length;return this.filter(function(){for(var t=0;n>t;t++)if(se.contains(this,e[t]))return!0})},not:function(t){return this.pushStack(u(this,t||[],!0))},filter:function(t){return this.pushStack(u(this,t||[],!1))},is:function(t){return!!t&&("string"==typeof t?Me.test(t)?se(t,this.context).index(this[0])>=0:se.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){for(var n,i=0,o=this.length,s=[],a=Me.test(t)||"string"!=typeof t?se(t,e||this.context):0;o>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(11>n.nodeType&&(a?a.index(n)>-1:1===n.nodeType&&se.find.matchesSelector(n,t))){n=s.push(n);break}return this.pushStack(s.length>1?se.unique(s):s)},index:function(t){return t?"string"==typeof t?ee.call(se(t),this[0]):ee.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var n="string"==typeof t?se(t,e):se.makeArray(t&&t.nodeType?[t]:t),i=se.merge(this.get(),n);return this.pushStack(se.unique(i))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),se.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return se.dir(t,"parentNode")},parentsUntil:function(t,e,n){return se.dir(t,"parentNode",n)},next:function(t){return c(t,"nextSibling")},prev:function(t){return c(t,"previousSibling")},nextAll:function(t){return se.dir(t,"nextSibling")},prevAll:function(t){return se.dir(t,"previousSibling")},nextUntil:function(t,e,n){return se.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return se.dir(t,"previousSibling",n)},siblings:function(t){return se.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return se.sibling(t.firstChild)},contents:function(t){return se.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:se.merge([],t.childNodes)}},function(t,e){se.fn[t]=function(n,i){var o=se.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=se.filter(i,o)),this.length>1&&(Le[t]||se.unique(o),"p"===t[0]&&o.reverse()),this.pushStack(o)}}),se.extend({filter:function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?se.find.matchesSelector(i,t)?[i]:[]:se.find.matches(t,se.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,n,i){for(var o=[],s=i!==e;(t=t[n])&&9!==t.nodeType;)if(1===t.nodeType){if(s&&se(t).is(i))break;o.push(t)}return o},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}});var je=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ne=/<([\w:]+)/,Ee=/<|&#?\w+;/,Oe=/<(?:script|style|link)/i,Ae=/^(?:checkbox|radio)$/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Re=/^$|\/(?:java|ecma)script/i,Fe=/^true\/(.*)/,ze=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ve={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ve.optgroup=Ve.option,Ve.tbody=Ve.tfoot=Ve.colgroup=Ve.caption=Ve.col=Ve.thead,Ve.th=Ve.td,se.fn.extend({text:function(t){return se.access(this,function(t){return t===e?se.text(this):this.empty().append((this[0]&&this[0].ownerDocument||q).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=d(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var n,i=t?se.filter(t,this):this,o=0;null!=(n=i[o]);o++)e||1!==n.nodeType||se.cleanData(m(n)),n.parentNode&&(e&&se.contains(n.ownerDocument,n)&&f(m(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(se.cleanData(m(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return se.clone(this,t,e)})},html:function(t){return se.access(this,function(t){var n=this[0]||{},i=0,o=this.length;if(t===e&&1===n.nodeType)return n.innerHTML;if("string"==typeof t&&!Oe.test(t)&&!Ve[(Ne.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(je,"<$1></$2>");try{for(;o>i;i++)n=this[i]||{},1===n.nodeType&&(se.cleanData(m(n,!1)),n.innerHTML=t);n=0}catch(s){}}n&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=se.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(n){var i=t[e++],o=t[e++];o&&(se(this).remove(),o.insertBefore(n,i))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,n){t=Q.apply([],t);var i,o,s,a,r,l,c=0,u=this.length,d=this,f=u-1,g=t[0],v=se.isFunction(g);if(v||!(1>=u||"string"!=typeof g||se.support.checkClone)&&Pe.test(g))return this.each(function(i){var o=d.eq(i);v&&(t[0]=g.call(this,i,o.html())),o.domManip(t,e,n)});if(u&&(i=se.buildFragment(t,this[0].ownerDocument,!1,!n&&this),o=i.firstChild,1===i.childNodes.length&&(i=o),o)){for(s=se.map(m(i,"script"),h),a=s.length;u>c;c++)r=i,c!==f&&(r=se.clone(r,!0,!0),a&&se.merge(s,m(r,"script"))),e.call(this[c],r,c);if(a)for(l=s[s.length-1].ownerDocument,se.map(s,p),c=0;a>c;c++)r=s[c],Re.test(r.type||"")&&!me.access(r,"globalEval")&&se.contains(l,r)&&(r.src?se._evalUrl(r.src):se.globalEval(r.textContent.replace(ze,"")))}return this}}),se.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){se.fn[t]=function(t){for(var n,i=[],o=se(t),s=o.length-1,a=0;s>=a;a++)n=a===s?this:this.clone(!0),se(o[a])[e](n),Z.apply(i,n.get());return this.pushStack(i)}}),se.extend({clone:function(t,e,n){var i,o,s,a,r=t.cloneNode(!0),l=se.contains(t.ownerDocument,t);if(!(se.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||se.isXMLDoc(t)))for(a=m(r),s=m(t),i=0,o=s.length;o>i;i++)v(s[i],a[i]);if(e)if(n)for(s=s||m(t),a=a||m(r),i=0,o=s.length;o>i;i++)g(s[i],a[i]);else g(t,r);return a=m(r,"script"),a.length>0&&f(a,!l&&m(t,"script")),r},buildFragment:function(t,e,n,i){for(var o,s,a,r,l,c,u=0,d=t.length,h=e.createDocumentFragment(),p=[];d>u;u++)if(o=t[u],o||0===o)if("object"===se.type(o))se.merge(p,o.nodeType?[o]:o);else if(Ee.test(o)){for(s=s||h.appendChild(e.createElement("div")),a=(Ne.exec(o)||["",""])[1].toLowerCase(),r=Ve[a]||Ve._default,s.innerHTML=r[1]+o.replace(je,"<$1></$2>")+r[2],c=r[0];c--;)s=s.firstChild;se.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(e.createTextNode(o));for(h.textContent="",u=0;o=p[u++];)if((!i||-1===se.inArray(o,i))&&(l=se.contains(o.ownerDocument,o),s=m(h.appendChild(o),"script"),l&&f(s),n))for(c=0;o=s[c++];)Re.test(o.type||"")&&n.push(o);return h},cleanData:function(t){for(var e,n,i,o=t.length,s=0,a=se.event.special;o>s;s++){if(n=t[s],se.acceptData(n)&&(e=me.access(n)))for(i in e.events)a[i]?se.event.remove(n,i):se.removeEvent(n,i,e.handle);ge.discard(n),me.discard(n)}},_evalUrl:function(t){return se.ajax({url:t,type:"GET",dataType:"text",async:!1,global:!1,success:se.globalEval})}}),se.fn.extend({wrapAll:function(t){var e;return se.isFunction(t)?this.each(function(e){se(this).wrapAll(t.call(this,e))}):(this[0]&&(e=se(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(se.isFunction(t)?function(e){se(this).wrapInner(t.call(this,e))}:function(){var e=se(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=se.isFunction(t);return this.each(function(n){se(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){se.nodeName(this,"body")||se(this).replaceWith(this.childNodes)}).end()}});var Be,He,We=/^(none|table(?!-c[ea]).+)/,$e=/^margin/,qe=RegExp("^("+ae+")(.*)$","i"),Ue=RegExp("^("+ae+")(?!px)[a-z%]+$","i"),Xe=RegExp("^([+-])=("+ae+")","i"),Ge={BODY:"block"},Je={position:"absolute",visibility:"hidden",display:"block"},Ye={letterSpacing:0,fontWeight:400},Ke=["Top","Right","Bottom","Left"],Qe=["Webkit","O","Moz","ms"];se.fn.extend({css:function(t,n){return se.access(this,function(t,n,i){var o,s,a={},r=0;if(se.isArray(n)){for(o=w(t),s=n.length;s>r;r++)a[n[r]]=se.css(t,n[r],!1,o);return a}return i!==e?se.style(t,n,i):se.css(t,n)},t,n,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(t){var e="boolean"==typeof t;return this.each(function(){(e?t:y(this))?se(this).show():se(this).hide()})}}),se.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Be(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,n,i,o){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,a,r,l=se.camelCase(n),c=t.style;return n=se.cssProps[l]||(se.cssProps[l]=b(c,l)),r=se.cssHooks[n]||se.cssHooks[l],i===e?r&&"get"in r&&(s=r.get(t,!1,o))!==e?s:c[n]:(a=typeof i,"string"===a&&(s=Xe.exec(i))&&(i=(s[1]+1)*s[2]+parseFloat(se.css(t,n)),a="number"),null==i||"number"===a&&isNaN(i)||("number"!==a||se.cssNumber[l]||(i+="px"),se.support.clearCloneStyle||""!==i||0!==n.indexOf("background")||(c[n]="inherit"),r&&"set"in r&&(i=r.set(t,i,o))===e||(c[n]=i)),e)}},css:function(t,n,i,o){var s,a,r,l=se.camelCase(n);return n=se.cssProps[l]||(se.cssProps[l]=b(t.style,l)),r=se.cssHooks[n]||se.cssHooks[l],r&&"get"in r&&(s=r.get(t,!0,i)),s===e&&(s=Be(t,n,o)),"normal"===s&&n in Ye&&(s=Ye[n]),""===i||i?(a=parseFloat(s),i===!0||se.isNumeric(a)?a||0:s):s}}),Be=function(t,n,i){var o,s,a,r=i||w(t),l=r?r.getPropertyValue(n)||r[n]:e,c=t.style;return r&&(""!==l||se.contains(t.ownerDocument,t)||(l=se.style(t,n)),Ue.test(l)&&$e.test(n)&&(o=c.width,s=c.minWidth,a=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=r.width,c.width=o,c.minWidth=s,c.maxWidth=a)),l},se.each(["height","width"],function(t,n){se.cssHooks[n]={get:function(t,i,o){return i?0===t.offsetWidth&&We.test(se.css(t,"display"))?se.swap(t,Je,function(){return S(t,n,o)}):S(t,n,o):e},set:function(t,e,i){var o=i&&w(t);return x(t,e,i?C(t,n,i,se.support.boxSizing&&"border-box"===se.css(t,"boxSizing",!1,o),o):0)}}}),se(function(){se.support.reliableMarginRight||(se.cssHooks.marginRight={get:function(t,n){return n?se.swap(t,{display:"inline-block"},Be,[t,"marginRight"]):e}}),!se.support.pixelPosition&&se.fn.position&&se.each(["top","left"],function(t,n){se.cssHooks[n]={get:function(t,i){return i?(i=Be(t,n),Ue.test(i)?se(t).position()[n]+"px":i):e}}})}),se.expr&&se.expr.filters&&(se.expr.filters.hidden=function(t){return 0>=t.offsetWidth&&0>=t.offsetHeight},se.expr.filters.visible=function(t){return!se.expr.filters.hidden(t)}),se.each({margin:"",padding:"",border:"Width"},function(t,e){se.cssHooks[t+e]={expand:function(n){for(var i=0,o={},s="string"==typeof n?n.split(" "):[n];4>i;i++)o[t+Ke[i]+e]=s[i]||s[i-2]||s[0];return o}},$e.test(t)||(se.cssHooks[t+e].set=x)});var Ze=/%20/g,tn=/\[\]$/,en=/\r?\n/g,nn=/^(?:submit|button|image|reset|file)$/i,on=/^(?:input|select|textarea|keygen)/i;se.fn.extend({serialize:function(){return se.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=se.prop(this,"elements");return t?se.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!se(this).is(":disabled")&&on.test(this.nodeName)&&!nn.test(t)&&(this.checked||!Ae.test(t))}).map(function(t,e){var n=se(this).val();return null==n?null:se.isArray(n)?se.map(n,function(t){return{name:e.name,value:t.replace(en,"\r\n")}}):{name:e.name,value:n.replace(en,"\r\n")}}).get()}}),se.param=function(t,n){var i,o=[],s=function(t,e){e=se.isFunction(e)?e():null==e?"":e,o[o.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(n===e&&(n=se.ajaxSettings&&se.ajaxSettings.traditional),se.isArray(t)||t.jquery&&!se.isPlainObject(t))se.each(t,function(){s(this.name,this.value)});else for(i in t)k(i,t[i],n,s);return o.join("&").replace(Ze,"+")},se.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){se.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),se.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var sn,an,rn=se.now(),ln=/\?/,cn=/#.*$/,un=/([?&])_=[^&]*/,dn=/^(.*?):[ \t]*([^\r\n]*)$/gm,hn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,pn=/^(?:GET|HEAD)$/,fn=/^\/\//,gn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,mn=se.fn.load,vn={},bn={},yn="*/".concat("*");try{an=$.href}catch(wn){an=q.createElement("a"),an.href="",an=an.href}sn=gn.exec(an.toLowerCase())||[],se.fn.load=function(t,n,i){if("string"!=typeof t&&mn)return mn.apply(this,arguments);var o,s,a,r=this,l=t.indexOf(" ");return l>=0&&(o=t.slice(l),t=t.slice(0,l)),se.isFunction(n)?(i=n,n=e):n&&"object"==typeof n&&(s="POST"),r.length>0&&se.ajax({url:t,type:s,dataType:"html",data:n}).done(function(t){a=arguments,r.html(o?se("<div>").append(se.parseHTML(t)).find(o):t)}).complete(i&&function(t,e){r.each(i,a||[t.responseText,e,t])}),this},se.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){se.fn[e]=function(t){return this.on(e,t)}}),se.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:an,type:"GET",isLocal:hn.test(sn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":yn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":se.parseJSON,"text xml":se.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?L(L(t,se.ajaxSettings),e):L(se.ajaxSettings,t)},ajaxPrefilter:I(vn),ajaxTransport:I(bn),ajax:function(t,n){function i(t,n,i,r){var c,d,b,y,_,C=n;2!==w&&(w=2,l&&clearTimeout(l),o=e,a=r||"",x.readyState=t>0?4:0,c=t>=200&&300>t||304===t,i&&(y=j(h,x,i)),y=N(h,y,x,c),c?(h.ifModified&&(_=x.getResponseHeader("Last-Modified"),_&&(se.lastModified[s]=_),_=x.getResponseHeader("etag"),_&&(se.etag[s]=_)),204===t?C="nocontent":304===t?C="notmodified":(C=y.state,d=y.data,b=y.error,c=!b)):(b=C,(t||!C)&&(C="error",0>t&&(t=0))),x.status=t,x.statusText=(n||C)+"",c?g.resolveWith(p,[d,C,x]):g.rejectWith(p,[x,C,b]),x.statusCode(v),v=e,u&&f.trigger(c?"ajaxSuccess":"ajaxError",[x,h,c?d:b]),m.fireWith(p,[x,C]),u&&(f.trigger("ajaxComplete",[x,h]),--se.active||se.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=e),n=n||{};var o,s,a,r,l,c,u,d,h=se.ajaxSetup({},n),p=h.context||h,f=h.context&&(p.nodeType||p.jquery)?se(p):se.event,g=se.Deferred(),m=se.Callbacks("once memory"),v=h.statusCode||{},b={},y={},w=0,_="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!r)for(r={};e=dn.exec(a);)r[e[1].toLowerCase()]=e[2];e=r[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?a:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return w||(t=y[n]=y[n]||t,b[t]=e),this},overrideMimeType:function(t){return w||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)v[e]=[v[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||_;return o&&o.abort(e),i(0,e),this}};if(g.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,h.url=((t||h.url||an)+"").replace(cn,"").replace(fn,sn[1]+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=se.trim(h.dataType||"*").toLowerCase().match(re)||[""],null==h.crossDomain&&(c=gn.exec(h.url.toLowerCase()),h.crossDomain=!(!c||c[1]===sn[1]&&c[2]===sn[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(sn[3]||("http:"===sn[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=se.param(h.data,h.traditional)),M(vn,h,n,x),2===w)return x;u=h.global,u&&0===se.active++&&se.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!pn.test(h.type),s=h.url,h.hasContent||(h.data&&(s=h.url+=(ln.test(s)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=un.test(s)?s.replace(un,"$1_="+rn++):s+(ln.test(s)?"&":"?")+"_="+rn++)),h.ifModified&&(se.lastModified[s]&&x.setRequestHeader("If-Modified-Since",se.lastModified[s]),se.etag[s]&&x.setRequestHeader("If-None-Match",se.etag[s])),(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",h.contentType),x.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+yn+"; q=0.01":""):h.accepts["*"]);for(d in h.headers)x.setRequestHeader(d,h.headers[d]);if(h.beforeSend&&(h.beforeSend.call(p,x,h)===!1||2===w))return x.abort();_="abort";for(d in{success:1,error:1,complete:1})x[d](h[d]);if(o=M(bn,h,n,x)){x.readyState=1,u&&f.trigger("ajaxSend",[x,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){x.abort("timeout")},h.timeout));try{w=1,o.send(b,i)
}catch(C){if(!(2>w))throw C;i(-1,C)}}else i(-1,"No Transport");return x},getJSON:function(t,e,n){return se.get(t,e,n,"json")},getScript:function(t,n){return se.get(t,e,n,"script")}}),se.each(["get","post"],function(t,n){se[n]=function(t,i,o,s){return se.isFunction(i)&&(s=s||o,o=i,i=e),se.ajax({url:t,type:n,dataType:s,data:i,success:o})}}),se.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return se.globalEval(t),t}}}),se.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),se.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(i,o){e=se("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),q.head.appendChild(e[0])},abort:function(){n&&n()}}}});var _n=[],xn=/(=)\?(?=&|$)|\?\?/;se.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=_n.pop()||se.expando+"_"+rn++;return this[t]=!0,t}}),se.ajaxPrefilter("json jsonp",function(n,i,o){var s,a,r,l=n.jsonp!==!1&&(xn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&xn.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(s=n.jsonpCallback=se.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(xn,"$1"+s):n.jsonp!==!1&&(n.url+=(ln.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return r||se.error(s+" was not called"),r[0]},n.dataTypes[0]="json",a=t[s],t[s]=function(){r=arguments},o.always(function(){t[s]=a,n[s]&&(n.jsonpCallback=i.jsonpCallback,_n.push(s)),r&&se.isFunction(a)&&a(r[0]),r=a=e}),"script"):e}),se.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Cn=se.ajaxSettings.xhr(),Sn={0:200,1223:204},Tn=0,Dn={};t.ActiveXObject&&se(t).on("unload",function(){for(var t in Dn)Dn[t]();Dn=e}),se.support.cors=!!Cn&&"withCredentials"in Cn,se.support.ajax=Cn=!!Cn,se.ajaxTransport(function(t){var n;return se.support.cors||Cn&&!t.crossDomain?{send:function(i,o){var s,a,r=t.xhr();if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)r[s]=t.xhrFields[s];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)r.setRequestHeader(s,i[s]);n=function(t){return function(){n&&(delete Dn[a],n=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?o(r.status||404,r.statusText):o(Sn[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:e,r.getAllResponseHeaders()))}},r.onload=n(),r.onerror=n("error"),n=Dn[a=Tn++]=n("abort"),r.send(t.hasContent&&t.data||null)},abort:function(){n&&n()}}:e});var kn,In,Mn=/^(?:toggle|show|hide)$/,Ln=RegExp("^(?:([+-])=|)("+ae+")([a-z%]*)$","i"),jn=/queueHooks$/,Nn=[R],En={"*":[function(t,e){var n,i,o=this.createTween(t,e),s=Ln.exec(e),a=o.cur(),r=+a||0,l=1,c=20;if(s){if(n=+s[2],i=s[3]||(se.cssNumber[t]?"":"px"),"px"!==i&&r){r=se.css(o.elem,t,!0)||n||1;do l=l||".5",r/=l,se.style(o.elem,t,r+i);while(l!==(l=o.cur()/a)&&1!==l&&--c)}o.unit=i,o.start=r,o.end=s[1]?r+(s[1]+1)*n:n}return o}]};se.Animation=se.extend(A,{tweener:function(t,e){se.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,i=0,o=t.length;o>i;i++)n=t[i],En[n]=En[n]||[],En[n].unshift(e)},prefilter:function(t,e){e?Nn.unshift(t):Nn.push(t)}}),se.Tween=F,F.prototype={constructor:F,init:function(t,e,n,i,o,s){this.elem=t,this.prop=n,this.easing=o||"swing",this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=s||(se.cssNumber[n]?"":"px")},cur:function(){var t=F.propHooks[this.prop];return t&&t.get?t.get(this):F.propHooks._default.get(this)},run:function(t){var e,n=F.propHooks[this.prop];return this.pos=e=this.options.duration?se.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):F.propHooks._default.set(this),this}},F.prototype.init.prototype=F.prototype,F.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=se.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){se.fx.step[t.prop]?se.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[se.cssProps[t.prop]]||se.cssHooks[t.prop])?se.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},F.propHooks.scrollTop=F.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},se.each(["toggle","show","hide"],function(t,e){var n=se.fn[e];se.fn[e]=function(t,i,o){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(z(e,!0),t,i,o)}}),se.fn.extend({fadeTo:function(t,e,n,i){return this.filter(y).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var o=se.isEmptyObject(t),s=se.speed(e,n,i),a=function(){var e=A(this,se.extend({},t),s);a.finish=function(){e.stop(!0)},(o||me.get(this,"finish"))&&e.stop(!0)};return a.finish=a,o||s.queue===!1?this.each(a):this.queue(s.queue,a)},stop:function(t,n,i){var o=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=n,n=t,t=e),n&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,n=null!=t&&t+"queueHooks",s=se.timers,a=me.get(this);if(n)a[n]&&a[n].stop&&o(a[n]);else for(n in a)a[n]&&a[n].stop&&jn.test(n)&&o(a[n]);for(n=s.length;n--;)s[n].elem!==this||null!=t&&s[n].queue!==t||(s[n].anim.stop(i),e=!1,s.splice(n,1));(e||!i)&&se.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=me.get(this),i=n[t+"queue"],o=n[t+"queueHooks"],s=se.timers,a=i?i.length:0;for(n.finish=!0,se.queue(this,t,[]),o&&o.cur&&o.cur.finish&&o.cur.finish.call(this),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;a>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),se.each({slideDown:z("show"),slideUp:z("hide"),slideToggle:z("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){se.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),se.speed=function(t,e,n){var i=t&&"object"==typeof t?se.extend({},t):{complete:n||!n&&e||se.isFunction(t)&&t,duration:t,easing:n&&e||e&&!se.isFunction(e)&&e};return i.duration=se.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in se.fx.speeds?se.fx.speeds[i.duration]:se.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){se.isFunction(i.old)&&i.old.call(this),i.queue&&se.dequeue(this,i.queue)},i},se.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},se.timers=[],se.fx=F.prototype.init,se.fx.tick=function(){var t,n=se.timers,i=0;for(kn=se.now();n.length>i;i++)t=n[i],t()||n[i]!==t||n.splice(i--,1);n.length||se.fx.stop(),kn=e},se.fx.timer=function(t){t()&&se.timers.push(t)&&se.fx.start()},se.fx.interval=13,se.fx.start=function(){In||(In=setInterval(se.fx.tick,se.fx.interval))},se.fx.stop=function(){clearInterval(In),In=null},se.fx.speeds={slow:600,fast:200,_default:400},se.fx.step={},se.expr&&se.expr.filters&&(se.expr.filters.animated=function(t){return se.grep(se.timers,function(e){return t===e.elem}).length}),se.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){se.offset.setOffset(this,t,e)});var n,i,o=this[0],s={top:0,left:0},a=o&&o.ownerDocument;return a?(n=a.documentElement,se.contains(n,o)?(typeof o.getBoundingClientRect!==W&&(s=o.getBoundingClientRect()),i=V(a),{top:s.top+i.pageYOffset-n.clientTop,left:s.left+i.pageXOffset-n.clientLeft}):s):void 0},se.offset={setOffset:function(t,e,n){var i,o,s,a,r,l,c,u=se.css(t,"position"),d=se(t),h={};"static"===u&&(t.style.position="relative"),r=d.offset(),s=se.css(t,"top"),l=se.css(t,"left"),c=("absolute"===u||"fixed"===u)&&(s+l).indexOf("auto")>-1,c?(i=d.position(),a=i.top,o=i.left):(a=parseFloat(s)||0,o=parseFloat(l)||0),se.isFunction(e)&&(e=e.call(t,n,r)),null!=e.top&&(h.top=e.top-r.top+a),null!=e.left&&(h.left=e.left-r.left+o),"using"in e?e.using.call(t,h):d.css(h)}},se.fn.extend({position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===se.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),se.nodeName(t[0],"html")||(i=t.offset()),i.top+=se.css(t[0],"borderTopWidth",!0),i.left+=se.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-se.css(n,"marginTop",!0),left:e.left-i.left-se.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||U;t&&!se.nodeName(t,"html")&&"static"===se.css(t,"position");)t=t.offsetParent;return t||U})}}),se.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,i){var o="pageYOffset"===i;se.fn[n]=function(s){return se.access(this,function(n,s,a){var r=V(n);return a===e?r?r[i]:n[s]:(r?r.scrollTo(o?t.pageXOffset:a,o?a:t.pageYOffset):n[s]=a,e)},n,s,arguments.length,null)}}),se.each({Height:"height",Width:"width"},function(t,n){se.each({padding:"inner"+t,content:n,"":"outer"+t},function(i,o){se.fn[o]=function(o,s){var a=arguments.length&&(i||"boolean"!=typeof o),r=i||(o===!0||s===!0?"margin":"border");return se.access(this,function(n,i,o){var s;return se.isWindow(n)?n.document.documentElement["client"+t]:9===n.nodeType?(s=n.documentElement,Math.max(n.body["scroll"+t],s["scroll"+t],n.body["offset"+t],s["offset"+t],s["client"+t])):o===e?se.css(n,i,r):se.style(n,i,o,r)},n,a?o:e,a,null)}})}),se.fn.size=function(){return this.length},se.fn.andSelf=se.fn.addBack,"object"==typeof module&&"object"==typeof module.exports?module.exports=se:"function"==typeof define&&define.amd&&define("jquery",[],function(){return se}),"object"==typeof t&&"object"==typeof t.document&&(t.jQuery=t.$=se)}(window),function(t,e){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,o){t.Backbone=e(t,o,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");e(t,exports,n)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,n,i){{var o=t.Backbone,s=[],a=(s.push,s.slice);s.splice}e.VERSION="1.1.2",e.$=i,e.noConflict=function(){return t.Backbone=o,this},e.emulateHTTP=!1,e.emulateJSON=!1;var r=e.Events={on:function(t,e,n){if(!c(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,i){if(!c(this,"once",t,[e,i])||!e)return this;var o=this,s=n.once(function(){o.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,i)},off:function(t,e,i){var o,s,a,r,l,u,d,h;if(!this._events||!c(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events=void 0,this;for(r=t?[t]:n.keys(this._events),l=0,u=r.length;u>l;l++)if(t=r[l],a=this._events[t]){if(this._events[t]=o=[],e||i)for(d=0,h=a.length;h>d;d++)s=a[d],(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context)&&o.push(s);o.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!c(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&u(n,e),i&&u(i,arguments),this},stopListening:function(t,e,i){var o=this._listeningTo;if(!o)return this;var s=!e&&!i;i||"object"!=typeof e||(i=this),t&&((o={})[t._listenId]=t);for(var a in o)t=o[a],t.off(e,i,this),(s||n.isEmpty(t._events))&&delete this._listeningTo[a];return this}},l=/\s+/,c=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)t[e].apply(t,[o,n[o]].concat(i));return!1}if(l.test(n)){for(var s=n.split(l),a=0,r=s.length;r>a;a++)t[e].apply(t,[s[a]].concat(i));return!1}return!0},u=function(t,e){var n,i=-1,o=t.length,s=e[0],a=e[1],r=e[2];switch(e.length){case 0:for(;++i<o;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<o;)(n=t[i]).callback.call(n.ctx,s,a);return;case 3:for(;++i<o;)(n=t[i]).callback.call(n.ctx,s,a,r);return;default:for(;++i<o;)(n=t[i]).callback.apply(n.ctx,e);return}},d={listenTo:"on",listenToOnce:"once"};n.each(d,function(t,e){r[e]=function(e,i,o){var s=this._listeningTo||(this._listeningTo={}),a=e._listenId||(e._listenId=n.uniqueId("l"));return s[a]=e,o||"object"!=typeof i||(o=this),e[t](i,o,this),this}}),r.bind=r.on,r.unbind=r.off,n.extend(e,r);var h=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,r,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var o,s,a,r,l,c,u,d;if(null==t)return this;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;a=i.unset,l=i.silent,r=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(o in s)e=s[o],n.isEqual(d[o],e)||r.push(o),n.isEqual(u[o],e)?delete this.changed[o]:this.changed[o]=e,a?delete d[o]:d[o]=e;if(!l){r.length&&(this._pending=i);for(var h=0,p=r.length;p>h;h++)this.trigger("change:"+r[h],this,d[r[h]],i)}if(c)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e,i=!1,o=this._changing?this._previousAttributes:this.attributes;for(var s in t)n.isEqual(o[s],e=t[s])||((i||(i={}))[s]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(i&&i(e,n,t),void e.trigger("sync",e,n,t)):!1},R(this,t),this.sync("read",this,t)},save:function(t,e,i){var o,s,a,r=this.attributes;if(null==t||"object"==typeof t?(o=t,i=e):(o={})[t]=e,i=n.extend({validate:!0},i),o&&!i.wait){if(!this.set(o,i))return!1}else if(!this._validate(o,i))return!1;o&&i.wait&&(this.attributes=n.extend({},r,o)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(t){l.attributes=r;var e=l.parse(t,i);return i.wait&&(e=n.extend(o||{},e)),n.isObject(e)&&!l.set(e,i)?!1:(c&&c(l,t,i),void l.trigger("sync",l,t,i))},R(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=o),a=this.sync(s,this,i),o&&i.wait&&(this.attributes=r),a},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,o=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&o(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;R(this,t);var s=this.sync("delete",this,t);return t.wait||o(),s},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||P();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(t){h.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.attributes),n[t].apply(n,e)}});var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};n.extend(f.prototype,r,{model:h,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,m))},remove:function(t,e){var i=!n.isArray(t);t=i?[t]:n.clone(t),e||(e={});var o,s,a,r;for(o=0,s=t.length;s>o;o++)r=t[o]=this.get(t[o]),r&&(delete this._byId[r.id],delete this._byId[r.cid],a=this.indexOf(r),this.models.splice(a,1),this.length--,e.silent||(e.index=a,r.trigger("remove",r,this,e)),this._removeReference(r,e));return i?t[0]:t},set:function(t,e){e=n.defaults({},e,g),e.parse&&(t=this.parse(t,e));var i=!n.isArray(t);t=i?t?[t]:[]:n.clone(t);var o,s,a,r,l,c,u,d=e.at,p=this.model,f=this.comparator&&null==d&&e.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,v=[],b=[],y={},w=e.add,_=e.merge,x=e.remove,C=!f&&w&&x?[]:!1;for(o=0,s=t.length;s>o;o++){if(l=t[o]||{},a=l instanceof h?r=l:l[p.prototype.idAttribute||"id"],c=this.get(a))x&&(y[c.cid]=!0),_&&(l=l===r?r.attributes:l,e.parse&&(l=c.parse(l,e)),c.set(l,e),f&&!u&&c.hasChanged(m)&&(u=!0)),t[o]=c;else if(w){if(r=t[o]=this._prepareModel(l,e),!r)continue;v.push(r),this._addReference(r,e)}r=c||r,!C||!r.isNew()&&y[r.id]||C.push(r),y[r.id]=!0}if(x){for(o=0,s=this.length;s>o;++o)y[(r=this.models[o]).cid]||b.push(r);b.length&&this.remove(b,e)}if(v.length||C&&C.length)if(f&&(u=!0),this.length+=v.length,null!=d)for(o=0,s=v.length;s>o;o++)this.models.splice(d+o,0,v[o]);else{C&&(this.models.length=0);var S=C||v;for(o=0,s=S.length;s>o;o++)this.models.push(S[o])}if(u&&this.sort({silent:!0}),!e.silent){for(o=0,s=v.length;s>o;o++)(r=v[o]).trigger("add",r,this,e);(u||C&&C.length)&&this.trigger("sort",this,e)}return i?t[0]:t},reset:function(t,e){e||(e={});for(var i=0,o=this.models.length;o>i;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return a.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return n.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=t?n.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(n){var o=t.reset?"reset":"set";i[o](n,t),e&&e(i,n,t),i.trigger("sync",i,n,t)},R(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?n.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,o=e.success;return e.success=function(t,n){e.wait&&i.add(t,e),o&&o(t,n,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof h)return t;e=e?n.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_addReference:function(t){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(t){f.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),n[t].apply(n,e)}});var b=["groupBy","countBy","sortBy","indexBy"];n.each(b,function(t){f.prototype[t]=function(e,i){var o=n.isFunction(e)?e:function(t){return t.get(e)};return n[t](this.models,o,i)}});var y=e.View=function(t){this.cid=n.uniqueId("view"),t||(t={}),n.extend(this,n.pick(t,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];n.extend(y.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=n.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[t[e]]),i){var o=e.match(w),s=o[1],a=o[2];i=n.bind(i,this),s+=".delegateEvents"+this.cid,""===a?this.$el.on(s,i):this.$el.on(s,a,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className"));var i=e.$("<"+n.result(this,"tagName")+">").attr(t);this.setElement(i,!1)}}}),e.sync=function(t,i,o){var s=C[t];n.defaults(o||(o={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:s,dataType:"json"};if(o.url||(a.url=n.result(i,"url")||P()),null!=o.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(o.attrs||i.toJSON(o))),o.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),o.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){a.type="POST",o.emulateJSON&&(a.data._method=s);var r=o.beforeSend;o.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),r?r.apply(this,arguments):void 0}}"GET"===a.type||o.emulateJSON||(a.processData=!1),"PATCH"===a.type&&x&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=o.xhr=e.ajax(n.extend(a,o));return i.trigger("request",i,l,o),l};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,D=/(\(\?)?:\w+/g,k=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(S.prototype,r,{initialize:function(){},route:function(t,i,o){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(o=i,i=""),o||(o=this[i]);var s=this;return e.history.route(t,function(n){var a=s._extractParameters(t,n);s.execute(o,a),s.trigger.apply(s,["route:"+i].concat(a)),s.trigger("route",i,a),e.history.trigger("route",s,i,a)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(I,"\\$&").replace(T,"(?:$1)?").replace(D,function(t,e){return e?t:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var M=e.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},L=/^[#\/]|\s+$/g,j=/^\/+|\/+$/g,N=/msie [\w.]+/,E=/\/$/,O=/#.*$/;M.started=!1,n.extend(M.prototype,r,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(E,"");t.indexOf(n)||(t=t.slice(n.length))}else t=this.getHash();return t.replace(L,"")},start:function(t){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),o=document.documentMode,s=N.exec(navigator.userAgent.toLowerCase())&&(!o||7>=o);if(this.root=("/"+this.root+"/").replace(j,"/"),s&&this._wantsHashChange){var a=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&r.hash&&(this.fragment=this.getHash().replace(L,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),n.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!M.started)return!1;e&&e!==!0||(e={trigger:!!e});var n=this.root+(t=this.getFragment(t||""));if(t=t.replace(O,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new M;var A=function(t,e){var i,o=this;i=t&&n.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},n.extend(i,o,e);var s=function(){this.constructor=i};return s.prototype=o.prototype,i.prototype=new s,t&&n.extend(i.prototype,t),i.__super__=o.prototype,i};h.extend=f.extend=S.extend=y.extend=M.extend=A;var P=function(){throw new Error('A "url" property or function must be specified')},R=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}};return e}),function(t,e){if("function"==typeof define&&define.amd)define("marionette",["backbone","underscore"],function(n,i){return t.Marionette=t.Mn=e(t,n,i)});else if("undefined"!=typeof exports){var n=require("backbone"),i=require("underscore");module.exports=e(t,n,i)}else t.Marionette=t.Mn=e(t,t.Backbone,t._)}(this,function(t,e,n){"use strict";!function(t,e){var n=t.ChildViewContainer;return t.ChildViewContainer=function(t,e){var n=function(t){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),e.each(t,this.add,this)};e.extend(n.prototype,{add:function(t,e){var n=t.cid;return this._views[n]=t,t.model&&(this._indexByModel[t.model.cid]=n),e&&(this._indexByCustom[e]=n),this._updateLength(),this},findByModel:function(t){return this.findByModelCid(t.cid)},findByModelCid:function(t){var e=this._indexByModel[t];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var n=t.cid;return t.model&&delete this._indexByModel[t.model.cid],e.any(this._indexByCustom,function(t,e){return t===n?(delete this._indexByCustom[e],!0):void 0},this),delete this._views[n],this._updateLength(),this},call:function(t){this.apply(t,e.tail(arguments))},apply:function(t,n){e.each(this._views,function(i){e.isFunction(i[t])&&i[t].apply(i,n||[])})},_updateLength:function(){this.length=e.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return e.each(i,function(t){n.prototype[t]=function(){var n=e.values(this._views),i=[n].concat(e.toArray(arguments));return e[t].apply(e,i)}}),n}(t,e),t.ChildViewContainer.VERSION="0.1.4",t.ChildViewContainer.noConflict=function(){return t.ChildViewContainer=n,this},t.ChildViewContainer}(e,n),function(t,e){var n=t.Wreqr,i=t.Wreqr={};return t.Wreqr.VERSION="1.3.1",t.Wreqr.noConflict=function(){return t.Wreqr=n,this},i.Handlers=function(t,e){var n=function(t){this.options=t,this._wreqrHandlers={},e.isFunction(this.initialize)&&this.initialize(t)};return n.extend=t.Model.extend,e.extend(n.prototype,t.Events,{setHandlers:function(t){e.each(t,function(t,n){var i=null;e.isObject(t)&&!e.isFunction(t)&&(i=t.context,t=t.callback),this.setHandler(n,t,i)},this)},setHandler:function(t,e,n){var i={callback:e,context:n};this._wreqrHandlers[t]=i,this.trigger("handler:add",t,e,n)},hasHandler:function(t){return!!this._wreqrHandlers[t]},getHandler:function(t){var e=this._wreqrHandlers[t];if(e)return function(){var t=Array.prototype.slice.apply(arguments);
return e.callback.apply(e.context,t)}},removeHandler:function(t){delete this._wreqrHandlers[t]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(t,e),i.CommandStorage=function(){var n=function(t){this.options=t,this._commands={},e.isFunction(this.initialize)&&this.initialize(t)};return e.extend(n.prototype,t.Events,{getCommands:function(t){var e=this._commands[t];return e||(e={command:t,instances:[]},this._commands[t]=e),e},addCommand:function(t,e){var n=this.getCommands(t);n.instances.push(e)},clearCommands:function(t){var e=this.getCommands(t);e.instances=[]}}),n}(),i.Commands=function(t){return t.Handlers.extend({storageType:t.CommandStorage,constructor:function(e){this.options=e||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);t.Handlers.prototype.constructor.apply(this,n)},execute:function(t,e){t=arguments[0],e=Array.prototype.slice.call(arguments,1),this.hasHandler(t)?this.getHandler(t).apply(this,e):this.storage.addCommand(t,e)},_executeCommands:function(t,n,i){var o=this.storage.getCommands(t);e.each(o.instances,function(t){n.apply(i,t)}),this.storage.clearCommands(t)},_initializeStorage:function(t){var n,i=t.storageType||this.storageType;n=e.isFunction(i)?new i:i,this.storage=n}})}(i),i.RequestResponse=function(t){return t.Handlers.extend({request:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.hasHandler(t)?this.getHandler(t).apply(this,e):void 0}})}(i),i.EventAggregator=function(t,e){var n=function(){};return n.extend=t.Model.extend,e.extend(n.prototype,t.Events),n}(t,e),i.Channel=function(){var n=function(e){this.vent=new t.Wreqr.EventAggregator,this.reqres=new t.Wreqr.RequestResponse,this.commands=new t.Wreqr.Commands,this.channelName=e};return e.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(t,e){return this._connect("vent",t,e),this},connectCommands:function(t,e){return this._connect("commands",t,e),this},connectRequests:function(t,e){return this._connect("reqres",t,e),this},_connect:function(t,n,i){if(n){i=i||this;var o="vent"===t?"on":"setHandler";e.each(n,function(n,s){this[t][o](s,e.bind(n,i))},this)}}}),n}(i),i.radio=function(t){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};e.extend(n.prototype,{channel:function(t){if(!t)throw new Error("Channel must receive a name");return this._getChannel(t)},_getChannel:function(e){var n=this._channels[e];return n||(n=new t.Channel(e),this._channels[e]=n),n},_proxyMethods:function(){e.each(["vent","commands","reqres"],function(t){e.each(i[t],function(e){this[t][e]=o(this,t,e)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},o=function(t,e,n){return function(i){var o=t._getChannel(i)[e],s=Array.prototype.slice.call(arguments,1);return o[n].apply(o,s)}};return new n}(i),t.Wreqr}(e,n);var i=t.Marionette,o=e.Marionette={};o.VERSION="2.3.0",o.noConflict=function(){return t.Marionette=i,this},e.Marionette=o,o.Deferred=e.$.Deferred,o.extend=e.Model.extend,o.isNodeAttached=function(t){return e.$.contains(document.documentElement,t)},o.getOption=function(t,e){return t&&e?t.options&&void 0!==t.options[e]?t.options[e]:t[e]:void 0},o.proxyGetOption=function(t){return o.getOption(this,t)},o.normalizeMethods=function(t){return n.reduce(t,function(t,e,i){return n.isFunction(e)||(e=this[e]),e&&(t[i]=e),t},{},this)},o.normalizeUIString=function(t,e){return t.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(t){return e[t.slice(4)]})},o.normalizeUIKeys=function(t,e){return n.reduce(t,function(t,n,i){var s=o.normalizeUIString(i,e);return t[s]=n,t},{})},o.normalizeUIValues=function(t,e){return n.each(t,function(i,s){n.isString(i)&&(t[s]=o.normalizeUIString(i,e))}),t},o.actAsCollection=function(t,e){var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(i,function(i){t[i]=function(){var t=n.values(n.result(this,e)),o=[t].concat(n.toArray(arguments));return n[i].apply(n,o)}})};var s=o.deprecate=function(t,e){n.isObject(t)&&(t=t.prev+" is going to be removed in the future. Please use "+t.next+" instead."+(t.url?" See: "+t.url:"")),void 0!==e&&e||s._cache[t]||(s._warn("Deprecation warning: "+t),s._cache[t]=!0)};s._warn="undefined"!=typeof console&&(console.warn||console.log)||function(){},s._cache={},o._triggerMethod=function(){function t(t,e,n){return n.toUpperCase()}var e=/(^|:)(\w)/gi;return function(i,o,s){var a=arguments.length<3;a&&(s=o,o=s[0]);var r,l="on"+o.replace(e,t),c=i[l];return n.isFunction(c)&&(r=c.apply(i,a?n.rest(s):s)),n.isFunction(i.trigger)&&(a+s.length>1?i.trigger.apply(i,a?s:[o].concat(n.rest(s,0))):i.trigger(o)),r}}(),o.triggerMethod=function(){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(t){var e=n.isFunction(t.triggerMethod)?t.triggerMethod:o.triggerMethod;return e.apply(t,n.rest(arguments))},o.MonitorDOMRefresh=function(t){function e(){t._isShown=!0,s()}function i(){t._isRendered=!0,s()}function s(){t._isShown&&t._isRendered&&o.isNodeAttached(t.el)&&n.isFunction(t.triggerMethod)&&t.triggerMethod("dom:refresh")}t.on({show:e,render:i})},function(t){function e(e,i,o,s){var a=s.split(/\s+/);n.each(a,function(n){var s=e[n];if(!s)throw new t.Error('Method "'+n+'" was configured as an event handler, but does not exist.');e.listenTo(i,o,s)})}function i(t,e,n,i){t.listenTo(e,n,i)}function o(t,e,i,o){var s=o.split(/\s+/);n.each(s,function(n){var o=t[n];t.stopListening(e,i,o)})}function s(t,e,n,i){t.stopListening(e,n,i)}function a(e,i,o,s,a){if(i&&o){if(!n.isFunction(o)&&!n.isObject(o))throw new t.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});n.isFunction(o)&&(o=o.call(e)),n.each(o,function(t,o){n.isFunction(t)?s(e,i,o,t):a(e,i,o,t)})}}t.bindEntityEvents=function(t,n,o){a(t,n,o,i,e)},t.unbindEntityEvents=function(t,e,n){a(t,e,n,s,o)},t.proxyBindEntityEvents=function(e,n){return t.bindEntityEvents(this,e,n)},t.proxyUnbindEntityEvents=function(e,n){return t.unbindEntityEvents(this,e,n)}}(o);var a=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(t,e){n.isObject(t)?(e=t,t=e.message):e||(e={});var i=Error.call(this,t);n.extend(this,n.pick(i,a),n.pick(e,a)),this.captureStackTrace(),e.url&&(this.url=this.urlRoot+e.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},n.extend(o.Callbacks.prototype,{add:function(t,e){var i=n.result(this._deferred,"promise");this._callbacks.push({cb:t,ctx:e}),i.then(function(n){e&&(n.context=e),t.call(n.context,n.options)})},run:function(t,e){this._deferred.resolve({options:t,context:e})},reset:function(){var t=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],n.each(t,function(t){this.add(t.cb,t.ctx)},this)}}),o.Controller=function(t){this.options=t||{},n.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,n.extend(o.Controller.prototype,e.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,getOption:o.proxyGetOption}),o.Object=function(t){this.options=n.extend({},n.result(this,"options"),t),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,n.extend(o.Object.prototype,e.Events,{initialize:function(){},destroy:function(){this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening()},triggerMethod:o.triggerMethod,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(t){if(this.options=t||{},this.el=this.getOption("el"),this.el=this.el instanceof e.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,t)},show:function(t,e){if(this._ensureElement()){this._ensureViewIsIntact(t);var n=e||{},i=t!==this.currentView,s=!!n.preventDestroy,a=!!n.forceShow,r=!!this.currentView,l=i&&!s,c=i||a;if(r&&this.triggerMethod("before:swapOut",this.currentView,this,e),this.currentView&&delete this.currentView._parent,l?this.empty():r&&c&&this.currentView.off("destroy",this.empty,this),c){t.once("destroy",this.empty,this),t.render(),t._parent=this,r&&this.triggerMethod("before:swap",t,this,e),this.triggerMethod("before:show",t,this,e),o.triggerMethodOn(t,"before:show",t,this,e),r&&this.triggerMethod("swapOut",this.currentView,this,e);var u=o.isNodeAttached(this.el),d=[],h=n.triggerBeforeAttach||this.triggerBeforeAttach,p=n.triggerAttach||this.triggerAttach;return u&&h&&(d=this._displayedViews(t),this._triggerAttach(d,"before:")),this.attachHtml(t),this.currentView=t,u&&p&&(d=this._displayedViews(t),this._triggerAttach(d)),r&&this.triggerMethod("swap",t,this,e),this.triggerMethod("show",t,this,e),o.triggerMethodOn(t,"show",t,this,e),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(t,e){var i=(e||"")+"attach";n.each(t,function(t){o.triggerMethodOn(t,i,t,this)},this)},_displayedViews:function(t){return n.union([t],n.result(t,"_getNestedViews")||[])},_ensureElement:function(){if(n.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(t){if(!t)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(t.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+t.cid+'") has already been destroyed and cannot be used.'})},getEl:function(t){return e.$(t)},attachHtml:function(t){this.$el.html(""),this.el.appendChild(t.el)},empty:function(){var t=this.currentView;if(t)return t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,this},_destroyView:function(){var t=this.currentView;t.destroy&&!t.isDestroyed?t.destroy():t.remove&&(t.remove(),t.isDestroyed=!0)},attachView:function(t){return this.currentView=t,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(t,e){if(n.isString(t))return this._buildRegionFromSelector(t,e);if(t.selector||t.el||t.regionClass)return this._buildRegionFromObject(t,e);if(n.isFunction(t))return this._buildRegionFromRegionClass(t);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(t,e){return new e({el:t})},_buildRegionFromObject:function(t,i){var o=t.regionClass||i,s=n.omit(t,"selector","regionClass");t.selector&&!s.el&&(s.el=t.selector);var a=new o(s);return t.parentEl&&(a.getEl=function(i){if(n.isObject(i))return e.$(i);var o=t.parentEl;return n.isFunction(o)&&(o=o()),o.find(i)}),a},_buildRegionFromRegionClass:function(t){return new t}}),o.RegionManager=o.Controller.extend({constructor:function(t){this._regions={},o.Controller.call(this,t),this.addRegions(this.getOption("regions"))},addRegions:function(t,e){n.isFunction(t)&&(t=t.apply(this,arguments));var i={};return n.each(t,function(t,o){n.isString(t)&&(t={selector:t}),t.selector&&(t=n.defaults({},t,e));var s=this.addRegion(o,t);i[o]=s},this),i},addRegion:function(t,e){var n;return n=e instanceof o.Region?e:o.Region.buildRegion(e,o.Region),this.triggerMethod("before:add:region",t,n),n._parent=this,this._store(t,n),this.triggerMethod("add:region",t,n),n},get:function(t){return this._regions[t]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(t){var e=this._regions[t];return this._remove(t,e),e},removeRegions:function(){var t=this.getRegions();return n.each(this._regions,function(t,e){this._remove(e,t)},this),t},emptyRegions:function(){var t=this.getRegions();return n.invoke(t,"empty"),t},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(t,e){this._regions[t]=e,this._setLength()},_remove:function(t,e){this.triggerMethod("before:remove:region",t,e),e.empty(),e.stopListening(),delete e._parent,delete this._regions[t],this._setLength(),this.triggerMethod("remove:region",t,e)},_setLength:function(){this.length=n.size(this._regions)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(t){this.templateId=t},n.extend(o.TemplateCache,{templateCaches:{},get:function(t){var e=this.templateCaches[t];return e||(e=new o.TemplateCache(t),this.templateCaches[t]=e),e.load()},clear:function(){var t,e=n.toArray(arguments),i=e.length;if(i>0)for(t=0;i>t;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),n.extend(o.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(t),this.compiledTemplate},loadTemplate:function(t){var n=e.$(t).html();if(!n||0===n.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+t+'"'});return n},compileTemplate:function(t){return n.template(t)}}),o.Renderer={render:function(t,e){if(!t)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var n;return(n="function"==typeof t?t:o.TemplateCache.get(t))(e)}},o.View=e.View.extend({constructor:function(t){n.bindAll(this,"render"),t=n.isFunction(t)?t.call(this):t,this.options=n.extend({},n.result(this,"options"),t),this._behaviors=o.Behaviors(this),e.View.apply(this,arguments),o.MonitorDOMRefresh(this),this.on("show",this.onShowCalled)},getTemplate:function(){return this.getOption("template")},serializeModel:function(t){return t.toJSON.apply(t,n.rest(arguments))},mixinTemplateHelpers:function(t){t=t||{};var e=this.getOption("templateHelpers");return n.isFunction(e)&&(e=e.call(this)),n.extend(t,e)},normalizeUIKeys:function(t){var e=n.result(this,"_uiBindings");return o.normalizeUIKeys(t,e||n.result(this,"ui"))},normalizeUIValues:function(t){var e=n.result(this,"ui"),i=n.result(this,"_uiBindings");return o.normalizeUIValues(t,i||e)},configureTriggers:function(){if(this.triggers){var t=this.normalizeUIKeys(n.result(this,"triggers"));return n.reduce(t,function(t,e,n){return t[n]=this._buildViewTrigger(e),t},{},this)}},delegateEvents:function(t){return this._delegateDOMEvents(t),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(t){t.bindEntityEvents(this.model,t.getOption("modelEvents")),t.bindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(t){var i=t||this.events;n.isFunction(i)&&(i=i.call(this)),i=this.normalizeUIKeys(i),n.isUndefined(t)&&(this.events=i);var o={},s=n.result(this,"behaviorEvents")||{},a=this.configureTriggers(),r=n.result(this,"behaviorTriggers")||{};n.extend(o,s,i,a,r),e.View.prototype.delegateEvents.call(this,o)},undelegateEvents:function(){return e.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(t){t.unbindEntityEvents(this.model,t.getOption("modelEvents")),t.unbindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},onShowCalled:function(){},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(!this.isDestroyed){var t=n.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.unbindUIElements(),this.remove(),n.invoke(this._behaviors,"destroy",t),this}},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(t),function(e){var n=t[e];this.ui[e]=this.$(n)},this)}},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(t){var e=n.isObject(t),i=n.defaults({},e?t:{},{preventDefault:!0,stopPropagation:!0}),o=e?i.event:t;return function(t){t&&(t.preventDefault&&i.preventDefault&&t.preventDefault(),t.stopPropagation&&i.stopPropagation&&t.stopPropagation());var e={view:this,model:this.model,collection:this.collection};this.triggerMethod(o,e)}},setElement:function(){var t=e.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),t},triggerMethod:function(){for(var t=o._triggerMethod,e=t(this,arguments),n=this._behaviors,i=0,s=n&&n.length;s>i;i++)t(n[i],arguments);return e},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var t=this._getImmediateChildren();return t.length?n.reduce(t,function(t,e){return e._getNestedViews?t.concat(e._getNestedViews()):t},t):t},normalizeMethods:o.normalizeMethods,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var t=[this.model||this.collection];return arguments.length&&t.push.apply(t,arguments),this.model?this.serializeModel.apply(this,t):{items:this.serializeCollection.apply(this,t)}},serializeCollection:function(t){return t.toJSON.apply(t,n.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var t=this.getTemplate();if(t!==!1){if(!t)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var e=this.serializeData();e=this.mixinTemplateHelpers(e);var n=o.Renderer.render(t,e,this);return this.attachElContent(n),this}},attachElContent:function(t){return this.$el.html(t),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",constructor:function(t){var e=t||{};n.isUndefined(this.sort)&&(this.sort=n.isUndefined(e.sort)?!0:e.sort),this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this._triggerBeforeShowBufferedChildren(),this.attachBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerBeforeShowBufferedChildren:function(){this._isShown&&n.each(this._bufferedChildren,n.partial(this._triggerMethodOnChild,"before:show"))},_triggerShowBufferedChildren:function(){this._isShown&&(n.each(this._bufferedChildren,n.partial(this._triggerMethodOnChild,"show")),this._bufferedChildren=[])},_triggerMethodOnChild:function(t,e){o.triggerMethodOn(e,t)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(t){this.destroyEmptyView();var e=this.getChildView(t),n=this.collection.indexOf(t);this.addChild(t,e,n)},_onCollectionRemove:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},onShowCalled:function(){this.children.each(n.partial(this._triggerMethodOnChild,"show"))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.triggerMethod("render",this),this},resortView:function(){this.render()},_sortViews:function(){var t=this.collection.find(function(t,e){var n=this.children.findByModel(t);return!n||n._index!==e},this);t&&this.resortView()},_emptyViewIndex:-1,_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren(),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this))},showCollection:function(){var t;this.collection.each(function(e,n){t=this.getChildView(e),this.addChild(e,t,n)},this)},showEmptyView:function(){var t=this.getEmptyView();if(t&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new e.Model;this.addEmptyView(n,t),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(t,e){var i=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(i)&&(i=i.call(this,t,this._emptyViewIndex));var s=this.buildChildView(t,e,i);s._parent=this,this.proxyChildEvents(s),this._isShown&&o.triggerMethodOn(s,"before:show"),this.children.add(s),this.renderChildView(s,this._emptyViewIndex),this._isShown&&o.triggerMethodOn(s,"show")},getChildView:function(){var t=this.getOption("childView");if(!t)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(t,e,i){var o=this.getOption("childViewOptions");n.isFunction(o)&&(o=o.call(this,t,i));var s=this.buildChildView(t,e,o);return this._updateIndices(s,!0,i),this._addChildView(s,i),s._parent=this,s},_updateIndices:function(t,e,n){this.sort&&(e?(t._index=n,this.children.each(function(e){e._index>=t._index&&e._index++})):this.children.each(function(e){e._index>=t._index&&e._index--}))},_addChildView:function(t,e){this.proxyChildEvents(t),this.triggerMethod("before:add:child",t),this.children.add(t),this.renderChildView(t,e),this._isShown&&!this.isBuffering&&o.triggerMethodOn(t,"show"),this.triggerMethod("add:child",t)},renderChildView:function(t,e){return t.render(),this.attachHtml(this,t,e),t},buildChildView:function(t,e,i){var o=n.extend({model:t},i);return new e(o)},removeChildView:function(t){return t&&(this.triggerMethod("before:remove:child",t),t.destroy?t.destroy():t.remove&&t.remove(),delete t._parent,this.stopListening(t),this.children.remove(t),this.triggerMethod("remove:child",t),this._updateIndices(t,!1)),t},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(t,e){t.$el.append(e)},attachHtml:function(t,e,n){t.isBuffering?(t.elBuffer.appendChild(e.el),t._bufferedChildren.push(e)):t._insertBefore(e,n)||t._insertAfter(e)},_insertBefore:function(t,e){var n,i=this.sort&&e<this.children.length-1;return i&&(n=this.children.find(function(t){return t._index===e+1})),n?(n.$el.before(t.el),!0):!1},_insertAfter:function(t){this.$el.append(t.el)},_initChildViewStorage:function(){this.children=new e.ChildViewContainer},destroy:function(){return this.isDestroyed?void 0:(this.triggerMethod("before:destroy:collection"),this.destroyChildren(),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(){var t=this.children.map(n.identity);return this.children.each(this.removeChildView,this),this.checkEmpty(),t},proxyChildEvents:function(t){var e=this.getOption("childViewEventPrefix");this.listenTo(t,"all",function(){var i=n.toArray(arguments),o=i[0],s=this.normalizeMethods(n.result(this,"childEvents"));i[0]=e+":"+o,i.splice(1,0,t),"undefined"!=typeof s&&n.isFunction(s[o])&&s[o].apply(this,i.slice(1)),this.triggerMethod.apply(this,i)},this)},_getImmediateChildren:function(){return n.values(this.children._views)}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(){var t=this.getOption("childView")||this.constructor;return t},serializeData:function(){var t={};return this.model&&(t=n.partial(this.serializeModel,this.model).apply(this,arguments)),t},render:function(){return this._ensureViewIsIntact(),this.isRendered=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this.triggerMethod("render",this),this},_renderChildren:function(){this.isRendered&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t),this.triggerMethod("before:render:template");var e=this.getTemplate(),n=o.Renderer.render(e,t,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(t){return this.$el.html(t),this},attachBuffer:function(t,e){var n=this.getChildViewContainer(t);n.append(e)},_insertAfter:function(t){var e=this.getChildViewContainer(this,t);e.append(t.el)},getChildViewContainer:function(t){if("$childViewContainer"in t)return t.$childViewContainer;var e,i=o.getOption(t,"childViewContainer");if(i){var s=n.isFunction(i)?i.call(t):i;if(e="@"===s.charAt(0)&&t.ui?t.ui[s.substr(4)]:t.$(s),e.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+t.childViewContainer})}else e=t.$el;return t.$childViewContainer=e,e},resetChildViewContainer:function(){this.$childViewContainer&&delete this.$childViewContainer}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,constructor:function(t){t=t||{},this._firstRender=!0,this._initializeRegions(t),o.ItemView.call(this,t)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},addRegion:function(t,e){var n={};return n[t]=e,this._buildRegions(n)[t]},addRegions:function(t){return this.regions=n.extend({},this.regions,t),this._buildRegions(t)},removeRegion:function(t){return delete this.regions[t],this.regionManager.removeRegion(t)},getRegion:function(t){return this.regionManager.get(t)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(t){var e={regionClass:this.getOption("regionClass"),parentEl:n.partial(n.result,this,"$el")};return this.regionManager.addRegions(t,e)},_initializeRegions:function(t){var e;this._initRegionManager(),e=n.isFunction(this.regions)?this.regions(t):this.regions||{};var i=this.getOption.call(t,"regions");n.isFunction(i)&&(i=i.call(this,t)),n.extend(e,i),e=this.normalizeUIValues(e),this.addRegions(e)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(t){this.triggerMethod("before:add:region",t)}),this.listenTo(this.regionManager,"add:region",function(t,e){this[t]=e,this.triggerMethod("add:region",t,e)}),this.listenTo(this.regionManager,"before:remove:region",function(t){this.triggerMethod("before:remove:region",t)}),this.listenTo(this.regionManager,"remove:region",function(t,e){delete this[t],this.triggerMethod("remove:region",t,e)})},_getImmediateChildren:function(){return n.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(t,e){this.view=e,this.defaults=n.result(this,"defaults")||{},this.options=n.extend({},this.defaults,t),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){this.stopListening()},proxyViewProperties:function(t){this.$el=t.$el,this.el=t.el}}),o.Behaviors=function(t,e){function n(t,i){return e.isObject(t.behaviors)?(i=n.parseBehaviors(t,i||e.result(t,"behaviors")),n.wrap(t,i,e.keys(o)),i):{}}function i(t,n){this._view=t,this._viewUI=e.result(t,"ui"),this._behaviors=n,this._triggers={}}var o={behaviorTriggers:function(t,e){var n=new i(this,e);return n.buildBehaviorTriggers()},behaviorEvents:function(n,i){var o={},s=e.result(this,"ui");return e.each(i,function(n,i){var a={},r=e.clone(e.result(n,"events"))||{},l=e.result(n,"ui"),c=e.extend({},s,l);r=t.normalizeUIKeys(r,c),e.each(e.keys(r),function(t){var o=new Array(i+2).join(" "),s=t+o,l=e.isFunction(r[t])?r[t]:n[r[t]];a[s]=e.bind(l,n)}),o=e.extend(o,a)}),o}};return e.extend(n,{behaviorsLookup:function(){throw new t.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,i){return t.behaviorClass?t.behaviorClass:e.isFunction(n.behaviorsLookup)?n.behaviorsLookup.apply(this,arguments)[i]:n.behaviorsLookup[i]},parseBehaviors:function(t,i){return e.chain(i).map(function(i,o){var s=n.getBehaviorClass(i,o),a=new s(i,t),r=n.parseBehaviors(t,e.result(a,"behaviors"));return[a].concat(r)}).flatten().value()},wrap:function(t,n,i){e.each(i,function(i){t[i]=e.partial(o[i],t[i],n)})}}),e.extend(i.prototype,{buildBehaviorTriggers:function(){return e.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,i){var o=e.extend({},this._viewUI,e.result(n,"ui")),s=e.clone(e.result(n,"triggers"))||{};s=t.normalizeUIKeys(s,o),e.each(s,e.partial(this._setHandlerForBehavior,n,i),this)},_setHandlerForBehavior:function(t,e,n,i){var o=i.replace(/^\S+/,function(t){return t+".behaviortriggers"+e});this._triggers[o]=this._view._buildViewTrigger(n)}}),n}(o,n),o.AppRouter=e.Router.extend({constructor:function(t){this.options=t||{},e.Router.apply(this,arguments);var n=this.getOption("appRoutes"),i=this._getController();this.processAppRoutes(i,n),this.on("route",this._processOnRoute,this)},appRoute:function(t,e){var n=this._getController();this._addAppRoute(n,t,e)},_processOnRoute:function(t,e){if(n.isFunction(this.onRoute)){var i=n.invert(this.getOption("appRoutes"))[t];this.onRoute(t,i,e)}},processAppRoutes:function(t,e){if(e){var i=n.keys(e).reverse();
n.each(i,function(n){this._addAppRoute(t,n,e[n])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(t,e,i){var s=t[i];if(!s)throw new o.Error('Method "'+i+'" was not found on the controller');this.route(e,i,n.bind(s,t))},getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(t){this._initializeRegions(t),this._initCallbacks=new o.Callbacks,this.submodules={},n.extend(this,t),this._initChannel(),o.Object.call(this,t)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(t){this._initCallbacks.add(t)},start:function(t){this.triggerMethod("before:start",t),this._initCallbacks.run(t,this),this.triggerMethod("start",t)},addRegions:function(t){return this._regionManager.addRegions(t)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(t){return this._regionManager.removeRegion(t)},getRegion:function(t){return this._regionManager.get(t)},getRegions:function(){return this._regionManager.getRegions()},module:function(t,e){var i=o.Module.getClass(e),s=n.toArray(arguments);return s.unshift(this),i.create.apply(i,s)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(t){var e=n.isFunction(this.regions)?this.regions(t):this.regions||{};this._initRegionManager();var i=o.getOption(t,"regions");return n.isFunction(i)&&(i=i.call(this,t)),n.extend(e,i),this.addRegions(e),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(t,e){this[t]=e,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(t){delete this[t],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||e.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres}}),o.Module=function(t,e,i){this.moduleName=t,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,n.isFunction(this.initialize)&&this.initialize(t,e,this.options)},o.Module.extend=o.extend,n.extend(o.Module.prototype,e.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(n.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),n.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(t,i){if(t){var s=n.flatten([this,this.app,e,o,e.$,n,i]);t.apply(this,s)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),n.extend(o.Module,{create:function(t,e,i){var o=t,s=n.rest(arguments,3);e=e.split(".");var a=e.length,r=[];return r[a-1]=i,n.each(e,function(e,n){var a=o;o=this._getModule(a,e,t,i),this._addModuleDefinition(a,o,r[n],s)},this),o},_getModule:function(t,e,i,o){var s=n.extend({},o),a=this.getClass(o),r=t[e];return r||(r=new a(e,i,s),t[e]=r,t.submodules[e]=r),r},getClass:function(t){var e=o.Module;return t?t.prototype instanceof e?t:t.moduleClass||e:e},_addModuleDefinition:function(t,e,n,i){var o=this._getDefine(n),s=this._getStartWithParent(n,e);o&&e.addDefinition(o,i),this._addStartWithParent(t,e,s)},_getStartWithParent:function(t,e){var i;return n.isFunction(t)&&t.prototype instanceof o.Module?(i=e.constructor.prototype.startWithParent,n.isUndefined(i)?!0:i):n.isObject(t)?(i=t.startWithParent,n.isUndefined(i)?!0:i):!0},_getDefine:function(t){return!n.isFunction(t)||t.prototype instanceof o.Module?n.isObject(t)?t.define:null:t},_addStartWithParent:function(t,e,n){e.startWithParent=e.startWithParent&&n,e.startWithParent&&!e.startWithParentIsConfigured&&(e.startWithParentIsConfigured=!0,t.addInitializer(function(t){e.startWithParent&&e.start(t)}))}}),o}),function(t,e){"object"==typeof module&&module.exports&&"function"==typeof require?module.exports=e():"function"==typeof define&&"object"==typeof define.amd?define("loglevel",e):t.log=e()}(this,function(){function t(t){return typeof console===l?!1:void 0!==console[t]?e(console,t):void 0!==console.log?e(console,"log"):r}function e(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(i){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function n(t,e){return function(){typeof console!==l&&(i(e),a[t].apply(a,arguments))}}function i(t){for(var e=0;e<c.length;e++){var n=c[e];a[n]=t>e?r:a.methodFactory(n,t)}}function o(t){var e=(c[t]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=e)}catch(n){}try{window.document.cookie="loglevel="+e+";"}catch(n){}}function s(){var t;try{t=window.localStorage.loglevel}catch(e){}if(typeof t===l)try{t=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(e){}void 0===a.levels[t]&&(t="WARN"),a.setLevel(a.levels[t])}var a={},r=function(){},l="undefined",c=["trace","debug","info","warn","error"];a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=function(e,i){return t(e)||n(e,i)},a.setLevel=function(t){if("string"==typeof t&&void 0!==a.levels[t.toUpperCase()]&&(t=a.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;return o(t),i(t),typeof console===l&&t<a.levels.SILENT?"No console available for logging":void 0},a.enableAll=function(){a.setLevel(a.levels.TRACE)},a.disableAll=function(){a.setLevel(a.levels.SILENT)};var u=typeof window!==l?window.log:void 0;return a.noConflict=function(){return typeof window!==l&&window.log===a&&(window.log=u),a},s(),a}),!function(t,e){if("function"==typeof define&&define.amd)define("syphon",["underscore","backbone","jquery"],function(t,n,i){return e(t,n,i)});else if("undefined"!=typeof exports){var n=require("underscore"),i=require("backbone"),o=require("jquery");module.exports=e(n,i,o)}else e(t._,t.Backbone,t.jQuery)}(this,function(t,e,n){"use strict";var i=e.Syphon,o=e.Syphon={};o.VERSION="0.5.0",o.noConflict=function(){return e.Syphon=i,this},o.ignoredTypes=["button","submit","reset","fieldset"],o.serialize=function(e,i){var o={},r=l(i),u=s(e,r);return t.each(u,function(t){var e=n(t),i=a(e),s=r.keyExtractors.get(i),l=s(e),u=r.inputReaders.get(i),d=u(e),h=r.keyAssignmentValidators.get(i);if(h(e,l,d)){var p=r.keySplitter(l);o=c(o,p,d)}}),o},o.deserialize=function(e,i,o){var r=l(o),c=s(e,r),d=u(r,i);t.each(c,function(t){var e=n(t),i=a(e),o=r.keyExtractors.get(i),s=o(e),l=r.inputWriters.get(i),c=d[s];l(e,c)})};var s=function(e,i){var o=r(e),s=o.elements;return s=t.reject(s,function(e){var o,s=a(e),r=i.keyExtractors.get(s),l=r(n(e)),c=t.include(i.ignoredTypes,s),u=t.include(i.include,l),d=t.include(i.exclude,l);return o=u?!1:i.include?!0:d||c})},a=function(t){var e,i=n(t),o=i[0].tagName,s=o;return"input"===o.toLowerCase()&&(e=i.attr("type"),s=e?e:"text"),s.toLowerCase()},r=function(e){return t.isUndefined(e.$el)&&"form"===e.tagName.toLowerCase()?e:e.$el.is("form")?e.el:e.$("form")[0]},l=function(e){var n=t.clone(e)||{};return n.ignoredTypes=t.clone(o.ignoredTypes),n.inputReaders=n.inputReaders||o.InputReaders,n.inputWriters=n.inputWriters||o.InputWriters,n.keyExtractors=n.keyExtractors||o.KeyExtractors,n.keySplitter=n.keySplitter||o.KeySplitter,n.keyJoiner=n.keyJoiner||o.KeyJoiner,n.keyAssignmentValidators=n.keyAssignmentValidators||o.KeyAssignmentValidators,n},c=function(e,n,i){if(!n)return e;var o=n.shift();return e[o]||(e[o]=t.isArray(o)?[]:{}),0===n.length&&(t.isArray(e[o])?e[o].push(i):e[o]=i),n.length>0&&c(e[o],n,i),e},u=function(e,n,i){var o={};return t.each(n,function(n,s){var a={};i&&(s=e.keyJoiner(i,s)),t.isArray(n)?(s+="[]",a[s]=n):t.isObject(n)?a=u(e,n,s):a[s]=n,t.extend(o,a)}),o},d=o.TypeRegistry=function(){this.registeredTypes={}};d.extend=e.Model.extend,t.extend(d.prototype,{get:function(t){return this.registeredTypes[t]||this.registeredTypes["default"]},register:function(t,e){this.registeredTypes[t]=e},registerDefault:function(t){this.registeredTypes["default"]=t},unregister:function(t){this.registeredTypes[t]&&delete this.registeredTypes[t]}});var h=o.KeyExtractorSet=d.extend(),p=o.KeyExtractors=new h;p.registerDefault(function(t){return t.prop("name")||""});var f=o.InputReaderSet=d.extend(),g=o.InputReaders=new f;g.registerDefault(function(t){return t.val()}),g.register("checkbox",function(t){return t.prop("checked")});var m=o.InputWriterSet=d.extend(),v=o.InputWriters=new m;v.registerDefault(function(t,e){t.val(e)}),v.register("checkbox",function(t,e){t.prop("checked",e)}),v.register("radio",function(t,e){t.prop("checked",t.val()===e.toString())});var b=o.KeyAssignmentValidatorSet=d.extend(),y=o.KeyAssignmentValidators=new b;return y.registerDefault(function(){return!0}),y.register("radio",function(t){return t.prop("checked")}),o.KeySplitter=function(t){var e,n=t.match(/[^\[\]]+/g);return t.indexOf("[]")===t.length-2&&(e=n.pop(),n.push([e])),n},o.KeyJoiner=function(t,e){return t+"["+e+"]"},e.Syphon}),define("app",["marionette","loglevel","syphon"],function(t,e){window.log=e,e.setLevel("silent");var n=new t.Application;return n.addRegions({main:"#page-content",sidebar:"#sidebar_panel",header:"#header_panel",modal:"#modal"}),n.on("start",function(){Backbone.history&&Backbone.history.start({})}),t.Behaviors.behaviorsLookup=function(){return n.module("Behaviors")},Backbone.Syphon.InputReaders.register("number",function(t){return parseInt(t.val(),10)}),n}),define("common/server",["../app","jquery"],function(t,e){"use strict";return t.module("Server",function(n){function i(){if("undefined"==typeof localStorage||!localStorage.hasOwnProperty("navizon"))return!1;var t=JSON.parse(localStorage.navizon);return t.hasOwnProperty("username")&&t.hasOwnProperty("password")?(n.setCredentials(t.username,t.password,t.siteId,!1),!0):!1}function o(){"undefined"!=typeof localStorage&&(localStorage.navizon=JSON.stringify({username:n.getUsername(),password:n.getPassword(),siteId:n.getSiteId()}))}function s(t){if("undefined"!=typeof localStorage){var e={};localStorage.navizon&&(e=JSON.parse(localStorage.navizon)),e.siteId=t,localStorage.navizon=JSON.stringify(e)}}function a(){"undefined"!=typeof localStorage&&delete localStorage.navizon}function r(){p=null;var t=h.get(d.get("siteId")),e=null!=t?t.get("address"):"";e.length>0&&(new google.maps.Geocoder).geocode({address:e},function(t,e){e==google.maps.GeocoderStatus.OK&&(p=t[0].geometry.location)})}log.debug("ServerConnection created");var l="https://its.navizon.com/api/v1",c="https://navimote2.navizon.com/api/v1",u="https://its.navizon.com:8443/api/v1";n.LoginInfo=Backbone.Model.extend({defaults:{username:null,password:null,loggedIn:!1,siteId:null}}),n.SiteModel=Backbone.Model.extend({idAttribute:"siteId",defaults:{name:"",desc:"",address:"",access:10},url:function(){return n.getResourceUrl("/sites/")+this.get("siteId")+"/"}}),n.SiteCollection=Backbone.Collection.extend({model:n.SiteModel,comparator:"siteId",url:function(){return n.getBaseUrl()+"/sites/"}});var d=new n.LoginInfo,h=new n.SiteCollection,p=null;n.addInitializer(function(){log.debug("Server.addInitializer running"),i()}),n.setCredentials=function(n,i,s,a){log.debug("ServerConnection.setCredentials"),e.ajaxSetup({beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+btoa(n+":"+i))}}),h.fetch({reset:!0,success:function(){log.debug("sites success"),s=h.get(s)?s:h.first().id,d.set({username:n,password:i,siteId:s,loggedIn:!0}),a&&o(),r(),t.vent.trigger("login:success")},error:function(){log.debug("sites error"),t.vent.trigger("login:error")}})},n.isLoggedIn=function(){return d.get("loggedIn")},n.isSuperuser=function(t){var e,n=h.get(t);return n&&(e=n.get("access")),e&&"superuser"===e},n.logout=function(){d.clear({silent:!0}).set(d.defaults),a(),t.vent.trigger("logout")},n.getLoginInfo=function(){return d},n.getBaseUrl=function(){return l},n.setSiteId=function(t){d.set("siteId",t),s(t),r()},n.getSiteId=function(){return d.get("siteId")},n.getUsername=function(){return d.get("username")},n.getPassword=function(){return d.get("password")},n.getResourceUrl=function(t){return l+"/sites/"+d.get("siteId")+t},n.getSiteLatLng=function(){return p},n.Navimote={},n.Navimote.getBaseUrl=function(){return c},n.Navimote.getResourceUrl=function(t){return c+"/sites/"+d.get("siteId")+t},n.CvTrack={},n.CvTrack.getBaseUrl=function(){return u},n.CvTrack.getResourceUrl=function(t){return u+"/sites/"+d.get("siteId")+t}})}),define("text",["module"],function(t){"use strict";var e,n,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a="undefined"!=typeof location&&location.href,r=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||void 0),u=[],d=t.config&&t.config()||{};return e={version:"2.0.3",strip:function(t){if(t){t=t.replace(o,"");var e=t.match(s);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){n=i[e];try{t=new ActiveXObject(n)}catch(o){}if(t){i=[n];break}}return t},parseName:function(t){var e=!1,n=t.indexOf("."),i=t.substring(0,n),o=t.substring(n+1,t.length);return n=o.indexOf("!"),-1!==n&&(e=o.substring(n+1,o.length),e="strip"===e,o=o.substring(0,n)),{moduleName:i,ext:o,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,n,i,o){var s,a,r,l=e.xdRegExp.exec(t);return l?(s=l[2],a=l[3],a=a.split(":"),r=a[1],a=a[0],!(s&&s!==n||a&&a.toLowerCase()!==i.toLowerCase()||(r||a)&&r!==o)):!0},finishLoad:function(t,n,i,o){i=n?e.strip(i):i,d.isBuild&&(u[t]=i),o(i)},load:function(t,n,i,o){if(o.isBuild&&!o.inlineText)return void i();d.isBuild=o.isBuild;var s=e.parseName(t),u=s.moduleName+"."+s.ext,h=n.toUrl(u),p=d.useXhr||e.useXhr;!a||p(h,r,l,c)?e.get(h,function(n){e.finishLoad(t,s.strip,n,i)},function(t){i.error&&i.error(t)}):n([u],function(t){e.finishLoad(s.moduleName+"."+s.ext,s.strip,t,i)})},write:function(t,n,i){if(u.hasOwnProperty(n)){var o=e.jsEscape(u[n]);i.asModule(t+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(t,n,i,o,s){var a=e.parseName(n),r=a.moduleName+"."+a.ext,l=i.toUrl(a.moduleName+"."+a.ext)+".js";e.load(r,i,function(){var n=function(t){return o(l,t)};n.asModule=function(t,e){return o.asModule(t,l,e)},e.write(t,r,n,s)},s)}},"node"===d.env||!d.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(n=require.nodeRequire("fs"),e.get=function(t,e){var i=n.readFileSync(t,"utf8");0===i.indexOf("﻿")&&(i=i.substring(1)),e(i)}):"xhr"===d.env||!d.env&&e.createXhr()?e.get=function(t,n,i){var o=e.createXhr();o.open("GET",t,!0),d.onXhr&&d.onXhr(o,t),o.onreadystatechange=function(){var e,s;4===o.readyState&&(e=o.status,e>399&&600>e?(s=new Error(t+" HTTP status: "+e),s.xhr=o,i(s)):n(o.responseText))},o.send(null)}:("rhino"===d.env||!d.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(e.get=function(t,e){var n,i,o="utf-8",s=new java.io.File(t),a=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),o)),l="";try{for(n=new java.lang.StringBuffer,i=r.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),n.append(i);null!==(i=r.readLine());)n.append(a),n.append(i);l=String(n.toString())}finally{r.close()}e(l)}),e}),define("text!general/login/login_template.html",[],function(){return'<div class="row">\n    <div class="col-lg-6">\n\n        <div class="block full">\n\n            <div class="block-title">\n                <h2><strong>Accuware</strong> credentials</h2>\n            </div>\n\n            <form class="form-horizontal form-bordered form-control-borderless" novalidate="novalidate">\n\n                <!--Username-->\n                <div class="form-group">\n                    <div class="input-group">\n                        <span class="input-group-addon"><i class="gi gi-envelope"></i></span>\n                        <input type="text" name="username" class="form-control input-lg" placeholder="Email">\n                    </div>\n                </div>\n\n                <!--Password-->\n                <div class="form-group">\n                    <div class="input-group">\n                        <span class="input-group-addon"><i class="gi gi-asterisk"></i></span>\n                        <input type="password" name="password" class="form-control input-lg" placeholder="Password">\n                    </div>\n                </div>\n\n                <!--Buttons -->\n                <div class="form-group form-actions">\n                    <div class="col-xs-6">\n                        <label class="switch switch-primary" data-toggle="tooltip" title="" data-original-title="Remember Me?">\n                            <input type="checkbox" name="save" checked="">\n                            <span></span>\n                        </label>\n                        <span class="help-block">Remember Me</span>\n                    </div>\n\n                    <div class="col-xs-6 text-right">\n                        <button id="login-button" class="btn btn-primary"><i class="fa fa-angle-right"></i> Login to Dashboard</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>'}),!function(t,e){"use strict";"function"==typeof define&&define.amd?define("bootbox",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.bootbox=e(t.jQuery)}(this,function e(t,n){"use strict";function i(t){var e=m[f.locale];return e?e[t]:m.en[t]}function o(e,n,i){e.stopPropagation(),e.preventDefault();var o=t.isFunction(i)&&i(e)===!1;o||n.modal("hide")}function s(t){var e,n=0;for(e in t)n++;return n}function a(e,n){var i=0;t.each(e,function(t,e){n(t,e,i++)})}function r(e){var n,i;if("object"!=typeof e)throw new Error("Please supply an object of options");if(!e.message)throw new Error("Please specify a message");return e=t.extend({},f,e),e.buttons||(e.buttons={}),e.backdrop=e.backdrop?"static":!1,n=e.buttons,i=s(n),a(n,function(e,o,s){if(t.isFunction(o)&&(o=n[e]={callback:o}),"object"!==t.type(o))throw new Error("button with key "+e+" must be an object");o.label||(o.label=e),o.className||(o.className=2>=i&&s===i-1?"btn-primary":"btn-default")}),e}function l(t,e){var n=t.length,i={};if(1>n||n>2)throw new Error("Invalid argument length");return 2===n||"string"==typeof t[0]?(i[e[0]]=t[0],i[e[1]]=t[1]):i=t[0],i}function c(e,n,i){return t.extend(!0,{},e,l(n,i))}function u(t,e,n,i){var o={className:"bootbox-"+t,buttons:d.apply(null,e)};return h(c(o,i,n),e)}function d(){for(var t={},e=0,n=arguments.length;n>e;e++){var o=arguments[e],s=o.toLowerCase(),a=o.toUpperCase();t[s]={label:i(a)}}return t}function h(t,e){var i={};return a(e,function(t,e){i[e]=!0}),a(t.buttons,function(t){if(i[t]===n)throw new Error("button key "+t+" is not allowed (options are "+e.join("\n")+")")}),t}var p={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},f={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0,container:"body"},g={};g.alert=function(){var e;if(e=u("alert",["ok"],["message","callback"],arguments),e.callback&&!t.isFunction(e.callback))throw new Error("alert requires callback property to be a function when provided");return e.buttons.ok.callback=e.onEscape=function(){return t.isFunction(e.callback)?e.callback():!0},g.dialog(e)},g.confirm=function(){var e;if(e=u("confirm",["cancel","confirm"],["message","callback"],arguments),e.buttons.cancel.callback=e.onEscape=function(){return e.callback(!1)},e.buttons.confirm.callback=function(){return e.callback(!0)},!t.isFunction(e.callback))throw new Error("confirm requires a callback");return g.dialog(e)},g.prompt=function(){var e,i,o,s,r,l,u;if(s=t(p.form),i={className:"bootbox-prompt",buttons:d("cancel","confirm"),value:"",inputType:"text"},e=h(c(i,arguments,["title","callback"]),["cancel","confirm"]),l=e.show===n?!0:e.show,e.message=s,e.buttons.cancel.callback=e.onEscape=function(){return e.callback(null)},e.buttons.confirm.callback=function(){var n;switch(e.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":n=r.val();break;case"checkbox":var i=r.find("input:checked");n=[],a(i,function(e,i){n.push(t(i).val())})}return e.callback(n)},e.show=!1,!e.title)throw new Error("prompt requires a title");if(!t.isFunction(e.callback))throw new Error("prompt requires a callback");if(!p.inputs[e.inputType])throw new Error("invalid prompt type");switch(r=t(p.inputs[e.inputType]),e.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":r.val(e.value);break;case"select":var f={};if(u=e.inputOptions||[],!u.length)throw new Error("prompt with select requires options");a(u,function(e,i){var o=r;if(i.value===n||i.text===n)throw new Error("given options in wrong format");i.group&&(f[i.group]||(f[i.group]=t("<optgroup/>").attr("label",i.group)),o=f[i.group]),o.append("<option value='"+i.value+"'>"+i.text+"</option>")}),a(f,function(t,e){r.append(e)}),r.val(e.value);break;case"checkbox":var m=t.isArray(e.value)?e.value:[e.value];if(u=e.inputOptions||[],!u.length)throw new Error("prompt with checkbox requires options");if(!u[0].value||!u[0].text)throw new Error("given options in wrong format");r=t("<div/>"),a(u,function(n,i){var o=t(p.inputs[e.inputType]);o.find("input").attr("value",i.value),o.find("label").append(i.text),a(m,function(t,e){e===i.value&&o.find("input").prop("checked",!0)}),r.append(o)})}return e.placeholder&&r.attr("placeholder",e.placeholder),e.pattern&&r.attr("pattern",e.pattern),s.append(r),s.on("submit",function(t){t.preventDefault(),t.stopPropagation(),o.find(".btn-primary").click()}),o=g.dialog(e),o.off("shown.bs.modal"),o.on("shown.bs.modal",function(){r.focus()}),l===!0&&o.modal("show"),o},g.dialog=function(e){e=r(e);var n=t(p.dialog),i=n.find(".modal-dialog"),s=n.find(".modal-body"),l=e.buttons,c="",u={onEscape:e.onEscape};if(a(l,function(t,e){c+="<button data-bb-handler='"+t+"' type='button' class='btn "+e.className+"'>"+e.label+"</button>",u[t]=e.callback}),s.find(".bootbox-body").html(e.message),e.animate===!0&&n.addClass("fade"),e.className&&n.addClass(e.className),"large"===e.size&&i.addClass("modal-lg"),"small"===e.size&&i.addClass("modal-sm"),e.title&&s.before(p.header),e.closeButton){var d=t(p.closeButton);e.title?n.find(".modal-header").prepend(d):d.css("margin-top","-10px").prependTo(s)}return e.title&&n.find(".modal-title").html(e.title),c.length&&(s.after(p.footer),n.find(".modal-footer").html(c)),n.on("hidden.bs.modal",function(t){t.target===this&&n.remove()}),n.on("shown.bs.modal",function(){n.find(".btn-primary:first").focus()}),n.on("escape.close.bb",function(t){u.onEscape&&o(t,n,u.onEscape)}),n.on("click",".modal-footer button",function(e){var i=t(this).data("bb-handler");o(e,n,u[i])}),n.on("click",".bootbox-close-button",function(t){o(t,n,u.onEscape)}),n.on("keyup",function(t){27===t.which&&n.trigger("escape.close.bb")}),t(e.container).append(n),n.modal({backdrop:e.backdrop,keyboard:!1,show:!1}),e.show&&n.modal("show"),n},g.setDefaults=function(){var e={};2===arguments.length?e[arguments[0]]=arguments[1]:e=arguments[0],t.extend(f,e)},g.hideAll=function(){return t(".bootbox").modal("hide"),g};var m={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zrušit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"Εντάξει",CANCEL:"Ακύρωση",CONFIRM:"Επιβεβαίωση"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"אישור",CANCEL:"ביטול",CONFIRM:"אישור"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"キャンセル",CONFIRM:"確認"},lt:{OK:"Gerai",CANCEL:"Atšaukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprināt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},tr:{OK:"Tamam",CANCEL:"İptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return g.init=function(n){return e(n||t)},g}),define("general/login/login_controller",["app","common/server","text!general/login/login_template.html","bootbox","syphon"],function(t,e,n,i){return t.module("General.Login",function(t,o,s,a,r,l){log.info("Login controller instantiated"),t.Controller={show:function(t){function r(){var t=s.Syphon.serialize(h);e.setCredentials(t.username,t.password,null,t.save)}function c(){t||(t="general/sites"),s.history.navigate(t,{trigger:!0})}function u(){i.alert("Login error")}var d=a.ItemView.extend({template:l.template(n),triggers:{"click #login-button":"login"}}),h=new d;o.main.show(h),h.on("login",r),o.vent.on("login:success",c),o.vent.on("login:error",u)}}})}),define("util",[],function(){"use strict";function t(t,e){return null!=t&&t.hasOwnProperty(e)&&null!=t[e]?t[e]:null}function e(t,e){"text"===t.attr("type")?t.val(e):t.text(e)}function n(t){return"text"===t.attr("type")?t.val():t.text()}function i(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):t}function o(t){var e,n,i,o;return 0>t&&(t=0),e=Math.floor(t/864e5),t-=24*e*60*60*1e3,n=Math.floor(t/36e5),t-=60*n*60*1e3,i=Math.floor(t/6e4),t-=60*i*1e3,o=Math.floor(t/1e3),e>1?e+" days ago":e>0?e+" day ago":n>0?n+"h "+i+"m ago":i>0?i+"m "+o+"s ago":o+"s ago"}function s(t){var e,n,i;return 0>t&&(t=0),e=Math.floor(t/864e5),t-=24*e*60*60*1e3,n=Math.floor(t/36e5),t-=60*n*60*1e3,i=Math.floor(t/6e4),t-=60*i*1e3,e>1?e+" days":e>0?"1 day and "+n+" hours":n>0?n+" hours":i>0?i+" minutes":"less than a minute"}function a(t){var e=t.aData[t.iDataColumn];return e==Number.POSITIVE_INFINITY?"N/A":o(1e3*e)}function r(){var t,e=(new Date).toString();return t=e.indexOf("GMT"),-1!=t&&(e=e.substring(0,t-1)),e}function l(t,e){var n,i=new google.maps.LatLngBounds;for(n in e)e[n].loc&&null!=e[n].loc.lat&&null!=e[n].loc.lng&&i.extend(new google.maps.LatLng(e[n].loc.lat,e[n].loc.lng));return i.isEmpty()?!1:(t.setCenter(i.getCenter()),t.fitBounds(i),!0)}function c(t){var e;return t&&0!==t.length?("u"===t[0]||"U"===t[0]||"w"===t[0]||"W"===t[0]?(D.lastIndex=0,e=D.exec(t)):(T.lastIndex=0,e=T.exec(t)),null===e||0!==e.index?null:t.replace(/\.|:|\-/g,"").toUpperCase()):null}function u(t,e){var n=c(t),i=e||":";return null!=n&&(n=n[0]+n[1]+i+n[2]+n[3]+i+n[4]+n[5]+i+n[6]+n[7]+i+n[8]+n[9]+i+n[10]+n[11]),n}function d(t){return t&&t.length>0&&h(t)?t:null}function h(t){if(0==t.length)return!0;var e=0,n=/^(com|net|org|edu|int|mil|gov|arpa|biz|aero|name|coop|info|pro|museum)$/,i=/^(.+)@(.+)$/,o='\\(\\)><@,;:\\\\\\"\\.\\[\\]',s="[^\\s"+o+"]",a='("[^"]*")',r=/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/,l=s+"+",c="("+l+"|"+a+")",u=new RegExp("^"+c+"(\\."+c+")*$"),d=(new RegExp("^"+l+"(\\."+l+")*$"),t.match(i));if(null==d)return!1;var h=d[1],p=d[2];for(g=0;g<h.length;g++)if(h.charCodeAt(g)>127)return!1;for(g=0;g<p.length;g++)if(p.charCodeAt(g)>127)return!1;if(null==h.match(u))return!1;var f=p.match(r);if(null!=f){for(var g=1;4>=g;g++)if(f[g]>255)return!1;return!0}var m=new RegExp("^"+l+"$"),v=p.split("."),b=v.length;for(g=0;b>g;g++)if(-1==v[g].search(m))return!1;return e&&2!=v[v.length-1].length&&-1==v[v.length-1].search(n)?!1:2>b?!1:!0}function p(t){var e,n;return""===t?t:(e=new RegExp(/^[+-]?\d{1,6}(\.\d{1,2})?$/gi),n=e.exec(t),null==n||0!=n.index?null:t)}function f(t,e){return t.lat().toFixed(6)==e.lat().toFixed(6)&&t.lng().toFixed(6)==e.lng().toFixed(6)?0:1}function g(e,n){var i,o,s,a={};if(e&&e.length&&e.length>0)for(s=e.length,i=0;s>i;i++)o=t(e[i],n),null!=o&&(a[o]=e[i]);return a}function m(t,e){$(t).removeClass("ajax_success").addClass("ajax_error").text(e).show()}function v(t,e){$(t).addClass("ajax_success").removeClass("ajax_error").text(e).show()}function b(t){var e,n=[],i={},o=[],s=t.length;for(e=0;s>e;e++)n[e]=t[e].levelId,i[n[e]]=t[e];for(n.sort(),e=0;s>e;e++)o.push(i[n[e]]);return o}function y(e,n){var i,o,s,a,r=e.length,l=[];for(a=n?b(e):e,i=0;r>i;i++)o=a[i],s=void 0!=t(o,"fpCount")&&t(o,"fpCount")>=0?sprintf("L%d, %s, %d fps",o.levelId,t(o,"name"),t(o,"fpCount")):sprintf("L%d, %s",o.levelId,t(o,"name")),l.push('<option value="'+o.levelId+'">'+s+"</option>");return l.join("")}function w(e){var n=t(e,"levelId"),i=t(e,"name");return null==n&&null==i?"N/A":i?i:"Level "+n}function x(t){var e=t,n=null;return _.has(e,"position")&&!_.isEmpty(e.position)&&(n=e.position),{levelId:n?n.levelId:null,lat:n?n.lat:null,lng:n?n.lng:null,prec:n?n.precision:null,source:n?n.source:null,fixed_at:n?n.fixed_at:0/0}}function C(t){var e,n=_.clone(t);
return _.each(_.keys(n),function(t){e=n[t],(_.isNull(e)||_.isUndefined(e)||_.isNaN(e)||""===e)&&delete n[t]}),n}function S(t,e){this._jqEl=t,this._defSuccessMsg=e?e:null}var T=new RegExp(/^([0-9a-f]{2}([:-]|$)){6}$|([0-9a-f]{4}([.]|$)){3}$|([0-9a-f]{12}$)/gi),D=new RegExp(/^([0-9a-z]{2}([:-]|$)){6}$|([0-9a-z]{4}([.]|$)){3}$|([0-9a-z]{12}$)/gi);return S.prototype.start=function(){this._jqEl.find("img").show(),this._jqEl.find("span").hide()},S.prototype.stop=function(){this._jqEl.find("img").hide()},S.prototype.stopError=function(t){this._jqEl.find("img").hide(),this._jqEl.find("span").removeClass("ajax_success").addClass("ajax_error").text(t).show()},S.prototype.stopSuccess=function(t){var e;e=t?t:this._defSuccessMsg?this._defSuccessMsg:"",this._jqEl.find("img").hide(),this._jqEl.find("span").addClass("ajax_success").removeClass("ajax_error").text(e).show()},S.prototype.clear=function(){this._jqEl.find("span").hide()},{getProperty:t,setValue:e,getValue:n,escapeHtml:i,formatTime:o,formatTimeApprox:s,lastSeenDataTableRender:a,getCurrentTimeString:r,repositionMap:l,validateMac:c,validateEmail:d,formatMac:u,validateAlt:p,compareLatLng:f,arrayToMap:g,errorMsg:m,successMsg:v,sortLevels:b,getLevelsAsHtmlOptions:y,getLevelDesc:w,resolveNavimotePosition:x,AjaxSpinner:S,removeEmptyAttrs:C}}),define("common/entities",["app","common/server","util"],function(t,e,n){return t.module("Entities",function(t,i,o,s,a,r){t.ItsModel=o.Model.extend({saveAttr:[],sync:function(t,e,n){return("create"===t||"update"===t)&&(n.method="PUT",n.emulateJSON=!0,n.data=a.param(e.pick(this.saveAttr))),o.sync.apply(this,[t,e,n])}}),t.SiteModel=t.ItsModel.extend({idAttribute:"siteId",defaults:{name:"",desc:"",address:"",access:10},saveAttr:["name","desc","address"],url:function(){return e.getResourceUrl("/")}}),t.SiteCollection=o.Collection.extend({model:t.SiteModel,url:function(){return e.getBaseUrl()+"/sites/"}}),t.SiteSettingModel=t.ItsModel.extend({idAttribute:"siteId",defaults:{tags:"",posFilter:"none",reportPeriod:5e3,nodeType:"OM2P",rssModel:"auto"},saveAttr:["posFilter","rssModel"],url:function(){return e.getResourceUrl("/settings/")}}),t.LevelModel=t.ItsModel.extend({idAttribute:"levelId",defaults:{name:"",desc:"",alt:0/0},saveAttr:["name","desc"],url:function(){return e.getResourceUrl("/levels/")+this.id+"/"}}),t.LevelCollection=o.Collection.extend({model:t.LevelModel,url:function(){return e.getResourceUrl("/levels/?with=fpCount")}}),t.FloorplanModel=t.ItsModel.extend({idAttribute:"fpId",defaults:{name:"",desc:"",access:"private",levelId:0},saveAttr:["name","desc","levelId","access"],url:function(){return e.getResourceUrl("/floorplans/")+this.id+"/"}}),t.FloorplanCollection=o.Collection.extend({model:t.FloorplanModel,url:function(){return e.getResourceUrl("/floorplans/?with=tiles")}}),t.UserModel=t.ItsModel.extend({idAttribute:"username",defaults:{username:"",password:""},saveAttr:["password"],url:function(){return e.getBaseUrl()+"/users/"+this.get("username")+"/"}}),t.AccountModel=t.ItsModel.extend({idAttribute:"username",defaults:{username:"",access:"10"},saveAttr:["access"],url:function(){return e.getResourceUrl("/accounts/")+this.get("username")+"/"}}),t.AccountCollection=o.Collection.extend({model:t.AccountModel,url:function(){return e.getResourceUrl("/accounts/")}}),t.StationModel=t.ItsModel.extend({idAttribute:"mac",defaults:{name:null,desc:null,lrrt:0/0,loc:null},saveAttr:["name","desc"],url:function(){return e.getResourceUrl("/stations/")+this.get("mac")+"/"}}),t.StationCollection=o.Collection.extend({model:t.StationModel,url:function(){return e.getResourceUrl("/stations/")}}),i.reqres.setHandler("all_stations:entities",function(){var n=o.Collection.extend({model:t.StationModel,url:function(){return e.getResourceUrl("/stations/?type=all&loc=no&lrrt=-1")}});return new n}),i.reqres.setHandler("known_stations_loc:entities",function(){var n=o.Collection.extend({model:t.StationModel,url:function(){return e.getResourceUrl("/stations/?type=known&loc=yes")}});return new n}),i.reqres.setHandler("all_stations_loc:entities",function(){var n=o.Collection.extend({model:t.StationModel,url:function(){return e.getResourceUrl("/stations/?type=all&loc=yes")}});return new n}),i.reqres.setHandler("stations_count:entities",function(n){var i=t.ItsModel.extend({defaults:{known_sta:null,other_sta:null},url:function(){return e.getResourceUrl("/stations/?type=count&lrrt="+n)}});return new i}),t.NodeModel=o.Model.extend({idAttribute:"mac",defaults:{name:"",desc:"",lrrt:0/0,lrne:0/0},url:function(){return e.getResourceUrl("/nodes/")+this.id+"/"},sync:function(t,e,n){var i,s;return("create"===t||"update"===t)&&(n.method="PUT",n.emulateJSON=!0,i=e.get("loc"),s=e.pick("name","desc"),s.lat=i.lat,s.lng=i.lng,s.levelId=i.levelId,n.data=a.param(s),i=e.pick("loc"),n.data),o.sync.apply(this,[t,e,n])}}),t.NodeCollection=o.Collection.extend({model:t.NodeModel,url:function(){return e.getResourceUrl("/nodes/")}}),t.Indoors={},t.Indoors.FingerprintModel=o.Model.extend({}),t.Indoors.AccessPointModel=o.Model.extend({idAttribute:"mac",defaults:{mfr:0/0,maxRss:0,minRss:0,delta:0,entries:[]}}),t.Indoors.RouteModel=o.Model.extend({}),t.Indoors.FingerprintCollection=o.Collection.extend({model:t.Indoors.FingerprintModel,levelId:0,initialize:function(){log.debug("FingerprintCollection initialized")},setLevelId:function(t){t&&(this.levelId=t)},url:function(){return e.getResourceUrl("/levels/")+this.levelId+"/fingerprints/"}}),t.Indoors.AccessPointCollection=o.Collection.extend({model:t.Indoors.AccessPointModel,initialize:function(){log.debug("AccessPointCollection initialized")},addAccessPoint:function(t,e,n,i){var o=this.get(t);o?(o.get("maxRss")<e&&o.set("maxRss",e),o.get("minRss")>e&&o.set("minRss",e),o.attributes.entries.push({lat:n,lng:i,rss:e})):this.add({mac:t,maxRss:e,minRss:e,lat:n,lng:i,entries:[{lat:n,lng:i,rss:e}]})}}),t.Indoors.RouteCollection=o.Collection.extend({model:t.Indoors.RouteModel,levelId:0,initialize:function(){log.debug("RouteCollection initialized")},setLevelId:function(t){t&&(this.levelId=t)},url:function(){return e.getResourceUrl("/levels/")+this.levelId+"/fingerprints/routes/"}}),t.Navimote={},t.Navimote.DeviceStatusModel=o.Model.extend({idAttribute:"mac",url:function(){return e.Navimote.getResourceUrl("/devices/")+this.id+"/status/"},parse:function(e){var i,o,s,a;return a=r.extend({},t.Navimote.DEFAULT_UDO,e.udo),e=r.extend(r.omit(e,"udo"),a),o=n.resolveNavimotePosition(e),s=r.has(e,"current_server_time")?e.current_server_time:0/0,i=Math.max(0,s-o.fixed_at),e.loc=o,e.lrrt=i,e},push:function(t,n){var i=this.url;this.url=function(){return e.Navimote.getResourceUrl("/devices/")+this.id+"/push/"},this.save().success(function(){t()}).error(function(){n()}),this.url=i}}),t.Navimote.DeviceStatusCollection=o.Collection.extend({model:t.Navimote.DeviceStatusModel,url:function(){return e.Navimote.getResourceUrl("/devices/?with=status,udo")}}),t.Navimote.DEFAULT_UDO={name:"",desc:"",type:""},t.Navimote.DeviceModel=o.Model.extend({idAttribute:"mac",defaults:{lrrt:0/0},url:function(){return e.Navimote.getResourceUrl("/devices/")+this.id+"/"},sync:function(t,e,n){return"create"===t||"update"===t?(n.method="PUT",n.url=this.url(),n.attrs=this.pick("name","desc","type"),o.sync.apply(this,[t,e,n])):("delete"===t&&(n.url=this.url()),o.sync.apply(this,[t,e,n]))},parse:function(e){var i,o,s,a;return r.has(e,"status")&&"success"==e.status?this.toJSON():(o=n.resolveNavimotePosition(e),s=r.has(e,"current_server_time")?e.current_server_time:0/0,i=Math.max(0,s-o.fixed_at),e.lrrt=i,a=r.extend({},t.Navimote.DEFAULT_UDO,e.udo),r.extend(a,r.omit(e,"udo")))},push:function(t,n){var i=this.url;this.url=function(){return e.Navimote.getResourceUrl("/devices/")+this.id+"/push/"},this.save().success(function(){t()}).error(function(){n()}),this.url=i}}),t.Navimote.DeviceCollection=o.Collection.extend({model:t.Navimote.DeviceModel,url:function(){return e.Navimote.getResourceUrl("/devices/?with=udo,status")}}),t.Navimote.SiteConfig=o.Model.extend({url:function(){return e.Navimote.getResourceUrl("/config/")},sync:function(t,e,n){return("create"===t||"update"===t)&&(this._sanitizeValues(),n.method="PUT",n.data=JSON.stringify(e.pick(["device_configs","location_source_config"]))),o.sync.apply(this,[t,e,n])},getGeneralConfig:function(t){var e=r.omit(this.get("device_configs")[t],"wifi_config");return r.has(e,"buzzer_on_button_press")&&r.isBoolean(e.buzzer_on_button_press)&&(e.buzzer_on_button_press=e.buzzer_on_button_press?"true":"false"),r.has(e,"camera_positioning")||(e.camera_positioning=0),new o.Model(e)},getLocationSourceConfig:function(){var t=this.get("location_source_config");return new o.Model(t)},getWiFiConfig:function(t){var e={},n=this.get("device_configs");return r.has(n,t)&&r.has(n[t],"wifi_config")&&(e=n[t].wifi_config,r.has(e,"channels")&&r.isArray(e.channels)&&(e.channels=e.channels.join(", "))),new o.Model(e)},storeConfig:function(t,e,n,i){var o,s=this.get("device_configs");r.each(e.attributes,function(t,n){(null==t||isNaN(t))&&(console.log("je delete "+n),delete e.attributes[n])}),s[t]=e.toJSON(),o=n.toJSON(),r.isEmpty(o)||(s[t].wifi_config=o),i&&!r.isEmpty(i.toJSON())&&this.set("location_source_config",i.toJSON())},addConfig:function(t,e){var n=this.get("device_configs");n[t]=e,this.set("device_configs",n)},removeConfig:function(t){var e=this.get("device_configs");delete e[t]},getDeviceLabels:function(){return r.keys(this.get("device_configs"))},_sanitizeValues:function(){var t,e,n=this.get("device_configs");r.each(r.keys(n),function(i){if(r.has(n[i],"buzzer_on_button_press")&&r.isString(n[i].buzzer_on_button_press)&&(n[i].buzzer_on_button_press="true"===n[i].buzzer_on_button_press?!0:!1),t=n[i].wifi_config,!r.isEmpty(t)&&r.has(t,"channels")){e=t.channels;try{r.isString(e)&&(e=r.map(e.split(","),function(t){return parseInt(t)}))}catch(o){e=[0]}t.channels=e}})}}),t.Navimote.DeviceConfig=t.Navimote.SiteConfig.extend({idAttribute:"mac",url:function(){return e.Navimote.getResourceUrl("/devices/")+this.id+"/config/"}}),t.CvTrack={},t.CvTrack.CameraModel=o.Model.extend({idAttribute:"mac",url:function(){return e.CvTrack.getResourceUrl("/cameras/")+this.id+"/"}}),t.CvTrack.CameraCollection=o.Collection.extend({model:t.CvTrack.CameraModel,url:function(){return e.CvTrack.getResourceUrl("/cameras/")}}),t.Vps={},t.Vps.VisualPointModel=o.Model.extend({idAttribute:"id",url:function(){return""}}),t.Vps.VisualPointCollection=o.Collection.extend({model:t.Vps.VisualPointModel,url:function(){return""}})})}),define("ouiresolver",[],function(){"use strict";function t(){i()}function e(){return null!==r}function n(t){var e,n=null;return t&&t.length>0&&(e=t[0].toUpperCase(),a[e])?a[e]:(null!==r&&(n=r[t]),n?n:"n/a")}function i(){var t="undefined"!=typeof Storage&&localStorage.ouiMapJson;t?$.ajax({type:"HEAD",url:s,beforeSend:function(){},complete:function(t){200==t.status&&t.getResponseHeader("Last-Modified")!==localStorage.ouiMapLastModified?o():r=JSON.parse(localStorage.ouiMapJson)}}):o()}function o(){new Date;$.ajax({url:s,beforeSend:function(){},success:function(t,e,n){r=JSON.parse(t),"undefined"!=typeof Storage&&(localStorage.ouiMapJson=t,localStorage.ouiMapLastModified=n.getResponseHeader("Last-Modified"))}})}var s="https://s3.amazonaws.com/navizon.its.resources/oui.json",a={U:"iOS device",I:"iBeacon",W:"Navizon Wearabouts",N:"Android device"},r=null;return{init:t,isDataLoaded:e,getCompanyName:n}}),define("common/local_storage",[],function(){"use strict";function t(t){if("undefined"==typeof Storage)return{};var e=localStorage.getItem(t);return null==e&&(e="{}"),JSON.parse(e)}function e(t,e,n){if("undefined"!=typeof Storage){var i=localStorage.getItem(t);null==i&&(i="{}"),i=JSON.parse(i),i[e]=n,localStorage.setItem(t,JSON.stringify(i))}}return{getItem:t,setField:e}}),function(t,e,n){!function(t){"use strict";"function"==typeof define&&define.amd?define("datatables",["jquery"],t):"object"==typeof exports?t(require("jquery")):jQuery&&!jQuery.fn.dataTable&&t(jQuery)}(function(i){"use strict";function o(t){var e,n,s="a aa ai ao as b fn i m o s ",a={};i.each(t,function(i){e=i.match(/^([^A-Z]+?)([A-Z])/),e&&-1!==s.indexOf(e[1]+" ")&&(n=i.replace(e[0],e[2].toLowerCase()),a[n]=i,"o"===e[1]&&o(t[i]))}),t._hungarianMap=a}function s(t,e,a){t._hungarianMap||o(t);var r;i.each(e,function(o){r=t._hungarianMap[o],r===n||!a&&e[r]!==n||("o"===r.charAt(0)?(e[r]||(e[r]={}),i.extend(!0,e[r],e[o]),s(t[r],e[r],a)):e[r]=e[o])})}function a(t){var e=Ge.defaults.oLanguage,n=t.sZeroRecords;!t.sEmptyTable&&n&&"No data available in table"===e.sEmptyTable&&Re(t,t,"sZeroRecords","sEmptyTable"),!t.sLoadingRecords&&n&&"Loading..."===e.sLoadingRecords&&Re(t,t,"sZeroRecords","sLoadingRecords"),t.sInfoThousands&&(t.sThousands=t.sInfoThousands);var i=t.sDecimal;i&&Ue(i)}function r(t){bn(t,"ordering","bSort"),bn(t,"orderMulti","bSortMulti"),bn(t,"orderClasses","bSortClasses"),bn(t,"orderCellsTop","bSortCellsTop"),bn(t,"order","aaSorting"),bn(t,"orderFixed","aaSortingFixed"),bn(t,"paging","bPaginate"),bn(t,"pagingType","sPaginationType"),bn(t,"pageLength","iDisplayLength"),bn(t,"searching","bFilter");var e=t.aoSearchCols;if(e)for(var n=0,i=e.length;i>n;n++)e[n]&&s(Ge.models.oSearch,e[n])}function l(t){bn(t,"orderable","bSortable"),bn(t,"orderData","aDataSort"),bn(t,"orderSequence","asSorting"),bn(t,"orderDataType","sortDataType")}function c(t){var e=t.oBrowser,n=i("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(i("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(i('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),o=n.find(".test");e.bScrollOversize=100===o[0].offsetWidth,e.bScrollbarLeft=1!==o.offset().left,n.remove()}function u(t,e,i,o,s,a){var r,l=o,c=!1;for(i!==n&&(r=i,c=!0);l!==s;)t.hasOwnProperty(l)&&(r=c?e(r,t[l],l,t):t[l],c=!0,l+=a);return r}function d(t,n){var o=Ge.defaults.column,s=t.aoColumns.length,a=i.extend({},Ge.models.oColumn,o,{nTh:n?n:e.createElement("th"),sTitle:o.sTitle?o.sTitle:n?n.innerHTML:"",aDataSort:o.aDataSort?o.aDataSort:[s],mData:o.mData?o.mData:s,idx:s});t.aoColumns.push(a);var r=t.aoPreSearchCols;r[s]=i.extend({},Ge.models.oSearch,r[s]),h(t,s,null)}function h(t,e,o){var a=t.aoColumns[e],r=t.oClasses,c=i(a.nTh);if(!a.sWidthOrig){a.sWidthOrig=c.attr("width")||null;var u=(c.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);u&&(a.sWidthOrig=u[1])}o!==n&&null!==o&&(l(o),s(Ge.defaults.column,o),o.mDataProp===n||o.mData||(o.mData=o.mDataProp),o.sType&&(a._sManualType=o.sType),o.className&&!o.sClass&&(o.sClass=o.className),i.extend(a,o),Re(a,o,"sWidth","sWidthOrig"),"number"==typeof o.iDataSort&&(a.aDataSort=[o.iDataSort]),Re(a,o,"aDataSort"));var d=a.mData,h=k(d),p=a.mRender?k(a.mRender):null,f=function(t){return"string"==typeof t&&-1!==t.indexOf("@")};a._bAttrSrc=i.isPlainObject(d)&&(f(d.sort)||f(d.type)||f(d.filter)),a.fnGetData=function(t,e,i){var o=h(t,e,n,i);return p&&e?p(o,e,t,i):o},a.fnSetData=function(t,e,n){return I(d)(t,e,n)},"number"!=typeof d&&(t._rowReadObject=!0),t.oFeatures.bSort||(a.bSortable=!1,c.addClass(r.sSortableNone));var g=-1!==i.inArray("asc",a.asSorting),m=-1!==i.inArray("desc",a.asSorting);a.bSortable&&(g||m)?g&&!m?(a.sSortingClass=r.sSortableAsc,a.sSortingClassJUI=r.sSortJUIAscAllowed):!g&&m?(a.sSortingClass=r.sSortableDesc,a.sSortingClassJUI=r.sSortJUIDescAllowed):(a.sSortingClass=r.sSortable,a.sSortingClassJUI=r.sSortJUI):(a.sSortingClass=r.sSortableNone,a.sSortingClassJUI="")}function p(t){if(t.oFeatures.bAutoWidth!==!1){var e=t.aoColumns;be(t);for(var n=0,i=e.length;i>n;n++)e[n].nTh.style.width=e[n].sWidth}var o=t.oScroll;(""!==o.sY||""!==o.sX)&&me(t),Be(t,null,"column-sizing",[t])}function f(t,e){var n=v(t,"bVisible");return"number"==typeof n[e]?n[e]:null}function g(t,e){var n=v(t,"bVisible"),o=i.inArray(e,n);return-1!==o?o:null}function m(t){return v(t,"bVisible").length}function v(t,e){var n=[];return i.map(t.aoColumns,function(t,i){t[e]&&n.push(i)}),n}function b(t){var e,i,o,s,a,r,l,c,u,d=t.aoColumns,h=t.aoData,p=Ge.ext.type.detect;for(e=0,i=d.length;i>e;e++)if(l=d[e],u=[],!l.sType&&l._sManualType)l.sType=l._sManualType;else if(!l.sType){for(o=0,s=p.length;s>o;o++){for(a=0,r=h.length;r>a&&(u[a]===n&&(u[a]=S(t,a,e,"type")),c=p[o](u[a],t),c&&"html"!==c);a++);if(c){l.sType=c;break}}l.sType||(l.sType="string")}}function y(t,e,o,s){var a,r,l,c,u,h,p,f=t.aoColumns;if(e)for(a=e.length-1;a>=0;a--){p=e[a];var g=p.targets!==n?p.targets:p.aTargets;for(i.isArray(g)||(g=[g]),l=0,c=g.length;c>l;l++)if("number"==typeof g[l]&&g[l]>=0){for(;f.length<=g[l];)d(t);s(g[l],p)}else if("number"==typeof g[l]&&g[l]<0)s(f.length+g[l],p);else if("string"==typeof g[l])for(u=0,h=f.length;h>u;u++)("_all"==g[l]||i(f[u].nTh).hasClass(g[l]))&&s(u,p)}if(o)for(a=0,r=o.length;r>a;a++)s(a,o[a])}function w(t,e,n,o){var s=t.aoData.length,a=i.extend(!0,{},Ge.models.oRow,{src:n?"dom":"data"});a._aData=e,t.aoData.push(a);for(var r=t.aoColumns,l=0,c=r.length;c>l;l++)n&&T(t,s,l,S(t,s,l)),r[l].sType=null;return t.aiDisplayMaster.push(s),(n||!t.oFeatures.bDeferRender)&&O(t,s,n,o),s}function _(t,e){var n;return e instanceof i||(e=i(e)),e.map(function(e,i){return n=E(t,i),w(t,n.data,i,n.cells)})}function x(t,e){return e._DT_RowIndex!==n?e._DT_RowIndex:null}function C(t,e,n){return i.inArray(n,t.aoData[e].anCells)}function S(t,e,i,o){var s=t.iDraw,a=t.aoColumns[i],r=t.aoData[e]._aData,l=a.sDefaultContent,c=a.fnGetData(r,o,{settings:t,row:e,col:i});if(c===n)return t.iDrawError!=s&&null===l&&(Pe(t,0,"Requested unknown parameter "+("function"==typeof a.mData?"{function}":"'"+a.mData+"'")+" for row "+e,4),t.iDrawError=s),l;if(c!==r&&null!==c||null===l){if("function"==typeof c)return c.call(r)}else c=l;return null===c&&"display"==o?"":c}function T(t,e,n,i){var o=t.aoColumns[n],s=t.aoData[e]._aData;o.fnSetData(s,i,{settings:t,row:e,col:n})}function D(t){return i.map(t.match(/(\\.|[^\.])+/g),function(t){return t.replace(/\\./g,".")})}function k(t){if(i.isPlainObject(t)){var e={};return i.each(t,function(t,n){n&&(e[t]=k(n))}),function(t,i,o,s){var a=e[i]||e._;return a!==n?a(t,i,o,s):t}}if(null===t)return function(t){return t};if("function"==typeof t)return function(e,n,i,o){return t(e,n,i,o)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e){return e[t]};var o=function(t,e,i){var s,a,r,l;if(""!==i)for(var c=D(i),u=0,d=c.length;d>u;u++){if(s=c[u].match(yn),a=c[u].match(wn),s){c[u]=c[u].replace(yn,""),""!==c[u]&&(t=t[c[u]]),r=[],c.splice(0,u+1),l=c.join(".");for(var h=0,p=t.length;p>h;h++)r.push(o(t[h],e,l));var f=s[0].substring(1,s[0].length-1);t=""===f?r:r.join(f);break}if(a)c[u]=c[u].replace(wn,""),t=t[c[u]]();else{if(null===t||t[c[u]]===n)return n;t=t[c[u]]}}return t};return function(e,n){return o(e,n,t)}}function I(t){if(i.isPlainObject(t))return I(t._);if(null===t)return function(){};if("function"==typeof t)return function(e,n,i){t(e,"set",n,i)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e,n){e[t]=n};var e=function(t,i,o){for(var s,a,r,l,c,u=D(o),d=u[u.length-1],h=0,p=u.length-1;p>h;h++){if(a=u[h].match(yn),r=u[h].match(wn),a){u[h]=u[h].replace(yn,""),t[u[h]]=[],s=u.slice(),s.splice(0,h+1),c=s.join(".");for(var f=0,g=i.length;g>f;f++)l={},e(l,i[f],c),t[u[h]].push(l);return}r&&(u[h]=u[h].replace(wn,""),t=t[u[h]](i)),(null===t[u[h]]||t[u[h]]===n)&&(t[u[h]]={}),t=t[u[h]]}d.match(wn)?t=t[d.replace(wn,"")](i):t[d.replace(yn,"")]=i};return function(n,i){return e(n,i,t)}}function M(t){return pn(t.aoData,"_aData")}function L(t){t.aoData.length=0,t.aiDisplayMaster.length=0,t.aiDisplay.length=0}function j(t,e,i){for(var o=-1,s=0,a=t.length;a>s;s++)t[s]==e?o=s:t[s]>e&&t[s]--;-1!=o&&i===n&&t.splice(o,1)}function N(t,e,i,o){var s,a,r=t.aoData[e];if("dom"!==i&&(i&&"auto"!==i||"dom"!==r.src)){var l,c=r.anCells;if(c)for(s=0,a=c.length;a>s;s++){for(l=c[s];l.childNodes.length;)l.removeChild(l.firstChild);c[s].innerHTML=S(t,e,s,"display")}}else r._aData=E(t,r).data;r._aSortData=null,r._aFilterData=null;var u=t.aoColumns;if(o!==n)u[o].sType=null;else for(s=0,a=u.length;a>s;s++)u[s].sType=null;A(r)}function E(t,e){var n,o,s,a=[],r=e.firstChild,l=0,c=t.aoColumns,u=t._rowReadObject,d=u?{}:[],h=function(t,e){if("string"==typeof t){var n=t.indexOf("@");if(-1!==n){var i=t.substring(n+1),o=I(t);o(d,e.getAttribute(i))}}},p=function(t){if(o=c[l],s=i.trim(t.innerHTML),o&&o._bAttrSrc){var e=I(o.mData._);e(d,s),h(o.mData.sort,t),h(o.mData.type,t),h(o.mData.filter,t)}else u?(o._setter||(o._setter=I(o.mData)),o._setter(d,s)):d.push(s);l++};if(r)for(;r;)n=r.nodeName.toUpperCase(),("TD"==n||"TH"==n)&&(p(r),a.push(r)),r=r.nextSibling;else{a=e.anCells;for(var f=0,g=a.length;g>f;f++)p(a[f])}return{data:d,cells:a}}function O(t,n,i,o){var s,a,r,l,c,u=t.aoData[n],d=u._aData,h=[];if(null===u.nTr){for(s=i||e.createElement("tr"),u.nTr=s,u.anCells=h,s._DT_RowIndex=n,A(u),l=0,c=t.aoColumns.length;c>l;l++)r=t.aoColumns[l],a=i?o[l]:e.createElement(r.sCellType),h.push(a),(!i||r.mRender||r.mData!==l)&&(a.innerHTML=S(t,n,l,"display")),r.sClass&&(a.className+=" "+r.sClass),r.bVisible&&!i?s.appendChild(a):!r.bVisible&&i&&a.parentNode.removeChild(a),r.fnCreatedCell&&r.fnCreatedCell.call(t.oInstance,a,S(t,n,l),d,n,l);Be(t,"aoRowCreatedCallback",null,[s,d,n])}u.nTr.setAttribute("role","row")}function A(t){var e=t.nTr,n=t._aData;if(e){if(n.DT_RowId&&(e.id=n.DT_RowId),n.DT_RowClass){var o=n.DT_RowClass.split(" ");t.__rowc=t.__rowc?vn(t.__rowc.concat(o)):o,i(e).removeClass(t.__rowc.join(" ")).addClass(n.DT_RowClass)}n.DT_RowData&&i(e).data(n.DT_RowData)}}function P(t){var e,n,o,s,a,r=t.nTHead,l=t.nTFoot,c=0===i("th, td",r).length,u=t.oClasses,d=t.aoColumns;for(c&&(s=i("<tr/>").appendTo(r)),e=0,n=d.length;n>e;e++)a=d[e],o=i(a.nTh).addClass(a.sClass),c&&o.appendTo(s),t.oFeatures.bSort&&(o.addClass(a.sSortingClass),a.bSortable!==!1&&(o.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),Le(t,a.nTh,e))),a.sTitle!=o.html()&&o.html(a.sTitle),We(t,"header")(t,o,a,u);if(c&&B(t.aoHeader,r),i(r).find(">tr").attr("role","row"),i(r).find(">tr>th, >tr>td").addClass(u.sHeaderTH),i(l).find(">tr>th, >tr>td").addClass(u.sFooterTH),null!==l){var h=t.aoFooter[0];for(e=0,n=h.length;n>e;e++)a=d[e],a.nTf=h[e].cell,a.sClass&&i(a.nTf).addClass(a.sClass)}}function R(t,e,o){var s,a,r,l,c,u,d,h,p,f=[],g=[],m=t.aoColumns.length;if(e){for(o===n&&(o=!1),s=0,a=e.length;a>s;s++){for(f[s]=e[s].slice(),f[s].nTr=e[s].nTr,r=m-1;r>=0;r--)t.aoColumns[r].bVisible||o||f[s].splice(r,1);g.push([])}for(s=0,a=f.length;a>s;s++){if(d=f[s].nTr)for(;u=d.firstChild;)d.removeChild(u);for(r=0,l=f[s].length;l>r;r++)if(h=1,p=1,g[s][r]===n){for(d.appendChild(f[s][r].cell),g[s][r]=1;f[s+h]!==n&&f[s][r].cell==f[s+h][r].cell;)g[s+h][r]=1,h++;for(;f[s][r+p]!==n&&f[s][r].cell==f[s][r+p].cell;){for(c=0;h>c;c++)g[s+c][r+p]=1;p++}i(f[s][r].cell).attr("rowspan",h).attr("colspan",p)}}}}function F(t){var e=Be(t,"aoPreDrawCallback","preDraw",[t]);if(-1!==i.inArray(!1,e))return void fe(t,!1);var o=[],s=0,a=t.asStripeClasses,r=a.length,l=(t.aoOpenRows.length,t.oLanguage),c=t.iInitDisplayStart,u="ssp"==$e(t),d=t.aiDisplay;t.bDrawing=!0,c!==n&&-1!==c&&(t._iDisplayStart=u?c:c>=t.fnRecordsDisplay()?0:c,t.iInitDisplayStart=-1);var h=t._iDisplayStart,p=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,fe(t,!1);else if(u){if(!t.bDestroying&&!$(t))return}else t.iDraw++;if(0!==d.length)for(var f=u?0:h,g=u?t.aoData.length:p,v=f;g>v;v++){var b=d[v],y=t.aoData[b];null===y.nTr&&O(t,b);var w=y.nTr;if(0!==r){var _=a[s%r];y._sRowStripe!=_&&(i(w).removeClass(y._sRowStripe).addClass(_),y._sRowStripe=_)}Be(t,"aoRowCallback",null,[w,y._aData,s,v]),o.push(w),s++}else{var x=l.sZeroRecords;1==t.iDraw&&"ajax"==$e(t)?x=l.sLoadingRecords:l.sEmptyTable&&0===t.fnRecordsTotal()&&(x=l.sEmptyTable),o[0]=i("<tr/>",{"class":r?a[0]:""}).append(i("<td />",{valign:"top",colSpan:m(t),"class":t.oClasses.sRowEmpty}).html(x))[0]}Be(t,"aoHeaderCallback","header",[i(t.nTHead).children("tr")[0],M(t),h,p,d]),Be(t,"aoFooterCallback","footer",[i(t.nTFoot).children("tr")[0],M(t),h,p,d]);var C=i(t.nTBody);C.children().detach(),C.append(i(o)),Be(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}function z(t,e){var n=t.oFeatures,i=n.bSort,o=n.bFilter;i&&ke(t),o?J(t,t.oPreviousSearch):t.aiDisplay=t.aiDisplayMaster.slice(),e!==!0&&(t._iDisplayStart=0),t._drawHold=e,F(t),t._drawHold=!1}function V(t){var e=t.oClasses,n=i(t.nTable),o=i("<div/>").insertBefore(n),s=t.oFeatures,a=i("<div/>",{id:t.sTableId+"_wrapper","class":e.sWrapper+(t.nTFoot?"":" "+e.sNoFooter)});t.nHolding=o[0],t.nTableWrapper=a[0],t.nTableReinsertBefore=t.nTable.nextSibling;for(var r,l,c,u,d,h,p=t.sDom.split(""),f=0;f<p.length;f++){if(r=null,l=p[f],"<"==l){if(c=i("<div/>")[0],u=p[f+1],"'"==u||'"'==u){for(d="",h=2;p[f+h]!=u;)d+=p[f+h],h++;if("H"==d?d=e.sJUIHeader:"F"==d&&(d=e.sJUIFooter),-1!=d.indexOf(".")){var g=d.split(".");c.id=g[0].substr(1,g[0].length-1),c.className=g[1]}else"#"==d.charAt(0)?c.id=d.substr(1,d.length-1):c.className=d;f+=h}a.append(c),a=i(c)}else if(">"==l)a=a.parent();else if("l"==l&&s.bPaginate&&s.bLengthChange)r=ue(t);else if("f"==l&&s.bFilter)r=G(t);else if("r"==l&&s.bProcessing)r=pe(t);else if("t"==l)r=ge(t);else if("i"==l&&s.bInfo)r=oe(t);else if("p"==l&&s.bPaginate)r=de(t);else if(0!==Ge.ext.feature.length)for(var m=Ge.ext.feature,v=0,b=m.length;b>v;v++)if(l==m[v].cFeature){r=m[v].fnInit(t);break}if(r){var y=t.aanFeatures;y[l]||(y[l]=[]),y[l].push(r),a.append(r)}}o.replaceWith(a)}function B(t,e){var n,o,s,a,r,l,c,u,d,h,p,f=i(e).children("tr"),g=function(t,e,n){for(var i=t[e];i[n];)n++;return n};for(t.splice(0,t.length),s=0,l=f.length;l>s;s++)t.push([]);for(s=0,l=f.length;l>s;s++)for(n=f[s],u=0,o=n.firstChild;o;){if("TD"==o.nodeName.toUpperCase()||"TH"==o.nodeName.toUpperCase())for(d=1*o.getAttribute("colspan"),h=1*o.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,h=h&&0!==h&&1!==h?h:1,c=g(t,s,u),p=1===d?!0:!1,r=0;d>r;r++)for(a=0;h>a;a++)t[s+a][c+r]={cell:o,unique:p},t[s+a].nTr=n;o=o.nextSibling}}function H(t,e,n){var i=[];n||(n=t.aoHeader,e&&(n=[],B(n,e)));for(var o=0,s=n.length;s>o;o++)for(var a=0,r=n[o].length;r>a;a++)!n[o][a].unique||i[a]&&t.bSortCellsTop||(i[a]=n[o][a].cell);return i}function W(t,e,n){if(Be(t,"aoServerParams","serverParams",[e]),e&&i.isArray(e)){var o={},s=/(.*?)\[\]$/;i.each(e,function(t,e){var n=e.name.match(s);if(n){var i=n[0];o[i]||(o[i]=[]),o[i].push(e.value)}else o[e.name]=e.value}),e=o}var a,r=t.ajax,l=t.oInstance;if(i.isPlainObject(r)&&r.data){a=r.data;var c=i.isFunction(a)?a(e):a;e=i.isFunction(a)&&c?c:i.extend(!0,e,c),delete r.data}var u={data:e,success:function(e){var i=e.error||e.sError;i&&t.oApi._fnLog(t,0,i),t.json=e,Be(t,null,"xhr",[t,e]),n(e)},dataType:"json",cache:!1,type:t.sServerMethod,error:function(e,n){var i=t.oApi._fnLog;"parsererror"==n?i(t,0,"Invalid JSON response",1):4===e.readyState&&i(t,0,"Ajax error",7),fe(t,!1)}};t.oAjaxData=e,Be(t,null,"preXhr",[t,e]),t.fnServerData?t.fnServerData.call(l,t.sAjaxSource,i.map(e,function(t,e){return{name:e,value:t}}),n,t):t.sAjaxSource||"string"==typeof r?t.jqXHR=i.ajax(i.extend(u,{url:r||t.sAjaxSource})):i.isFunction(r)?t.jqXHR=r.call(l,e,n,t):(t.jqXHR=i.ajax(i.extend(u,r)),r.data=a)}function $(t){return t.bAjaxDataGet?(t.iDraw++,fe(t,!0),W(t,q(t),function(e){U(t,e)}),!1):!0}function q(t){var e,n,o,s,a=t.aoColumns,r=a.length,l=t.oFeatures,c=t.oPreviousSearch,u=t.aoPreSearchCols,d=[],h=De(t),p=t._iDisplayStart,f=l.bPaginate!==!1?t._iDisplayLength:-1,g=function(t,e){d.push({name:t,value:e})};g("sEcho",t.iDraw),g("iColumns",r),g("sColumns",pn(a,"sName").join(",")),g("iDisplayStart",p),g("iDisplayLength",f);var m={draw:t.iDraw,columns:[],order:[],start:p,length:f,search:{value:c.sSearch,regex:c.bRegex}};for(e=0;r>e;e++)o=a[e],s=u[e],n="function"==typeof o.mData?"function":o.mData,m.columns.push({data:n,name:o.sName,searchable:o.bSearchable,orderable:o.bSortable,search:{value:s.sSearch,regex:s.bRegex}}),g("mDataProp_"+e,n),l.bFilter&&(g("sSearch_"+e,s.sSearch),g("bRegex_"+e,s.bRegex),g("bSearchable_"+e,o.bSearchable)),l.bSort&&g("bSortable_"+e,o.bSortable);l.bFilter&&(g("sSearch",c.sSearch),g("bRegex",c.bRegex)),l.bSort&&(i.each(h,function(t,e){m.order.push({column:e.col,dir:e.dir}),g("iSortCol_"+t,e.col),g("sSortDir_"+t,e.dir)}),g("iSortingCols",h.length));var v=Ge.ext.legacy.ajax;return null===v?t.sAjaxSource?d:m:v?d:m}function U(t,e){var i=function(t,i){return e[t]!==n?e[t]:e[i]},o=i("sEcho","draw"),s=i("iTotalRecords","recordsTotal"),a=i("iTotalDisplayRecords","recordsFiltered");if(o){if(1*o<t.iDraw)return;t.iDraw=1*o}L(t),t._iRecordsTotal=parseInt(s,10),t._iRecordsDisplay=parseInt(a,10);for(var r=X(t,e),l=0,c=r.length;c>l;l++)w(t,r[l]);t.aiDisplay=t.aiDisplayMaster.slice(),t.bAjaxDataGet=!1,F(t),t._bInitComplete||le(t,e),t.bAjaxDataGet=!0,fe(t,!1)}function X(t,e){var o=i.isPlainObject(t.ajax)&&t.ajax.dataSrc!==n?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===o?e.aaData||e[o]:""!==o?k(o)(e):e}function G(t){var n=t.oClasses,o=t.sTableId,s=t.oLanguage,a=t.oPreviousSearch,r=t.aanFeatures,l='<input type="search" class="'+n.sFilterInput+'"/>',c=s.sSearch;c=c.match(/_INPUT_/)?c.replace("_INPUT_",l):c+l;var u=i("<div/>",{id:r.f?null:o+"_filter","class":n.sFilter}).append(i("<label/>").append(c)),d=function(){var e=(r.f,this.value?this.value:"");e!=a.sSearch&&(J(t,{sSearch:e,bRegex:a.bRegex,bSmart:a.bSmart,bCaseInsensitive:a.bCaseInsensitive}),t._iDisplayStart=0,F(t))},h=null!==t.searchDelay?t.searchDelay:"ssp"===$e(t)?400:0,p=i("input",u).val(a.sSearch).attr("placeholder",s.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",h?ye(d,h):d).bind("keypress.DT",function(t){return 13==t.keyCode?!1:void 0}).attr("aria-controls",o);return i(t.nTable).on("search.dt.DT",function(n,i){if(t===i)try{p[0]!==e.activeElement&&p.val(a.sSearch)}catch(o){}}),u[0]}function J(t,e,i){var o=t.oPreviousSearch,s=t.aoPreSearchCols,a=function(t){o.sSearch=t.sSearch,o.bRegex=t.bRegex,o.bSmart=t.bSmart,o.bCaseInsensitive=t.bCaseInsensitive},r=function(t){return t.bEscapeRegex!==n?!t.bEscapeRegex:t.bRegex};if(b(t),"ssp"!=$e(t)){Q(t,e.sSearch,i,r(e),e.bSmart,e.bCaseInsensitive),a(e);for(var l=0;l<s.length;l++)K(t,s[l].sSearch,l,r(s[l]),s[l].bSmart,s[l].bCaseInsensitive);Y(t)}else a(e);t.bFiltered=!0,Be(t,null,"search",[t])}function Y(t){for(var e,n,i=Ge.ext.search,o=t.aiDisplay,s=0,a=i.length;a>s;s++){for(var r=[],l=0,c=o.length;c>l;l++)n=o[l],e=t.aoData[n],i[s](t,e._aFilterData,n,e._aData,l)&&r.push(n);o.length=0,o.push.apply(o,r)}}function K(t,e,n,i,o,s){if(""!==e)for(var a,r=t.aiDisplay,l=Z(e,i,o,s),c=r.length-1;c>=0;c--)a=t.aoData[r[c]]._aFilterData[n],l.test(a)||r.splice(c,1)}function Q(t,e,n,i,o,s){var a,r,l,c=Z(e,i,o,s),u=t.oPreviousSearch.sSearch,d=t.aiDisplayMaster;if(0!==Ge.ext.search.length&&(n=!0),r=ee(t),e.length<=0)t.aiDisplay=d.slice();else for((r||n||u.length>e.length||0!==e.indexOf(u)||t.bSorted)&&(t.aiDisplay=d.slice()),a=t.aiDisplay,l=a.length-1;l>=0;l--)c.test(t.aoData[a[l]]._sFilterRow)||a.splice(l,1)}function Z(t,e,n,o){if(t=e?t:te(t),n){var s=i.map(t.match(/"[^"]+"|[^ ]+/g)||"",function(t){if('"'===t.charAt(0)){var e=t.match(/^"(.*)"$/);t=e?e[1]:t}return t.replace('"',"")});t="^(?=.*?"+s.join(")(?=.*?")+").*$"}return new RegExp(t,o?"i":"")}function te(t){return t.replace(sn,"\\$1")}function ee(t){var e,n,i,o,s,a,r,l,c=t.aoColumns,u=Ge.ext.type.search,d=!1;for(n=0,o=t.aoData.length;o>n;n++)if(l=t.aoData[n],!l._aFilterData){for(a=[],i=0,s=c.length;s>i;i++)e=c[i],e.bSearchable?(r=S(t,n,i,"filter"),u[e.sType]&&(r=u[e.sType](r)),null===r&&(r=""),"string"!=typeof r&&r.toString&&(r=r.toString())):r="",r.indexOf&&-1!==r.indexOf("&")&&(_n.innerHTML=r,r=xn?_n.textContent:_n.innerText),r.replace&&(r=r.replace(/[\r\n]/g,"")),a.push(r);l._aFilterData=a,l._sFilterRow=a.join("  "),d=!0}return d}function ne(t){return{search:t.sSearch,smart:t.bSmart,regex:t.bRegex,caseInsensitive:t.bCaseInsensitive}}function ie(t){return{sSearch:t.search,bSmart:t.smart,bRegex:t.regex,bCaseInsensitive:t.caseInsensitive}
}function oe(t){var e=t.sTableId,n=t.aanFeatures.i,o=i("<div/>",{"class":t.oClasses.sInfo,id:n?null:e+"_info"});return n||(t.aoDrawCallback.push({fn:se,sName:"information"}),o.attr("role","status").attr("aria-live","polite"),i(t.nTable).attr("aria-describedby",e+"_info")),o[0]}function se(t){var e=t.aanFeatures.i;if(0!==e.length){var n=t.oLanguage,o=t._iDisplayStart+1,s=t.fnDisplayEnd(),a=t.fnRecordsTotal(),r=t.fnRecordsDisplay(),l=r?n.sInfo:n.sInfoEmpty;r!==a&&(l+=" "+n.sInfoFiltered),l+=n.sInfoPostFix,l=ae(t,l);var c=n.fnInfoCallback;null!==c&&(l=c.call(t.oInstance,t,o,s,a,r,l)),i(e).html(l)}}function ae(t,e){var n=t.fnFormatNumber,i=t._iDisplayStart+1,o=t._iDisplayLength,s=t.fnRecordsDisplay(),a=-1===o;return e.replace(/_START_/g,n.call(t,i)).replace(/_END_/g,n.call(t,t.fnDisplayEnd())).replace(/_MAX_/g,n.call(t,t.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(t,s)).replace(/_PAGE_/g,n.call(t,a?1:Math.ceil(i/o))).replace(/_PAGES_/g,n.call(t,a?1:Math.ceil(s/o)))}function re(t){var e,n,i,o=t.iInitDisplayStart,s=t.aoColumns,a=t.oFeatures;if(!t.bInitialised)return void setTimeout(function(){re(t)},200);for(V(t),P(t),R(t,t.aoHeader),R(t,t.aoFooter),fe(t,!0),a.bAutoWidth&&be(t),e=0,n=s.length;n>e;e++)i=s[e],i.sWidth&&(i.nTh.style.width=Se(i.sWidth));z(t);var r=$e(t);"ssp"!=r&&("ajax"==r?W(t,[],function(n){var i=X(t,n);for(e=0;e<i.length;e++)w(t,i[e]);t.iInitDisplayStart=o,z(t),fe(t,!1),le(t,n)},t):(fe(t,!1),le(t)))}function le(t,e){t._bInitComplete=!0,e&&p(t),Be(t,"aoInitComplete","init",[t,e])}function ce(t,e){var n=parseInt(e,10);t._iDisplayLength=n,He(t),Be(t,null,"length",[t,n])}function ue(t){for(var e=t.oClasses,n=t.sTableId,o=t.aLengthMenu,s=i.isArray(o[0]),a=s?o[0]:o,r=s?o[1]:o,l=i("<select/>",{name:n+"_length","aria-controls":n,"class":e.sLengthSelect}),c=0,u=a.length;u>c;c++)l[0][c]=new Option(r[c],a[c]);var d=i("<div><label/></div>").addClass(e.sLength);return t.aanFeatures.l||(d[0].id=n+"_length"),d.children().append(t.oLanguage.sLengthMenu.replace("_MENU_",l[0].outerHTML)),i("select",d).val(t._iDisplayLength).bind("change.DT",function(){ce(t,i(this).val()),F(t)}),i(t.nTable).bind("length.dt.DT",function(e,n,o){t===n&&i("select",d).val(o)}),d[0]}function de(t){var e=t.sPaginationType,n=Ge.ext.pager[e],o="function"==typeof n,s=function(t){F(t)},a=i("<div/>").addClass(t.oClasses.sPaging+e)[0],r=t.aanFeatures;return o||n.fnInit(t,a,s),r.p||(a.id=t.sTableId+"_paginate",t.aoDrawCallback.push({fn:function(t){if(o){var e,i,a=t._iDisplayStart,l=t._iDisplayLength,c=t.fnRecordsDisplay(),u=-1===l,d=u?0:Math.ceil(a/l),h=u?1:Math.ceil(c/l),p=n(d,h);for(e=0,i=r.p.length;i>e;e++)We(t,"pageButton")(t,r.p[e],e,p,d,h)}else n.fnUpdate(t,s)},sName:"pagination"})),a}function he(t,e,n){var i=t._iDisplayStart,o=t._iDisplayLength,s=t.fnRecordsDisplay();0===s||-1===o?i=0:"number"==typeof e?(i=e*o,i>s&&(i=0)):"first"==e?i=0:"previous"==e?(i=o>=0?i-o:0,0>i&&(i=0)):"next"==e?s>i+o&&(i+=o):"last"==e?i=Math.floor((s-1)/o)*o:Pe(t,0,"Unknown paging action: "+e,5);var a=t._iDisplayStart!==i;return t._iDisplayStart=i,a&&(Be(t,null,"page",[t]),n&&F(t)),a}function pe(t){return i("<div/>",{id:t.aanFeatures.r?null:t.sTableId+"_processing","class":t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function fe(t,e){t.oFeatures.bProcessing&&i(t.aanFeatures.r).css("display",e?"block":"none"),Be(t,null,"processing",[t,e])}function ge(t){var e=i(t.nTable);e.attr("role","grid");var n=t.oScroll;if(""===n.sX&&""===n.sY)return t.nTable;var o=n.sX,s=n.sY,a=t.oClasses,r=e.children("caption"),l=r.length?r[0]._captionSide:null,c=i(e[0].cloneNode(!1)),u=i(e[0].cloneNode(!1)),d=e.children("tfoot"),h="<div/>",p=function(t){return t?Se(t):null};n.sX&&"100%"===e.attr("width")&&e.removeAttr("width"),d.length||(d=null);var f=i(h,{"class":a.sScrollWrapper}).append(i(h,{"class":a.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:o?p(o):"100%"}).append(i(h,{"class":a.sScrollHeadInner}).css({"box-sizing":"content-box",width:n.sXInner||"100%"}).append(c.removeAttr("id").css("margin-left",0).append(e.children("thead")))).append("top"===l?r:null)).append(i(h,{"class":a.sScrollBody}).css({overflow:"auto",height:p(s),width:p(o)}).append(e));d&&f.append(i(h,{"class":a.sScrollFoot}).css({overflow:"hidden",border:0,width:o?p(o):"100%"}).append(i(h,{"class":a.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",0).append(e.children("tfoot")))).append("bottom"===l?r:null));var g=f.children(),m=g[0],v=g[1],b=d?g[2]:null;return o&&i(v).scroll(function(){var t=this.scrollLeft;m.scrollLeft=t,d&&(b.scrollLeft=t)}),t.nScrollHead=m,t.nScrollBody=v,t.nScrollFoot=b,t.aoDrawCallback.push({fn:me,sName:"scrolling"}),f[0]}function me(t){var e,n,o,s,a,r,l,c,u,d=t.oScroll,h=d.sX,p=d.sXInner,g=d.sY,m=d.iBarWidth,v=i(t.nScrollHead),b=v[0].style,y=v.children("div"),w=y[0].style,_=y.children("table"),x=t.nScrollBody,C=i(x),S=x.style,T=i(t.nScrollFoot),D=T.children("div"),k=D.children("table"),I=i(t.nTHead),M=i(t.nTable),L=M[0],j=L.style,N=t.nTFoot?i(t.nTFoot):null,E=t.oBrowser,O=E.bScrollOversize,A=[],P=[],R=[],F=function(t){var e=t.style;e.paddingTop="0",e.paddingBottom="0",e.borderTopWidth="0",e.borderBottomWidth="0",e.height=0};if(M.children("thead, tfoot").remove(),a=I.clone().prependTo(M),e=I.find("tr"),o=a.find("tr"),a.find("th, td").removeAttr("tabindex"),N&&(r=N.clone().prependTo(M),n=N.find("tr"),s=r.find("tr")),h||(S.width="100%",v[0].style.width="100%"),i.each(H(t,a),function(e,n){l=f(t,e),n.style.width=t.aoColumns[l].sWidth}),N&&ve(function(t){t.style.width=""},s),d.bCollapse&&""!==g&&(S.height=C[0].offsetHeight+I[0].offsetHeight+"px"),u=M.outerWidth(),""===h?(j.width="100%",O&&(M.find("tbody").height()>x.offsetHeight||"scroll"==C.css("overflow-y"))&&(j.width=Se(M.outerWidth()-m))):""!==p?j.width=Se(p):u==C.width()&&C.height()<M.height()?(j.width=Se(u-m),M.outerWidth()>u-m&&(j.width=Se(u))):j.width=Se(u),u=M.outerWidth(),ve(F,o),ve(function(t){R.push(t.innerHTML),A.push(Se(i(t).css("width")))},o),ve(function(t,e){t.style.width=A[e]},e),i(o).height(0),N&&(ve(F,s),ve(function(t){P.push(Se(i(t).css("width")))},s),ve(function(t,e){t.style.width=P[e]},n),i(s).height(0)),ve(function(t,e){t.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+R[e]+"</div>",t.style.width=A[e]},o),N&&ve(function(t,e){t.innerHTML="",t.style.width=P[e]},s),M.outerWidth()<u?(c=x.scrollHeight>x.offsetHeight||"scroll"==C.css("overflow-y")?u+m:u,O&&(x.scrollHeight>x.offsetHeight||"scroll"==C.css("overflow-y"))&&(j.width=Se(c-m)),(""===h||""!==p)&&Pe(t,1,"Possible column misalignment",6)):c="100%",S.width=Se(c),b.width=Se(c),N&&(t.nScrollFoot.style.width=Se(c)),g||O&&(S.height=Se(L.offsetHeight+m)),g&&d.bCollapse){S.height=Se(g);var z=h&&L.offsetWidth>x.offsetWidth?m:0;L.offsetHeight<x.offsetHeight&&(S.height=Se(L.offsetHeight+z))}var V=M.outerWidth();_[0].style.width=Se(V),w.width=Se(V);var B=M.height()>x.clientHeight||"scroll"==C.css("overflow-y"),W="padding"+(E.bScrollbarLeft?"Left":"Right");w[W]=B?m+"px":"0px",N&&(k[0].style.width=Se(V),D[0].style.width=Se(V),D[0].style[W]=B?m+"px":"0px"),C.scroll(),!t.bSorted&&!t.bFiltered||t._drawHold||(x.scrollTop=0)}function ve(t,e,n){for(var i,o,s=0,a=0,r=e.length;r>a;){for(i=e[a].firstChild,o=n?n[a].firstChild:null;i;)1===i.nodeType&&(n?t(i,o,s):t(i,s),s++),i=i.nextSibling,o=n?o.nextSibling:null;a++}}function be(e){var n,o,s,a,r,l=e.nTable,c=e.aoColumns,u=e.oScroll,d=u.sY,h=u.sX,f=u.sXInner,g=c.length,b=v(e,"bVisible"),y=i("th",e.nTHead),w=l.getAttribute("width"),_=l.parentNode,x=!1;for(n=0;n<b.length;n++)o=c[b[n]],null!==o.sWidth&&(o.sWidth=we(o.sWidthOrig,_),x=!0);if(x||h||d||g!=m(e)||g!=y.length){var C=i(l).clone().empty().css("visibility","hidden").removeAttr("id").append(i(e.nTHead).clone(!1)).append(i(e.nTFoot).clone(!1)).append(i("<tbody><tr/></tbody>"));C.find("tfoot th, tfoot td").css("width","");var S=C.find("tbody tr");for(y=H(e,C.find("thead")[0]),n=0;n<b.length;n++)o=c[b[n]],y[n].style.width=null!==o.sWidthOrig&&""!==o.sWidthOrig?Se(o.sWidthOrig):"";if(e.aoData.length)for(n=0;n<b.length;n++)s=b[n],o=c[s],i(xe(e,s)).clone(!1).append(o.sContentPadding).appendTo(S);if(C.appendTo(_),h&&f?C.width(f):h?(C.css("width","auto"),C.width()<_.offsetWidth&&C.width(_.offsetWidth)):d?C.width(_.offsetWidth):w&&C.width(w),_e(e,C[0]),h){var T=0;for(n=0;n<b.length;n++)o=c[b[n]],r=i(y[n]).outerWidth(),T+=null===o.sWidthOrig?r:parseInt(o.sWidth,10)+r-i(y[n]).width();C.width(Se(T)),l.style.width=Se(T)}for(n=0;n<b.length;n++)o=c[b[n]],a=i(y[n]).width(),a&&(o.sWidth=Se(a));l.style.width=Se(C.css("width")),C.remove()}else for(n=0;g>n;n++)c[n].sWidth=Se(y.eq(n).width());w&&(l.style.width=Se(w)),!w&&!h||e._reszEvt||(i(t).bind("resize.DT-"+e.sInstance,ye(function(){p(e)})),e._reszEvt=!0)}function ye(t,e){var i,o,s=e!==n?e:200;return function(){var e=this,a=+new Date,r=arguments;i&&i+s>a?(clearTimeout(o),o=setTimeout(function(){i=n,t.apply(e,r)},s)):i?(i=a,t.apply(e,r)):i=a}}function we(t,n){if(!t)return 0;var o=i("<div/>").css("width",Se(t)).appendTo(n||e.body),s=o[0].offsetWidth;return o.remove(),s}function _e(t,e){var n=t.oScroll;if(n.sX||n.sY){var o=n.sX?0:n.iBarWidth;e.style.width=Se(i(e).outerWidth()-o)}}function xe(t,e){var n=Ce(t,e);if(0>n)return null;var o=t.aoData[n];return o.nTr?o.anCells[e]:i("<td/>").html(S(t,n,e,"display"))[0]}function Ce(t,e){for(var n,i=-1,o=-1,s=0,a=t.aoData.length;a>s;s++)n=S(t,s,e,"display")+"",n=n.replace(Cn,""),n.length>i&&(i=n.length,o=s);return o}function Se(t){return null===t?"0px":"number"==typeof t?0>t?"0px":t+"px":t.match(/\d$/)?t+"px":t}function Te(){if(!Ge.__scrollbarWidth){var t=i("<p/>").css({width:"100%",height:200,padding:0})[0],e=i("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(t).appendTo("body"),n=t.offsetWidth;e.css("overflow","scroll");var o=t.offsetWidth;n===o&&(o=e[0].clientWidth),e.remove(),Ge.__scrollbarWidth=n-o}return Ge.__scrollbarWidth}function De(t){var e,o,s,a,r,l,c,u=[],d=t.aoColumns,h=t.aaSortingFixed,p=i.isPlainObject(h),f=[],g=function(t){t.length&&!i.isArray(t[0])?f.push(t):f.push.apply(f,t)};for(i.isArray(h)&&g(h),p&&h.pre&&g(h.pre),g(t.aaSorting),p&&h.post&&g(h.post),e=0;e<f.length;e++)for(c=f[e][0],a=d[c].aDataSort,o=0,s=a.length;s>o;o++)r=a[o],l=d[r].sType||"string",f[e]._idx===n&&(f[e]._idx=i.inArray(f[e][1],d[r].asSorting)),u.push({src:c,col:r,dir:f[e][1],index:f[e]._idx,type:l,formatter:Ge.ext.type.order[l+"-pre"]});return u}function ke(t){var e,n,i,o,s,a=[],r=Ge.ext.type.order,l=t.aoData,c=(t.aoColumns,0),u=t.aiDisplayMaster;for(b(t),s=De(t),e=0,n=s.length;n>e;e++)o=s[e],o.formatter&&c++,Ne(t,o.col);if("ssp"!=$e(t)&&0!==s.length){for(e=0,i=u.length;i>e;e++)a[u[e]]=e;u.sort(c===s.length?function(t,e){var n,i,o,r,c,u=s.length,d=l[t]._aSortData,h=l[e]._aSortData;for(o=0;u>o;o++)if(c=s[o],n=d[c.col],i=h[c.col],r=i>n?-1:n>i?1:0,0!==r)return"asc"===c.dir?r:-r;return n=a[t],i=a[e],i>n?-1:n>i?1:0}:function(t,e){var n,i,o,c,u,d,h=s.length,p=l[t]._aSortData,f=l[e]._aSortData;for(o=0;h>o;o++)if(u=s[o],n=p[u.col],i=f[u.col],d=r[u.type+"-"+u.dir]||r["string-"+u.dir],c=d(n,i),0!==c)return c;return n=a[t],i=a[e],i>n?-1:n>i?1:0})}t.bSorted=!0}function Ie(t){for(var e,n,i=t.aoColumns,o=De(t),s=t.oLanguage.oAria,a=0,r=i.length;r>a;a++){var l=i[a],c=l.asSorting,u=l.sTitle.replace(/<.*?>/g,""),d=l.nTh;d.removeAttribute("aria-sort"),l.bSortable?(o.length>0&&o[0].col==a?(d.setAttribute("aria-sort","asc"==o[0].dir?"ascending":"descending"),n=c[o[0].index+1]||c[0]):n=c[0],e=u+("asc"===n?s.sSortAscending:s.sSortDescending)):e=u,d.setAttribute("aria-label",e)}}function Me(t,e,o,s){var a,r=t.aoColumns[e],l=t.aaSorting,c=r.asSorting,u=function(t,e){var o=t._idx;return o===n&&(o=i.inArray(t[1],c)),o+1<c.length?o+1:e?null:0};if("number"==typeof l[0]&&(l=t.aaSorting=[l]),o&&t.oFeatures.bSortMulti){var d=i.inArray(e,pn(l,"0"));-1!==d?(a=u(l[d],!0),null===a?l.splice(d,1):(l[d][1]=c[a],l[d]._idx=a)):(l.push([e,c[0],0]),l[l.length-1]._idx=0)}else l.length&&l[0][0]==e?(a=u(l[0]),l.length=1,l[0][1]=c[a],l[0]._idx=a):(l.length=0,l.push([e,c[0]]),l[0]._idx=0);z(t),"function"==typeof s&&s(t)}function Le(t,e,n,i){var o=t.aoColumns[n];ze(e,{},function(e){o.bSortable!==!1&&(t.oFeatures.bProcessing?(fe(t,!0),setTimeout(function(){Me(t,n,e.shiftKey,i),"ssp"!==$e(t)&&fe(t,!1)},0)):Me(t,n,e.shiftKey,i))})}function je(t){var e,n,o,s=t.aLastSort,a=t.oClasses.sSortColumn,r=De(t),l=t.oFeatures;if(l.bSort&&l.bSortClasses){for(e=0,n=s.length;n>e;e++)o=s[e].src,i(pn(t.aoData,"anCells",o)).removeClass(a+(2>e?e+1:3));for(e=0,n=r.length;n>e;e++)o=r[e].src,i(pn(t.aoData,"anCells",o)).addClass(a+(2>e?e+1:3))}t.aLastSort=r}function Ne(t,e){var n,i=t.aoColumns[e],o=Ge.ext.order[i.sSortDataType];o&&(n=o.call(t.oInstance,t,e,g(t,e)));for(var s,a,r=Ge.ext.type.order[i.sType+"-pre"],l=0,c=t.aoData.length;c>l;l++)s=t.aoData[l],s._aSortData||(s._aSortData=[]),(!s._aSortData[e]||o)&&(a=o?n[l]:S(t,l,e,"sort"),s._aSortData[e]=r?r(a):a)}function Ee(t){if(t.oFeatures.bStateSave&&!t.bDestroying){var e={time:+new Date,start:t._iDisplayStart,length:t._iDisplayLength,order:i.extend(!0,[],t.aaSorting),search:ne(t.oPreviousSearch),columns:i.map(t.aoColumns,function(e,n){return{visible:e.bVisible,search:ne(t.aoPreSearchCols[n])}})};Be(t,"aoStateSaveParams","stateSaveParams",[t,e]),t.oSavedState=e,t.fnStateSaveCallback.call(t.oInstance,t,e)}}function Oe(t){var e,n,o=t.aoColumns;if(t.oFeatures.bStateSave){var s=t.fnStateLoadCallback.call(t.oInstance,t);if(s&&s.time){var a=Be(t,"aoStateLoadParams","stateLoadParams",[t,s]);if(-1===i.inArray(!1,a)){var r=t.iStateDuration;if(!(r>0&&s.time<+new Date-1e3*r)&&o.length===s.columns.length){for(t.oLoadedState=i.extend(!0,{},s),t._iDisplayStart=s.start,t.iInitDisplayStart=s.start,t._iDisplayLength=s.length,t.aaSorting=[],i.each(s.order,function(e,n){t.aaSorting.push(n[0]>=o.length?[0,n[1]]:n)}),i.extend(t.oPreviousSearch,ie(s.search)),e=0,n=s.columns.length;n>e;e++){var l=s.columns[e];o[e].bVisible=l.visible,i.extend(t.aoPreSearchCols[e],ie(l.search))}Be(t,"aoStateLoaded","stateLoaded",[t,s])}}}}}function Ae(t){var e=Ge.settings,n=i.inArray(t,pn(e,"nTable"));return-1!==n?e[n]:null}function Pe(e,n,i,o){if(i="DataTables warning: "+(null!==e?"table id="+e.sTableId+" - ":"")+i,o&&(i+=". For more information about this error, please see http://datatables.net/tn/"+o),n)t.console&&console.log&&console.log(i);else{var s=Ge.ext,a=s.sErrMode||s.errMode;if("alert"!=a)throw new Error(i);alert(i)}}function Re(t,e,o,s){return i.isArray(o)?void i.each(o,function(n,o){i.isArray(o)?Re(t,e,o[0],o[1]):Re(t,e,o)}):(s===n&&(s=o),void(e[o]!==n&&(t[s]=e[o])))}function Fe(t,e,n){var o;for(var s in e)e.hasOwnProperty(s)&&(o=e[s],i.isPlainObject(o)?(i.isPlainObject(t[s])||(t[s]={}),i.extend(!0,t[s],o)):t[s]=n&&"data"!==s&&"aaData"!==s&&i.isArray(o)?o.slice():o);return t}function ze(t,e,n){i(t).bind("click.DT",e,function(e){t.blur(),n(e)}).bind("keypress.DT",e,function(t){13===t.which&&(t.preventDefault(),n(t))}).bind("selectstart.DT",function(){return!1})}function Ve(t,e,n,i){n&&t[e].push({fn:n,sName:i})}function Be(t,e,n,o){var s=[];return e&&(s=i.map(t[e].slice().reverse(),function(e){return e.fn.apply(t.oInstance,o)})),null!==n&&i(t.nTable).trigger(n+".dt",o),s}function He(t){var e=t._iDisplayStart,n=t.fnDisplayEnd(),i=t._iDisplayLength;e>=n&&(e=n-i),(-1===i||0>e)&&(e=0),t._iDisplayStart=e}function We(t,e){var n=t.renderer,o=Ge.ext.renderer[e];return i.isPlainObject(n)&&n[e]?o[n[e]]||o._:"string"==typeof n?o[n]||o._:o._}function $e(t){return t.oFeatures.bServerSide?"ssp":t.ajax||t.sAjaxSource?"ajax":"dom"}function qe(t,e){var n=[],i=Un.numbers_length,o=Math.floor(i/2);return i>=e?n=gn(0,e):o>=t?(n=gn(0,i-2),n.push("ellipsis"),n.push(e-1)):t>=e-1-o?(n=gn(e-(i-2),e),n.splice(0,0,"ellipsis"),n.splice(0,0,0)):(n=gn(t-1,t+2),n.push("ellipsis"),n.push(e-1),n.splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}function Ue(t){i.each({num:function(e){return Xn(e,t)},"num-fmt":function(e){return Xn(e,t,an)},"html-num":function(e){return Xn(e,t,en)},"html-num-fmt":function(e){return Xn(e,t,en,an)}},function(e,n){Je.type.order[e+t+"-pre"]=n})}function Xe(t){return function(){var e=[Ae(this[Ge.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return Ge.ext.internal[t].apply(this,e)}}var Ge,Je,Ye,Ke,Qe,Ze={},tn=/[\r\n]/g,en=/<.*?>/g,nn=/^[\w\+\-]/,on=/[\w\+\-]$/,sn=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),an=/[',$Â£â‚¬Â¥%\u2009\u202F]/g,rn=function(t){return t&&t!==!0&&"-"!==t?!1:!0},ln=function(t){var e=parseInt(t,10);return!isNaN(e)&&isFinite(t)?e:null},cn=function(t,e){return Ze[e]||(Ze[e]=new RegExp(te(e),"g")),"string"==typeof t&&"."!==e?t.replace(/\./g,"").replace(Ze[e],"."):t},un=function(t,e,n){var i="string"==typeof t;return e&&i&&(t=cn(t,e)),n&&i&&(t=t.replace(an,"")),rn(t)||!isNaN(parseFloat(t))&&isFinite(t)},dn=function(t){return rn(t)||"string"==typeof t},hn=function(t,e,n){if(rn(t))return!0;var i=dn(t);return i&&un(mn(t),e,n)?!0:null},pn=function(t,e,i){var o=[],s=0,a=t.length;if(i!==n)for(;a>s;s++)t[s]&&t[s][e]&&o.push(t[s][e][i]);else for(;a>s;s++)t[s]&&o.push(t[s][e]);return o},fn=function(t,e,i,o){var s=[],a=0,r=e.length;if(o!==n)for(;r>a;a++)s.push(t[e[a]][i][o]);else for(;r>a;a++)s.push(t[e[a]][i]);return s},gn=function(t,e){var i,o=[];e===n?(e=0,i=t):(i=e,e=t);for(var s=e;i>s;s++)o.push(s);return o},mn=function(t){return t.replace(en,"")},vn=function(t){var e,n,i,o=[],s=t.length,a=0;t:for(n=0;s>n;n++){for(e=t[n],i=0;a>i;i++)if(o[i]===e)continue t;o.push(e),a++}return o},bn=function(t,e,i){t[e]!==n&&(t[i]=t[e])},yn=/\[.*?\]$/,wn=/\(\)$/,_n=i("<div>")[0],xn=_n.textContent!==n,Cn=/<.*?>/g;Ge=function(t){this.$=function(t,e){return this.api(!0).$(t,e)},this._=function(t,e){return this.api(!0).rows(t,e).data()},this.api=function(t){return new Ye(t?Ae(this[Je.iApiIndex]):this)},this.fnAddData=function(t,e){var o=this.api(!0),s=i.isArray(t)&&(i.isArray(t[0])||i.isPlainObject(t[0]))?o.rows.add(t):o.row.add(t);return(e===n||e)&&o.draw(),s.flatten().toArray()},this.fnAdjustColumnSizing=function(t){var e=this.api(!0).columns.adjust(),i=e.settings()[0],o=i.oScroll;t===n||t?e.draw(!1):(""!==o.sX||""!==o.sY)&&me(i)},this.fnClearTable=function(t){var e=this.api(!0).clear();(t===n||t)&&e.draw()},this.fnClose=function(t){this.api(!0).row(t).child.hide()},this.fnDeleteRow=function(t,e,i){var o=this.api(!0),s=o.rows(t),a=s.settings()[0],r=a.aoData[s[0][0]];return s.remove(),e&&e.call(this,a,r),(i===n||i)&&o.draw(),r},this.fnDestroy=function(t){this.api(!0).destroy(t)},this.fnDraw=function(t){this.api(!0).draw(!t)},this.fnFilter=function(t,e,i,o,s,a){var r=this.api(!0);null===e||e===n?r.search(t,i,o,a):r.column(e).search(t,i,o,a),r.draw()},this.fnGetData=function(t,e){var i=this.api(!0);if(t!==n){var o=t.nodeName?t.nodeName.toLowerCase():"";return e!==n||"td"==o||"th"==o?i.cell(t,e).data():i.row(t).data()||null}return i.data().toArray()},this.fnGetNodes=function(t){var e=this.api(!0);return t!==n?e.row(t).node():e.rows().nodes().flatten().toArray()},this.fnGetPosition=function(t){var e=this.api(!0),n=t.nodeName.toUpperCase();if("TR"==n)return e.row(t).index();if("TD"==n||"TH"==n){var i=e.cell(t).index();return[i.row,i.columnVisible,i.column]}return null},this.fnIsOpen=function(t){return this.api(!0).row(t).child.isShown()},this.fnOpen=function(t,e,n){return this.api(!0).row(t).child(e,n).show().child()[0]},this.fnPageChange=function(t,e){var i=this.api(!0).page(t);(e===n||e)&&i.draw(!1)},this.fnSetColumnVis=function(t,e,i){var o=this.api(!0).column(t).visible(e);(i===n||i)&&o.columns.adjust().draw()},this.fnSettings=function(){return Ae(this[Je.iApiIndex])},this.fnSort=function(t){this.api(!0).order(t).draw()},this.fnSortListener=function(t,e,n){this.api(!0).order.listener(t,e,n)},this.fnUpdate=function(t,e,i,o,s){var a=this.api(!0);return i===n||null===i?a.row(e).data(t):a.cell(e,i).data(t),(s===n||s)&&a.columns.adjust(),(o===n||o)&&a.draw(),0},this.fnVersionCheck=Je.fnVersionCheck;var e=this,o=t===n,u=this.length;o&&(t={}),this.oApi=this.internal=Je.internal;for(var p in Ge.ext.internal)p&&(this[p]=Xe(p));return this.each(function(){var p,f={},g=u>1?Fe(f,t,!0):t,m=0,v=this.getAttribute("id"),b=!1,x=Ge.defaults;if("table"!=this.nodeName.toLowerCase())return void Pe(null,0,"Non-table node initialisation ("+this.nodeName+")",2);r(x),l(x.column),s(x,x,!0),s(x.column,x.column,!0),s(x,g);var C=Ge.settings;for(m=0,p=C.length;p>m;m++){if(C[m].nTable==this){var S=g.bRetrieve!==n?g.bRetrieve:x.bRetrieve,T=g.bDestroy!==n?g.bDestroy:x.bDestroy;if(o||S)return C[m].oInstance;if(T){C[m].oInstance.fnDestroy();break}return void Pe(C[m],0,"Cannot reinitialise DataTable",3)}if(C[m].sTableId==this.id){C.splice(m,1);break}}(null===v||""===v)&&(v="DataTables_Table_"+Ge.ext._unique++,this.id=v);var D=i.extend(!0,{},Ge.models.oSettings,{nTable:this,oApi:e.internal,oInit:g,sDestroyWidth:i(this)[0].style.width,sInstance:v,sTableId:v});C.push(D),D.oInstance=1===e.length?e:i(this).dataTable(),r(g),g.oLanguage&&a(g.oLanguage),g.aLengthMenu&&!g.iDisplayLength&&(g.iDisplayLength=i.isArray(g.aLengthMenu[0])?g.aLengthMenu[0][0]:g.aLengthMenu[0]),g=Fe(i.extend(!0,{},x),g),Re(D.oFeatures,g,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),Re(D,g,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),Re(D.oScroll,g,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Re(D.oLanguage,g,"fnInfoCallback"),Ve(D,"aoDrawCallback",g.fnDrawCallback,"user"),Ve(D,"aoServerParams",g.fnServerParams,"user"),Ve(D,"aoStateSaveParams",g.fnStateSaveParams,"user"),Ve(D,"aoStateLoadParams",g.fnStateLoadParams,"user"),Ve(D,"aoStateLoaded",g.fnStateLoaded,"user"),Ve(D,"aoRowCallback",g.fnRowCallback,"user"),Ve(D,"aoRowCreatedCallback",g.fnCreatedRow,"user"),Ve(D,"aoHeaderCallback",g.fnHeaderCallback,"user"),Ve(D,"aoFooterCallback",g.fnFooterCallback,"user"),Ve(D,"aoInitComplete",g.fnInitComplete,"user"),Ve(D,"aoPreDrawCallback",g.fnPreDrawCallback,"user");var k=D.oClasses;if(g.bJQueryUI?(i.extend(k,Ge.ext.oJUIClasses,g.oClasses),g.sDom===x.sDom&&"lfrtip"===x.sDom&&(D.sDom='<"H"lfr>t<"F"ip>'),D.renderer?i.isPlainObject(D.renderer)&&!D.renderer.header&&(D.renderer.header="jqueryui"):D.renderer="jqueryui"):i.extend(k,Ge.ext.classes,g.oClasses),i(this).addClass(k.sTable),(""!==D.oScroll.sX||""!==D.oScroll.sY)&&(D.oScroll.iBarWidth=Te()),D.oScroll.sX===!0&&(D.oScroll.sX="100%"),D.iInitDisplayStart===n&&(D.iInitDisplayStart=g.iDisplayStart,D._iDisplayStart=g.iDisplayStart),null!==g.iDeferLoading){D.bDeferLoading=!0;var I=i.isArray(g.iDeferLoading);D._iRecordsDisplay=I?g.iDeferLoading[0]:g.iDeferLoading,D._iRecordsTotal=I?g.iDeferLoading[1]:g.iDeferLoading}""!==g.oLanguage.sUrl?(D.oLanguage.sUrl=g.oLanguage.sUrl,i.getJSON(D.oLanguage.sUrl,null,function(t){a(t),s(x.oLanguage,t),i.extend(!0,D.oLanguage,g.oLanguage,t),re(D)}),b=!0):i.extend(!0,D.oLanguage,g.oLanguage),null===g.asStripeClasses&&(D.asStripeClasses=[k.sStripeOdd,k.sStripeEven]);var M=D.asStripeClasses,L=i("tbody tr:eq(0)",this);-1!==i.inArray(!0,i.map(M,function(t){return L.hasClass(t)}))&&(i("tbody tr",this).removeClass(M.join(" ")),D.asDestroyStripes=M.slice());var j,N=[],O=this.getElementsByTagName("thead");if(0!==O.length&&(B(D.aoHeader,O[0]),N=H(D)),null===g.aoColumns)for(j=[],m=0,p=N.length;p>m;m++)j.push(null);else j=g.aoColumns;for(m=0,p=j.length;p>m;m++)d(D,N?N[m]:null);if(y(D,g.aoColumnDefs,j,function(t,e){h(D,t,e)}),L.length){var A=function(t,e){return t.getAttribute("data-"+e)?e:null};i.each(E(D,L[0]).cells,function(t,e){var i=D.aoColumns[t];if(i.mData===t){var o=A(e,"sort")||A(e,"order"),s=A(e,"filter")||A(e,"search");(null!==o||null!==s)&&(i.mData={_:t+".display",sort:null!==o?t+".@data-"+o:n,type:null!==o?t+".@data-"+o:n,filter:null!==s?t+".@data-"+s:n},h(D,t))}})}var P=D.oFeatures;if(g.bStateSave&&(P.bStateSave=!0,Oe(D,g),Ve(D,"aoDrawCallback",Ee,"state_save")),g.aaSorting===n){var R=D.aaSorting;for(m=0,p=R.length;p>m;m++)R[m][1]=D.aoColumns[m].asSorting[0]}je(D),P.bSort&&Ve(D,"aoDrawCallback",function(){if(D.bSorted){var t=De(D),e={};i.each(t,function(t,n){e[n.src]=n.dir}),Be(D,null,"order",[D,t,e]),Ie(D)}}),Ve(D,"aoDrawCallback",function(){(D.bSorted||"ssp"===$e(D)||P.bDeferRender)&&je(D)},"sc"),c(D);var F=i(this).children("caption").each(function(){this._captionSide=i(this).css("caption-side")}),z=i(this).children("thead");0===z.length&&(z=i("<thead/>").appendTo(this)),D.nTHead=z[0];var V=i(this).children("tbody");0===V.length&&(V=i("<tbody/>").appendTo(this)),D.nTBody=V[0];var W=i(this).children("tfoot");if(0===W.length&&F.length>0&&(""!==D.oScroll.sX||""!==D.oScroll.sY)&&(W=i("<tfoot/>").appendTo(this)),0===W.length||0===W.children().length?i(this).addClass(k.sNoFooter):W.length>0&&(D.nTFoot=W[0],B(D.aoFooter,D.nTFoot)),g.aaData)for(m=0;m<g.aaData.length;m++)w(D,g.aaData[m]);else(D.bDeferLoading||"dom"==$e(D))&&_(D,i(D.nTBody).children("tr"));D.aiDisplay=D.aiDisplayMaster.slice(),D.bInitialised=!0,b===!1&&re(D)}),e=null,this};var Sn=[],Tn=Array.prototype,Dn=function(t){var e,n,o=Ge.settings,s=i.map(o,function(t){return t.nTable});return t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?(e=i.inArray(t,s),-1!==e?[o[e]]:null):t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?n=i(t):t instanceof i&&(n=t),n?n.map(function(){return e=i.inArray(this,s),-1!==e?o[e]:null}).toArray():void 0):[]};Ye=function(t,e){if(!this instanceof Ye)throw"DT API must be constructed as a new object";var n=[],o=function(t){var e=Dn(t);e&&n.push.apply(n,e)};if(i.isArray(t))for(var s=0,a=t.length;a>s;s++)o(t[s]);else o(t);this.context=vn(n),e&&this.push.apply(this,e.toArray?e.toArray():e),this.selector={rows:null,cols:null,opts:null},Ye.extend(this,this,Sn)},Ge.Api=Ye,Ye.prototype={concat:Tn.concat,context:[],each:function(t){for(var e=0,n=this.length;n>e;e++)t.call(this,this[e],e,this);return this},eq:function(t){var e=this.context;return e.length>t?new Ye(e[t],this[t]):null},filter:function(t){var e=[];if(Tn.filter)e=Tn.filter.call(this,t,this);else for(var n=0,i=this.length;i>n;n++)t.call(this,this[n],n,this)&&e.push(this[n]);return new Ye(this.context,e)},flatten:function(){var t=[];return new Ye(this.context,t.concat.apply(t,this.toArray()))},join:Tn.join,indexOf:Tn.indexOf||function(t,e){for(var n=e||0,i=this.length;i>n;n++)if(this[n]===t)return n;return-1},iterator:function(t,e,i){var o,s,a,r,l,c,u,d,h=[],p=this.context,f=this.selector;for("string"==typeof t&&(i=e,e=t,t=!1),s=0,a=p.length;a>s;s++){var g=new Ye(p[s]);if("table"===e)o=i.call(g,p[s],s),o!==n&&h.push(o);else if("columns"===e||"rows"===e)o=i.call(g,p[s],this[s],s),o!==n&&h.push(o);else if("column"===e||"column-rows"===e||"row"===e||"cell"===e)for(u=this[s],"column-rows"===e&&(c=Nn(p[s],f.opts)),r=0,l=u.length;l>r;r++)d=u[r],o="cell"===e?i.call(g,p[s],d.row,d.column,s,r):i.call(g,p[s],d,s,r,c),o!==n&&h.push(o)}if(h.length){var m=new Ye(p,t?h.concat.apply([],h):h),v=m.selector;return v.rows=f.rows,v.cols=f.cols,v.opts=f.opts,m}return this},lastIndexOf:Tn.lastIndexOf||function(){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(t){var e=[];if(Tn.map)e=Tn.map.call(this,t,this);else for(var n=0,i=this.length;i>n;n++)e.push(t.call(this,this[n],n));return new Ye(this.context,e)},pluck:function(t){return this.map(function(e){return e[t]})},pop:Tn.pop,push:Tn.push,reduce:Tn.reduce||function(t,e){return u(this,t,e,0,this.length,1)},reduceRight:Tn.reduceRight||function(t,e){return u(this,t,e,this.length-1,-1,-1)},reverse:Tn.reverse,selector:null,shift:Tn.shift,sort:Tn.sort,splice:Tn.splice,toArray:function(){return Tn.slice.call(this)},to$:function(){return i(this)},toJQuery:function(){return i(this)},unique:function(){return new Ye(this.context,vn(this))},unshift:Tn.unshift},Ye.extend=function(t,e,n){if(e&&(e instanceof Ye||e.__dt_wrapper)){var o,s,a,r=function(t,e,n){return function(){var i=e.apply(t,arguments);return Ye.extend(i,i,n.methodExt),i}};for(o=0,s=n.length;s>o;o++)a=n[o],e[a.name]="function"==typeof a.val?r(t,a.val,a):i.isPlainObject(a.val)?{}:a.val,e[a.name].__dt_wrapper=!0,Ye.extend(t,e[a.name],a.propExt)}},Ye.register=Ke=function(t,e){if(i.isArray(t))for(var n=0,o=t.length;o>n;n++)Ye.register(t[n],e);else{var s,a,r,l,c=t.split("."),u=Sn,d=function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n].name===e)return t[n];return null};for(s=0,a=c.length;a>s;s++){l=-1!==c[s].indexOf("()"),r=l?c[s].replace("()",""):c[s];var h=d(u,r);h||(h={name:r,val:{},methodExt:[],propExt:[]},u.push(h)),s===a-1?h.val=e:u=l?h.methodExt:h.propExt}}},Ye.registerPlural=Qe=function(t,e,o){Ye.register(t,o),Ye.register(e,function(){var t=o.apply(this,arguments);return t===this?this:t instanceof Ye?t.length?i.isArray(t[0])?new Ye(t.context,t[0]):t[0]:n:t})};var kn=function(t,e){if("number"==typeof t)return[e[t]];var n=i.map(e,function(t){return t.nTable});return i(n).filter(t).map(function(){var t=i.inArray(this,n);return e[t]}).toArray()};Ke("tables()",function(t){return t?new Ye(kn(t,this.context)):this}),Ke("table()",function(t){var e=this.tables(t),n=e.context;return n.length?new Ye(n[0]):e}),Qe("tables().nodes()","table().node()",function(){return this.iterator("table",function(t){return t.nTable})}),Qe("tables().body()","table().body()",function(){return this.iterator("table",function(t){return t.nTBody})}),Qe("tables().header()","table().header()",function(){return this.iterator("table",function(t){return t.nTHead})}),Qe("tables().footer()","table().footer()",function(){return this.iterator("table",function(t){return t.nTFoot})}),Qe("tables().containers()","table().container()",function(){return this.iterator("table",function(t){return t.nTableWrapper})}),Ke("draw()",function(t){return this.iterator("table",function(e){z(e,t===!1)})}),Ke("page()",function(t){return t===n?this.page.info().page:this.iterator("table",function(e){he(e,t)})}),Ke("page.info()",function(){if(0===this.context.length)return n;var t=this.context[0],e=t._iDisplayStart,i=t._iDisplayLength,o=t.fnRecordsDisplay(),s=-1===i;return{page:s?0:Math.floor(e/i),pages:s?1:Math.ceil(o/i),start:e,end:t.fnDisplayEnd(),length:i,recordsTotal:t.fnRecordsTotal(),recordsDisplay:o}}),Ke("page.len()",function(t){return t===n?0!==this.context.length?this.context[0]._iDisplayLength:n:this.iterator("table",function(e){ce(e,t)})});var In=function(t,e,n){if("ssp"==$e(t)?z(t,e):(fe(t,!0),W(t,[],function(n){L(t);for(var i=X(t,n),o=0,s=i.length;s>o;o++)w(t,i[o]);z(t,e),fe(t,!1)})),n){var i=new Ye(t);i.one("draw",function(){n(i.ajax.json())})}};Ke("ajax.json()",function(){var t=this.context;return t.length>0?t[0].json:void 0}),Ke("ajax.params()",function(){var t=this.context;return t.length>0?t[0].oAjaxData:void 0}),Ke("ajax.reload()",function(t,e){return this.iterator("table",function(n){In(n,e===!1,t)})}),Ke("ajax.url()",function(t){var e=this.context;return t===n?0===e.length?n:(e=e[0],e.ajax?i.isPlainObject(e.ajax)?e.ajax.url:e.ajax:e.sAjaxSource):this.iterator("table",function(e){i.isPlainObject(e.ajax)?e.ajax.url=t:e.ajax=t})}),Ke("ajax.url().load()",function(t,e){return this.iterator("table",function(n){In(n,e===!1,t)})});var Mn=function(t,e){var o,s,a,r,l,c,u=[],d=typeof t;for(t&&"string"!==d&&"function"!==d&&t.length!==n||(t=[t]),a=0,r=t.length;r>a;a++)for(s=t[a]&&t[a].split?t[a].split(","):[t[a]],l=0,c=s.length;c>l;l++)o=e("string"==typeof s[l]?i.trim(s[l]):s[l]),o&&o.length&&u.push.apply(u,o);return u},Ln=function(t){return t||(t={}),t.filter&&!t.search&&(t.search=t.filter),{search:t.search||"none",order:t.order||"current",page:t.page||"all"}
},jn=function(t){for(var e=0,n=t.length;n>e;e++)if(t[e].length>0)return t[0]=t[e],t.length=1,t.context=[t.context[e]],t;return t.length=0,t},Nn=function(t,e){var n,o,s,a=[],r=t.aiDisplay,l=t.aiDisplayMaster,c=e.search,u=e.order,d=e.page;if("ssp"==$e(t))return"removed"===c?[]:gn(0,l.length);if("current"==d)for(n=t._iDisplayStart,o=t.fnDisplayEnd();o>n;n++)a.push(r[n]);else if("current"==u||"applied"==u)a="none"==c?l.slice():"applied"==c?r.slice():i.map(l,function(t){return-1===i.inArray(t,r)?t:null});else if("index"==u||"original"==u)for(n=0,o=t.aoData.length;o>n;n++)"none"==c?a.push(n):(s=i.inArray(n,r),(-1===s&&"removed"==c||s>=0&&"applied"==c)&&a.push(n));return a},En=function(t,e,n){return Mn(e,function(e){var o=ln(e);if(null!==o&&!n)return[o];var s=Nn(t,n);if(null!==o&&-1!==i.inArray(o,s))return[o];if(!e)return s;var a=fn(t.aoData,s,"nTr");return"function"==typeof e?i.map(s,function(n){var i=t.aoData[n];return e(n,i._aData,i.nTr)?n:null}):e.nodeName&&-1!==i.inArray(e,a)?[e._DT_RowIndex]:i(a).filter(e).map(function(){return this._DT_RowIndex}).toArray()})};Ke("rows()",function(t,e){t===n?t="":i.isPlainObject(t)&&(e=t,t=""),e=Ln(e);var o=this.iterator("table",function(n){return En(n,t,e)});return o.selector.rows=t,o.selector.opts=e,o}),Ke("rows().nodes()",function(){return this.iterator("row",function(t,e){return t.aoData[e].nTr||n})}),Ke("rows().data()",function(){return this.iterator(!0,"rows",function(t,e){return fn(t.aoData,e,"_aData")})}),Qe("rows().cache()","row().cache()",function(t){return this.iterator("row",function(e,n){var i=e.aoData[n];return"search"===t?i._aFilterData:i._aSortData})}),Qe("rows().invalidate()","row().invalidate()",function(t){return this.iterator("row",function(e,n){N(e,n,t)})}),Qe("rows().indexes()","row().index()",function(){return this.iterator("row",function(t,e){return e})}),Qe("rows().remove()","row().remove()",function(){var t=this;return this.iterator("row",function(e,n,o){var s=e.aoData;s.splice(n,1);for(var a=0,r=s.length;r>a;a++)null!==s[a].nTr&&(s[a].nTr._DT_RowIndex=a);i.inArray(n,e.aiDisplay);j(e.aiDisplayMaster,n),j(e.aiDisplay,n),j(t[o],n,!1),He(e)})}),Ke("rows.add()",function(t){var e=this.iterator("table",function(e){var n,i,o,s=[];for(i=0,o=t.length;o>i;i++)n=t[i],s.push(n.nodeName&&"TR"===n.nodeName.toUpperCase()?_(e,n)[0]:w(e,n));return s}),n=this.rows(-1);return n.pop(),n.push.apply(n,e.toArray()),n}),Ke("row()",function(t,e){return jn(this.rows(t,e))}),Ke("row().data()",function(t){var e=this.context;return t===n?e.length&&this.length?e[0].aoData[this[0]]._aData:n:(e[0].aoData[this[0]]._aData=t,N(e[0],this[0],"data"),this)}),Ke("row().node()",function(){var t=this.context;return t.length&&this.length?t[0].aoData[this[0]].nTr||null:null}),Ke("row.add()",function(t){t instanceof i&&t.length&&(t=t[0]);var e=this.iterator("table",function(e){return t.nodeName&&"TR"===t.nodeName.toUpperCase()?_(e,t)[0]:w(e,t)});return this.row(e[0])});var On=function(t,e,n,o){var s=[],a=function(e,n){if(e.nodeName&&"tr"===e.nodeName.toLowerCase())s.push(e);else{var o=i("<tr><td/></tr>").addClass(n);i("td",o).addClass(n).html(e)[0].colSpan=m(t),s.push(o[0])}};if(i.isArray(n)||n instanceof i)for(var r=0,l=n.length;l>r;r++)a(n[r],o);else a(n,o);e._details&&e._details.remove(),e._details=i(s),e._detailsShow&&e._details.insertAfter(e.nTr)},An=function(t,e){var i=t.context;if(i.length){var o=i[0].aoData[e!==n?e:t[0]];o._details&&(o._details.remove(),o._detailsShow=n,o._details=n)}},Pn=function(t,e){var n=t.context;if(n.length&&t.length){var i=n[0].aoData[t[0]];i._details&&(i._detailsShow=e,e?i._details.insertAfter(i.nTr):i._details.detach(),Rn(n[0]))}},Rn=function(t){var e=new Ye(t),n=".dt.DT_details",i="draw"+n,o="column-visibility"+n,s="destroy"+n,a=t.aoData;e.off(i+" "+o+" "+s),pn(a,"_details").length>0&&(e.on(i,function(n,i){t===i&&e.rows({page:"current"}).eq(0).each(function(t){var e=a[t];e._detailsShow&&e._details.insertAfter(e.nTr)})}),e.on(o,function(e,n){if(t===n)for(var i,o=m(n),s=0,r=a.length;r>s;s++)i=a[s],i._details&&i._details.children("td[colspan]").attr("colspan",o)}),e.on(s,function(n,i){if(t===i)for(var o=0,s=a.length;s>o;o++)a[o]._details&&An(e,o)}))},Fn="",zn=Fn+"row().child",Vn=zn+"()";Ke(Vn,function(t,e){var i=this.context;return t===n?i.length&&this.length?i[0].aoData[this[0]]._details:n:(t===!0?this.child.show():t===!1?An(this):i.length&&this.length&&On(i[0],i[0].aoData[this[0]],t,e),this)}),Ke([zn+".show()",Vn+".show()"],function(){return Pn(this,!0),this}),Ke([zn+".hide()",Vn+".hide()"],function(){return Pn(this,!1),this}),Ke([zn+".remove()",Vn+".remove()"],function(){return An(this),this}),Ke(zn+".isShown()",function(){var t=this.context;return t.length&&this.length?t[0].aoData[this[0]]._detailsShow||!1:!1});var Bn=/^(.+):(name|visIdx|visible)$/,Hn=function(t,e,n,i,o){for(var s=[],a=0,r=o.length;r>a;a++)s.push(S(t,o[a],e));return s},Wn=function(t,e,n){var o=t.aoColumns,s=pn(o,"sName"),a=pn(o,"nTh");return Mn(e,function(e){var r=ln(e);if(""===e)return gn(o.length);if(null!==r)return[r>=0?r:o.length+r];if("function"==typeof e){var l=Nn(t,n);return i.map(o,function(n,i){return e(i,Hn(t,i,0,0,l),a[i])?i:null})}var c="string"==typeof e?e.match(Bn):"";if(!c)return i(a).filter(e).map(function(){return i.inArray(this,a)}).toArray();switch(c[2]){case"visIdx":case"visible":var u=parseInt(c[1],10);if(0>u){var d=i.map(o,function(t,e){return t.bVisible?e:null});return[d[d.length+u]]}return[f(t,u)];case"name":return i.map(s,function(t,e){return t===c[1]?e:null})}})},$n=function(t,e,o,s){var a,r,l,c,u=t.aoColumns,d=u[e],h=t.aoData;if(o===n)return d.bVisible;if(d.bVisible!==o){if(o){var f=i.inArray(!0,pn(u,"bVisible"),e+1);for(r=0,l=h.length;l>r;r++)c=h[r].nTr,a=h[r].anCells,c&&c.insertBefore(a[e],a[f]||null)}else i(pn(t.aoData,"anCells",e)).detach();d.bVisible=o,R(t,t.aoHeader),R(t,t.aoFooter),(s===n||s)&&(p(t),(t.oScroll.sX||t.oScroll.sY)&&me(t)),Be(t,null,"column-visibility",[t,e,o]),Ee(t)}};Ke("columns()",function(t,e){t===n?t="":i.isPlainObject(t)&&(e=t,t=""),e=Ln(e);var o=this.iterator("table",function(n){return Wn(n,t,e)});return o.selector.cols=t,o.selector.opts=e,o}),Qe("columns().header()","column().header()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].nTh})}),Qe("columns().footer()","column().footer()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].nTf})}),Qe("columns().data()","column().data()",function(){return this.iterator("column-rows",Hn)}),Qe("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].mData})}),Qe("columns().cache()","column().cache()",function(t){return this.iterator("column-rows",function(e,n,i,o,s){return fn(e.aoData,s,"search"===t?"_aFilterData":"_aSortData",n)})}),Qe("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(t,e,n,i,o){return fn(t.aoData,o,"anCells",e)})}),Qe("columns().visible()","column().visible()",function(t,e){return this.iterator("column",function(i,o){return t===n?i.aoColumns[o].bVisible:$n(i,o,t,e)})}),Qe("columns().indexes()","column().index()",function(t){return this.iterator("column",function(e,n){return"visible"===t?g(e,n):n})}),Ke("columns.adjust()",function(){return this.iterator("table",function(t){p(t)})}),Ke("column.index()",function(t,e){if(0!==this.context.length){var n=this.context[0];if("fromVisible"===t||"toData"===t)return f(n,e);if("fromData"===t||"toVisible"===t)return g(n,e)}}),Ke("column()",function(t,e){return jn(this.columns(t,e))});var qn=function(t,e,o){var s,a,r,l,c,u,d,h=t.aoData,p=Nn(t,o),f=fn(h,p,"anCells"),g=i([].concat.apply([],f)),m=t.aoColumns.length;return Mn(e,function(e){var o="function"==typeof e;if(null===e||e===n||o){for(a=[],r=0,l=p.length;l>r;r++)for(s=p[r],c=0;m>c;c++)u={row:s,column:c},o?(d=t.aoData[s],e(u,S(t,s,c),d.anCells[c])&&a.push(u)):a.push(u);return a}return i.isPlainObject(e)?[e]:g.filter(e).map(function(t,e){return s=e.parentNode._DT_RowIndex,{row:s,column:i.inArray(e,h[s].anCells)}}).toArray()})};Ke("cells()",function(t,e,o){if(i.isPlainObject(t)&&(typeof t.row!==n?(o=e,e=null):(o=t,t=null)),i.isPlainObject(e)&&(o=e,e=null),null===e||e===n)return this.iterator("table",function(e){return qn(e,t,Ln(o))});var s,a,r,l,c,u=this.columns(e,o),d=this.rows(t,o),h=this.iterator("table",function(t,e){for(s=[],a=0,r=d[e].length;r>a;a++)for(l=0,c=u[e].length;c>l;l++)s.push({row:d[e][a],column:u[e][l]});return s});return i.extend(h.selector,{cols:e,rows:t,opts:o}),h}),Qe("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(t,e,n){return t.aoData[e].anCells[n]})}),Ke("cells().data()",function(){return this.iterator("cell",function(t,e,n){return S(t,e,n)})}),Qe("cells().cache()","cell().cache()",function(t){return t="search"===t?"_aFilterData":"_aSortData",this.iterator("cell",function(e,n,i){return e.aoData[n][t][i]})}),Qe("cells().render()","cell().render()",function(t){return this.iterator("cell",function(e,n,i){return S(e,n,i,t)})}),Qe("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(t,e,n){return{row:e,column:n,columnVisible:g(t,n)}})}),Ke(["cells().invalidate()","cell().invalidate()"],function(t){var e=this.selector;return this.rows(e.rows,e.opts).invalidate(t),this}),Ke("cell()",function(t,e,n){return jn(this.cells(t,e,n))}),Ke("cell().data()",function(t){var e=this.context,i=this[0];return t===n?e.length&&i.length?S(e[0],i[0].row,i[0].column):n:(T(e[0],i[0].row,i[0].column,t),N(e[0],i[0].row,"data",i[0].column),this)}),Ke("order()",function(t,e){var o=this.context;return t===n?0!==o.length?o[0].aaSorting:n:("number"==typeof t?t=[[t,e]]:i.isArray(t[0])||(t=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=t.slice()}))}),Ke("order.listener()",function(t,e,n){return this.iterator("table",function(i){Le(i,t,e,n)})}),Ke(["columns().order()","column().order()"],function(t){var e=this;return this.iterator("table",function(n,o){var s=[];i.each(e[o],function(e,n){s.push([n,t])}),n.aaSorting=s})}),Ke("search()",function(t,e,o,s){var a=this.context;return t===n?0!==a.length?a[0].oPreviousSearch.sSearch:n:this.iterator("table",function(n){n.oFeatures.bFilter&&J(n,i.extend({},n.oPreviousSearch,{sSearch:t+"",bRegex:null===e?!1:e,bSmart:null===o?!0:o,bCaseInsensitive:null===s?!0:s}),1)})}),Qe("columns().search()","column().search()",function(t,e,o,s){return this.iterator("column",function(a,r){var l=a.aoPreSearchCols;return t===n?l[r].sSearch:void(a.oFeatures.bFilter&&(i.extend(l[r],{sSearch:t+"",bRegex:null===e?!1:e,bSmart:null===o?!0:o,bCaseInsensitive:null===s?!0:s}),J(a,a.oPreviousSearch,1)))})}),Ke("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Ke("state.clear()",function(){return this.iterator("table",function(t){t.fnStateSaveCallback.call(t.oInstance,t,{})})}),Ke("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Ke("state.save()",function(){return this.iterator("table",function(t){Ee(t)})}),Ge.versionCheck=Ge.fnVersionCheck=function(t){for(var e,n,i=Ge.version.split("."),o=t.split("."),s=0,a=o.length;a>s;s++)if(e=parseInt(i[s],10)||0,n=parseInt(o[s],10)||0,e!==n)return e>n;return!0},Ge.isDataTable=Ge.fnIsDataTable=function(t){var e=i(t).get(0),n=!1;return i.each(Ge.settings,function(t,i){(i.nTable===e||i.nScrollHead===e||i.nScrollFoot===e)&&(n=!0)}),n},Ge.tables=Ge.fnTables=function(t){return jQuery.map(Ge.settings,function(e){return!t||t&&i(e.nTable).is(":visible")?e.nTable:void 0})},Ge.util={throttle:ye},Ge.camelToHungarian=s,Ke("$()",function(t,e){var n=this.rows(e).nodes(),o=i(n);return i([].concat(o.filter(t).toArray(),o.find(t).toArray()))}),i.each(["on","one","off"],function(t,e){Ke(e+"()",function(){var t=Array.prototype.slice.call(arguments);t[0].match(/\.dt\b/)||(t[0]+=".dt");var n=i(this.tables().nodes());return n[e].apply(n,t),this})}),Ke("clear()",function(){return this.iterator("table",function(t){L(t)})}),Ke("settings()",function(){return new Ye(this.context,this.context)}),Ke("data()",function(){return this.iterator("table",function(t){return pn(t.aoData,"_aData")}).flatten()}),Ke("destroy()",function(e){return e=e||!1,this.iterator("table",function(n){var o,s=n.nTableWrapper.parentNode,a=n.oClasses,r=n.nTable,l=n.nTBody,c=n.nTHead,u=n.nTFoot,d=i(r),h=i(l),p=i(n.nTableWrapper),f=i.map(n.aoData,function(t){return t.nTr});n.bDestroying=!0,Be(n,"aoDestroyCallback","destroy",[n]),e||new Ye(n).columns().visible(!0),p.unbind(".DT").find(":not(tbody *)").unbind(".DT"),i(t).unbind(".DT-"+n.sInstance),r!=c.parentNode&&(d.children("thead").detach(),d.append(c)),u&&r!=u.parentNode&&(d.children("tfoot").detach(),d.append(u)),d.detach(),p.detach(),n.aaSorting=[],n.aaSortingFixed=[],je(n),i(f).removeClass(n.asStripeClasses.join(" ")),i("th, td",c).removeClass(a.sSortable+" "+a.sSortableAsc+" "+a.sSortableDesc+" "+a.sSortableNone),n.bJUI&&(i("th span."+a.sSortIcon+", td span."+a.sSortIcon,c).detach(),i("th, td",c).each(function(){var t=i("div."+a.sSortJUIWrapper,this);i(this).append(t.contents()),t.detach()})),!e&&s&&s.insertBefore(r,n.nTableReinsertBefore),h.children().detach(),h.append(f),d.css("width",n.sDestroyWidth).removeClass(a.sTable),o=n.asDestroyStripes.length,o&&h.children().each(function(t){i(this).addClass(n.asDestroyStripes[t%o])});var g=i.inArray(n,Ge.settings);-1!==g&&Ge.settings.splice(g,1)})}),Ge.version="1.10.3",Ge.settings=[],Ge.models={},Ge.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},Ge.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null},Ge.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},Ge.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(t){try{return JSON.parse((-1===t.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+t.sInstance+"_"+location.pathname))}catch(e){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(t,e){try{(-1===t.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+t.sInstance+"_"+location.pathname,JSON.stringify(e))}catch(n){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:i.extend({},Ge.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null},o(Ge.defaults),Ge.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},o(Ge.defaults.column),Ge.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:n,oAjaxData:n,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==$e(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==$e(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var t=this._iDisplayLength,e=this._iDisplayStart,n=e+t,i=this.aiDisplay.length,o=this.oFeatures,s=o.bPaginate;return o.bServerSide?s===!1||-1===t?e+i:Math.min(e+t,this._iRecordsDisplay):!s||n>i||-1===t?i:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}},Ge.ext=Je={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:Ge.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:Ge.version},i.extend(Je,{afnFiltering:Je.search,aTypes:Je.type.detect,ofnSearch:Je.type.search,oSort:Je.type.order,afnSortData:Je.order,aoFeatures:Je.feature,oApi:Je.internal,oStdClasses:Je.classes,oPagination:Je.pager}),i.extend(Ge.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),function(){var t="";t="";var e=t+"ui-state-default",n=t+"css_right ui-icon ui-icon-",o=t+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";i.extend(Ge.ext.oJUIClasses,Ge.ext.classes,{sPageButton:"fg-button ui-button "+e,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:e+" sorting_asc",sSortDesc:e+" sorting_desc",sSortable:e+" sorting",sSortableAsc:e+" sorting_asc_disabled",sSortableDesc:e+" sorting_desc_disabled",sSortableNone:e+" sorting_disabled",sSortJUIAsc:n+"triangle-1-n",sSortJUIDesc:n+"triangle-1-s",sSortJUI:n+"carat-2-n-s",sSortJUIAscAllowed:n+"carat-1-n",sSortJUIDescAllowed:n+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+e,sScrollFoot:"dataTables_scrollFoot "+e,sHeaderTH:e,sFooterTH:e,sJUIHeader:o+" ui-corner-tl ui-corner-tr",sJUIFooter:o+" ui-corner-bl ui-corner-br"})}();var Un=Ge.ext.pager;i.extend(Un,{simple:function(){return["previous","next"]},full:function(){return["first","previous","next","last"]},simple_numbers:function(t,e){return["previous",qe(t,e),"next"]},full_numbers:function(t,e){return["first","previous",qe(t,e),"next","last"]},_numbers:qe,numbers_length:7}),i.extend(!0,Ge.ext.renderer,{pageButton:{_:function(t,n,o,s,a,r){var l,c,u=t.oClasses,d=t.oLanguage.oPaginate,h=0,p=function(e,n){var s,f,g,m,v=function(e){he(t,e.data.action,!0)};for(s=0,f=n.length;f>s;s++)if(m=n[s],i.isArray(m)){var b=i("<"+(m.DT_el||"div")+"/>").appendTo(e);p(b,m)}else{switch(l="",c="",m){case"ellipsis":e.append("<span>&hellip;</span>");break;case"first":l=d.sFirst,c=m+(a>0?"":" "+u.sPageButtonDisabled);break;case"previous":l=d.sPrevious,c=m+(a>0?"":" "+u.sPageButtonDisabled);break;case"next":l=d.sNext,c=m+(r-1>a?"":" "+u.sPageButtonDisabled);break;case"last":l=d.sLast,c=m+(r-1>a?"":" "+u.sPageButtonDisabled);break;default:l=m+1,c=a===m?u.sPageButtonActive:""}l&&(g=i("<a>",{"class":u.sPageButton+" "+c,"aria-controls":t.sTableId,"data-dt-idx":h,tabindex:t.iTabIndex,id:0===o&&"string"==typeof m?t.sTableId+"_"+m:null}).html(l).appendTo(e),ze(g,{action:m},v),h++)}};try{var f=i(e.activeElement).data("dt-idx");p(i(n).empty(),s),null!==f&&i(n).find("[data-dt-idx="+f+"]").focus()}catch(g){}}}});var Xn=function(t,e,n,i){return 0===t||t&&"-"!==t?(e&&(t=cn(t,e)),t.replace&&(n&&(t=t.replace(n,"")),i&&(t=t.replace(i,""))),1*t):-1/0};return i.extend(Je.type.order,{"date-pre":function(t){return Date.parse(t)||0},"html-pre":function(t){return rn(t)?"":t.replace?t.replace(/<.*?>/g,"").toLowerCase():t+""},"string-pre":function(t){return rn(t)?"":"string"==typeof t?t.toLowerCase():t.toString?t.toString():""},"string-asc":function(t,e){return e>t?-1:t>e?1:0},"string-desc":function(t,e){return e>t?1:t>e?-1:0}}),Ue(""),i.extend(Ge.ext.type.detect,[function(t,e){var n=e.oLanguage.sDecimal;return un(t,n)?"num"+n:null},function(t){if(!(!t||t instanceof Date||nn.test(t)&&on.test(t)))return null;var e=Date.parse(t);return null!==e&&!isNaN(e)||rn(t)?"date":null},function(t,e){var n=e.oLanguage.sDecimal;return un(t,n,!0)?"num-fmt"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return hn(t,n)?"html-num"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return hn(t,n,!0)?"html-num-fmt"+n:null},function(t){return rn(t)||"string"==typeof t&&-1!==t.indexOf("<")?"html":null}]),i.extend(Ge.ext.type.search,{html:function(t){return rn(t)?t:"string"==typeof t?t.replace(tn," ").replace(en,""):""},string:function(t){return rn(t)?t:"string"==typeof t?t.replace(tn," "):t}}),i.extend(!0,Ge.ext.renderer,{header:{_:function(t,e,n,o){i(t.nTable).on("order.dt.DT",function(i,s,a,r){if(t===s){var l=n.idx;e.removeClass(n.sSortingClass+" "+o.sSortAsc+" "+o.sSortDesc).addClass("asc"==r[l]?o.sSortAsc:"desc"==r[l]?o.sSortDesc:n.sSortingClass)}})},jqueryui:function(t,e,n,o){i("<div/>").addClass(o.sSortJUIWrapper).append(e.contents()).append(i("<span/>").addClass(o.sSortIcon+" "+n.sSortingClassJUI)).appendTo(e),i(t.nTable).on("order.dt.DT",function(i,s,a,r){if(t===s){var l=n.idx;e.removeClass(o.sSortAsc+" "+o.sSortDesc).addClass("asc"==r[l]?o.sSortAsc:"desc"==r[l]?o.sSortDesc:n.sSortingClass),e.find("span."+o.sSortIcon).removeClass(o.sSortJUIAsc+" "+o.sSortJUIDesc+" "+o.sSortJUI+" "+o.sSortJUIAscAllowed+" "+o.sSortJUIDescAllowed).addClass("asc"==r[l]?o.sSortJUIAsc:"desc"==r[l]?o.sSortJUIDesc:n.sSortingClassJUI)}})}}}),Ge.render={number:function(t,e,n,i){return{display:function(o){var s=0>o?"-":"";o=Math.abs(parseFloat(o));var a=parseInt(o,10),r=n?e+(o-a).toFixed(n).substring(2):"";return s+(i||"")+a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,t)+r}}}},i.extend(Ge.ext.internal,{_fnExternApiFunc:Xe,_fnBuildAjax:W,_fnAjaxUpdate:$,_fnAjaxParameters:q,_fnAjaxUpdateDraw:U,_fnAjaxDataSrc:X,_fnAddColumn:d,_fnColumnOptions:h,_fnAdjustColumnSizing:p,_fnVisibleToColumnIndex:f,_fnColumnIndexToVisible:g,_fnVisbleColumns:m,_fnGetColumns:v,_fnColumnTypes:b,_fnApplyColumnDefs:y,_fnHungarianMap:o,_fnCamelToHungarian:s,_fnLanguageCompat:a,_fnBrowserDetect:c,_fnAddData:w,_fnAddTr:_,_fnNodeToDataIndex:x,_fnNodeToColumnIndex:C,_fnGetCellData:S,_fnSetCellData:T,_fnSplitObjNotation:D,_fnGetObjectDataFn:k,_fnSetObjectDataFn:I,_fnGetDataMaster:M,_fnClearTable:L,_fnDeleteIndex:j,_fnInvalidateRow:N,_fnGetRowElements:E,_fnCreateTr:O,_fnBuildHead:P,_fnDrawHead:R,_fnDraw:F,_fnReDraw:z,_fnAddOptionsHtml:V,_fnDetectHeader:B,_fnGetUniqueThs:H,_fnFeatureHtmlFilter:G,_fnFilterComplete:J,_fnFilterCustom:Y,_fnFilterColumn:K,_fnFilter:Q,_fnFilterCreateSearch:Z,_fnEscapeRegex:te,_fnFilterData:ee,_fnFeatureHtmlInfo:oe,_fnUpdateInfo:se,_fnInfoMacros:ae,_fnInitialise:re,_fnInitComplete:le,_fnLengthChange:ce,_fnFeatureHtmlLength:ue,_fnFeatureHtmlPaginate:de,_fnPageChange:he,_fnFeatureHtmlProcessing:pe,_fnProcessingDisplay:fe,_fnFeatureHtmlTable:ge,_fnScrollDraw:me,_fnApplyToChildren:ve,_fnCalculateColumnWidths:be,_fnThrottle:ye,_fnConvertToWidth:we,_fnScrollingWidthAdjust:_e,_fnGetWidestNode:xe,_fnGetMaxLenString:Ce,_fnStringToCss:Se,_fnScrollBarWidth:Te,_fnSortFlatten:De,_fnSort:ke,_fnSortAria:Ie,_fnSortListener:Me,_fnSortAttachListener:Le,_fnSortingClasses:je,_fnSortData:Ne,_fnSaveState:Ee,_fnLoadState:Oe,_fnSettingsFromNode:Ae,_fnLog:Pe,_fnMap:Re,_fnBindAction:ze,_fnCallbackReg:Ve,_fnCallbackFire:Be,_fnLengthOverflow:He,_fnRenderer:We,_fnDataSource:$e,_fnRowAttributes:A,_fnCalculateEnd:function(){}}),i.fn.dataTable=Ge,i.fn.dataTableSettings=Ge.settings,i.fn.dataTableExt=Ge.ext,i.fn.DataTable=function(t){return i(this).dataTable(t).api()},i.each(Ge,function(t,e){i.fn.DataTable[t]=e}),i.fn.dataTable})}(window,document),define("datatables-bootstrap",["jquery","datatables"],function(t){t.fn.dataTableExt.oApi.fnPagingInfo=function(t){return{iStart:t._iDisplayStart,iEnd:t.fnDisplayEnd(),iLength:t._iDisplayLength,iTotal:t.fnRecordsTotal(),iFilteredTotal:t.fnRecordsDisplay(),iPage:Math.ceil(t._iDisplayStart/t._iDisplayLength),iTotalPages:Math.ceil(t.fnRecordsDisplay()/t._iDisplayLength)}},t.extend(t.fn.dataTableExt.oPagination,{bootstrap:{fnInit:function(t,e,n){var i=t.oLanguage.oPaginate,o=function(e){e.preventDefault(),t.oApi._fnPageChange(t,e.data.action)&&n(t)};jQuery(e).append('<ul class="pagination pagination-sm remove-margin"><li class="prev disabled"><a href="javascript:void(0)"><i class="fa fa-chevron-left"></i> '+i.sPrevious+'</a></li><li class="next disabled"><a href="javascript:void(0)">'+i.sNext+' <i class="fa fa-chevron-right"></i></a></li></ul>');var s=jQuery("a",e);jQuery(s[0]).bind("click.DT",{action:"previous"},o),jQuery(s[1]).bind("click.DT",{action:"next"},o)},fnUpdate:function(t,e){var n,i,o,s,a,r=5,l=t.oInstance.fnPagingInfo(),c=t.aanFeatures.p,u=Math.floor(r/2);for(l.iTotalPages<r?(s=1,a=l.iTotalPages):l.iPage<=u?(s=1,a=r):l.iPage>=l.iTotalPages-u?(s=l.iTotalPages-r+1,a=l.iTotalPages):(s=l.iPage-u+1,a=s+r-1),n=0,iLen=c.length;iLen>n;n++){for(jQuery("li:gt(0)",c[n]).filter(":not(:last)").remove(),i=s;a>=i;i++)o=i===l.iPage+1?'class="active"':"",jQuery("<li "+o+'><a href="javascript:void(0)">'+i+"</a></li>").insertBefore(jQuery("li:last",c[n])[0]).bind("click",function(n){n.preventDefault(),t._iDisplayStart=(parseInt(jQuery("a",this).text(),10)-1)*l.iLength,e(t)});0===l.iPage?jQuery("li:first",c[n]).addClass("disabled"):jQuery("li:first",c[n]).removeClass("disabled"),l.iPage===l.iTotalPages-1||0===l.iTotalPages?jQuery("li:last",c[n]).addClass("disabled"):jQuery("li:last",c[n]).removeClass("disabled")}}}}),t.extend(!0,t.fn.dataTable.defaults,{sDom:"<'row'<'col-sm-6 col-xs-5'l><'col-sm-6 col-xs-7'f>r>t<'row'<'col-sm-5 hidden-xs'i><'col-sm-7 col-xs-12 clearfix'p>>",sPaginationType:"bootstrap",oLanguage:{sLengthMenu:"_MENU_",sSearch:'<div class="input-group">_INPUT_<span class="input-group-addon"><i class="fa fa-search"></i></span></div>',sInfo:"<strong>_START_</strong>-<strong>_END_</strong> of <strong>_TOTAL_</strong>",oPaginate:{sPrevious:"",sNext:""}}})}),define("common/common_views",["app","common/entities","ouiresolver","util","common/server","common/local_storage","datatables-bootstrap"],function(t,e,n,i,o,s){return t.module("Common.Views",function(t,a,r,l,c,u){t.FloorplanMap=l.Object.extend({parentView:null,map:null,$gmapDiv:null,currLevelId:0/0,preferredLevelId:null,levelChangeFn:null,localStorageId:void 0,firstZoomChanged:!0,_floorplanObjs:[],_activeFps:[],_cachedFps:{},_localStorage:{},initialize:function(){var t=this;log.info("Floorplan map Object initialized"),this.$gmapDiv=this.options.$gmapDiv,this.parentView=this.options.parentView,this.options.levels=this.options.levels||new e.LevelCollection,this.options.floorplans=this.options.floorplans||new e.FloorplanCollection,void 0===this.options.autoReposition&&(this.options.autoReposition=!0),void 0!=this.options.preferredLevelId&&(this.preferredLevelId=this.options.preferredLevelId),void 0!=this.options.localStorageId&&(this.localStorageId=this.options.localStorageId),this.levelChangeFn=this.options.levelChangeFn||this.levelChangeFn,this.localStorageId&&(this._localStorage=s.getItem(this.localStorageId),void 0!=this._localStorage.levelId&&(this.preferredLevelId=this._localStorage.levelId)),this.options.levels.on("reset",function(){log.debug("%d levels found",this.length),t._setLevels(this.toJSON())}),this.options.floorplans.on("reset",function(){log.debug("%d floorplans found",this.length),t._setFloorplans(this.toJSON())})},show:function(t){var e,n=this,i=!1,o=google.maps.MapTypeId.SATELLITE;this.$gmapDiv=t||this.$gmapDiv,this._localStorage.mapType&&"roadmap"==this._localStorage.mapType&&(o=google.maps.MapTypeId.ROADMAP),this._localStorage.mapType&&"Floorplan"==this._localStorage.mapType&&(o="Floorplan"),e={zoom:2,center:new google.maps.LatLng(0,0),mapTypeId:o,tilt:0,scaleControl:!0,mapTypeControl:!0,mapTypeControlOptions:{mapTypeIds:["Floorplan",google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE]}},this.map=new google.maps.Map(this.$gmapDiv[0],e),this._initializeToolsOnMap(),this._localStorage.mapType&&"Floorplan"==this._localStorage.mapType&&(i||(n.options.levels.fetch({reset:!0}),n.options.floorplans.fetch({reset:!0}),i=!0)),google.maps.event.addListener(this.map,"tilesloaded",function(){i||(log.debug("fetching levels and floorplans"),n.options.levels.fetch({reset:!0}),n.options.floorplans.fetch({reset:!0}),i=!0)})},getLevels:function(){return this.options.levels},getAttFromLocalStorage:function(t){return this._localStorage[t]},setAttInLocalStorage:function(t,e){s.setField(this.localStorageId,t,e),this._localStorage[t]=e},getLevelId:function(){return this.currLevelId},getFloorplans:function(){return this.options.floorplans},getMap:function(){return this.map},displayLevel:function(t,e){this._setCurrentLevel(t),this._onChangeLevel(t,e)},_initializeToolsOnMap:function(){var t=this;c(window).bind("map:fullscreen",function(){log.debug("triggered map:fullscreen"),google.maps.event.trigger(t.map,"resize")}),this.map.mapTypes.set("Floorplan",this._createFloorplanMapType()),google.maps.event.addListener(this.map,"maptypeid_changed",function(){t.localStorageId&&s.setField(t.localStorageId,"mapType",t.map.getMapTypeId())
}),google.maps.event.addListener(this.map,"zoom_changed",function(){return t.firstZoomChanged?(t.firstZoomChanged=!1,void(t._localStorage.mapZoom&&t.map.setZoom(t._localStorage.mapZoom))):void(t.localStorageId&&s.setField(t.localStorageId,"mapZoom",t.map.getZoom()))}),this._createLevelSelector()},_setFloorplans:function(t){this._floorplanObjs=t,this._refreshFloorplans()},_refreshFloorplans:function(t){log.debug("_refreshFloorplans, reposition "+t);var e,n,i,o,s=this._activeFps.length,a=[],r={},l=!1;for(void 0===t&&(t=this.options.autoReposition),e=0;s>e;e++)n=this._activeFps[e],n._fpObj.levelId==this.currLevelId?(a.push(n),r[n._fpObj.fpId]=!0,l=!0):n._kmlLayer.setMap(null);for(o=this._floorplanObjs?this._floorplanObjs.length:0,e=0;o>e;e++)if(i=this._floorplanObjs[e],!r[i.fpId]&&i.levelId==this.currLevelId){if(n=this._cachedFps[i.fpId],n||(n=this._createFloorplan(i),this._cachedFps[i.fpId]=n),u.has(n,"_mapTiler")){if(t&&!l){l=!0;var c=n._fpObj.tiles.bbox;this.map.setCenter(new google.maps.LatLng((c.north+c.south)/2,(c.east+c.west)/2)),this.map.setZoom(this._localStorage&&this._localStorage.mapZoom?this._localStorage.mapZoom:18),log.debug("_refreshFloorplans, repositioned on "+n._fpObj.fpId)}this.map.overlayMapTypes.clear(),this.map.overlayMapTypes.setAt(0,n._mapTiler)}else t&&!l&&(l=!0,n._kmlLayer.preserveViewport=!1,log.debug("_refreshFloorplans, repositioned on "+n._fpObj.fpId)),n._kmlLayer.setMap(this.map);a.push(n)}this._activeFps=a},_createFloorplanMapType:function(){function t(){}return t.prototype.tileSize=new google.maps.Size(256,256),t.prototype.maxZoom=25,t.prototype.getTile=function(t,e,n){var i=n.createElement("div");return i.innerHTML="&copy; Navizon Inc",i.style.width=this.tileSize.width+"px",i.style.height=this.tileSize.height+"px",i.style.fontSize="12px",i.style.borderWidth="0px",i.style.borderColor="#494949",i.style.backgroundColor="#494949",i},t.prototype.name="Floor plan",t.prototype.alt="Floor plan Map Type",new t},_createFloorplan:function(t){function e(t,e){var n=Math.pow(2,e),i=256/n,c=256/n,u=new google.maps.LatLngBounds(l.fromPointToLatLng(new google.maps.Point(t.x*i,(t.y+1)*c)),l.fromPointToLatLng(new google.maps.Point((t.x+1)*i,t.y*c))),d=t.y;return o.intersects(u)&&e>=a&&s>=e?r+e+"/"+t.x+"/"+d+".png":null}var n={};if(n._fpObj=t,n._kmlLayer=new google.maps.KmlLayer(t.kmlAligned,{suppressInfoWindows:!0,preserveViewport:!0,clickable:!1}),!u.isEmpty(t.tiles)){var i,o,s,a,r,l=this.map.getProjection();i=t.tiles.bbox,o=new google.maps.LatLngBounds(new google.maps.LatLng(i.south,i.west),new google.maps.LatLng(i.north,i.east)),s=t.tiles.maxZoom,a=t.tiles.minZoom,r=t.tiles.folder,n._mapTiler=new google.maps.ImageMapType({getTileUrl:e,tileSize:new google.maps.Size(256,256),isPng:!0,opacity:1})}return n},_setLevels:function(t){var e=0;this._getLevelSelector().html(i.getLevelsAsHtmlOptions(i.sortLevels(t),!1)),this.preferredLevelId&&this.options.levels.get(this.preferredLevelId)&&(e=this.preferredLevelId),this.displayLevel(e,this.autoReposition)},_setCurrentLevel:function(t){this.currLevelId=t,this._getLevelSelector().val(t)},_onChangeLevel:function(t,e){this.currLevelId=t,this._refreshFloorplans(e),this.levelChangeFn&&this.levelChangeFn(t),this.trigger("level:change",t)},_createLevelSelector:function(){var t,e,n,i,o=this;log.debug("_createLevelSelector"),n=c('<select id="system_map_level_selector" class="map_level_selector"></select>'),e=c("<dummy></dummy>").append(n),i=e.html(),t=document.createElement("DIV"),t.innerHTML=i,t.index=1,this.map.controls[google.maps.ControlPosition.TOP_RIGHT].push(t),this.$gmapDiv.on("change","#system_map_level_selector",function(){var t=c(this).val();o._onChangeLevel(t),o.localStorageId&&s.setField(o.localStorageId,"levelId",t)})},_getLevelSelector:function(){return this.$gmapDiv.find("#system_map_level_selector")}}),t.DatatableView=l.View.extend({$table:null,columns:[],datatableParams:{},events:{"click button.js-edit":"_onEdit","click button.js-config":"_onConfig","click button.js-delete":"_onDelete","click button.js-select":"_onSelect","click button.js-show":"_onShow","change input.js-check":"_onCheck"},_baseHandler:function(t){var e=c(t.currentTarget).attr("data-id");return t.stopPropagation(),this.collection.get(e)},_onEdit:function(t){this.trigger("edit",this._baseHandler(t))},_onConfig:function(t){this.trigger("config",this._baseHandler(t))},_onDelete:function(t){this.trigger("delete",this._baseHandler(t))},_onSelect:function(t){this.trigger("select",this._baseHandler(t))},_onShow:function(t){this.trigger("show",this._baseHandler(t))},_onCheck:function(t){var e=c(t.currentTarget).attr("data-id"),n=c(t.currentTarget).is(":checked");t.stopPropagation(),this.trigger("check",{id:e,checked:n})},collectionEvents:{add:function(t){this.$table.row.add(t.toJSON()).draw(),this.triggerMethod("table:rendered")},remove:function(t){var e=t.idAttribute;this.$table.rows(function(n,i){return i[e]===t.get(e)}).remove().draw()},reset:function(t){this.$table.clear().rows.add(t.toJSON()).draw(),this.triggerMethod("table:rendered")},change:function(t){var e=t.idAttribute;this.$table.row(function(n,i){return i[e]===t.get(e)}).remove(),this.$table.row.add(t.toJSON()).draw()}},initialize:function(t){t.columns&&(this.columns=t.columns),t.idField&&(this.idField=t.idField),t.template&&(this.template=t.template),t.datatableParams&&c.extend(this.datatableParams,t.datatableParams)},onShow:function(){this.$table=this.$el.find("table").DataTable(c.extend({autoWidth:!1,data:this.collection.toJSON(),columns:this.columns,aLengthMenu:[[10,50,-1],[10,50,"All"]],iDisplayLength:10},this.datatableParams)),this.$el.addClass("table-responsive"),this.$el.find("table").addClass("table table-vcenter table-condensed table-bordered"),c(".dataTables_filter input").addClass("form-control input-sm").attr("placeholder","Search"),c(".dataTables_length select").addClass("form-control input-sm")},render:function(){this.$el.html(this.template({}))},onTableRendered:function(){this.$el.find('[data-toggle="tooltip"], .enable-tooltip').tooltip({container:"body",animation:!1})}}),t.EditDialogView=l.View.extend({template:null,$validator:null,validationParams:null,renderParams:{},autoClose:!0,autoCloseDelay:500,behaviors:{SpinButton:{button:"button.js-submit"}},ui:{submitButton:"button.js-submit"},events:{"click @ui.submitButton":"submitClicked"},submitClicked:function(){if(this.$validator&&!this.$validator.checkForm())return void this.$validator.showErrors();var t=this.model.clone();t.set(r.Syphon.serialize(this)),this.triggerMethod("submit",t)},onSubmitSuccess:function(){var t=this;this.autoClose&&setTimeout(function(){t.closeDialog()},this.autoCloseDelay)},onSubmitError:function(){},showDialog:function(){this.$el.find(".js-modal").modal()},closeDialog:function(){this.$el.find(".js-modal").modal("hide")},initialize:function(t){log.info("CommonViews.EditDialogView initialized"),t.renderParams&&(this.renderParams=t.renderParams),t.type&&(this.type=t.type),t.validationParams&&(this.validationParams=t.validationParams),t.template&&(this.template=t.template)},onShow:function(){if(this.validationParams&&(this.$validator=this.$el.find("form").validate(u.extend({},t.ValidationConfig,this.validationParams))),r.Syphon.deserialize(this,this.model.toJSON()),"delete"===this.type){this.$el.find("form").addClass(" form-bordered");var e=this.$el.find("input,select");u.each(e,function(t){c(t).replaceWith(c("<p>").addClass("form-control-static").text(c(t).val()))})}0==o.isSuperuser(o.getSiteId())&&this.$el.find('input[name="desc"]').attr("disabled",!0),this.showDialog()},render:function(){var t=c.extend({},this.model.toJSON(),{type:this.type},this.renderParams);this.$el.html(this.template(t))}}),t.EditController=l.Controller.extend({dialogTemplate:null,DialogViewClass:null,openEditDialog:function(t,e,n){var i=new this.DialogViewClass(c.extend({model:t,type:"edit"},e));i.on("submit",function(t){t.save().success(function(){n(t),i.triggerMethod("submit:success")}).error(function(){i.triggerMethod("submit:error")})}),a.modal.show(i)},openDeleteDialog:function(t,e,n){var i=new this.DialogViewClass(c.extend({model:t,type:"delete"},e));i.on("submit",function(t){t.destroy().success(function(){n(t),i.triggerMethod("submit:success")}).error(function(){i.triggerMethod("submit:error")})}),a.modal.show(i)},openNewDialog:function(t,e,n){var i=new this.DialogViewClass(c.extend({model:t,type:"new"},e));i.on("submit",function(t){t.save().success(function(){n(t),i.triggerMethod("submit:success")}).error(function(){i.triggerMethod("submit:error"),a.vent.trigger("error:show")})}),a.modal.show(i)}}),t.DatatableView.getHtmlForButtons=function(t,e,n){var i="",o=0;return-1!==n.indexOf("show")&&(i+='<button data-placement="bottom" data-toggle="tooltip" data-original-title="Show" class="js-show btn btn-alt btn-primary" data-id='+t[e]+'><i class="fa fa-search"></i></button>',o++),-1!==n.indexOf("radius")&&(i+='<button data-placement="bottom" data-toggle="tooltip" data-original-title="Radius of confidence" class="js-radius btn btn-alt btn-primary" data-id='+t[e]+'><i class="fa fa-bullseye"></i></button>',o++),-1!==n.indexOf("select")&&(i+='<button data-placement="bottom" data-toggle="tooltip" data-original-title="Select" class="js-select btn btn-alt btn-primary" data-id='+t[e]+'><i class="fa fa-check-square-o"></i></button>',o++),-1!==n.indexOf("edit")&&(i+='<button data-placement="bottom" data-toggle="tooltip" data-original-title="Edit" class="js-edit btn btn-alt btn-primary" data-id='+t[e]+'><i class="fa fa-edit"></i></button>',o++),-1!==n.indexOf("config")&&(i+='<button data-placement="bottom" data-toggle="tooltip" data-original-title="Config" class="js-config btn btn-alt btn-primary" data-id='+t[e]+'><i class="fa fa-gear"></i></button>',o++),-1!==n.indexOf("delete")&&(i+='<button data-placement="bottom" data-toggle="tooltip" data-original-title="Delete" class="js-delete btn btn-alt btn-primary" data-id='+t[e]+'><i class="fa fa-trash-o"></i></button>',o++),-1!==n.indexOf("pushDevice")&&(i+='<button data-placement="bottom" data-toggle="tooltip" data-original-title="Request Location Update" class="js-push-device btn btn-alt btn-primary" data-id='+t[e]+'><i class="fa fa-refresh"></i></button>',o++),-1!==n.indexOf("check")&&(i+='<label class="switch switch-primary"><input class="js-check" type="checkbox" data-id='+t[e]+"><span></span></label>",o++),o>1&&(i='<div class="btn-group btn-group-sm">'+i+"</div>"),i},t.DatatableView.getButtonColumn=function(e,n){return{data:null,orderable:!1,searchable:!1,width:40*n.length+"px",render:function(i,o){return"display"!==o?i:t.DatatableView.getHtmlForButtons(i,e,n)}}},t.DatatableView.getColumn=function(t,e){var o={};switch(t){case"id":o={data:e,width:"120px"};break;case"name":o={data:"name",width:"200px"};break;case"access":o={data:"access",render:function(t,e){if("display"!==e)return t;switch(t){case"10":return"Read Only";case"20":return"Read-Write";case"30":return"Full Control";case"superuser":return"Superuser";default:return t}}};break;case"desc":o={data:"desc"};break;case"mfr":o={data:null,render:function(t){return t.mac?n.getCompanyName(t.mac.substring(0,6)):""}};break;case"lrrt":o={data:"lrrt",searchable:!1,render:function(t,e){return"display"==e?isFinite(t)?i.formatTime(1e3*t):"n/a":"sort"==e?isFinite(t)?t:1e9:t}};break;case"lrne":o={data:"lrne",searchable:!1,render:function(t,e){return"display"==e&&isNaN(t)?"n/a":t}};break;default:o={data:t,width:e+"px"}}return o},t.ValidationConfig={errorClass:"help-block",errorElement:"div",errorPlacement:function(t,e){e.parents(".form-group > div").append(t)},highlight:function(t){c(t).closest(".form-group").removeClass("has-success has-error").addClass("has-error"),c(t).closest(".help-block").remove()},success:function(t){t.closest(".form-group").removeClass("has-success has-error"),t.closest(".help-block").remove()}}})}),define("text!general/sites/sites_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="its_sites_template">\n\n    <!-- Current site -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Current</strong> Site</h2>\n        </div>\n        <div class="row">\n            <div class="col-md-12">\n                <div id="site_view"></div>\n            </div>\n        </div>\n    </div>\n\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Available</strong> Sites</h2>\n        </div>\n        <div id="site_table" class="table-responsive"></div>\n    </div>\n\n</script>\n\n<!--Site view -->\n<script type="text/x-template" id="site_view_template">\n    <form class="form-horizontal form-bordered">\n\n        <!--Site ID -->\n        <div class="col-xs-2">\n            <div class="form-group">\n                <label>Site ID</label>\n                <p name="siteId" class="form-control-static"><%= siteId %></p>\n            </div>\n        </div>\n\n        <!--Name -->\n        <div class="col-xs-4">\n            <div class="form-group">\n                <label>Name</label>\n                <p name="Desc" class="form-control-static"><%= name %></p>\n            </div>\n        </div>\n\n        <!--Desc -->\n        <div class="col-xs-6">\n            <div class="form-group">\n                <label>Description</label>\n                <p name="Desc" class="form-control-static"><%= desc %></p>\n            </div>\n        </div>\n\n        <!--Access -->\n        <div class="col-xs-6">\n            <div class="form-group">\n                <label>Access</label>\n                <p name="Desc" class="form-control-static"><%= access %></p>\n            </div>\n        </div>\n\n        <!--Address -->\n        <div class="col-xs-6">\n            <div class="form-group">\n                <label>Address</label>\n                <p name="Desc" class="form-control-static"><%= address %></p>\n            </div>\n        </div>\n\n        <div class="col-xs-12">\n            <div class="form-group">\n                <button id="edit_site" type="button" class="btn btn-primary"><i class="fa fa-edit"></i> Edit Site</button>\n            </div>\n        </div>\n    </form>\n</script>\n\n\n<!-- node table-->\n<script type="text/x-template" id="site_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Site ID </th>\n            <th> Name </th>\n            <th> Description </th>\n            <!--<th> Address </th>-->\n            <th> Access </th>\n            <th> Action </th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Dialog for Add, Edit, Delete operations -->\n<script type="text/x-template" id="dialog-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <h4 class="modal-title">Edit Site <%= siteId %></h4>\n                </div>\n\n                <div class="modal-body">\n                    <form class="form-horizontal">\n\n                        <!-- Name -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Name</label>\n                            <div class="col-md-9">\n                                <input name="name" value="" maxlength="20" class="form-control" placeholder="Name">\n                            </div>\n                        </div>\n\n                        <!-- Desc -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Description</label>\n                            <div class="col-md-9">\n                                <input name="desc" value="" maxlength="60" class="form-control" placeholder="Description">\n                            </div>\n                        </div>\n\n                        <!-- Address -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Address</label>\n                            <div class="col-md-9">\n                                <input name="address" value="" maxlength="120" class="form-control" placeholder="Address">\n                            </div>\n                        </div>\n                    </form>\n                </div>\n\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <button type="button" class="btn btn-primary js-submit"><i class="fa fa-save"></i> Save Changes</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n'}),define("general/sites/sites_views",["app","common/common_views","text!general/sites/sites_templates.html"],function(t,e,n){return log.info("General.Sites.Views initialized"),t.module("General.Sites",function(t,i,o,s,a,r){t.MainView=s.LayoutView.extend({template:r.template(a(n).filter("#its_sites_template").html()),regions:{siteView:"#site_view",siteTable:"#site_table"},triggers:{"click #refresh":"refresh"}}),t.SiteView=s.ItemView.extend({template:r.template(a(n).filter("#site_view_template").html()),events:{"click button#edit_site":function(){this.trigger("site:edit",this.model)}}}),t.SiteTableView=e.DatatableView.extend({template:r.template(a(n).filter("#site_table_template").html()),datatableParams:{aLengthMenu:[[10,50,100,-1],[10,50,100,"All"]]},columns:[e.DatatableView.getColumn("id","siteId"),e.DatatableView.getColumn("name"),e.DatatableView.getColumn("desc"),e.DatatableView.getColumn("access"),{data:null,orderable:!1,searchable:!1,width:"60px",render:function(t,e){return"display"!==e?t:'<button class="js-select btn btn-alt btn-primary btn-sm" data-id='+t.siteId+">Select</button>"}}]}),t.ModalView=e.EditDialogView.extend({template:r.template(a(n).filter("#dialog-template").html())})})}),define("general/sites/sites_controller",["app","marionette","common/server","common/entities","common/common_views","general/sites/sites_views","text!general/sites/sites_templates.html","bootbox"],function(t,e,n,i,o,s,a,r){return o.EditController.extend({initialize:function(){log.info("Sites Controller initialized"),this.DialogViewClass=o.EditDialogView.extend({template:_.template($(a).filter("#dialog-template").html())})},show:function(e){function o(t){c.openEditDialog(t,{},function(t){u.get(t.id).set(t.pick("name","desc","address")),t.id===n.getSiteId()&&l(t)})}function a(t){var i;l(t),n.setSiteId(t.id),i={title:"Site Changed",message:"Now using Site ID "+t.id},i.buttons=_.isUndefined(e)?{ok:{label:"OK",className:"btn btn-primary",callback:function(){}}}:{ok:{label:"Stay Here",className:"btn btn-default",callback:function(){}},next:{label:"Back to: "+e,className:"btn btn-primary",callback:function(){Backbone.history.navigate(e,{trigger:!0})}}},r.dialog(i)}function l(t){var e=new s.SiteView({model:t});e.on("site:edit",function(t){o(t)}),d.siteView.show(e)}log.debug("SiteController.show - prevRoute %s",e);var c=this,u=new i.SiteCollection,d=new s.MainView({}),h=new s.SiteTableView({collection:u});u.on("reset",function(){l(u.get(n.getSiteId()))}),d.on("show",function(){d.siteTable.show(h),h.on("edit",o),h.on("select",a),d.on("refresh",function(){u.fetch({reset:!0})})}),t.main.show(d),u.fetch({reset:!0})}})}),define("text!general/levels/levels_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="its_levels_template">\n\n    <!-- Sites table -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Levels</strong></h2>\n            <div class="block-options pull-right">\n                <a id="refresh_known" href="javascript:void(0)" class="btn btn-alt btn-sm btn-default" data-toggle="tooltip" title="" data-original-title="Refresh"><i class="fa fa-refresh"></i></a>\n            </div>\n        </div>\n\n        <!-- Button -->\n        <div class="row">\n            <div class="col-md-12">\n                <div class="form-group">\n                    <button type="button" class="btn btn-primary js-add"><i class="fa fa-plus-circle"></i>&nbsp;Add Level&nbsp;</button>\n                </div>\n            </div>\n        </div>\n\n        <!--Table -->\n        <div class="row">\n            <div class="col-lg-9">\n                <div id="level_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n</script>\n\n<!-- node table-->\n<script type="text/x-template" id="level_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Level ID </th>\n            <th> Name </th>\n            <th> Description </th>\n            <th> Action </th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Dialog for Add, Edit, Delete operations -->\n<script type="text/x-template" id="dialog-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <% if(type === \'new\') { %>\n                        <h4 class="modal-title">New Level</h4>\n                    <% } else if (type === \'delete\'){ %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= name ? name : levelId %>?</h4>\n                    <% } else { %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= name ? name : levelId %></h4>\n                    <% } %>\n                </div>\n\n                <div class="modal-body">\n                    <form class="form-horizontal">\n\n\n                        <!-- LevelId -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Level ID</label>\n                            <div class="col-md-9">\n                                <% if (type === \'new\') { %>\n                                    <select name="levelId" class="form-control">\n                                        <% _.each(_.range(-10, 21), function(r) { %>\n                                            <option value="<%= r %>" <%= (levels.indexOf(r) != -1) ? \'disabled\' : \'\' %> ><%= r %></option>\n                                        <% }); %>\n                                    </select>\n                                <% } else { %>\n                                    <p class="form-control-static"><%= levelId %></p>\n                                <% } %>\n                            </div>\n                        </div>\n\n                        <!-- Name -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Name</label>\n                            <div class="col-md-9">\n                                <input name="name" maxlength="20" value="" class="form-control" placeholder="Name">\n                            </div>\n                        </div>\n\n                        <!-- Desc -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Description</label>\n                            <div class="col-md-9">\n                                <input name="desc" maxlength="60" value="" class="form-control" placeholder="Description">\n                            </div>\n                        </div>\n\n                    </form>\n                </div>\n\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <% if (type === \'delete\') { %>\n                        <button type="button" class="btn btn-warning js-submit"><i class="fa fa-trash-o"></i> Delete Level</button>\n                    <% } else { %>\n                        <button type="button" class="btn btn-primary js-submit"><i class="fa fa-save"></i> Save</button>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n'}),define("common/behaviors",["app"],function(t){return t.module("Behaviors",function(t,e,n,i,o){t.SpinButton=i.Behavior.extend({defaults:{autoReset:!1,autoResetTime:1e3},button:null,spinIcon:o("<i>").addClass("fa fa-spinner fa-spin"),errorIcon:o("<i>").addClass("fa fa-times"),successIcon:o("<i>").addClass("fa fa-check"),originalIcon:null,originalText:"",onShow:function(){this.button="string"===o.type(this.options.button)?this.view.$el.find(this.options.button):this.options.button},onSubmit:function(){this.originalIcon=this.button.find("i"),this.originalText=this.button.text(),this.originalIcon.replaceWith(this.spinIcon)},onSubmitSuccess:function(){var t=this.button.find("i");if(t.replaceWith(this.successIcon),this.button.addClass("btn-success"),this.options.autoReset){var e=this;setTimeout(function(){e.view.triggerMethod("reset")},this.options.autoResetTime)}},onSubmitError:function(){this.onReset()},onReset:function(){var t=this.button.find("i");t.replaceWith(this.originalIcon),this.button.removeClass("btn-success btn-error")}}),t.FullScreenMap=i.Behavior.extend({button:null,blockDiv:null,mapDiv:null,onAttach:function(){var t=this;this.button=this.view.$el.find(this.options.button),this.mapDiv=this.view.$el.find(this.options.map),this.blockDiv=this.mapDiv.parent(),this.button.on("click",function(){var e;t.blockDiv.addClass("block-fullscreen"),t.mapDiv.css("height",t.blockDiv.height()),jQuery(window).trigger("map:fullscreen"),e='<a id="_button-exit-fullscreen" class="btn btn-alt btn-sm btn-primary button-on-map-fullscreen" href="javascript:void(0)">',e+='<i class="fa fa-desktop"></i> exit</a>',t.blockDiv.children().before(e),o("#_button-exit-fullscreen").on("click",function(){t.blockDiv.removeClass("block-fullscreen"),t.mapDiv.css("height","480px"),o(this).remove(),jQuery(window).trigger("map:fullscreen")})})}})})}),define("general/levels/levels_controller",["app","common/entities","common/common_views","text!general/levels/levels_templates.html","common/behaviors"],function(t,e,n,i){var o=Marionette.LayoutView.extend({template:_.template($(i).filter("#its_levels_template").html()),regions:{siteTable:"#level_table"},ui:{addButton:"button.js-add"},triggers:{"click button.js-add":"new","click #refresh_known":"refresh"}}),s=n.DatatableView.extend({template:_.template($(i).filter("#level_table_template").html()),columns:[n.DatatableView.getColumn("id","levelId"),n.DatatableView.getColumn("name"),n.DatatableView.getColumn("desc"),n.DatatableView.getButtonColumn("levelId",["edit","delete"])]});return n.EditController.extend({initialize:function(){log.info("Levels Controller initialized"),this.DialogViewClass=n.EditDialogView.extend({template:_.template($(i).filter("#dialog-template").html())})},show:function(){function n(t){l.openEditDialog(t,{},function(t){c.get(t.id).set(t.pick("name","desc"))})}function i(t){l.openDeleteDialog(t,{},function(t){c.remove(t.id)})}function a(){var t,n=new e.LevelModel;for(t=0;10>t;t++)if(!c.get(t)){n.set("levelId",t);break}l.openNewDialog(n,{renderParams:{levels:c.map(function(t){return t.get("levelId")})}},function(t){c.add(t)})}function r(){console.log("good"),c.fetch({reset:!0})}var l=this,c=new e.LevelCollection,u=new o({}),d=new s({collection:c});u.on("show",function(){u.siteTable.show(d),d.on("edit",n),d.on("delete",i),u.on("new",a),u.on("refresh",r)}),t.main.show(u),c.fetch({reset:!0})}})}),define("text!general/users/users_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="its_users_template">\n\n    <!-- Your account -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Your</strong> account</h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <form id="change_password_form" class="form-inline">\n                    <div class="form-group">\n                        <label class="sr-only" for="password1">Password1</label>\n                        <input type="password" maxlength="32" id="password1" name="password1" class="form-control" placeholder="New Password">\n                    </div>\n                    <div class="form-group">\n                        <label class="sr-only" for="password2">Password2</label>\n                        <input type="password" maxlength="32" id="password2" name="password2" class="form-control" placeholder="Retype Password">\n                    </div>\n                    <div class="form-group">\n                        <button id="change_password" class="btn btn-primary"><i class="fa fa-user"></i> Change Password</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n\n    <!-- Registered accounts -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Registered</strong> accounts</h2>\n        </div>\n\n        <!-- Button -->\n        <div class="form-group">\n            <button type="button" class="btn btn-primary js-register"><i class="fa fa-plus-circle"></i>&nbsp;Add Account&nbsp;</button>\n        </div>\n\n        <!--Table -->\n        <div class="row">\n            <div class="col-lg-9">\n                <div id="account_table" class="table-responsive"></div>\n            </div>\n        </div>\n\n        <!--<div id="account_table" class="table-responsive col-md-9"></div>-->\n\n    </div>\n</script>\n\n<!-- accounts table-->\n<script type="text/x-template" id="account_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Username </th>\n            <th> Access </th>\n            <th> Action</th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Dialog for Add, Edit, Delete operations -->\n<script type="text/x-template" id="dialog-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <% if(type === \'new\') { %>\n                        <h4 class="modal-title">Add Account</h4>\n                    <% } else if (type === \'delete\'){ %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= username %> </h4>\n                    <% } else { %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= username %> </h4>\n                    <% } %>\n                </div>\n\n                <div class="modal-body">\n\n                    <form class="form-horizontal">\n\n                        <!-- User -->\n                        <% if (type === \'new\') {%>\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">User</label>\n                            <div class="col-md-6">\n                               <input name="username" maxlength="254" type="email" value="" class="form-control" placeholder="user@email.com">\n                            </div>\n                        </div>\n                        <% } %>\n\n                        <!-- Access -->\n                        <div class="form-group">\n                            <% if (type !== \'delete\') { %>\n                                    <label class="col-md-3 control-label">Access</label>\n                                    <div class="col-md-6">\n                                        <select name="access" class="form-control" placeholder="access">\n                                            <option value="10"> Read Only</option>\n                                            <option value="20"> Read-Write</option>\n                                            <option value="30"> Full Control</option>\n                                        </select>\n                                    </div>\n                            <% } else { %>\n                                <p class="form-control-static col-lg-12">Revoke access to the account?</p>\n                            <% } %>\n                        </div>\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <% if (type === \'delete\') { %>\n                        <button type="button" class="btn btn-warning js-submit"><i class="fa fa-trash-o"></i> Revoke Access</button>\n                    <% } else { %>\n                        <button type="button" class="btn btn-primary js-submit"><i class="fa fa-save"></i> Save</button>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n'
}),function(t){function e(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function n(t,e){for(var n=[];e>0;n[--e]=t);return n.join("")}var i=function(){return i.cache.hasOwnProperty(arguments[0])||(i.cache[arguments[0]]=i.parse(arguments[0])),i.format.call(null,i.cache[arguments[0]],arguments)};i.format=function(t,o){var s,a,r,l,c,u,d,h=1,p=t.length,f="",g=[];for(a=0;p>a;a++)if(f=e(t[a]),"string"===f)g.push(t[a]);else if("array"===f){if(l=t[a],l[2])for(s=o[h],r=0;r<l[2].length;r++){if(!s.hasOwnProperty(l[2][r]))throw i('[sprintf] property "%s" does not exist',l[2][r]);s=s[l[2][r]]}else s=l[1]?o[l[1]]:o[h++];if(/[^s]/.test(l[8])&&"number"!=e(s))throw i("[sprintf] expecting number but found %s",e(s));switch(l[8]){case"b":s=s.toString(2);break;case"c":s=String.fromCharCode(s);break;case"d":s=parseInt(s,10);break;case"e":s=l[7]?s.toExponential(l[7]):s.toExponential();break;case"f":s=l[7]?parseFloat(s).toFixed(l[7]):parseFloat(s);break;case"o":s=s.toString(8);break;case"s":s=(s=String(s))&&l[7]?s.substring(0,l[7]):s;break;case"u":s>>>=0;break;case"x":s=s.toString(16);break;case"X":s=s.toString(16).toUpperCase()}s=/[def]/.test(l[8])&&l[3]&&s>=0?"+"+s:s,u=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",d=l[6]-String(s).length,c=l[6]?n(u,d):"",g.push(l[5]?s+c:c+s)}return g.join("")},i.cache={},i.parse=function(t){for(var e=t,n=[],i=[],o=0;e;){if(null!==(n=/^[^\x25]+/.exec(e)))i.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(e)))i.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(e)))throw"[sprintf] huh?";if(n[2]){o|=1;var s=[],a=n[2],r=[];if(null===(r=/^([a-z_][a-z_\d]*)/i.exec(a)))throw"[sprintf] huh?";for(s.push(r[1]);""!==(a=a.substring(r[0].length));)if(null!==(r=/^\.([a-z_][a-z_\d]*)/i.exec(a)))s.push(r[1]);else{if(null===(r=/^\[(\d+)\]/.exec(a)))throw"[sprintf] huh?";s.push(r[1])}n[2]=s}else o|=2;if(3===o)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";i.push(n)}e=e.substring(n[0].length)}return i};var o=function(t,e,n){return n=e.slice(0),n.splice(0,0,t),i.apply(null,n)};t.sprintf=i,t.vsprintf=o}("undefined"!=typeof exports?exports:window),define("sprintf",function(){}),function(t){"function"==typeof define&&define.amd?define("vendor/jquery.validate",["jquery"],t):t(jQuery)}(function(t){t.extend(t.fn,{validate:function(e){if(!this.length)return void(e&&e.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var n=t.data(this[0],"validator");return n?n:(this.attr("novalidate","novalidate"),n=new t.validator(e,this[0]),t.data(this[0],"validator",n),n.settings.onsubmit&&(this.validateDelegate(":submit","click",function(e){n.settings.submitHandler&&(n.submitButton=e.target),t(e.target).hasClass("cancel")&&(n.cancelSubmit=!0),void 0!==t(e.target).attr("formnovalidate")&&(n.cancelSubmit=!0)}),this.submit(function(e){function i(){var i,o;return n.settings.submitHandler?(n.submitButton&&(i=t("<input type='hidden'/>").attr("name",n.submitButton.name).val(t(n.submitButton).val()).appendTo(n.currentForm)),o=n.settings.submitHandler.call(n,n.currentForm,e),n.submitButton&&i.remove(),void 0!==o?o:!1):!0}return n.settings.debug&&e.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,i()):n.form()?n.pendingRequest?(n.formSubmitted=!0,!1):i():(n.focusInvalid(),!1)})),n)},valid:function(){var e,n;return t(this[0]).is("form")?e=this.validate().form():(e=!0,n=t(this[0].form).validate(),this.each(function(){e=n.element(this)&&e})),e},removeAttrs:function(e){var n={},i=this;return t.each(e.split(/\s/),function(t,e){n[e]=i.attr(e),i.removeAttr(e)}),n},rules:function(e,n){var i,o,s,a,r,l,c=this[0];if(e)switch(i=t.data(c.form,"validator").settings,o=i.rules,s=t.validator.staticRules(c),e){case"add":t.extend(s,t.validator.normalizeRule(n)),delete s.messages,o[c.name]=s,n.messages&&(i.messages[c.name]=t.extend(i.messages[c.name],n.messages));break;case"remove":return n?(l={},t.each(n.split(/\s/),function(e,n){l[n]=s[n],delete s[n],"required"===n&&t(c).removeAttr("aria-required")}),l):(delete o[c.name],s)}return a=t.validator.normalizeRules(t.extend({},t.validator.classRules(c),t.validator.attributeRules(c),t.validator.dataRules(c),t.validator.staticRules(c)),c),a.required&&(r=a.required,delete a.required,a=t.extend({required:r},a),t(c).attr("aria-required","true")),a.remote&&(r=a.remote,delete a.remote,a=t.extend(a,{remote:r})),a}}),t.extend(t.expr[":"],{blank:function(e){return!t.trim(""+t(e).val())},filled:function(e){return!!t.trim(""+t(e).val())},unchecked:function(e){return!t(e).prop("checked")}}),t.validator=function(e,n){this.settings=t.extend(!0,{},t.validator.defaults,e),this.currentForm=n,this.init()},t.validator.format=function(e,n){return 1===arguments.length?function(){var n=t.makeArray(arguments);return n.unshift(e),t.validator.format.apply(this,n)}:(arguments.length>2&&n.constructor!==Array&&(n=t.makeArray(arguments).slice(1)),n.constructor!==Array&&(n=[n]),t.each(n,function(t,n){e=e.replace(new RegExp("\\{"+t+"\\}","g"),function(){return n})}),e)},t.extend(t.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:t([]),errorLabelContainer:t([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(t){this.lastActive=t,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,t,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(t)))},onfocusout:function(t){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)},onkeyup:function(t,e){(9!==e.which||""!==this.elementValue(t))&&(t.name in this.submitted||t===this.lastElement)&&this.element(t)},onclick:function(t){t.name in this.submitted?this.element(t):t.parentNode.name in this.submitted&&this.element(t.parentNode)},highlight:function(e,n,i){"radio"===e.type?this.findByName(e.name).addClass(n).removeClass(i):t(e).addClass(n).removeClass(i)},unhighlight:function(e,n,i){"radio"===e.type?this.findByName(e.name).removeClass(n).addClass(i):t(e).removeClass(n).addClass(i)}},setDefaults:function(e){t.extend(t.validator.defaults,e)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:t.validator.format("Please enter no more than {0} characters."),minlength:t.validator.format("Please enter at least {0} characters."),rangelength:t.validator.format("Please enter a value between {0} and {1} characters long."),range:t.validator.format("Please enter a value between {0} and {1}."),max:t.validator.format("Please enter a value less than or equal to {0}."),min:t.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function e(e){var n=t.data(this[0].form,"validator"),i="on"+e.type.replace(/^validate/,""),o=n.settings;o[i]&&!this.is(o.ignore)&&o[i].call(n,this[0],e)}this.labelContainer=t(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||t(this.currentForm),this.containers=t(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var n,i=this.groups={};t.each(this.settings.groups,function(e,n){"string"==typeof n&&(n=n.split(/\s/)),t.each(n,function(t,n){i[n]=e})}),n=this.settings.rules,t.each(n,function(e,i){n[e]=t.validator.normalizeRule(i)}),t(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox']","focusin focusout keyup",e).validateDelegate("select, option, [type='radio'], [type='checkbox']","click",e),this.settings.invalidHandler&&t(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler),t(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),t.extend(this.submitted,this.errorMap),this.invalid=t.extend({},this.errorMap),this.valid()||t(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var t=0,e=this.currentElements=this.elements();e[t];t++)this.check(e[t]);return this.valid()},element:function(e){var n=this.clean(e),i=this.validationTargetFor(n),o=!0;return this.lastElement=i,void 0===i?delete this.invalid[n.name]:(this.prepareElement(i),this.currentElements=t(i),o=this.check(i)!==!1,o?delete this.invalid[i.name]:this.invalid[i.name]=!0),t(e).attr("aria-invalid",!o),this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),o},showErrors:function(e){if(e){t.extend(this.errorMap,e),this.errorList=[];for(var n in e)this.errorList.push({message:e[n],element:this.findByName(n)[0]});this.successList=t.grep(this.successList,function(t){return!(t.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){t.fn.resetForm&&t(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(t){var e,n=0;for(e in t)n++;return n},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(t){t.not(this.containers).text(""),this.addWrapper(t).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{t(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var e=this.lastActive;return e&&1===t.grep(this.errorList,function(t){return t.element.name===e.name}).length&&e},elements:function(){var e=this,n={};return t(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled], [readonly]").not(this.settings.ignore).filter(function(){return!this.name&&e.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in n||!e.objectLength(t(this).rules())?!1:(n[this.name]=!0,!0)})},clean:function(e){return t(e)[0]},errors:function(){var e=this.settings.errorClass.split(" ").join(".");return t(this.settings.errorElement+"."+e,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=t([]),this.toHide=t([]),this.currentElements=t([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(t){this.reset(),this.toHide=this.errorsFor(t)},elementValue:function(e){var n,i=t(e),o=e.type;return"radio"===o||"checkbox"===o?t("input[name='"+e.name+"']:checked").val():"number"===o&&"undefined"!=typeof e.validity?e.validity.badInput?!1:i.val():(n=i.val(),"string"==typeof n?n.replace(/\r/g,""):n)},check:function(e){e=this.validationTargetFor(this.clean(e));var n,i,o,s=t(e).rules(),a=t.map(s,function(t,e){return e}).length,r=!1,l=this.elementValue(e);for(i in s){o={method:i,parameters:s[i]};try{if(n=t.validator.methods[i].call(this,l,e,o.parameters),"dependency-mismatch"===n&&1===a){r=!0;continue}if(r=!1,"pending"===n)return void(this.toHide=this.toHide.not(this.errorsFor(e)));if(!n)return this.formatAndAdd(e,o),!1}catch(c){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+e.id+", check the '"+o.method+"' method.",c),c}}if(!r)return this.objectLength(s)&&this.successList.push(e),!0},customDataMessage:function(e,n){return t(e).data("msg"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase())||t(e).data("msg")},customMessage:function(t,e){var n=this.settings.messages[t];return n&&(n.constructor===String?n:n[e])},findDefined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t];return void 0},defaultMessage:function(e,n){return this.findDefined(this.customMessage(e.name,n),this.customDataMessage(e,n),!this.settings.ignoreTitle&&e.title||void 0,t.validator.messages[n],"<strong>Warning: No message defined for "+e.name+"</strong>")},formatAndAdd:function(e,n){var i=this.defaultMessage(e,n.method),o=/\$?\{(\d+)\}/g;"function"==typeof i?i=i.call(this,n.parameters,e):o.test(i)&&(i=t.validator.format(i.replace(o,"{$1}"),n.parameters)),this.errorList.push({message:i,element:e,method:n.method}),this.errorMap[e.name]=i,this.submitted[e.name]=i},addWrapper:function(t){return this.settings.wrapper&&(t=t.add(t.parent(this.settings.wrapper))),t},defaultShowErrors:function(){var t,e,n;for(t=0;this.errorList[t];t++)n=this.errorList[t],this.settings.highlight&&this.settings.highlight.call(this,n.element,this.settings.errorClass,this.settings.validClass),this.showLabel(n.element,n.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(t=0;this.successList[t];t++)this.showLabel(this.successList[t]);if(this.settings.unhighlight)for(t=0,e=this.validElements();e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return t(this.errorList).map(function(){return this.element})},showLabel:function(e,n){var i,o,s,a=this.errorsFor(e),r=this.idOrName(e),l=t(e).attr("aria-describedby");a.length?(a.removeClass(this.settings.validClass).addClass(this.settings.errorClass),a.html(n)):(a=t("<"+this.settings.errorElement+">").attr("id",r+"-error").addClass(this.settings.errorClass).html(n||""),i=a,this.settings.wrapper&&(i=a.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(i):this.settings.errorPlacement?this.settings.errorPlacement(i,t(e)):i.insertAfter(e),a.is("label")?a.attr("for",r):0===a.parents("label[for='"+r+"']").length&&(s=a.attr("id").replace(/(:|\.|\[|\])/g,"\\$1"),l?l.match(new RegExp("\\b"+s+"\\b"))||(l+=" "+s):l=s,t(e).attr("aria-describedby",l),o=this.groups[e.name],o&&t.each(this.groups,function(e,n){n===o&&t("[name='"+e+"']",this.currentForm).attr("aria-describedby",a.attr("id"))}))),!n&&this.settings.success&&(a.text(""),"string"==typeof this.settings.success?a.addClass(this.settings.success):this.settings.success(a,e)),this.toShow=this.toShow.add(a)},errorsFor:function(e){var n=this.idOrName(e),i=t(e).attr("aria-describedby"),o="label[for='"+n+"'], label[for='"+n+"'] *";return i&&(o=o+", #"+i.replace(/\s+/g,", #")),this.errors().filter(o)},idOrName:function(t){return this.groups[t.name]||(this.checkable(t)?t.name:t.id||t.name)},validationTargetFor:function(e){return this.checkable(e)&&(e=this.findByName(e.name)),t(e).not(this.settings.ignore)[0]},checkable:function(t){return/radio|checkbox/i.test(t.type)},findByName:function(e){return t(this.currentForm).find("[name='"+e+"']")},getLength:function(e,n){switch(n.nodeName.toLowerCase()){case"select":return t("option:selected",n).length;case"input":if(this.checkable(n))return this.findByName(n.name).filter(":checked").length}return e.length},depend:function(t,e){return this.dependTypes[typeof t]?this.dependTypes[typeof t](t,e):!0},dependTypes:{"boolean":function(t){return t},string:function(e,n){return!!t(e,n.form).length},"function":function(t,e){return t(e)}},optional:function(e){var n=this.elementValue(e);return!t.validator.methods.required.call(this,n,e)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,this.pending[t.name]=!0)},stopRequest:function(e,n){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[e.name],n&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(t(this.currentForm).submit(),this.formSubmitted=!1):!n&&0===this.pendingRequest&&this.formSubmitted&&(t(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(e){return t.data(e,"previousValue")||t.data(e,"previousValue",{old:null,valid:!0,message:this.defaultMessage(e,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(e,n){e.constructor===String?this.classRuleSettings[e]=n:t.extend(this.classRuleSettings,e)},classRules:function(e){var n={},i=t(e).attr("class");return i&&t.each(i.split(" "),function(){this in t.validator.classRuleSettings&&t.extend(n,t.validator.classRuleSettings[this])}),n},attributeRules:function(e){var n,i,o={},s=t(e),a=e.getAttribute("type");for(n in t.validator.methods)"required"===n?(i=e.getAttribute(n),""===i&&(i=!0),i=!!i):i=s.attr(n),/min|max/.test(n)&&(null===a||/number|range|text/.test(a))&&(i=Number(i)),i||0===i?o[n]=i:a===n&&"range"!==a&&(o[n]=!0);return o.maxlength&&/-1|2147483647|524288/.test(o.maxlength)&&delete o.maxlength,o},dataRules:function(e){var n,i,o={},s=t(e);for(n in t.validator.methods)i=s.data("rule"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase()),void 0!==i&&(o[n]=i);return o},staticRules:function(e){var n={},i=t.data(e.form,"validator");return i.settings.rules&&(n=t.validator.normalizeRule(i.settings.rules[e.name])||{}),n},normalizeRules:function(e,n){return t.each(e,function(i,o){if(o===!1)return void delete e[i];if(o.param||o.depends){var s=!0;switch(typeof o.depends){case"string":s=!!t(o.depends,n.form).length;break;case"function":s=o.depends.call(n,n)}s?e[i]=void 0!==o.param?o.param:!0:delete e[i]}}),t.each(e,function(i,o){e[i]=t.isFunction(o)?o(n):o}),t.each(["minlength","maxlength"],function(){e[this]&&(e[this]=Number(e[this]))}),t.each(["rangelength","range"],function(){var n;e[this]&&(t.isArray(e[this])?e[this]=[Number(e[this][0]),Number(e[this][1])]:"string"==typeof e[this]&&(n=e[this].replace(/[\[\]]/g,"").split(/[\s,]+/),e[this]=[Number(n[0]),Number(n[1])]))}),t.validator.autoCreateRanges&&(null!=e.min&&null!=e.max&&(e.range=[e.min,e.max],delete e.min,delete e.max),null!=e.minlength&&null!=e.maxlength&&(e.rangelength=[e.minlength,e.maxlength],delete e.minlength,delete e.maxlength)),e},normalizeRule:function(e){if("string"==typeof e){var n={};t.each(e.split(/\s/),function(){n[this]=!0}),e=n}return e},addMethod:function(e,n,i){t.validator.methods[e]=n,t.validator.messages[e]=void 0!==i?i:t.validator.messages[e],n.length<3&&t.validator.addClassRules(e,t.validator.normalizeRule(e))},methods:{required:function(e,n,i){if(!this.depend(i,n))return"dependency-mismatch";if("select"===n.nodeName.toLowerCase()){var o=t(n).val();return o&&o.length>0}return this.checkable(n)?this.getLength(e,n)>0:t.trim(e).length>0},email:function(t,e){return this.optional(e)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)},url:function(t,e){return this.optional(e)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},date:function(t,e){return this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())},dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(t)},number:function(t,e){return this.optional(e)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},creditcard:function(t,e){if(this.optional(e))return"dependency-mismatch";if(/[^0-9 \-]+/.test(t))return!1;var n,i,o=0,s=0,a=!1;if(t=t.replace(/\D/g,""),t.length<13||t.length>19)return!1;for(n=t.length-1;n>=0;n--)i=t.charAt(n),s=parseInt(i,10),a&&(s*=2)>9&&(s-=9),o+=s,a=!a;return o%10===0},minlength:function(e,n,i){var o=t.isArray(e)?e.length:this.getLength(e,n);return this.optional(n)||o>=i},maxlength:function(e,n,i){var o=t.isArray(e)?e.length:this.getLength(e,n);return this.optional(n)||i>=o},rangelength:function(e,n,i){var o=t.isArray(e)?e.length:this.getLength(e,n);return this.optional(n)||o>=i[0]&&o<=i[1]},min:function(t,e,n){return this.optional(e)||t>=n},max:function(t,e,n){return this.optional(e)||n>=t},range:function(t,e,n){return this.optional(e)||t>=n[0]&&t<=n[1]},equalTo:function(e,n,i){var o=t(i);return this.settings.onfocusout&&o.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){t(n).valid()}),e===o.val()},remote:function(e,n,i){if(this.optional(n))return"dependency-mismatch";var o,s,a=this.previousValue(n);return this.settings.messages[n.name]||(this.settings.messages[n.name]={}),a.originalMessage=this.settings.messages[n.name].remote,this.settings.messages[n.name].remote=a.message,i="string"==typeof i&&{url:i}||i,a.old===e?a.valid:(a.old=e,o=this,this.startRequest(n),s={},s[n.name]=e,t.ajax(t.extend(!0,{url:i,mode:"abort",port:"validate"+n.name,dataType:"json",data:s,context:o.currentForm,success:function(i){var s,r,l,c=i===!0||"true"===i;o.settings.messages[n.name].remote=a.originalMessage,c?(l=o.formSubmitted,o.prepareElement(n),o.formSubmitted=l,o.successList.push(n),delete o.invalid[n.name],o.showErrors()):(s={},r=i||o.defaultMessage(n,"remote"),s[n.name]=a.message=t.isFunction(r)?r(e):r,o.invalid[n.name]=!0,o.showErrors(s)),a.valid=c,o.stopRequest(n,c)}},i)),"pending")}}}),t.format=function(){throw"$.format has been deprecated. Please use $.validator.format instead."};var e,n={};t.ajaxPrefilter?t.ajaxPrefilter(function(t,e,i){var o=t.port;"abort"===t.mode&&(n[o]&&n[o].abort(),n[o]=i)}):(e=t.ajax,t.ajax=function(i){var o=("mode"in i?i:t.ajaxSettings).mode,s=("port"in i?i:t.ajaxSettings).port;return"abort"===o?(n[s]&&n[s].abort(),n[s]=e.apply(this,arguments),n[s]):e.apply(this,arguments)}),t.extend(t.fn,{validateDelegate:function(e,n,i){return this.bind(n,function(n){var o=t(n.target);return o.is(e)?i.apply(o,arguments):void 0})}})}),define("general/users/users_views",["app","common/common_views","text!general/users/users_templates.html","sprintf","bootstrap","syphon","vendor/jquery.validate"],function(t,e,n){return t.module("General.Users",function(t,i,o,s,a,r){t.MainView=s.LayoutView.extend({$validator:null,template:r.template(a(n).filter("#its_users_template").html()),ui:{password1:"input#password1",password2:"input#password2",submitButton:"button#change_password"},regions:{accountTable:"#account_table"},triggers:{"click button.js-register":"user:new"},events:{"click @ui.submitButton":"changePasswordClicked"},changePasswordClicked:function(t){if(t.stopPropagation(),!this.$validator.checkForm())return void this.$validator.showErrors();var e=this.ui.password1.val();try{btoa(e),this.trigger("user:change_password",e)}catch(n){this.$validator.showErrors({password1:"Invalid characters"})}},savePasswordSuccess:function(){var t=this;this.ui.submitButton.addClass("btn-success"),setTimeout(function(){t.ui.submitButton.removeClass("btn-success"),t.ui.password2.val(""),t.ui.password1.val("")},1e3)},onShow:function(){var t=this;this.$validator=this.$el.find("#change_password_form").validate(r.extend({},e.ValidationConfig,{errorPlacement:function(e){t.$el.find("#change_password_form").append(e)},rules:{password1:{required:!0},password2:{equalTo:"#password1"}},messages:{password2:{equalTo:"Please enter the same password"}}}))}}),t.AccountTableView=e.DatatableView.extend({template:r.template(a(n).filter("#account_table_template").html()),columns:[{data:"username"},{data:"access",render:function(t,e){if("display"!==e)return t;switch(t){case 10:return"Read Only";case 20:return"Read-Write";case 30:return"Full Control";default:return"n/a"}}},e.DatatableView.getButtonColumn("username",["edit","delete"])]}),t.ModalView=e.EditDialogView.extend({template:r.template(a(n).filter("#dialog-template").html())})})}),define("general/users/users_controller",["app","common/server","common/entities","common/common_views","general/users/users_views"],function(t,e,n,i,o){return i.EditController.extend({initialize:function(){log.info("Users Controller initialized"),this.DialogViewClass=o.ModalView},show:function(){function i(){u.fetch({reset:!0})}function s(t){var i=new n.UserModel({username:e.getUsername(),password:t});i.save().success(function(){e.setCredentials(i.get("username"),i.get("password"),e.getSiteId(),!0),d.savePasswordSuccess()})}function a(){var t=new n.AccountModel;c.openNewDialog(t,{validationParams:{rules:{username:{required:!0,email:!0}}}},function(t){u.add(t)})}function r(t){c.openEditDialog(t,{},function(t){u.get(t.id).set(t.pick("access"))})}function l(t){c.openDeleteDialog(t,{},function(t){u.remove(t.id)})}var c=this,u=new n.AccountCollection,d=new o.MainView({}),h=new o.AccountTableView({collection:u});d.on("show",function(){d.accountTable.show(h),d.on("user:change_password",s),d.on("user:new",a),h.on("edit",r),h.on("delete",l),d.on("refresh",i)}),t.main.show(d),u.fetch({reset:!0})}})}),define("text!general/floorplans/floorplan_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="main_view_template">\n\n    <div class="block full">\n        <div class="block-title">\n            <h4><strong>Floor plans</strong></h4>\n        </div>\n\n        <div id="table_section">\n            <div class="row">\n                <div class="col-md-12">\n                    <div class="form-group">\n                        <button id="new_floorplan_image" type="button" class="btn btn-primary"><i class="fa fa-plus-circle"></i> New Floor Plan...</button>\n                        <button id="new_floorplan_kml" type="button" class="btn btn-default"><i class="fa fa-file-o"></i> Import KML...</button>\n                    </div>\n                </div>\n            </div>\n\n            <!--Floor plan table-->\n            <div class="row">\n                <div class="col-md-12">\n                    <div id="floorplan_table" class="table-responsive"></div>\n                </div>\n            </div>\n        </div>\n\n        <!--Floor plan Show / Edit section -->\n        <div id ="edit_section">\n        </div>\n\n    </div>\n</script>\n\n\n<!-- floor plan table-->\n<script type="text/x-template" id="floorplan_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> ID </th>\n            <th> Name </th>\n            <th> Description </th>\n            <th> Level ID </th>\n            <th> Action </th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!--Floor plan Show / Edit section -->\n<script type="text/x-template" id="show_edit_template">\n\n    <div class="row">\n    <div class="col-md-12">\n        <div class="block-section">\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n                <a id="close_edit" href="javascript:void(0)" class="btn btn-alt btn-sm btn-default toggle-bars"><i class="fa fa-times-circle"></i> Close</a>\n            </div>\n            <h4 class="sub-header"></h4>\n\n            <!--Form used to upload a new floorplan or change/edit the image -->\n            <form id="upload_form" method="POST" enctype="multipart/form-data" target="fpupload_postframe" action="">\n                <div class="row">\n                    <div class="col-xs-4">\n                        <div class="form-group">\n                            <label>Name</label>\n                            <input type="input" name="name" class="form-control input-sm" placeholder="Name">\n                        </div>\n                    </div>\n                    <div class="col-xs-4">\n                        <div class="form-group">\n                            <label>Description</label>\n                            <input type="input" name="desc" class="form-control input-sm" placeholder="Description">\n                        </div>\n                    </div>\n                    <div class="col-xs-4">\n                        <div class="form-group">\n                            <label>Level ID</label>\n                            <select name="levelId" class="form-control input-sm">\n                            </select>\n                        </div>\n                    </div>\n                </div>\n                <!--Hidden controls -->\n                <input type="hidden" name="fp_id" value="" placeholder="fp_id">\n                <input type="hidden" name="access" value="private"/>\n                <input type="file" name="image" accept="image/gif,image/jpeg,image/png" style="display: none">\n                <!--style="display: none">-->\n                <input type="hidden" name="username" value="" placeholder="username">\n                <input type="hidden" name="password" value="" placeholder="password">\n                <input type="hidden" name="kml_content" value="" placeholder="kml_content">\n            </form>\n\n            <!--Form buttons -->\n            <div id="button_row" class="row">\n                <div class="col-xs-4">\n                    <button id="replace_image" type="button" class="btn btn-default col-xs-12"> Replace Image...</button>\n                </div>\n                <div class="col-xs-4">\n                    <div class="btn-group">\n                        <button id="discard" type="button" class="btn btn-alt btn-warning"><i class="fa fa-trash-o"></i> Discard Changes</button>\n                        <button id="save" type="button" class="btn btn-alt btn-primary"><i class="fa fa-save"></i> Save</button>\n                    </div>\n                </div>\n                <div class="col-xs-4">\n                    <div id="progress" class="form-group">\n                        <p class="form-control-static"></p>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    </div>\n    </div>\n\n    <!--Google Map-->\n    <div class="block block-gmap">\n        <div class="gmap">\n            <!-- Google map goes here -->\n        </div>\n    </div>\n    \n</script>\n\n<!-- Dialog for uploading floorplan from KML -->\n<script type="text/x-template" id="kml-dialog-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <% if(type === \'new\') { %>\n                        <h4 class="modal-title">New floor plan from KML</h4>\n                    <% } else if (type === \'delete\'){ %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= name ? name : fpId %>?</h4>\n                    <% } %>\n                </div>\n\n                <div class="modal-body">\n                    <form class="form-horizontal" method="POST" enctype="multipart/form-data" target="fpupload_postframe" action="">\n\n                        <!-- Name -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Name</label>\n                            <div class="col-md-9">\n                                <input name="name" value="" class="form-control" placeholder="Name">\n                            </div>\n                        </div>\n\n                        <!-- Desc -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Description</label>\n                            <div class="col-md-9">\n                                <input name="desc" value="" class="form-control" placeholder="Description">\n                            </div>\n                        </div>\n\n                        <!--Level ID -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Level ID</label>\n                            <div class="col-md-9">\n                                <select name="levelId" class="form-control input-sm">\n                                </select>\n                            </div>\n                        </div>\n\n                        <!--Image file -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Image File</label>\n                            <div class="col-md-9">\n                                <input type="file" name="image"\n                                       accept="image/gif,image/jpeg,image/png">\n                                <span class="help-block">Supported images: GIF, JPEG, PNG. Max image size: 1MB</span>\n                            </div>\n                        </div>\n\n                        <!--KML file -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">KML File</label>\n                            <div class="col-md-9">\n                                <input type="file" name="kml"\n                                       accept="application/vnd.google-earth.kml+xml">\n                            </div>\n                        </div>\n\n                        <!-- hidden fields -->\n                        <input type="hidden" name="access" value="private"/>\n                        <input type="hidden" name="username" value="" placeholder="username">\n                        <input type="hidden" name="password" value="" placeholder="password">\n\n                        <!--status -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Status</label>\n                            <div id="progress" class="col-md-9">\n                                <p class="form-control-static"></p>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <% if (type === \'delete\') { %>\n                        <button type="button" class="btn btn-warning js-submit"><i class="fa fa-trash-o"></i> Delete Floorplan</button>\n                    <% } else { %>\n                        <button type="button" class="btn btn-primary js-submit"><i class="fa fa-upload"></i> Upload files...</button>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n<!-- Dialog for deleting a floor plan -->\n<script type="text/x-template" id="delete-dialog-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <h4 class="modal-title"><strong>DELETE</strong> <%= name ? name : fpId %>?</h4>\n                </div>\n\n                <div class="modal-body">\n                    <form class="form-horizontal">\n\n                        <!-- Name -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Name</label>\n                            <div class="col-md-9">\n                                <input name="name" value="" class="form-control" placeholder="Name">\n                            </div>\n                        </div>\n\n                        <!-- Desc -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Description</label>\n                            <div class="col-md-9">\n                                <input name="desc" value="" class="form-control" placeholder="Description">\n                            </div>\n                        </div>\n\n                        <!--Level ID -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Level ID</label>\n                            <div class="col-md-9">\n                                <select name="levelId" class="form-control input-sm">\n                                </select>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <button type="button" class="btn btn-warning js-submit"><i class="fa fa-trash-o"></i> Delete Floorplan</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n'
}),function(jQuery){"use strict";function toCSS(jss){function jsonToCSS(t,e){t&&!result[t]&&(result[t]={});for(var n in e){var i=e[n];if(i instanceof Array)for(var o=i,s=0;s<o.length;s++)addProperty(t,n,o[s]);else switch(typeof i){case"number":case"string":addProperty(t,n,i);break;case"object":var a=n.charAt(n.length-1);if(!t||"_"!==a&&"-"!==a)jsonToCSS(makeSelectorName(t,n),i);else{var r=i;for(var l in r)for(var c=l.split(/\s*,\s*/),u=0;u<c.length;u++){var d=r[l];if(d instanceof Array)for(var h=d,p=0;p<h.length;p++)addProperty(t,n+c[u],h[p]);else addProperty(t,n+c[u],r[l])}}}}}function makePropertyName(t){return t.replace(/_/g,"-")}function makeSelectorName(t,e){for(var n=[],i=e.split(/\s*,\s*/),o=t.split(/\s*,\s*/),s=0;s<o.length;s++)for(var a=o[s],r=0;r<i.length;r++){var l=i[r];n.push("&"===l.charAt(0)?a+l.substr(1):a?a+" "+l:l)}return n.join(", ")}function addProperty(t,e,n){"number"==typeof n&&(n+="px");for(var i=e.split(/\s*,\s*/),o=0;o<i.length;o++){var s=makePropertyName(i[o]);result[t][s]?result[t][s].push(n):result[t][s]=[n]}}var result={};if("string"==typeof jss)try{eval("var jss = {"+jss+"}")}catch(e){return"/*\nUnable to parse JSS: "+e+"\n*/"}jsonToCSS("",jss);var ret="";for(var a in result){var css=result[a];ret+=a+" {\n";for(var i in css)for(var values=css[i],j=0;j<values.length;j++)ret+="	"+i+": "+values[j]+";\n";ret+="}\n"}return ret}var defaults={truncateFirst:!1,containerName:"injectCSSContainer"};jQuery.injectCSS=function(t,e){e=jQuery.extend({},defaults,e),e.media=e.media||"all";var n=jQuery("#"+e.containerName);n.length||(n=jQuery("<style></style>").appendTo("head").attr({media:e.media,id:e.containerName,type:"text/css"}));var i="";e.truncateFirst||(i+=n.text()),i+=toCSS(t);var o=n[0];return void 0!==o.styleSheet&&void 0!==o.styleSheet.cssText?o.styleSheet.cssText=i:n.text(i),n}}(jQuery),define("injectcss",function(){}),function(t){var e,n="0.2.4",i="hasOwnProperty",o=/[\.\/]/,s="*",a=function(){},r=function(t,e){return t-e},l={n:{}},c=function(t,n){var i,o=Array.prototype.slice.call(arguments,2),s=c.listeners(t),a=0,l=!1,u=[],d={};e=t;for(var h=0,p=s.length;p>h;h++)"zIndex"in s[h]&&(u.push(s[h].zIndex),s[h].zIndex<0&&(d[s[h].zIndex]=s[h]));for(u.sort(r);u[a]<0;)if(i=d[u[a++]],i.apply(n,o)===l)return l;for(h=0;p>h;h++)if(i=s[h],"zIndex"in i)if(i.zIndex==u[a]){if(i.apply(n,o)===l)return l;do if(a++,i=d[u[a]],i&&i.apply(n,o)===l)return l;while(i)}else d[i.zIndex]=i;else if(i.apply(n,o)===l)return l};c.listeners=function(t){var e,n,i,a,r,c,u,d,h=t.split(o),p=l,f=[p],g=[];for(a=0,r=h.length;r>a;a++){for(d=[],c=0,u=f.length;u>c;c++)for(p=f[c].n,n=[p[h[a]],p[s]],i=2;i--;)e=n[i],e&&(d.push(e),g=g.concat(e.f||[]));f=d}return g},c.on=function(t,e){for(var n=t.split(o),i=l,s=0,r=n.length;r>s;s++)i=i.n,!i[n[s]]&&(i[n[s]]={n:{}}),i=i[n[s]];for(i.f=i.f||[],s=0,r=i.f.length;r>s;s++)if(i.f[s]==e)return a;return i.f.push(e),function(t){+t==+t&&(e.zIndex=+t)}},c.nt=function(t){return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},c.unbind=function(t,e){for(var n,a,r,c=t.split(o),u=[l],d=0,h=c.length;h>d;d++)for(var p=0;p<u.length;p+=r.length-2){if(r=[p,1],n=u[p].n,c[d]!=s)n[c[d]]&&r.push(n[c[d]]);else for(a in n)n[i](a)&&r.push(n[a]);u.splice.apply(u,r)}for(d=0,h=u.length;h>d;d++)for(n=u[d];n.n;){if(e){if(n.f){for(d=0,h=n.f.length;h>d;d++)if(n.f[d]==e){n.f.splice(d,1);break}!n.f.length&&delete n.f}for(a in n.n)if(n.n[i](a)&&n.n[a].f){var f=n.n[a].f;for(d=0,h=f.length;h>d;d++)if(f[d]==e){f.splice(d,1);break}!f.length&&delete n.n[a].f}}else{delete n.f;for(a in n.n)n.n[i](a)&&n.n[a].f&&delete n.n[a].f}n=n.n}},c.version=n,c.toString=function(){return"You are running Eve "+n},"undefined"!=typeof module&&module.exports?module.exports=c:t.eve=c}(this),define("eve",function(t){return function(){var e;return e||t.eve}}(this)),function(){function t(e){if(t.is(e,"function"))return b?e():eve.on("raphael.DOMload",e);if(t.is(e,q))return t._engine.create[k](t,e.splice(0,3+t.is(e[0],W))).add(e);var n=Array.prototype.slice.call(arguments,0);if(t.is(n[n.length-1],"function")){var i=n.pop();return b?i.call(t._engine.create[k](t,n)):eve.on("raphael.DOMload",function(){i.call(t._engine.create[k](t,n))})}return t._engine.create[k](t,arguments)}function e(t){if(Object(t)!==t)return t;var n=new t.constructor;for(var i in t)t[C](i)&&(n[i]=e(t[i]));return n}function n(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}function i(t,e,i){function o(){var s=Array.prototype.slice.call(arguments,0),a=s.join("␀"),r=o.cache=o.cache||{},l=o.count=o.count||[];return r[C](a)?(n(l,a),i?i(r[a]):r[a]):(l.length>=1e3&&delete r[l.shift()],l.push(a),r[a]=t[k](e,s),i?i(r[a]):r[a])}return o}function o(){return this.hex}function s(t,e){for(var n=[],i=0,o=t.length;o-2*!e>i;i+=2){var s=[{x:+t[i-2],y:+t[i-1]},{x:+t[i],y:+t[i+1]},{x:+t[i+2],y:+t[i+3]},{x:+t[i+4],y:+t[i+5]}];e?i?o-4==i?s[3]={x:+t[0],y:+t[1]}:o-2==i&&(s[2]={x:+t[0],y:+t[1]},s[3]={x:+t[2],y:+t[3]}):s[0]={x:+t[o-2],y:+t[o-1]}:o-4==i?s[3]=s[2]:i||(s[0]={x:+t[i],y:+t[i+1]}),n.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return n}function a(t,e,n,i,o){var s=-3*e+9*n-9*i+3*o,a=t*s+6*e-12*n+6*i;return t*a-3*e+3*n}function r(t,e,n,i,o,s,r,l,c){null==c&&(c=1),c=c>1?1:0>c?0:c;for(var u=c/2,d=12,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,g=0;d>g;g++){var m=u*h[g]+u,v=a(m,t,n,o,r),b=a(m,e,i,s,l),y=v*v+b*b;f+=p[g]*R.sqrt(y)}return u*f}function l(t,e,n,i,o,s,a,l,c){if(!(0>c||r(t,e,n,i,o,s,a,l)<c)){var u,d=1,h=d/2,p=d-h,f=.01;for(u=r(t,e,n,i,o,s,a,l,p);V(u-c)>f;)h/=2,p+=(c>u?1:-1)*h,u=r(t,e,n,i,o,s,a,l,p);return p}}function c(t,e,n,i,o,s,a,r){if(!(F(t,n)<z(o,a)||z(t,n)>F(o,a)||F(e,i)<z(s,r)||z(e,i)>F(s,r))){var l=(t*i-e*n)*(o-a)-(t-n)*(o*r-s*a),c=(t*i-e*n)*(s-r)-(e-i)*(o*r-s*a),u=(t-n)*(s-r)-(e-i)*(o-a);if(u){var d=l/u,h=c/u,p=+d.toFixed(2),f=+h.toFixed(2);if(!(p<+z(t,n).toFixed(2)||p>+F(t,n).toFixed(2)||p<+z(o,a).toFixed(2)||p>+F(o,a).toFixed(2)||f<+z(e,i).toFixed(2)||f>+F(e,i).toFixed(2)||f<+z(s,r).toFixed(2)||f>+F(s,r).toFixed(2)))return{x:d,y:h}}}}function u(e,n,i){var o=t.bezierBBox(e),s=t.bezierBBox(n);if(!t.isBBoxIntersect(o,s))return i?0:[];for(var a=r.apply(0,e),l=r.apply(0,n),u=~~(a/5),d=~~(l/5),h=[],p=[],f={},g=i?0:[],m=0;u+1>m;m++){var v=t.findDotsAtSegment.apply(t,e.concat(m/u));h.push({x:v.x,y:v.y,t:m/u})}for(m=0;d+1>m;m++)v=t.findDotsAtSegment.apply(t,n.concat(m/d)),p.push({x:v.x,y:v.y,t:m/d});for(m=0;u>m;m++)for(var b=0;d>b;b++){var y=h[m],w=h[m+1],_=p[b],x=p[b+1],C=V(w.x-y.x)<.001?"y":"x",S=V(x.x-_.x)<.001?"y":"x",T=c(y.x,y.y,w.x,w.y,_.x,_.y,x.x,x.y);if(T){if(f[T.x.toFixed(4)]==T.y.toFixed(4))continue;f[T.x.toFixed(4)]=T.y.toFixed(4);var D=y.t+V((T[C]-y[C])/(w[C]-y[C]))*(w.t-y.t),k=_.t+V((T[S]-_[S])/(x[S]-_[S]))*(x.t-_.t);D>=0&&1>=D&&k>=0&&1>=k&&(i?g++:g.push({x:T.x,y:T.y,t1:D,t2:k}))}}return g}function d(e,n,i){e=t._path2curve(e),n=t._path2curve(n);for(var o,s,a,r,l,c,d,h,p,f,g=i?0:[],m=0,v=e.length;v>m;m++){var b=e[m];if("M"==b[0])o=l=b[1],s=c=b[2];else{"C"==b[0]?(p=[o,s].concat(b.slice(1)),o=p[6],s=p[7]):(p=[o,s,o,s,l,c,l,c],o=l,s=c);for(var y=0,w=n.length;w>y;y++){var _=n[y];if("M"==_[0])a=d=_[1],r=h=_[2];else{"C"==_[0]?(f=[a,r].concat(_.slice(1)),a=f[6],r=f[7]):(f=[a,r,a,r,d,h,d,h],a=d,r=h);var x=u(p,f,i);if(i)g+=x;else{for(var C=0,S=x.length;S>C;C++)x[C].segment1=m,x[C].segment2=y,x[C].bez1=p,x[C].bez2=f;g=g.concat(x)}}}}}return g}function h(t,e,n,i,o,s){null!=t?(this.a=+t,this.b=+e,this.c=+n,this.d=+i,this.e=+o,this.f=+s):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function p(){return this.x+j+this.y+j+this.width+" × "+this.height}function f(t,e,n,i,o,s){function a(t){return((d*t+u)*t+c)*t}function r(t,e){var n=l(t,e);return((f*n+p)*n+h)*n}function l(t,e){var n,i,o,s,r,l;for(o=t,l=0;8>l;l++){if(s=a(o)-t,V(s)<e)return o;if(r=(3*d*o+2*u)*o+c,V(r)<1e-6)break;o-=s/r}if(n=0,i=1,o=t,n>o)return n;if(o>i)return i;for(;i>n;){if(s=a(o),V(s-t)<e)return o;t>s?n=o:i=o,o=(i-n)/2+n}return o}var c=3*e,u=3*(i-e)-c,d=1-c-u,h=3*n,p=3*(o-n)-h,f=1-h-p;return r(t,1/(200*s))}function g(t,e){var n=[],i={};if(this.ms=e,this.times=1,t){for(var o in t)t[C](o)&&(i[K(o)]=t[o],n.push(K(o)));n.sort(ce)}this.anim=i,this.top=n[n.length-1],this.percents=n}function m(e,n,i,o,s,a){i=K(i);var r,l,c,u,d,p,g=e.ms,m={},v={},b={};if(o)for(_=0,x=an.length;x>_;_++){var y=an[_];if(y.el.id==n.id&&y.anim==e){y.percent!=i?(an.splice(_,1),c=1):l=y,n.attr(y.totalOrigin);break}}else o=+v;for(var _=0,x=e.percents.length;x>_;_++){if(e.percents[_]==i||e.percents[_]>o*e.top){i=e.percents[_],d=e.percents[_-1]||0,g=g/e.top*(i-d),u=e.percents[_+1],r=e.anim[i];break}o&&n.attr(e.anim[e.percents[_]])}if(r){if(l)l.initstatus=o,l.start=new Date-l.ms*o;else{for(var S in r)if(r[C](S)&&(ee[C](S)||n.paper.customAttributes[C](S)))switch(m[S]=n.attr(S),null==m[S]&&(m[S]=te[S]),v[S]=r[S],ee[S]){case W:b[S]=(v[S]-m[S])/g;break;case"colour":m[S]=t.getRGB(m[S]);var T=t.getRGB(v[S]);b[S]={r:(T.r-m[S].r)/g,g:(T.g-m[S].g)/g,b:(T.b-m[S].b)/g};break;case"path":var D=Oe(m[S],v[S]),k=D[1];for(m[S]=D[0],b[S]=[],_=0,x=m[S].length;x>_;_++){b[S][_]=[0];for(var M=1,L=m[S][_].length;L>M;M++)b[S][_][M]=(k[_][M]-m[S][_][M])/g}break;case"transform":var j=n._,O=ze(j[S],v[S]);if(O)for(m[S]=O.from,v[S]=O.to,b[S]=[],b[S].real=!0,_=0,x=m[S].length;x>_;_++)for(b[S][_]=[m[S][_][0]],M=1,L=m[S][_].length;L>M;M++)b[S][_][M]=(v[S][_][M]-m[S][_][M])/g;else{var A=n.matrix||new h,P={_:{transform:j.transform},getBBox:function(){return n.getBBox(1)}};m[S]=[A.a,A.b,A.c,A.d,A.e,A.f],Re(P,v[S]),v[S]=P._.transform,b[S]=[(P.matrix.a-A.a)/g,(P.matrix.b-A.b)/g,(P.matrix.c-A.c)/g,(P.matrix.d-A.d)/g,(P.matrix.e-A.e)/g,(P.matrix.f-A.f)/g]}break;case"csv":var R=N(r[S])[E](w),F=N(m[S])[E](w);if("clip-rect"==S)for(m[S]=F,b[S]=[],_=F.length;_--;)b[S][_]=(R[_]-m[S][_])/g;v[S]=R;break;default:for(R=[][I](r[S]),F=[][I](m[S]),b[S]=[],_=n.paper.customAttributes[S].length;_--;)b[S][_]=((R[_]||0)-(F[_]||0))/g}var z=r.easing,V=t.easing_formulas[z];if(!V)if(V=N(z).match(J),V&&5==V.length){var B=V;V=function(t){return f(t,+B[1],+B[2],+B[3],+B[4],g)}}else V=de;if(p=r.start||e.start||+new Date,y={anim:e,percent:i,timestamp:p,start:p+(e.del||0),status:0,initstatus:o||0,stop:!1,ms:g,easing:V,from:m,diff:b,to:v,el:n,callback:r.callback,prev:d,next:u,repeat:a||e.times,origin:n.attr(),totalOrigin:s},an.push(y),o&&!l&&!c&&(y.stop=!0,y.start=new Date-g*o,1==an.length))return ln();c&&(y.start=new Date-y.ms*o),1==an.length&&rn(ln)}eve("raphael.anim.start."+n.id,n,e)}}function v(t){for(var e=0;e<an.length;e++)an[e].el.paper==t&&an.splice(e--,1)}t.version="2.1.0",t.eve=eve;var b,y,w=/[, ]+/,_={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},x=/\{(\d+)\}/g,C="hasOwnProperty",S={doc:document,win:window},T={was:Object.prototype[C].call(S.win,"Raphael"),is:S.win.Raphael},D=function(){this.ca=this.customAttributes={}},k="apply",I="concat",M="createTouch"in S.doc,L="",j=" ",N=String,E="split",O="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[E](j),A={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},P=N.prototype.toLowerCase,R=Math,F=R.max,z=R.min,V=R.abs,B=R.pow,H=R.PI,W="number",$="string",q="array",U=Object.prototype.toString,X=(t._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),G={NaN:1,Infinity:1,"-Infinity":1},J=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Y=R.round,K=parseFloat,Q=parseInt,Z=N.prototype.toUpperCase,te=t._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},ee=t._availableAnimAttrs={blur:W,"clip-rect":"csv",cx:W,cy:W,fill:"colour","fill-opacity":W,"font-size":W,height:W,opacity:W,path:"path",r:W,rx:W,ry:W,stroke:"colour","stroke-opacity":W,"stroke-width":W,transform:"transform",width:W,x:W,y:W},ne=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,ie={hs:1,rg:1},oe=/,?([achlmqrstvxz]),?/gi,se=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,ae=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,re=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,le=(t._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),ce=function(t,e){return K(t)-K(e)},ue=function(){},de=function(t){return t},he=t._rectPath=function(t,e,n,i,o){return o?[["M",t+o,e],["l",n-2*o,0],["a",o,o,0,0,1,o,o],["l",0,i-2*o],["a",o,o,0,0,1,-o,o],["l",2*o-n,0],["a",o,o,0,0,1,-o,-o],["l",0,2*o-i],["a",o,o,0,0,1,o,-o],["z"]]:[["M",t,e],["l",n,0],["l",0,i],["l",-n,0],["z"]]},pe=function(t,e,n,i){return null==i&&(i=n),[["M",t,e],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]]},fe=t._getPath={path:function(t){return t.attr("path")},circle:function(t){var e=t.attrs;return pe(e.cx,e.cy,e.r)},ellipse:function(t){var e=t.attrs;return pe(e.cx,e.cy,e.rx,e.ry)},rect:function(t){var e=t.attrs;return he(e.x,e.y,e.width,e.height,e.r)},image:function(t){var e=t.attrs;return he(e.x,e.y,e.width,e.height)},text:function(t){var e=t._getBBox();return he(e.x,e.y,e.width,e.height)}},ge=t.mapPath=function(t,e){if(!e)return t;var n,i,o,s,a,r,l;for(t=Oe(t),o=0,a=t.length;a>o;o++)for(l=t[o],s=1,r=l.length;r>s;s+=2)n=e.x(l[s],l[s+1]),i=e.y(l[s],l[s+1]),l[s]=n,l[s+1]=i;return t};if(t._g=S,t.type=S.win.SVGAngle||S.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var me,ve=S.doc.createElement("div");if(ve.innerHTML='<v:shape adj="1"/>',me=ve.firstChild,me.style.behavior="url(#default#VML)",!me||"object"!=typeof me.adj)return t.type=L;ve=null}t.svg=!(t.vml="VML"==t.type),t._Paper=D,t.fn=y=D.prototype=t.prototype,t._id=0,t._oid=0,t.is=function(t,e){return e=P.call(e),"finite"==e?!G[C](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||U.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,n,i,o,s,a){if(null==s){var r=e-i,l=n-o;return r||l?(180+180*R.atan2(-l,-r)/H+360)%360:0}return t.angle(e,n,s,a)-t.angle(i,o,s,a)},t.rad=function(t){return t%360*H/180},t.deg=function(t){return 180*t/H%360},t.snapTo=function(e,n,i){if(i=t.is(i,"finite")?i:10,t.is(e,q)){for(var o=e.length;o--;)if(V(e[o]-n)<=i)return e[o]}else{e=+e;var s=n%e;if(i>s)return n-s;if(s>e-i)return n-s+e}return n};t.createUUID=function(t,e){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,e).toUpperCase()}}(/[xy]/g,function(t){var e=16*R.random()|0,n="x"==t?e:3&e|8;return n.toString(16)});t.setWindow=function(e){eve("raphael.setWindow",t,S.win,e),S.win=e,S.doc=S.win.document,t._engine.initWin&&t._engine.initWin(S.win)};var be=function(e){if(t.vml){var n,o=/^\s+|\s+$/g;try{var s=new ActiveXObject("htmlfile");s.write("<body>"),s.close(),n=s.body}catch(a){n=createPopup().document.body}var r=n.createTextRange();be=i(function(t){try{n.style.color=N(t).replace(o,L);var e=r.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e.toString(16)).slice(-6)}catch(i){return"none"}})}else{var l=S.doc.createElement("i");l.title="Raphaël Colour Picker",l.style.display="none",S.doc.body.appendChild(l),be=i(function(t){return l.style.color=t,S.doc.defaultView.getComputedStyle(l,L).getPropertyValue("color")})}return be(e)},ye=function(){return"hsb("+[this.h,this.s,this.b]+")"},we=function(){return"hsl("+[this.h,this.s,this.l]+")"},_e=function(){return this.hex},xe=function(e,n,i){if(null==n&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(i=e.b,n=e.g,e=e.r),null==n&&t.is(e,$)){var o=t.getRGB(e);e=o.r,n=o.g,i=o.b}return(e>1||n>1||i>1)&&(e/=255,n/=255,i/=255),[e,n,i]},Ce=function(e,n,i,o){e*=255,n*=255,i*=255;var s={r:e,g:n,b:i,hex:t.rgb(e,n,i),toString:_e};return t.is(o,"finite")&&(s.opacity=o),s};t.color=function(e){var n;return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e?(n=t.hsb2rgb(e),e.r=n.r,e.g=n.g,e.b=n.b,e.hex=n.hex):t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e?(n=t.hsl2rgb(e),e.r=n.r,e.g=n.g,e.b=n.b,e.hex=n.hex):(t.is(e,"string")&&(e=t.getRGB(e)),t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e?(n=t.rgb2hsl(e),e.h=n.h,e.s=n.s,e.l=n.l,n=t.rgb2hsb(e),e.v=n.b):(e={hex:"none"},e.r=e.g=e.b=e.h=e.s=e.v=e.l=-1)),e.toString=_e,e},t.hsb2rgb=function(t,e,n,i){this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(n=t.b,e=t.s,t=t.h,i=t.o),t*=360;var o,s,a,r,l;return t=t%360/60,l=n*e,r=l*(1-V(t%2-1)),o=s=a=n-l,t=~~t,o+=[l,r,0,0,r,l][t],s+=[r,l,l,r,0,0][t],a+=[0,0,r,l,l,r][t],Ce(o,s,a,i)},t.hsl2rgb=function(t,e,n,i){this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(n=t.l,e=t.s,t=t.h),(t>1||e>1||n>1)&&(t/=360,e/=100,n/=100),t*=360;var o,s,a,r,l;return t=t%360/60,l=2*e*(.5>n?n:1-n),r=l*(1-V(t%2-1)),o=s=a=n-l/2,t=~~t,o+=[l,r,0,0,r,l][t],s+=[r,l,l,r,0,0][t],a+=[0,0,r,l,l,r][t],Ce(o,s,a,i)},t.rgb2hsb=function(t,e,n){n=xe(t,e,n),t=n[0],e=n[1],n=n[2];var i,o,s,a;return s=F(t,e,n),a=s-z(t,e,n),i=0==a?null:s==t?(e-n)/a:s==e?(n-t)/a+2:(t-e)/a+4,i=(i+360)%6*60/360,o=0==a?0:a/s,{h:i,s:o,b:s,toString:ye}},t.rgb2hsl=function(t,e,n){n=xe(t,e,n),t=n[0],e=n[1],n=n[2];var i,o,s,a,r,l;return a=F(t,e,n),r=z(t,e,n),l=a-r,i=0==l?null:a==t?(e-n)/l:a==e?(n-t)/l+2:(t-e)/l+4,i=(i+360)%6*60/360,s=(a+r)/2,o=0==l?0:.5>s?l/(2*s):l/(2-2*s),{h:i,s:o,l:s,toString:we}},t._path2string=function(){return this.join(",").replace(oe,"$1")};t._preload=function(t,e){var n=S.doc.createElement("img");n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){e.call(this),this.onload=null,S.doc.body.removeChild(this)},n.onerror=function(){S.doc.body.removeChild(this)},S.doc.body.appendChild(n),n.src=t};t.getRGB=i(function(e){if(!e||(e=N(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:o};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none",toString:o};!(ie[C](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=be(e));var n,i,s,a,r,l,c=e.match(X);return c?(c[2]&&(s=Q(c[2].substring(5),16),i=Q(c[2].substring(3,5),16),n=Q(c[2].substring(1,3),16)),c[3]&&(s=Q((r=c[3].charAt(3))+r,16),i=Q((r=c[3].charAt(2))+r,16),n=Q((r=c[3].charAt(1))+r,16)),c[4]&&(l=c[4][E](ne),n=K(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),i=K(l[1]),"%"==l[1].slice(-1)&&(i*=2.55),s=K(l[2]),"%"==l[2].slice(-1)&&(s*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(a=K(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100)),c[5]?(l=c[5][E](ne),n=K(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),i=K(l[1]),"%"==l[1].slice(-1)&&(i*=2.55),s=K(l[2]),"%"==l[2].slice(-1)&&(s*=2.55),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(n/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(a=K(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100),t.hsb2rgb(n,i,s,a)):c[6]?(l=c[6][E](ne),n=K(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),i=K(l[1]),"%"==l[1].slice(-1)&&(i*=2.55),s=K(l[2]),"%"==l[2].slice(-1)&&(s*=2.55),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(n/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(a=K(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100),t.hsl2rgb(n,i,s,a)):(c={r:n,g:i,b:s,toString:o},c.hex="#"+(16777216|s|i<<8|n<<16).toString(16).slice(1),t.is(a,"finite")&&(c.opacity=a),c)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:o}},t),t.hsb=i(function(e,n,i){return t.hsb2rgb(e,n,i).hex}),t.hsl=i(function(e,n,i){return t.hsl2rgb(e,n,i).hex}),t.rgb=i(function(t,e,n){return"#"+(16777216|n|e<<8|t<<16).toString(16).slice(1)}),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},n=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),n.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=function(e){if(!e)return null;var n=Se(e);if(n.arr)return De(n.arr);var i={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},o=[];return t.is(e,q)&&t.is(e[0],q)&&(o=De(e)),o.length||N(e).replace(se,function(t,e,n){var s=[],a=e.toLowerCase();if(n.replace(re,function(t,e){e&&s.push(+e)}),"m"==a&&s.length>2&&(o.push([e][I](s.splice(0,2))),a="l",e="m"==e?"l":"L"),"r"==a)o.push([e][I](s));else for(;s.length>=i[a]&&(o.push([e][I](s.splice(0,i[a]))),i[a]););}),o.toString=t._path2string,n.arr=De(o),o},t.parseTransformString=i(function(e){if(!e)return null;var n=[];return t.is(e,q)&&t.is(e[0],q)&&(n=De(e)),n.length||N(e).replace(ae,function(t,e,i){{var o=[];P.call(e)}i.replace(re,function(t,e){e&&o.push(+e)}),n.push([e][I](o))}),n.toString=t._path2string,n});var Se=function(t){var e=Se.ps=Se.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var n in e)e[C](n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])}),e[t]};t.findDotsAtSegment=function(t,e,n,i,o,s,a,r,l){var c=1-l,u=B(c,3),d=B(c,2),h=l*l,p=h*l,f=u*t+3*d*l*n+3*c*l*l*o+p*a,g=u*e+3*d*l*i+3*c*l*l*s+p*r,m=t+2*l*(n-t)+h*(o-2*n+t),v=e+2*l*(i-e)+h*(s-2*i+e),b=n+2*l*(o-n)+h*(a-2*o+n),y=i+2*l*(s-i)+h*(r-2*s+i),w=c*t+l*n,_=c*e+l*i,x=c*o+l*a,C=c*s+l*r,S=90-180*R.atan2(m-b,v-y)/H;return(m>b||y>v)&&(S+=180),{x:f,y:g,m:{x:m,y:v},n:{x:b,y:y},start:{x:w,y:_},end:{x:x,y:C},alpha:S}},t.bezierBBox=function(e,n,i,o,s,a,r,l){t.is(e,"array")||(e=[e,n,i,o,s,a,r,l]);var c=Ee.apply(null,e);return{x:c.min.x,y:c.min.y,x2:c.max.x,y2:c.max.y,width:c.max.x-c.min.x,height:c.max.y-c.min.y}},t.isPointInsideBBox=function(t,e,n){return e>=t.x&&e<=t.x2&&n>=t.y&&n<=t.y2},t.isBBoxIntersect=function(e,n){var i=t.isPointInsideBBox;return i(n,e.x,e.y)||i(n,e.x2,e.y)||i(n,e.x,e.y2)||i(n,e.x2,e.y2)||i(e,n.x,n.y)||i(e,n.x2,n.y)||i(e,n.x,n.y2)||i(e,n.x2,n.y2)||(e.x<n.x2&&e.x>n.x||n.x<e.x2&&n.x>e.x)&&(e.y<n.y2&&e.y>n.y||n.y<e.y2&&n.y>e.y)},t.pathIntersection=function(t,e){return d(t,e)},t.pathIntersectionNumber=function(t,e){return d(t,e,1)},t.isPointInsidePath=function(e,n,i){var o=t.pathBBox(e);return t.isPointInsideBBox(o,n,i)&&d(e,[["M",n,i],["H",o.x2+10]],1)%2==1},t._removedFactory=function(t){return function(){eve("raphael.log",null,"Raphaël: you are calling to method “"+t+"” of removed object",t)}};var Te=t.pathBBox=function(t){var n=Se(t);if(n.bbox)return n.bbox;if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};t=Oe(t);for(var i,o=0,s=0,a=[],r=[],l=0,c=t.length;c>l;l++)if(i=t[l],"M"==i[0])o=i[1],s=i[2],a.push(o),r.push(s);else{var u=Ee(o,s,i[1],i[2],i[3],i[4],i[5],i[6]);a=a[I](u.min.x,u.max.x),r=r[I](u.min.y,u.max.y),o=i[5],s=i[6]}var d=z[k](0,a),h=z[k](0,r),p=F[k](0,a),f=F[k](0,r),g={x:d,y:h,x2:p,y2:f,width:p-d,height:f-h};return n.bbox=e(g),g},De=function(n){var i=e(n);return i.toString=t._path2string,i},ke=t._pathToRelative=function(e){var n=Se(e);if(n.rel)return De(n.rel);t.is(e,q)&&t.is(e&&e[0],q)||(e=t.parsePathString(e));var i=[],o=0,s=0,a=0,r=0,l=0;"M"==e[0][0]&&(o=e[0][1],s=e[0][2],a=o,r=s,l++,i.push(["M",o,s]));for(var c=l,u=e.length;u>c;c++){var d=i[c]=[],h=e[c];if(h[0]!=P.call(h[0]))switch(d[0]=P.call(h[0]),d[0]){case"a":d[1]=h[1],d[2]=h[2],d[3]=h[3],d[4]=h[4],d[5]=h[5],d[6]=+(h[6]-o).toFixed(3),d[7]=+(h[7]-s).toFixed(3);break;case"v":d[1]=+(h[1]-s).toFixed(3);break;case"m":a=h[1],r=h[2];default:for(var p=1,f=h.length;f>p;p++)d[p]=+(h[p]-(p%2?o:s)).toFixed(3)}else{d=i[c]=[],"m"==h[0]&&(a=h[1]+o,r=h[2]+s);for(var g=0,m=h.length;m>g;g++)i[c][g]=h[g]}var v=i[c].length;switch(i[c][0]){case"z":o=a,s=r;break;case"h":o+=+i[c][v-1];break;case"v":s+=+i[c][v-1];break;default:o+=+i[c][v-2],s+=+i[c][v-1]}}return i.toString=t._path2string,n.rel=De(i),i},Ie=t._pathToAbsolute=function(e){var n=Se(e);if(n.abs)return De(n.abs);if(t.is(e,q)&&t.is(e&&e[0],q)||(e=t.parsePathString(e)),!e||!e.length)return[["M",0,0]];var i=[],o=0,a=0,r=0,l=0,c=0;"M"==e[0][0]&&(o=+e[0][1],a=+e[0][2],r=o,l=a,c++,i[0]=["M",o,a]);for(var u,d,h=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),p=c,f=e.length;f>p;p++){if(i.push(u=[]),d=e[p],d[0]!=Z.call(d[0]))switch(u[0]=Z.call(d[0]),u[0]){case"A":u[1]=d[1],u[2]=d[2],u[3]=d[3],u[4]=d[4],u[5]=d[5],u[6]=+(d[6]+o),u[7]=+(d[7]+a);break;case"V":u[1]=+d[1]+a;break;case"H":u[1]=+d[1]+o;break;case"R":for(var g=[o,a][I](d.slice(1)),m=2,v=g.length;v>m;m++)g[m]=+g[m]+o,g[++m]=+g[m]+a;i.pop(),i=i[I](s(g,h));break;case"M":r=+d[1]+o,l=+d[2]+a;default:for(m=1,v=d.length;v>m;m++)u[m]=+d[m]+(m%2?o:a)}else if("R"==d[0])g=[o,a][I](d.slice(1)),i.pop(),i=i[I](s(g,h)),u=["R"][I](d.slice(-2));else for(var b=0,y=d.length;y>b;b++)u[b]=d[b];switch(u[0]){case"Z":o=r,a=l;break;case"H":o=u[1];break;case"V":a=u[1];break;case"M":r=u[u.length-2],l=u[u.length-1];default:o=u[u.length-2],a=u[u.length-1]}}return i.toString=t._path2string,n.abs=De(i),i},Me=function(t,e,n,i){return[t,e,n,i,n,i]},Le=function(t,e,n,i,o,s){var a=1/3,r=2/3;return[a*t+r*n,a*e+r*i,a*o+r*n,a*s+r*i,o,s]},je=function(t,e,n,o,s,a,r,l,c,u){var d,h=120*H/180,p=H/180*(+s||0),f=[],g=i(function(t,e,n){var i=t*R.cos(n)-e*R.sin(n),o=t*R.sin(n)+e*R.cos(n);return{x:i,y:o}});if(u)S=u[0],T=u[1],x=u[2],C=u[3];else{d=g(t,e,-p),t=d.x,e=d.y,d=g(l,c,-p),l=d.x,c=d.y;var m=(R.cos(H/180*s),R.sin(H/180*s),(t-l)/2),v=(e-c)/2,b=m*m/(n*n)+v*v/(o*o);b>1&&(b=R.sqrt(b),n=b*n,o=b*o);var y=n*n,w=o*o,_=(a==r?-1:1)*R.sqrt(V((y*w-y*v*v-w*m*m)/(y*v*v+w*m*m))),x=_*n*v/o+(t+l)/2,C=_*-o*m/n+(e+c)/2,S=R.asin(((e-C)/o).toFixed(9)),T=R.asin(((c-C)/o).toFixed(9));S=x>t?H-S:S,T=x>l?H-T:T,0>S&&(S=2*H+S),0>T&&(T=2*H+T),r&&S>T&&(S-=2*H),!r&&T>S&&(T-=2*H)}var D=T-S;if(V(D)>h){var k=T,M=l,L=c;T=S+h*(r&&T>S?1:-1),l=x+n*R.cos(T),c=C+o*R.sin(T),f=je(l,c,n,o,s,0,r,M,L,[T,k,x,C])}D=T-S;var j=R.cos(S),N=R.sin(S),O=R.cos(T),A=R.sin(T),P=R.tan(D/4),F=4/3*n*P,z=4/3*o*P,B=[t,e],W=[t+F*N,e-z*j],$=[l+F*A,c-z*O],q=[l,c];if(W[0]=2*B[0]-W[0],W[1]=2*B[1]-W[1],u)return[W,$,q][I](f);f=[W,$,q][I](f).join()[E](",");for(var U=[],X=0,G=f.length;G>X;X++)U[X]=X%2?g(f[X-1],f[X],p).y:g(f[X],f[X+1],p).x;return U},Ne=function(t,e,n,i,o,s,a,r,l){var c=1-l;return{x:B(c,3)*t+3*B(c,2)*l*n+3*c*l*l*o+B(l,3)*a,y:B(c,3)*e+3*B(c,2)*l*i+3*c*l*l*s+B(l,3)*r}},Ee=i(function(t,e,n,i,o,s,a,r){var l,c=o-2*n+t-(a-2*o+n),u=2*(n-t)-2*(o-n),d=t-n,h=(-u+R.sqrt(u*u-4*c*d))/2/c,p=(-u-R.sqrt(u*u-4*c*d))/2/c,f=[e,r],g=[t,a];return V(h)>"1e12"&&(h=.5),V(p)>"1e12"&&(p=.5),h>0&&1>h&&(l=Ne(t,e,n,i,o,s,a,r,h),g.push(l.x),f.push(l.y)),p>0&&1>p&&(l=Ne(t,e,n,i,o,s,a,r,p),g.push(l.x),f.push(l.y)),c=s-2*i+e-(r-2*s+i),u=2*(i-e)-2*(s-i),d=e-i,h=(-u+R.sqrt(u*u-4*c*d))/2/c,p=(-u-R.sqrt(u*u-4*c*d))/2/c,V(h)>"1e12"&&(h=.5),V(p)>"1e12"&&(p=.5),h>0&&1>h&&(l=Ne(t,e,n,i,o,s,a,r,h),g.push(l.x),f.push(l.y)),p>0&&1>p&&(l=Ne(t,e,n,i,o,s,a,r,p),g.push(l.x),f.push(l.y)),{min:{x:z[k](0,g),y:z[k](0,f)},max:{x:F[k](0,g),y:F[k](0,f)}}}),Oe=t._path2curve=i(function(t,e){var n=!e&&Se(t);if(!e&&n.curve)return De(n.curve);for(var i=Ie(t),o=e&&Ie(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r=(function(t,e){var n,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][I](je[k](0,[e.x,e.y][I](t.slice(1))));break;case"S":n=e.x+(e.x-(e.bx||e.x)),i=e.y+(e.y-(e.by||e.y)),t=["C",n,i][I](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][I](Le(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][I](Le(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][I](Me(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][I](Me(e.x,e.y,t[1],e.y));break;case"V":t=["C"][I](Me(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][I](Me(e.x,e.y,e.X,e.Y))}return t}),l=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)t.splice(e++,0,["C"][I](n.splice(0,6)));t.splice(e,1),d=F(i.length,o&&o.length||0)}},c=function(t,e,n,s,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",s.x,s.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],d=F(i.length,o&&o.length||0))},u=0,d=F(i.length,o&&o.length||0);d>u;u++){i[u]=r(i[u],s),l(i,u),o&&(o[u]=r(o[u],a)),o&&l(o,u),c(i,o,s,a,u),c(o,i,a,s,u);var h=i[u],p=o&&o[u],f=h.length,g=o&&p.length;s.x=h[f-2],s.y=h[f-1],s.bx=K(h[f-4])||s.x,s.by=K(h[f-3])||s.y,a.bx=o&&(K(p[g-4])||a.x),a.by=o&&(K(p[g-3])||a.y),a.x=o&&p[g-2],a.y=o&&p[g-1]}return o||(n.curve=De(i)),o?[i,o]:i},null,De),Ae=(t._parseDots=i(function(e){for(var n=[],i=0,o=e.length;o>i;i++){var s={},a=e[i].match(/^([^:]*):?([\d\.]*)/);if(s.color=t.getRGB(a[1]),s.color.error)return null;s.color=s.color.hex,a[2]&&(s.offset=a[2]+"%"),n.push(s)}for(i=1,o=n.length-1;o>i;i++)if(!n[i].offset){for(var r=K(n[i-1].offset||0),l=0,c=i+1;o>c;c++)if(n[c].offset){l=n[c].offset;break}l||(l=100,c=o),l=K(l);for(var u=(l-r)/(c-i+1);c>i;i++)r+=u,n[i].offset=r+"%"}return n}),t._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),Pe=(t._tofront=function(t,e){e.top!==t&&(Ae(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},t._toback=function(t,e){e.bottom!==t&&(Ae(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},t._insertafter=function(t,e,n){Ae(t,n),e==n.top&&(n.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},t._insertbefore=function(t,e,n){Ae(t,n),e==n.bottom&&(n.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},t.toMatrix=function(t,e){var n=Te(t),i={_:{transform:L},getBBox:function(){return n}};return Re(i,e),i.matrix}),Re=(t.transformPath=function(t,e){return ge(t,Pe(t,e))},t._extractTransform=function(e,n){if(null==n)return e._.transform;n=N(n).replace(/\.{3}|\u2026/g,e._.transform||L);var i=t.parseTransformString(n),o=0,s=0,a=0,r=1,l=1,c=e._,u=new h;if(c.transform=i||[],i)for(var d=0,p=i.length;p>d;d++){var f,g,m,v,b,y=i[d],w=y.length,_=N(y[0]).toLowerCase(),x=y[0]!=_,C=x?u.invert():0;"t"==_&&3==w?x?(f=C.x(0,0),g=C.y(0,0),m=C.x(y[1],y[2]),v=C.y(y[1],y[2]),u.translate(m-f,v-g)):u.translate(y[1],y[2]):"r"==_?2==w?(b=b||e.getBBox(1),u.rotate(y[1],b.x+b.width/2,b.y+b.height/2),o+=y[1]):4==w&&(x?(m=C.x(y[2],y[3]),v=C.y(y[2],y[3]),u.rotate(y[1],m,v)):u.rotate(y[1],y[2],y[3]),o+=y[1]):"s"==_?2==w||3==w?(b=b||e.getBBox(1),u.scale(y[1],y[w-1],b.x+b.width/2,b.y+b.height/2),r*=y[1],l*=y[w-1]):5==w&&(x?(m=C.x(y[3],y[4]),v=C.y(y[3],y[4]),u.scale(y[1],y[2],m,v)):u.scale(y[1],y[2],y[3],y[4]),r*=y[1],l*=y[2]):"m"==_&&7==w&&u.add(y[1],y[2],y[3],y[4],y[5],y[6]),c.dirtyT=1,e.matrix=u
}e.matrix=u,c.sx=r,c.sy=l,c.deg=o,c.dx=s=u.e,c.dy=a=u.f,1==r&&1==l&&!o&&c.bbox?(c.bbox.x+=+s,c.bbox.y+=+a):c.dirtyT=1}),Fe=function(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}},ze=t._equaliseTransform=function(e,n){n=N(n).replace(/\.{3}|\u2026/g,e),e=t.parseTransformString(e)||[],n=t.parseTransformString(n)||[];for(var i,o,s,a,r=F(e.length,n.length),l=[],c=[],u=0;r>u;u++){if(s=e[u]||Fe(n[u]),a=n[u]||Fe(s),s[0]!=a[0]||"r"==s[0].toLowerCase()&&(s[2]!=a[2]||s[3]!=a[3])||"s"==s[0].toLowerCase()&&(s[3]!=a[3]||s[4]!=a[4]))return;for(l[u]=[],c[u]=[],i=0,o=F(s.length,a.length);o>i;i++)i in s&&(l[u][i]=s[i]),i in a&&(c[u][i]=a[i])}return{from:l,to:c}};t._getContainer=function(e,n,i,o){var s;return s=null!=o||t.is(e,"object")?e:S.doc.getElementById(e),null!=s?s.tagName?null==n?{container:s,width:s.style.pixelWidth||s.offsetWidth,height:s.style.pixelHeight||s.offsetHeight}:{container:s,width:n,height:i}:{container:1,x:e,y:n,width:i,height:o}:void 0},t.pathToRelative=ke,t._engine={},t.path2curve=Oe,t.matrix=function(t,e,n,i,o,s){return new h(t,e,n,i,o,s)},function(e){function n(t){return t[0]*t[0]+t[1]*t[1]}function i(t){var e=R.sqrt(n(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}e.add=function(t,e,n,i,o,s){var a,r,l,c,u=[[],[],[]],d=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],p=[[t,n,o],[e,i,s],[0,0,1]];for(t&&t instanceof h&&(p=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),a=0;3>a;a++)for(r=0;3>r;r++){for(c=0,l=0;3>l;l++)c+=d[a][l]*p[l][r];u[a][r]=c}this.a=u[0][0],this.b=u[1][0],this.c=u[0][1],this.d=u[1][1],this.e=u[0][2],this.f=u[1][2]},e.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new h(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},e.clone=function(){return new h(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(t,e){this.add(1,0,0,1,t,e)},e.scale=function(t,e,n,i){null==e&&(e=t),(n||i)&&this.add(1,0,0,1,n,i),this.add(t,0,0,e,0,0),(n||i)&&this.add(1,0,0,1,-n,-i)},e.rotate=function(e,n,i){e=t.rad(e),n=n||0,i=i||0;var o=+R.cos(e).toFixed(9),s=+R.sin(e).toFixed(9);this.add(o,s,-s,o,n,i),this.add(1,0,0,1,-n,-i)},e.x=function(t,e){return t*this.a+e*this.c+this.e},e.y=function(t,e){return t*this.b+e*this.d+this.f},e.get=function(t){return+this[N.fromCharCode(97+t)].toFixed(4)},e.toString=function(){return t.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},e.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.split=function(){var e={};e.dx=this.e,e.dy=this.f;var o=[[this.a,this.c],[this.b,this.d]];e.scalex=R.sqrt(n(o[0])),i(o[0]),e.shear=o[0][0]*o[1][0]+o[0][1]*o[1][1],o[1]=[o[1][0]-o[0][0]*e.shear,o[1][1]-o[0][1]*e.shear],e.scaley=R.sqrt(n(o[1])),i(o[1]),e.shear/=e.scaley;var s=-o[0][1],a=o[1][1];return 0>a?(e.rotate=t.deg(R.acos(a)),0>s&&(e.rotate=360-e.rotate)):e.rotate=t.deg(R.asin(s)),e.isSimple=!(+e.shear.toFixed(9)||e.scalex.toFixed(9)!=e.scaley.toFixed(9)&&e.rotate),e.isSuperSimple=!+e.shear.toFixed(9)&&e.scalex.toFixed(9)==e.scaley.toFixed(9)&&!e.rotate,e.noRotation=!+e.shear.toFixed(9)&&!e.rotate,e},e.toTransformString=function(t){var e=t||this[E]();return e.isSimple?(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[e.dx,e.dy]:L)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:L)+(e.rotate?"r"+[e.rotate,0,0]:L)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(h.prototype);var Ve=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);y.safari="Apple Computer, Inc."==navigator.vendor&&(Ve&&Ve[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Ve&&Ve[1]<8?function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){t.remove()})}:ue;for(var Be=function(){this.returnValue=!1},He=function(){return this.originalEvent.preventDefault()},We=function(){this.cancelBubble=!0},$e=function(){return this.originalEvent.stopPropagation()},qe=function(){return S.doc.addEventListener?function(t,e,n,i){var o=M&&A[e]?A[e]:e,s=function(o){var s=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,a=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,r=o.clientX+a,l=o.clientY+s;if(M&&A[C](e))for(var c=0,u=o.targetTouches&&o.targetTouches.length;u>c;c++)if(o.targetTouches[c].target==t){var d=o;o=o.targetTouches[c],o.originalEvent=d,o.preventDefault=He,o.stopPropagation=$e;break}return n.call(i,o,r,l)};return t.addEventListener(o,s,!1),function(){return t.removeEventListener(o,s,!1),!0}}:S.doc.attachEvent?function(t,e,n,i){var o=function(t){t=t||S.win.event;var e=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,o=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,s=t.clientX+o,a=t.clientY+e;return t.preventDefault=t.preventDefault||Be,t.stopPropagation=t.stopPropagation||We,n.call(i,t,s,a)};t.attachEvent("on"+e,o);var s=function(){return t.detachEvent("on"+e,o),!0};return s}:void 0}(),Ue=[],Xe=function(t){for(var e,n=t.clientX,i=t.clientY,o=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,s=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,a=Ue.length;a--;){if(e=Ue[a],M){for(var r,l=t.touches.length;l--;)if(r=t.touches[l],r.identifier==e.el._drag.id){n=r.clientX,i=r.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var c,u=e.el.node,d=u.nextSibling,h=u.parentNode,p=u.style.display;S.win.opera&&h.removeChild(u),u.style.display="none",c=e.el.paper.getElementByPoint(n,i),u.style.display=p,S.win.opera&&(d?h.insertBefore(u,d):h.appendChild(u)),c&&eve("raphael.drag.over."+e.el.id,e.el,c),n+=s,i+=o,eve("raphael.drag.move."+e.el.id,e.move_scope||e.el,n-e.el._drag.x,i-e.el._drag.y,n,i,t)}},Ge=function(e){t.unmousemove(Xe).unmouseup(Ge);for(var n,i=Ue.length;i--;)n=Ue[i],n.el._drag={},eve("raphael.drag.end."+n.el.id,n.end_scope||n.start_scope||n.move_scope||n.el,e);Ue=[]},Je=t.el={},Ye=O.length;Ye--;)!function(e){t[e]=Je[e]=function(n,i){return t.is(n,"function")&&(this.events=this.events||[],this.events.push({name:e,f:n,unbind:qe(this.shape||this.node||S.doc,e,n,i||this)})),this},t["un"+e]=Je["un"+e]=function(t){for(var n=this.events||[],i=n.length;i--;)if(n[i].name==e&&n[i].f==t)return n[i].unbind(),n.splice(i,1),!n.length&&delete this.events,this;return this}}(O[Ye]);Je.data=function(e,n){var i=le[this.id]=le[this.id]||{};if(1==arguments.length){if(t.is(e,"object")){for(var o in e)e[C](o)&&this.data(o,e[o]);return this}return eve("raphael.data.get."+this.id,this,i[e],e),i[e]}return i[e]=n,eve("raphael.data.set."+this.id,this,n,e),this},Je.removeData=function(t){return null==t?le[this.id]={}:le[this.id]&&delete le[this.id][t],this},Je.hover=function(t,e,n,i){return this.mouseover(t,n).mouseout(e,i||n)},Je.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var Ke=[];Je.drag=function(e,n,i,o,s,a){function r(r){(r.originalEvent||r).preventDefault();var l=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,c=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft;this._drag.x=r.clientX+c,this._drag.y=r.clientY+l,this._drag.id=r.identifier,!Ue.length&&t.mousemove(Xe).mouseup(Ge),Ue.push({el:this,move_scope:o,start_scope:s,end_scope:a}),n&&eve.on("raphael.drag.start."+this.id,n),e&&eve.on("raphael.drag.move."+this.id,e),i&&eve.on("raphael.drag.end."+this.id,i),eve("raphael.drag.start."+this.id,s||o||this,r.clientX+c,r.clientY+l,r)}return this._drag={},Ke.push({el:this,start:r}),this.mousedown(r),this},Je.onDragOver=function(t){t?eve.on("raphael.drag.over."+this.id,t):eve.unbind("raphael.drag.over."+this.id)},Je.undrag=function(){for(var e=Ke.length;e--;)Ke[e].el==this&&(this.unmousedown(Ke[e].start),Ke.splice(e,1),eve.unbind("raphael.drag.*."+this.id));!Ke.length&&t.unmousemove(Xe).unmouseup(Ge)},y.circle=function(e,n,i){var o=t._engine.circle(this,e||0,n||0,i||0);return this.__set__&&this.__set__.push(o),o},y.rect=function(e,n,i,o,s){var a=t._engine.rect(this,e||0,n||0,i||0,o||0,s||0);return this.__set__&&this.__set__.push(a),a},y.ellipse=function(e,n,i,o){var s=t._engine.ellipse(this,e||0,n||0,i||0,o||0);return this.__set__&&this.__set__.push(s),s},y.path=function(e){e&&!t.is(e,$)&&!t.is(e[0],q)&&(e+=L);var n=t._engine.path(t.format[k](t,arguments),this);return this.__set__&&this.__set__.push(n),n},y.image=function(e,n,i,o,s){var a=t._engine.image(this,e||"about:blank",n||0,i||0,o||0,s||0);return this.__set__&&this.__set__.push(a),a},y.text=function(e,n,i){var o=t._engine.text(this,e||0,n||0,N(i));return this.__set__&&this.__set__.push(o),o},y.set=function(e){!t.is(e,"array")&&(e=Array.prototype.splice.call(arguments,0,arguments.length));var n=new un(e);return this.__set__&&this.__set__.push(n),n},y.setStart=function(t){this.__set__=t||this.set()},y.setFinish=function(){var t=this.__set__;return delete this.__set__,t},y.setSize=function(e,n){return t._engine.setSize.call(this,e,n)},y.setViewBox=function(e,n,i,o,s){return t._engine.setViewBox.call(this,e,n,i,o,s)},y.top=y.bottom=null,y.raphael=t;var Qe=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,i=n.body,o=n.documentElement,s=o.clientTop||i.clientTop||0,a=o.clientLeft||i.clientLeft||0,r=e.top+(S.win.pageYOffset||o.scrollTop||i.scrollTop)-s,l=e.left+(S.win.pageXOffset||o.scrollLeft||i.scrollLeft)-a;return{y:r,x:l}};y.getElementByPoint=function(t,e){var n=this,i=n.canvas,o=S.doc.elementFromPoint(t,e);if(S.win.opera&&"svg"==o.tagName){var s=Qe(i),a=i.createSVGRect();a.x=t-s.x,a.y=e-s.y,a.width=a.height=1;var r=i.getIntersectionList(a,null);r.length&&(o=r[r.length-1])}if(!o)return null;for(;o.parentNode&&o!=i.parentNode&&!o.raphael;)o=o.parentNode;return o==n.canvas.parentNode&&(o=i),o=o&&o.raphael?n.getById(o.raphaelid):null},y.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},y.forEach=function(t,e){for(var n=this.bottom;n;){if(t.call(e,n)===!1)return this;n=n.next}return this},y.getElementsByPoint=function(t,e){var n=this.set();return this.forEach(function(i){i.isPointInside(t,e)&&n.push(i)}),n},Je.isPointInside=function(e,n){var i=this.realPath=this.realPath||fe[this.type](this);return t.isPointInsidePath(i,e,n)},Je.getBBox=function(t){if(this.removed)return{};var e=this._;return t?((e.dirty||!e.bboxwt)&&(this.realPath=fe[this.type](this),e.bboxwt=Te(this.realPath),e.bboxwt.toString=p,e.dirty=0),e.bboxwt):((e.dirty||e.dirtyT||!e.bbox)&&((e.dirty||!this.realPath)&&(e.bboxwt=0,this.realPath=fe[this.type](this)),e.bbox=Te(ge(this.realPath,this.matrix)),e.bbox.toString=p,e.dirty=e.dirtyT=0),e.bbox)},Je.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},Je.glow=function(t){if("text"==this.type)return null;t=t||{};var e={width:(t.width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:t.opacity||.5,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},n=e.width/2,i=this.paper,o=i.set(),s=this.realPath||fe[this.type](this);s=this.matrix?ge(s,this.matrix):s;for(var a=1;n+1>a;a++)o.push(i.path(s).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/n*a).toFixed(3),opacity:+(e.opacity/n).toFixed(3)}));return o.insertBefore(this).translate(e.offsetx,e.offsety)};var Ze=function(e,n,i,o,s,a,c,u,d){return null==d?r(e,n,i,o,s,a,c,u):t.findDotsAtSegment(e,n,i,o,s,a,c,u,l(e,n,i,o,s,a,c,u,d))},tn=function(e,n){return function(i,o,s){i=Oe(i);for(var a,r,l,c,u,d="",h={},p=0,f=0,g=i.length;g>f;f++){if(l=i[f],"M"==l[0])a=+l[1],r=+l[2];else{if(c=Ze(a,r,l[1],l[2],l[3],l[4],l[5],l[6]),p+c>o){if(n&&!h.start){if(u=Ze(a,r,l[1],l[2],l[3],l[4],l[5],l[6],o-p),d+=["C"+u.start.x,u.start.y,u.m.x,u.m.y,u.x,u.y],s)return d;h.start=d,d=["M"+u.x,u.y+"C"+u.n.x,u.n.y,u.end.x,u.end.y,l[5],l[6]].join(),p+=c,a=+l[5],r=+l[6];continue}if(!e&&!n)return u=Ze(a,r,l[1],l[2],l[3],l[4],l[5],l[6],o-p),{x:u.x,y:u.y,alpha:u.alpha}}p+=c,a=+l[5],r=+l[6]}d+=l.shift()+l}return h.end=d,u=e?p:n?h:t.findDotsAtSegment(a,r,l[0],l[1],l[2],l[3],l[4],l[5],1),u.alpha&&(u={x:u.x,y:u.y,alpha:u.alpha}),u}},en=tn(1),nn=tn(),on=tn(0,1);t.getTotalLength=en,t.getPointAtLength=nn,t.getSubpath=function(t,e,n){if(this.getTotalLength(t)-n<1e-6)return on(t,e).end;var i=on(t,n,1);return e?on(i,e).end:i},Je.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():en(this.attrs.path):void 0},Je.getPointAtLength=function(t){return"path"==this.type?nn(this.attrs.path,t):void 0},Je.getSubpath=function(e,n){return"path"==this.type?t.getSubpath(this.attrs.path,e,n):void 0};var sn=t.easing_formulas={linear:function(t){return t},"<":function(t){return B(t,1.7)},">":function(t){return B(t,.48)},"<>":function(t){var e=.48-t/1.04,n=R.sqrt(.1734+e*e),i=n-e,o=B(V(i),1/3)*(0>i?-1:1),s=-n-e,a=B(V(s),1/3)*(0>s?-1:1),r=o+a+.5;return 3*(1-r)*r*r+r*r*r},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){return t==!!t?t:B(2,-10*t)*R.sin(2*(t-.075)*H/.3)+1},bounce:function(t){var e,n=7.5625,i=2.75;return 1/i>t?e=n*t*t:2/i>t?(t-=1.5/i,e=n*t*t+.75):2.5/i>t?(t-=2.25/i,e=n*t*t+.9375):(t-=2.625/i,e=n*t*t+.984375),e}};sn.easeIn=sn["ease-in"]=sn["<"],sn.easeOut=sn["ease-out"]=sn[">"],sn.easeInOut=sn["ease-in-out"]=sn["<>"],sn["back-in"]=sn.backIn,sn["back-out"]=sn.backOut;var an=[],rn=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},ln=function(){for(var e=+new Date,n=0;n<an.length;n++){var i=an[n];if(!i.el.removed&&!i.paused){var o,s,a=e-i.start,r=i.ms,l=i.easing,c=i.from,u=i.diff,d=i.to,h=(i.t,i.el),p={},f={};if(i.initstatus?(a=(i.initstatus*i.anim.top-i.prev)/(i.percent-i.prev)*r,i.status=i.initstatus,delete i.initstatus,i.stop&&an.splice(n--,1)):i.status=(i.prev+(i.percent-i.prev)*(a/r))/i.anim.top,!(0>a))if(r>a){var g=l(a/r);for(var v in c)if(c[C](v)){switch(ee[v]){case W:o=+c[v]+g*r*u[v];break;case"colour":o="rgb("+[cn(Y(c[v].r+g*r*u[v].r)),cn(Y(c[v].g+g*r*u[v].g)),cn(Y(c[v].b+g*r*u[v].b))].join(",")+")";break;case"path":o=[];for(var b=0,y=c[v].length;y>b;b++){o[b]=[c[v][b][0]];for(var w=1,_=c[v][b].length;_>w;w++)o[b][w]=+c[v][b][w]+g*r*u[v][b][w];o[b]=o[b].join(j)}o=o.join(j);break;case"transform":if(u[v].real)for(o=[],b=0,y=c[v].length;y>b;b++)for(o[b]=[c[v][b][0]],w=1,_=c[v][b].length;_>w;w++)o[b][w]=c[v][b][w]+g*r*u[v][b][w];else{var x=function(t){return+c[v][t]+g*r*u[v][t]};o=[["m",x(0),x(1),x(2),x(3),x(4),x(5)]]}break;case"csv":if("clip-rect"==v)for(o=[],b=4;b--;)o[b]=+c[v][b]+g*r*u[v][b];break;default:var S=[][I](c[v]);for(o=[],b=h.paper.customAttributes[v].length;b--;)o[b]=+S[b]+g*r*u[v][b]}p[v]=o}h.attr(p),function(t,e,n){setTimeout(function(){eve("raphael.anim.frame."+t,e,n)})}(h.id,h,i.anim)}else{if(function(e,n,i){setTimeout(function(){eve("raphael.anim.frame."+n.id,n,i),eve("raphael.anim.finish."+n.id,n,i),t.is(e,"function")&&e.call(n)})}(i.callback,h,i.anim),h.attr(d),an.splice(n--,1),i.repeat>1&&!i.next){for(s in d)d[C](s)&&(f[s]=i.totalOrigin[s]);i.el.attr(f),m(i.anim,i.el,i.anim.percents[0],null,i.totalOrigin,i.repeat-1)}i.next&&!i.stop&&m(i.anim,i.el,i.next,null,i.totalOrigin,i.repeat)}}}t.svg&&h&&h.paper&&h.paper.safari(),an.length&&rn(ln)},cn=function(t){return t>255?255:0>t?0:t};Je.animateWith=function(e,n,i,o,s,a){var r=this;if(r.removed)return a&&a.call(r),r;var l=i instanceof g?i:t.animation(i,o,s,a);m(l,r,l.percents[0],null,r.attr());for(var c=0,u=an.length;u>c;c++)if(an[c].anim==n&&an[c].el==e){an[u-1].start=an[c].start;break}return r},Je.onAnimation=function(t){return t?eve.on("raphael.anim.frame."+this.id,t):eve.unbind("raphael.anim.frame."+this.id),this},g.prototype.delay=function(t){var e=new g(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},g.prototype.repeat=function(t){var e=new g(this.anim,this.ms);return e.del=this.del,e.times=R.floor(F(t,0))||1,e},t.animation=function(e,n,i,o){if(e instanceof g)return e;(t.is(i,"function")||!i)&&(o=o||i||null,i=null),e=Object(e),n=+n||0;var s,a,r={};for(a in e)e[C](a)&&K(a)!=a&&K(a)+"%"!=a&&(s=!0,r[a]=e[a]);return s?(i&&(r.easing=i),o&&(r.callback=o),new g({100:r},n)):new g(e,n)},Je.animate=function(e,n,i,o){var s=this;if(s.removed)return o&&o.call(s),s;var a=e instanceof g?e:t.animation(e,n,i,o);return m(a,s,a.percents[0],null,s.attr()),s},Je.setTime=function(t,e){return t&&null!=e&&this.status(t,z(e,t.ms)/t.ms),this},Je.status=function(t,e){var n,i,o=[],s=0;if(null!=e)return m(t,this,-1,z(e,1)),this;for(n=an.length;n>s;s++)if(i=an[s],i.el.id==this.id&&(!t||i.anim==t)){if(t)return i.status;o.push({anim:i.anim,status:i.status})}return t?0:o},Je.pause=function(t){for(var e=0;e<an.length;e++)an[e].el.id!=this.id||t&&an[e].anim!=t||eve("raphael.anim.pause."+this.id,this,an[e].anim)!==!1&&(an[e].paused=!0);return this},Je.resume=function(t){for(var e=0;e<an.length;e++)if(an[e].el.id==this.id&&(!t||an[e].anim==t)){var n=an[e];eve("raphael.anim.resume."+this.id,this,n.anim)!==!1&&(delete n.paused,this.status(n.anim,n.status))}return this},Je.stop=function(t){for(var e=0;e<an.length;e++)an[e].el.id!=this.id||t&&an[e].anim!=t||eve("raphael.anim.stop."+this.id,this,an[e].anim)!==!1&&an.splice(e--,1);return this},eve.on("raphael.remove",v),eve.on("raphael.clear",v),Je.toString=function(){return"Raphaël’s object"};var un=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,n=t.length;n>e;e++)!t[e]||t[e].constructor!=Je.constructor&&t[e].constructor!=un||(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},dn=un.prototype;dn.push=function(){for(var t,e,n=0,i=arguments.length;i>n;n++)t=arguments[n],!t||t.constructor!=Je.constructor&&t.constructor!=un||(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},dn.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},dn.forEach=function(t,e){for(var n=0,i=this.items.length;i>n;n++)if(t.call(e,this.items[n],n)===!1)return this;return this};for(var hn in Je)Je[C](hn)&&(dn[hn]=function(t){return function(){var e=arguments;return this.forEach(function(n){n[t][k](n,e)})}}(hn));dn.attr=function(e,n){if(e&&t.is(e,q)&&t.is(e[0],"object"))for(var i=0,o=e.length;o>i;i++)this.items[i].attr(e[i]);else for(var s=0,a=this.items.length;a>s;s++)this.items[s].attr(e,n);return this},dn.clear=function(){for(;this.length;)this.pop()},dn.splice=function(t,e){t=0>t?F(this.length+t,0):t,e=F(0,z(this.length-t,e));var n,i=[],o=[],s=[];for(n=2;n<arguments.length;n++)s.push(arguments[n]);for(n=0;e>n;n++)o.push(this[t+n]);for(;n<this.length-t;n++)i.push(this[t+n]);var a=s.length;for(n=0;n<a+i.length;n++)this.items[t+n]=this[t+n]=a>n?s[n]:i[n-a];for(n=this.items.length=this.length-=e-a;this[n];)delete this[n++];return new un(o)},dn.exclude=function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]==t)return this.splice(e,1),!0},dn.animate=function(e,n,i,o){(t.is(i,"function")||!i)&&(o=i||null);var s,a,r=this.items.length,l=r,c=this;if(!r)return this;o&&(a=function(){!--r&&o.call(c)}),i=t.is(i,$)?i:a;var u=t.animation(e,n,i,a);for(s=this.items[--l].animate(u);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(s,u,u);return this},dn.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},dn.getBBox=function(){for(var t=[],e=[],n=[],i=[],o=this.items.length;o--;)if(!this.items[o].removed){var s=this.items[o].getBBox();t.push(s.x),e.push(s.y),n.push(s.x+s.width),i.push(s.y+s.height)}return t=z[k](0,t),e=z[k](0,e),n=F[k](0,n),i=F[k](0,i),{x:t,y:e,x2:n,y2:i,width:n-t,height:i-e}},dn.clone=function(t){t=new un;for(var e=0,n=this.items.length;n>e;e++)t.push(this.items[e].clone());return t},dn.toString=function(){return"Raphaël‘s set"},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},n=t.face["font-family"];for(var i in t.face)t.face[C](i)&&(e.face[i]=t.face[i]);if(this.fonts[n]?this.fonts[n].push(e):this.fonts[n]=[e],!t.svg){e.face["units-per-em"]=Q(t.face["units-per-em"],10);for(var o in t.glyphs)if(t.glyphs[C](o)){var s=t.glyphs[o];if(e.glyphs[o]={w:s.w,k:{},d:s.d&&"M"+s.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},s.k)for(var a in s.k)s[C](a)&&(e.glyphs[o].k[a]=s.k[a])}}return t},y.getFont=function(e,n,i,o){if(o=o||"normal",i=i||"normal",n=+n||{normal:400,bold:700,lighter:300,bolder:800}[n]||400,t.fonts){var s=t.fonts[e];if(!s){var a=new RegExp("(^|\\s)"+e.replace(/[^\w\d\s+!~.:_-]/g,L)+"(\\s|$)","i");for(var r in t.fonts)if(t.fonts[C](r)&&a.test(r)){s=t.fonts[r];break}}var l;if(s)for(var c=0,u=s.length;u>c&&(l=s[c],l.face["font-weight"]!=n||l.face["font-style"]!=i&&l.face["font-style"]||l.face["font-stretch"]!=o);c++);return l}},y.print=function(e,n,i,o,s,a,r){a=a||"middle",r=F(z(r||0,1),-1);var l,c=N(i)[E](L),u=0,d=0,h=L;if(t.is(o,i)&&(o=this.getFont(o)),o){l=(s||16)/o.face["units-per-em"];for(var p=o.face.bbox[E](w),f=+p[0],g=p[3]-p[1],m=0,v=+p[1]+("baseline"==a?g+ +o.face.descent:g/2),b=0,y=c.length;y>b;b++){if("\n"==c[b])u=0,x=0,d=0,m+=g;else{var _=d&&o.glyphs[c[b-1]]||{},x=o.glyphs[c[b]];u+=d?(_.w||o.w)+(_.k&&_.k[c[b]]||0)+o.w*r:0,d=1}x&&x.d&&(h+=t.transformPath(x.d,["t",u*l,m*l,"s",l,l,f,v,"t",(e-f)/l,(n-v)/l]))}}return this.path(h).attr({fill:"#000",stroke:"none"})},y.add=function(e){if(t.is(e,"array"))for(var n,i=this.set(),o=0,s=e.length;s>o;o++)n=e[o]||{},_[C](n.type)&&i.push(this[n.type]().attr(n));return i},t.format=function(e,n){var i=t.is(n,q)?[0][I](n):arguments;return e&&t.is(e,$)&&i.length-1&&(e=e.replace(x,function(t,e){return null==i[++e]?L:i[e]})),e||L},t.fullfill=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(t,n,i){var o=i;return n.replace(e,function(t,e,n,i,s){e=e||i,o&&(e in o&&(o=o[e]),"function"==typeof o&&s&&(o=o()))}),o=(null==o||o==i?t:o)+""};return function(e,i){return String(e).replace(t,function(t,e){return n(t,e,i)})}}(),t.ninja=function(){return T.was?S.win.Raphael=T.is:delete Raphael,t},t.st=dn,function(e,n,i){function o(){/in/.test(e.readyState)?setTimeout(o,9):t.eve("raphael.DOMload")}null==e.readyState&&e.addEventListener&&(e.addEventListener(n,i=function(){e.removeEventListener(n,i,!1),e.readyState="complete"},!1),e.readyState="loading"),o()}(document,"DOMContentLoaded"),T.was?S.win.Raphael=t:Raphael=t,eve.on("raphael.DOMload",function(){b=!0})}(),window.Raphael.svg&&function(t){var e="hasOwnProperty",n=String,i=parseFloat,o=parseInt,s=Math,a=s.max,r=s.abs,l=s.pow,c=/[, ]+/,u=t.eve,d="",h=" ",p="http://www.w3.org/1999/xlink",f={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},g={};t.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var m=function(i,o){if(o){"string"==typeof i&&(i=m(i));for(var s in o)o[e](s)&&("xlink:"==s.substring(0,6)?i.setAttributeNS(p,s.substring(6),n(o[s])):i.setAttribute(s,n(o[s])))}else i=t._g.doc.createElementNS("http://www.w3.org/2000/svg",i),i.style&&(i.style.webkitTapHighlightColor="rgba(0,0,0,0)");return i},v=function(e,o){var c="linear",u=e.id+o,h=.5,p=.5,f=e.node,g=e.paper,v=f.style,b=t._g.doc.getElementById(u);if(!b){if(o=n(o).replace(t._radial_gradient,function(t,e,n){if(c="radial",e&&n){h=i(e),p=i(n);var o=2*(p>.5)-1;l(h-.5,2)+l(p-.5,2)>.25&&(p=s.sqrt(.25-l(h-.5,2))*o+.5)&&.5!=p&&(p=p.toFixed(5)-1e-5*o)}return d}),o=o.split(/\s*\-\s*/),"linear"==c){var y=o.shift();if(y=-i(y),isNaN(y))return null;var w=[0,0,s.cos(t.rad(y)),s.sin(t.rad(y))],_=1/(a(r(w[2]),r(w[3]))||1);w[2]*=_,w[3]*=_,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0)}var x=t._parseDots(o);if(!x)return null;if(u=u.replace(/[\(\)\s,\xb0#]/g,"_"),e.gradient&&u!=e.gradient.id&&(g.defs.removeChild(e.gradient),delete e.gradient),!e.gradient){b=m(c+"Gradient",{id:u}),e.gradient=b,m(b,"radial"==c?{fx:h,fy:p}:{x1:w[0],y1:w[1],x2:w[2],y2:w[3],gradientTransform:e.matrix.invert()}),g.defs.appendChild(b);for(var C=0,S=x.length;S>C;C++)b.appendChild(m("stop",{offset:x[C].offset?x[C].offset:C?"100%":"0%","stop-color":x[C].color||"#fff"}))}}return m(f,{fill:"url(#"+u+")",opacity:1,"fill-opacity":1}),v.fill=d,v.opacity=1,v.fillOpacity=1,1},b=function(t){var e=t.getBBox(1);m(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})},y=function(i,o,s){if("path"==i.type){for(var a,r,l,c,u,h=n(o).toLowerCase().split("-"),p=i.paper,v=s?"end":"start",b=i.node,y=i.attrs,w=y["stroke-width"],_=h.length,x="classic",C=3,S=3,T=5;_--;)switch(h[_]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":x=h[_];break;case"wide":S=5;break;case"narrow":S=2;break;case"long":C=5;break;case"short":C=2}if("open"==x?(C+=2,S+=2,T+=2,l=1,c=s?4:1,u={fill:"none",stroke:y.stroke}):(c=l=C/2,u={fill:y.stroke,stroke:"none"}),i._.arrows?s?(i._.arrows.endPath&&g[i._.arrows.endPath]--,i._.arrows.endMarker&&g[i._.arrows.endMarker]--):(i._.arrows.startPath&&g[i._.arrows.startPath]--,i._.arrows.startMarker&&g[i._.arrows.startMarker]--):i._.arrows={},"none"!=x){var D="raphael-marker-"+x,k="raphael-marker-"+v+x+C+S;t._g.doc.getElementById(D)?g[D]++:(p.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:f[x],id:D})),g[D]=1);var I,M=t._g.doc.getElementById(k);M?(g[k]++,I=M.getElementsByTagName("use")[0]):(M=m(m("marker"),{id:k,markerHeight:S,markerWidth:C,orient:"auto",refX:c,refY:S/2}),I=m(m("use"),{"xlink:href":"#"+D,transform:(s?"rotate(180 "+C/2+" "+S/2+") ":d)+"scale("+C/T+","+S/T+")","stroke-width":(1/((C/T+S/T)/2)).toFixed(4)}),M.appendChild(I),p.defs.appendChild(M),g[k]=1),m(I,u);var L=l*("diamond"!=x&&"oval"!=x);s?(a=i._.arrows.startdx*w||0,r=t.getTotalLength(y.path)-L*w):(a=L*w,r=t.getTotalLength(y.path)-(i._.arrows.enddx*w||0)),u={},u["marker-"+v]="url(#"+k+")",(r||a)&&(u.d=Raphael.getSubpath(y.path,a,r)),m(b,u),i._.arrows[v+"Path"]=D,i._.arrows[v+"Marker"]=k,i._.arrows[v+"dx"]=L,i._.arrows[v+"Type"]=x,i._.arrows[v+"String"]=o}else s?(a=i._.arrows.startdx*w||0,r=t.getTotalLength(y.path)-a):(a=0,r=t.getTotalLength(y.path)-(i._.arrows.enddx*w||0)),i._.arrows[v+"Path"]&&m(b,{d:Raphael.getSubpath(y.path,a,r)}),delete i._.arrows[v+"Path"],delete i._.arrows[v+"Marker"],delete i._.arrows[v+"dx"],delete i._.arrows[v+"Type"],delete i._.arrows[v+"String"];for(u in g)if(g[e](u)&&!g[u]){var j=t._g.doc.getElementById(u);j&&j.parentNode.removeChild(j)}}},w={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},_=function(t,e,i){if(e=w[n(e).toLowerCase()]){for(var o=t.attrs["stroke-width"]||"1",s={round:o,square:o,butt:0}[t.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,a=[],r=e.length;r--;)a[r]=e[r]*o+(r%2?1:-1)*s;m(t.node,{"stroke-dasharray":a.join(",")})}},x=function(i,s){var l=i.node,u=i.attrs,h=l.style.visibility;l.style.visibility="hidden";for(var f in s)if(s[e](f)){if(!t._availableAttrs[e](f))continue;var g=s[f];switch(u[f]=g,f){case"blur":i.blur(g);break;case"href":case"title":case"target":var w=l.parentNode;if("a"!=w.tagName.toLowerCase()){var x=m("a");w.insertBefore(x,l),x.appendChild(l),w=x}"target"==f?w.setAttributeNS(p,"show","blank"==g?"new":g):w.setAttributeNS(p,f,g);break;case"cursor":l.style.cursor=g;break;case"transform":i.transform(g);break;case"arrow-start":y(i,g);break;case"arrow-end":y(i,g,1);break;case"clip-rect":var C=n(g).split(c);if(4==C.length){i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode);var T=m("clipPath"),D=m("rect");T.id=t.createUUID(),m(D,{x:C[0],y:C[1],width:C[2],height:C[3]}),T.appendChild(D),i.paper.defs.appendChild(T),m(l,{"clip-path":"url(#"+T.id+")"}),i.clip=D}if(!g){var k=l.getAttribute("clip-path");if(k){var I=t._g.doc.getElementById(k.replace(/(^url\(#|\)$)/g,d));I&&I.parentNode.removeChild(I),m(l,{"clip-path":d}),delete i.clip}}break;case"path":"path"==i.type&&(m(l,{d:g?u.path=t._pathToAbsolute(g):"M0,0"}),i._.dirty=1,i._.arrows&&("startString"in i._.arrows&&y(i,i._.arrows.startString),"endString"in i._.arrows&&y(i,i._.arrows.endString,1)));break;case"width":if(l.setAttribute(f,g),i._.dirty=1,!u.fx)break;f="x",g=u.x;case"x":u.fx&&(g=-u.x-(u.width||0));case"rx":if("rx"==f&&"rect"==i.type)break;case"cx":l.setAttribute(f,g),i.pattern&&b(i),i._.dirty=1;break;case"height":if(l.setAttribute(f,g),i._.dirty=1,!u.fy)break;f="y",g=u.y;case"y":u.fy&&(g=-u.y-(u.height||0));case"ry":if("ry"==f&&"rect"==i.type)break;case"cy":l.setAttribute(f,g),i.pattern&&b(i),i._.dirty=1;break;case"r":"rect"==i.type?m(l,{rx:g,ry:g}):l.setAttribute(f,g),i._.dirty=1;break;case"src":"image"==i.type&&l.setAttributeNS(p,"href",g);break;case"stroke-width":(1!=i._.sx||1!=i._.sy)&&(g/=a(r(i._.sx),r(i._.sy))||1),i.paper._vbSize&&(g*=i.paper._vbSize),l.setAttribute(f,g),u["stroke-dasharray"]&&_(i,u["stroke-dasharray"],s),i._.arrows&&("startString"in i._.arrows&&y(i,i._.arrows.startString),"endString"in i._.arrows&&y(i,i._.arrows.endString,1));break;case"stroke-dasharray":_(i,g,s);break;case"fill":var M=n(g).match(t._ISURL);if(M){T=m("pattern");var L=m("image");T.id=t.createUUID(),m(T,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),m(L,{x:0,y:0,"xlink:href":M[1]}),T.appendChild(L),function(e){t._preload(M[1],function(){var t=this.offsetWidth,n=this.offsetHeight;m(e,{width:t,height:n}),m(L,{width:t,height:n}),i.paper.safari()})}(T),i.paper.defs.appendChild(T),m(l,{fill:"url(#"+T.id+")"}),i.pattern=T,i.pattern&&b(i);break}var j=t.getRGB(g);if(j.error){if(("circle"==i.type||"ellipse"==i.type||"r"!=n(g).charAt())&&v(i,g)){if("opacity"in u||"fill-opacity"in u){var N=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,d));if(N){var E=N.getElementsByTagName("stop");m(E[E.length-1],{"stop-opacity":("opacity"in u?u.opacity:1)*("fill-opacity"in u?u["fill-opacity"]:1)})}}u.gradient=g,u.fill="none";break}}else delete s.gradient,delete u.gradient,!t.is(u.opacity,"undefined")&&t.is(s.opacity,"undefined")&&m(l,{opacity:u.opacity}),!t.is(u["fill-opacity"],"undefined")&&t.is(s["fill-opacity"],"undefined")&&m(l,{"fill-opacity":u["fill-opacity"]});j[e]("opacity")&&m(l,{"fill-opacity":j.opacity>1?j.opacity/100:j.opacity});case"stroke":j=t.getRGB(g),l.setAttribute(f,j.hex),"stroke"==f&&j[e]("opacity")&&m(l,{"stroke-opacity":j.opacity>1?j.opacity/100:j.opacity}),"stroke"==f&&i._.arrows&&("startString"in i._.arrows&&y(i,i._.arrows.startString),"endString"in i._.arrows&&y(i,i._.arrows.endString,1));break;case"gradient":("circle"==i.type||"ellipse"==i.type||"r"!=n(g).charAt())&&v(i,g);break;case"opacity":u.gradient&&!u[e]("stroke-opacity")&&m(l,{"stroke-opacity":g>1?g/100:g});case"fill-opacity":if(u.gradient){N=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,d)),N&&(E=N.getElementsByTagName("stop"),m(E[E.length-1],{"stop-opacity":g}));break}default:"font-size"==f&&(g=o(g,10)+"px");var O=f.replace(/(\-.)/g,function(t){return t.substring(1).toUpperCase()});l.style[O]=g,i._.dirty=1,l.setAttribute(f,g)}}S(i,s),l.style.visibility=h},C=1.2,S=function(i,s){if("text"==i.type&&(s[e]("text")||s[e]("font")||s[e]("font-size")||s[e]("x")||s[e]("y"))){var a=i.attrs,r=i.node,l=r.firstChild?o(t._g.doc.defaultView.getComputedStyle(r.firstChild,d).getPropertyValue("font-size"),10):10;if(s[e]("text")){for(a.text=s.text;r.firstChild;)r.removeChild(r.firstChild);for(var c,u=n(s.text).split("\n"),h=[],p=0,f=u.length;f>p;p++)c=m("tspan"),p&&m(c,{dy:l*C,x:a.x}),c.appendChild(t._g.doc.createTextNode(u[p])),r.appendChild(c),h[p]=c
}else for(h=r.getElementsByTagName("tspan"),p=0,f=h.length;f>p;p++)p?m(h[p],{dy:l*C,x:a.x}):m(h[0],{dy:0});m(r,{x:a.x,y:a.y}),i._.dirty=1;var g=i._getBBox(),v=a.y-(g.y+g.height/2);v&&t.is(v,"finite")&&m(h[0],{dy:v})}},T=function(e,n){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.matrix=t.matrix(),this.realPath=null,this.paper=n,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},D=t.el;T.prototype=D,D.constructor=T,t._engine.path=function(t,e){var n=m("path");e.canvas&&e.canvas.appendChild(n);var i=new T(n,e);return i.type="path",x(i,{fill:"none",stroke:"#000",path:t}),i},D.rotate=function(t,e,o){if(this.removed)return this;if(t=n(t).split(c),t.length-1&&(e=i(t[1]),o=i(t[2])),t=i(t[0]),null==o&&(e=o),null==e||null==o){var s=this.getBBox(1);e=s.x+s.width/2,o=s.y+s.height/2}return this.transform(this._.transform.concat([["r",t,e,o]])),this},D.scale=function(t,e,o,s){if(this.removed)return this;if(t=n(t).split(c),t.length-1&&(e=i(t[1]),o=i(t[2]),s=i(t[3])),t=i(t[0]),null==e&&(e=t),null==s&&(o=s),null==o||null==s)var a=this.getBBox(1);return o=null==o?a.x+a.width/2:o,s=null==s?a.y+a.height/2:s,this.transform(this._.transform.concat([["s",t,e,o,s]])),this},D.translate=function(t,e){return this.removed?this:(t=n(t).split(c),t.length-1&&(e=i(t[1])),t=i(t[0])||0,e=+e||0,this.transform(this._.transform.concat([["t",t,e]])),this)},D.transform=function(n){var i=this._;if(null==n)return i.transform;if(t._extractTransform(this,n),this.clip&&m(this.clip,{transform:this.matrix.invert()}),this.pattern&&b(this),this.node&&m(this.node,{transform:this.matrix}),1!=i.sx||1!=i.sy){var o=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":o})}return this},D.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},D.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},D.remove=function(){if(!this.removed&&this.node.parentNode){var e=this.paper;e.__set__&&e.__set__.exclude(this),u.unbind("raphael.*.*."+this.id),this.gradient&&e.defs.removeChild(this.gradient),t._tear(this,e),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var n in this)this[n]="function"==typeof this[n]?t._removedFactory(n):null;this.removed=!0}},D._getBBox=function(){if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(n){}finally{e=e||{}}return t&&this.hide(),e},D.attr=function(n,i){if(this.removed)return this;if(null==n){var o={};for(var s in this.attrs)this.attrs[e](s)&&(o[s]=this.attrs[s]);return o.gradient&&"none"==o.fill&&(o.fill=o.gradient)&&delete o.gradient,o.transform=this._.transform,o}if(null==i&&t.is(n,"string")){if("fill"==n&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==n)return this._.transform;for(var a=n.split(c),r={},l=0,d=a.length;d>l;l++)n=a[l],r[n]=n in this.attrs?this.attrs[n]:t.is(this.paper.customAttributes[n],"function")?this.paper.customAttributes[n].def:t._availableAttrs[n];return d-1?r:r[a[0]]}if(null==i&&t.is(n,"array")){for(r={},l=0,d=n.length;d>l;l++)r[n[l]]=this.attr(n[l]);return r}if(null!=i){var h={};h[n]=i}else null!=n&&t.is(n,"object")&&(h=n);for(var p in h)u("raphael.attr."+p+"."+this.id,this,h[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[e](p)&&h[e](p)&&t.is(this.paper.customAttributes[p],"function")){var f=this.paper.customAttributes[p].apply(this,[].concat(h[p]));this.attrs[p]=h[p];for(var g in f)f[e](g)&&(h[g]=f[g])}return x(this,h),this},D.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var e=this.paper;return e.top!=this&&t._tofront(this,e),this},D.toBack=function(){if(this.removed)return this;var e=this.node.parentNode;"a"==e.tagName.toLowerCase()?e.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):e.firstChild!=this.node&&e.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper);this.paper;return this},D.insertAfter=function(e){if(this.removed)return this;var n=e.node||e[e.length-1].node;return n.nextSibling?n.parentNode.insertBefore(this.node,n.nextSibling):n.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this},D.insertBefore=function(e){if(this.removed)return this;var n=e.node||e[0].node;return n.parentNode.insertBefore(this.node,n),t._insertbefore(this,e,this.paper),this},D.blur=function(e){var n=this;if(0!==+e){var i=m("filter"),o=m("feGaussianBlur");n.attrs.blur=e,i.id=t.createUUID(),m(o,{stdDeviation:+e||1.5}),i.appendChild(o),n.paper.defs.appendChild(i),n._blur=i,m(n.node,{filter:"url(#"+i.id+")"})}else n._blur&&(n._blur.parentNode.removeChild(n._blur),delete n._blur,delete n.attrs.blur),n.node.removeAttribute("filter")},t._engine.circle=function(t,e,n,i){var o=m("circle");t.canvas&&t.canvas.appendChild(o);var s=new T(o,t);return s.attrs={cx:e,cy:n,r:i,fill:"none",stroke:"#000"},s.type="circle",m(o,s.attrs),s},t._engine.rect=function(t,e,n,i,o,s){var a=m("rect");t.canvas&&t.canvas.appendChild(a);var r=new T(a,t);return r.attrs={x:e,y:n,width:i,height:o,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},r.type="rect",m(a,r.attrs),r},t._engine.ellipse=function(t,e,n,i,o){var s=m("ellipse");t.canvas&&t.canvas.appendChild(s);var a=new T(s,t);return a.attrs={cx:e,cy:n,rx:i,ry:o,fill:"none",stroke:"#000"},a.type="ellipse",m(s,a.attrs),a},t._engine.image=function(t,e,n,i,o,s){var a=m("image");m(a,{x:n,y:i,width:o,height:s,preserveAspectRatio:"none"}),a.setAttributeNS(p,"href",e),t.canvas&&t.canvas.appendChild(a);var r=new T(a,t);return r.attrs={x:n,y:i,width:o,height:s,src:e},r.type="image",r},t._engine.text=function(e,n,i,o){var s=m("text");e.canvas&&e.canvas.appendChild(s);var a=new T(s,e);return a.attrs={x:n,y:i,"text-anchor":"middle",text:o,font:t._availableAttrs.font,stroke:"none",fill:"#000"},a.type="text",x(a,a.attrs),a},t._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},t._engine.create=function(){var e=t._getContainer.apply(0,arguments),n=e&&e.container,i=e.x,o=e.y,s=e.width,a=e.height;if(!n)throw new Error("SVG container not found.");var r,l=m("svg"),c="overflow:hidden;";return i=i||0,o=o||0,s=s||512,a=a||342,m(l,{height:a,version:1.1,width:s,xmlns:"http://www.w3.org/2000/svg"}),1==n?(l.style.cssText=c+"position:absolute;left:"+i+"px;top:"+o+"px",t._g.doc.body.appendChild(l),r=1):(l.style.cssText=c+"position:relative",n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l)),n=new t._Paper,n.width=s,n.height=a,n.canvas=l,n.clear(),n._left=n._top=0,r&&(n.renderfix=function(){}),n.renderfix(),n},t._engine.setViewBox=function(t,e,n,i,o){u("raphael.setViewBox",this,this._viewBox,[t,e,n,i,o]);var s,r,l=a(n/this.width,i/this.height),c=this.top,d=o?"meet":"xMinYMin";for(null==t?(this._vbSize&&(l=1),delete this._vbSize,s="0 0 "+this.width+h+this.height):(this._vbSize=l,s=t+h+e+h+n+h+i),m(this.canvas,{viewBox:s,preserveAspectRatio:d});l&&c;)r="stroke-width"in c.attrs?c.attrs["stroke-width"]:1,c.attr({"stroke-width":r}),c._.dirty=1,c._.dirtyT=1,c=c.prev;return this._viewBox=[t,e,n,i,!!o],this},t.prototype.renderfix=function(){var t,e=this.canvas,n=e.style;try{t=e.getScreenCTM()||e.createSVGMatrix()}catch(i){t=e.createSVGMatrix()}var o=-t.e%1,s=-t.f%1;(o||s)&&(o&&(this._left=(this._left+o)%1,n.left=this._left+"px"),s&&(this._top=(this._top+s)%1,n.top=this._top+"px"))},t.prototype.clear=function(){t.eve("raphael.clear",this);for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=m("desc")).appendChild(t._g.doc.createTextNode("Created with Raphaël "+t.version)),e.appendChild(this.desc),e.appendChild(this.defs=m("defs"))},t.prototype.remove=function(){u("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null};var k=t.st;for(var I in D)D[e](I)&&!k[e](I)&&(k[I]=function(t){return function(){var e=arguments;return this.forEach(function(n){n[t].apply(n,e)})}}(I))}(window.Raphael),window.Raphael.vml&&function(t){var e="hasOwnProperty",n=String,i=parseFloat,o=Math,s=o.round,a=o.max,r=o.min,l=o.abs,c="fill",u=/[, ]+/,d=t.eve,h=" progid:DXImageTransform.Microsoft",p=" ",f="",g={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,v=/ progid:\S+Blur\([^\)]+\)/g,b=/-?[^,\s-]+/g,y="position:absolute;left:0;top:0;width:1px;height:1px",w=21600,_={path:1,rect:1,image:1},x={circle:1,ellipse:1},C=function(e){var i=/[ahqstv]/gi,o=t._pathToAbsolute;if(n(e).match(i)&&(o=t._path2curve),i=/[clmz]/g,o==t._pathToAbsolute&&!n(e).match(i)){var a=n(e).replace(m,function(t,e,n){var i=[],o="m"==e.toLowerCase(),a=g[e];return n.replace(b,function(t){o&&2==i.length&&(a+=i+g["m"==e?"l":"L"],i=[]),i.push(s(t*w))}),a+i});return a}var r,l,c=o(e);a=[];for(var u=0,d=c.length;d>u;u++){r=c[u],l=c[u][0].toLowerCase(),"z"==l&&(l="x");for(var h=1,v=r.length;v>h;h++)l+=s(r[h]*w)+(h!=v-1?",":f);a.push(l)}return a.join(p)},S=function(e,n,i){var o=t.matrix();return o.rotate(-e,.5,.5),{dx:o.x(n,i),dy:o.y(n,i)}},T=function(t,e,n,i,o,s){var a=t._,r=t.matrix,u=a.fillpos,d=t.node,h=d.style,f=1,g="",m=w/e,v=w/n;if(h.visibility="hidden",e&&n){if(d.coordsize=l(m)+p+l(v),h.rotation=s*(0>e*n?-1:1),s){var b=S(s,i,o);i=b.dx,o=b.dy}if(0>e&&(g+="x"),0>n&&(g+=" y")&&(f=-1),h.flip=g,d.coordorigin=i*-m+p+o*-v,u||a.fillsize){var y=d.getElementsByTagName(c);y=y&&y[0],d.removeChild(y),u&&(b=S(s,r.x(u[0],u[1]),r.y(u[0],u[1])),y.position=b.dx*f+p+b.dy*f),a.fillsize&&(y.size=a.fillsize[0]*l(e)+p+a.fillsize[1]*l(n)),d.appendChild(y)}h.visibility="visible"}};t.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var D=function(t,e,i){for(var o=n(e).toLowerCase().split("-"),s=i?"end":"start",a=o.length,r="classic",l="medium",c="medium";a--;)switch(o[a]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":r=o[a];break;case"wide":case"narrow":c=o[a];break;case"long":case"short":l=o[a]}var u=t.node.getElementsByTagName("stroke")[0];u[s+"arrow"]=r,u[s+"arrowlength"]=l,u[s+"arrowwidth"]=c},k=function(o,l){o.attrs=o.attrs||{};var d=o.node,h=o.attrs,g=d.style,m=_[o.type]&&(l.x!=h.x||l.y!=h.y||l.width!=h.width||l.height!=h.height||l.cx!=h.cx||l.cy!=h.cy||l.rx!=h.rx||l.ry!=h.ry||l.r!=h.r),v=x[o.type]&&(h.cx!=l.cx||h.cy!=l.cy||h.r!=l.r||h.rx!=l.rx||h.ry!=l.ry),b=o;for(var y in l)l[e](y)&&(h[y]=l[y]);if(m&&(h.path=t._getPath[o.type](o),o._.dirty=1),l.href&&(d.href=l.href),l.title&&(d.title=l.title),l.target&&(d.target=l.target),l.cursor&&(g.cursor=l.cursor),"blur"in l&&o.blur(l.blur),(l.path&&"path"==o.type||m)&&(d.path=C(~n(h.path).toLowerCase().indexOf("r")?t._pathToAbsolute(h.path):h.path),"image"==o.type&&(o._.fillpos=[h.x,h.y],o._.fillsize=[h.width,h.height],T(o,1,1,0,0,0))),"transform"in l&&o.transform(l.transform),v){var S=+h.cx,k=+h.cy,M=+h.rx||+h.r||0,L=+h.ry||+h.r||0;d.path=t.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",s((S-M)*w),s((k-L)*w),s((S+M)*w),s((k+L)*w),s(S*w))}if("clip-rect"in l){var N=n(l["clip-rect"]).split(u);if(4==N.length){N[2]=+N[2]+ +N[0],N[3]=+N[3]+ +N[1];var E=d.clipRect||t._g.doc.createElement("div"),O=E.style;O.clip=t.format("rect({1}px {2}px {3}px {0}px)",N),d.clipRect||(O.position="absolute",O.top=0,O.left=0,O.width=o.paper.width+"px",O.height=o.paper.height+"px",d.parentNode.insertBefore(E,d),E.appendChild(d),d.clipRect=E)}l["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="auto")}if(o.textpath){var A=o.textpath.style;l.font&&(A.font=l.font),l["font-family"]&&(A.fontFamily='"'+l["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,f)+'"'),l["font-size"]&&(A.fontSize=l["font-size"]),l["font-weight"]&&(A.fontWeight=l["font-weight"]),l["font-style"]&&(A.fontStyle=l["font-style"])}if("arrow-start"in l&&D(b,l["arrow-start"]),"arrow-end"in l&&D(b,l["arrow-end"],1),null!=l.opacity||null!=l["stroke-width"]||null!=l.fill||null!=l.src||null!=l.stroke||null!=l["stroke-width"]||null!=l["stroke-opacity"]||null!=l["fill-opacity"]||null!=l["stroke-dasharray"]||null!=l["stroke-miterlimit"]||null!=l["stroke-linejoin"]||null!=l["stroke-linecap"]){var P=d.getElementsByTagName(c),R=!1;if(P=P&&P[0],!P&&(R=P=j(c)),"image"==o.type&&l.src&&(P.src=l.src),l.fill&&(P.on=!0),(null==P.on||"none"==l.fill||null===l.fill)&&(P.on=!1),P.on&&l.fill){var F=n(l.fill).match(t._ISURL);if(F){P.parentNode==d&&d.removeChild(P),P.rotate=!0,P.src=F[1],P.type="tile";var z=o.getBBox(1);P.position=z.x+p+z.y,o._.fillpos=[z.x,z.y],t._preload(F[1],function(){o._.fillsize=[this.offsetWidth,this.offsetHeight]})}else P.color=t.getRGB(l.fill).hex,P.src=f,P.type="solid",t.getRGB(l.fill).error&&(b.type in{circle:1,ellipse:1}||"r"!=n(l.fill).charAt())&&I(b,l.fill,P)&&(h.fill="none",h.gradient=l.fill,P.rotate=!1)}if("fill-opacity"in l||"opacity"in l){var V=((+h["fill-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+t.getRGB(l.fill).o+1||2)-1);V=r(a(V,0),1),P.opacity=V,P.src&&(P.color="none")}d.appendChild(P);var B=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0],H=!1;!B&&(H=B=j("stroke")),(l.stroke&&"none"!=l.stroke||l["stroke-width"]||null!=l["stroke-opacity"]||l["stroke-dasharray"]||l["stroke-miterlimit"]||l["stroke-linejoin"]||l["stroke-linecap"])&&(B.on=!0),("none"==l.stroke||null===l.stroke||null==B.on||0==l.stroke||0==l["stroke-width"])&&(B.on=!1);var W=t.getRGB(l.stroke);B.on&&l.stroke&&(B.color=W.hex),V=((+h["stroke-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+W.o+1||2)-1);var $=.75*(i(l["stroke-width"])||1);if(V=r(a(V,0),1),null==l["stroke-width"]&&($=h["stroke-width"]),l["stroke-width"]&&(B.weight=$),$&&1>$&&(V*=$)&&(B.weight=1),B.opacity=V,l["stroke-linejoin"]&&(B.joinstyle=l["stroke-linejoin"]||"miter"),B.miterlimit=l["stroke-miterlimit"]||8,l["stroke-linecap"]&&(B.endcap="butt"==l["stroke-linecap"]?"flat":"square"==l["stroke-linecap"]?"square":"round"),l["stroke-dasharray"]){var q={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};B.dashstyle=q[e](l["stroke-dasharray"])?q[l["stroke-dasharray"]]:f}H&&d.appendChild(B)}if("text"==b.type){b.paper.canvas.style.display=f;var U=b.paper.span,X=100,G=h.font&&h.font.match(/\d+(?:\.\d*)?(?=px)/);g=U.style,h.font&&(g.font=h.font),h["font-family"]&&(g.fontFamily=h["font-family"]),h["font-weight"]&&(g.fontWeight=h["font-weight"]),h["font-style"]&&(g.fontStyle=h["font-style"]),G=i(h["font-size"]||G&&G[0])||10,g.fontSize=G*X+"px",b.textpath.string&&(U.innerHTML=n(b.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var J=U.getBoundingClientRect();b.W=h.w=(J.right-J.left)/X,b.H=h.h=(J.bottom-J.top)/X,b.X=h.x,b.Y=h.y+b.H/2,("x"in l||"y"in l)&&(b.path.v=t.format("m{0},{1}l{2},{1}",s(h.x*w),s(h.y*w),s(h.x*w)+1));for(var Y=["x","y","text","font","font-family","font-weight","font-style","font-size"],K=0,Q=Y.length;Q>K;K++)if(Y[K]in l){b._.dirty=1;break}switch(h["text-anchor"]){case"start":b.textpath.style["v-text-align"]="left",b.bbx=b.W/2;break;case"end":b.textpath.style["v-text-align"]="right",b.bbx=-b.W/2;break;default:b.textpath.style["v-text-align"]="center",b.bbx=0}b.textpath.style["v-text-kern"]=!0}},I=function(e,s,a){e.attrs=e.attrs||{};var r=(e.attrs,Math.pow),l="linear",c=".5 .5";if(e.attrs.gradient=s,s=n(s).replace(t._radial_gradient,function(t,e,n){return l="radial",e&&n&&(e=i(e),n=i(n),r(e-.5,2)+r(n-.5,2)>.25&&(n=o.sqrt(.25-r(e-.5,2))*(2*(n>.5)-1)+.5),c=e+p+n),f}),s=s.split(/\s*\-\s*/),"linear"==l){var u=s.shift();if(u=-i(u),isNaN(u))return null}var d=t._parseDots(s);if(!d)return null;if(e=e.shape||e.node,d.length){e.removeChild(a),a.on=!0,a.method="none",a.color=d[0].color,a.color2=d[d.length-1].color;for(var h=[],g=0,m=d.length;m>g;g++)d[g].offset&&h.push(d[g].offset+p+d[g].color);a.colors=h.length?h.join():"0% "+a.color,"radial"==l?(a.type="gradientTitle",a.focus="100%",a.focussize="0 0",a.focusposition=c,a.angle=0):(a.type="gradient",a.angle=(270-u)%360),e.appendChild(a)}return 1},M=function(e,n){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=n,this.matrix=t.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},L=t.el;M.prototype=L,L.constructor=M,L.transform=function(e){if(null==e)return this._.transform;var i,o=this.paper._viewBoxShift,s=o?"s"+[o.scale,o.scale]+"-1-1t"+[o.dx,o.dy]:f;o&&(i=e=n(e).replace(/\.{3}|\u2026/g,this._.transform||f)),t._extractTransform(this,s+e);var a,r=this.matrix.clone(),l=this.skew,c=this.node,u=~n(this.attrs.fill).indexOf("-"),d=!n(this.attrs.fill).indexOf("url(");if(r.translate(-.5,-.5),d||u||"image"==this.type)if(l.matrix="1 0 0 1",l.offset="0 0",a=r.split(),u&&a.noRotation||!a.isSimple){c.style.filter=r.toFilter();var h=this.getBBox(),g=this.getBBox(1),m=h.x-g.x,v=h.y-g.y;c.coordorigin=m*-w+p+v*-w,T(this,1,1,m,v,0)}else c.style.filter=f,T(this,a.scalex,a.scaley,a.dx,a.dy,a.rotate);else c.style.filter=f,l.matrix=n(r),l.offset=r.offset();return i&&(this._.transform=i),this},L.rotate=function(t,e,o){if(this.removed)return this;if(null!=t){if(t=n(t).split(u),t.length-1&&(e=i(t[1]),o=i(t[2])),t=i(t[0]),null==o&&(e=o),null==e||null==o){var s=this.getBBox(1);e=s.x+s.width/2,o=s.y+s.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,e,o]])),this}},L.translate=function(t,e){return this.removed?this:(t=n(t).split(u),t.length-1&&(e=i(t[1])),t=i(t[0])||0,e=+e||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=e),this.transform(this._.transform.concat([["t",t,e]])),this)},L.scale=function(t,e,o,s){if(this.removed)return this;if(t=n(t).split(u),t.length-1&&(e=i(t[1]),o=i(t[2]),s=i(t[3]),isNaN(o)&&(o=null),isNaN(s)&&(s=null)),t=i(t[0]),null==e&&(e=t),null==s&&(o=s),null==o||null==s)var a=this.getBBox(1);return o=null==o?a.x+a.width/2:o,s=null==s?a.y+a.height/2:s,this.transform(this._.transform.concat([["s",t,e,o,s]])),this._.dirtyT=1,this},L.hide=function(){return!this.removed&&(this.node.style.display="none"),this},L.show=function(){return!this.removed&&(this.node.style.display=f),this},L._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},L.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),t.eve.unbind("raphael.*.*."+this.id),t._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;this.removed=!0}},L.attr=function(n,i){if(this.removed)return this;if(null==n){var o={};for(var s in this.attrs)this.attrs[e](s)&&(o[s]=this.attrs[s]);return o.gradient&&"none"==o.fill&&(o.fill=o.gradient)&&delete o.gradient,o.transform=this._.transform,o}if(null==i&&t.is(n,"string")){if(n==c&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var a=n.split(u),r={},l=0,h=a.length;h>l;l++)n=a[l],r[n]=n in this.attrs?this.attrs[n]:t.is(this.paper.customAttributes[n],"function")?this.paper.customAttributes[n].def:t._availableAttrs[n];return h-1?r:r[a[0]]}if(this.attrs&&null==i&&t.is(n,"array")){for(r={},l=0,h=n.length;h>l;l++)r[n[l]]=this.attr(n[l]);return r}var p;null!=i&&(p={},p[n]=i),null==i&&t.is(n,"object")&&(p=n);for(var f in p)d("raphael.attr."+f+"."+this.id,this,p[f]);if(p){for(f in this.paper.customAttributes)if(this.paper.customAttributes[e](f)&&p[e](f)&&t.is(this.paper.customAttributes[f],"function")){var g=this.paper.customAttributes[f].apply(this,[].concat(p[f]));this.attrs[f]=p[f];for(var m in g)g[e](m)&&(p[m]=g[m])}p.text&&"text"==this.type&&(this.textpath.string=p.text),k(this,p)}return this},L.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&t._tofront(this,this.paper),this},L.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper)),this)},L.insertAfter=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[e.length-1]),e.node.nextSibling?e.node.parentNode.insertBefore(this.node,e.node.nextSibling):e.node.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this)},L.insertBefore=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[0]),e.node.parentNode.insertBefore(this.node,e.node),t._insertbefore(this,e,this.paper),this)},L.blur=function(e){var n=this.node.runtimeStyle,i=n.filter;i=i.replace(v,f),0!==+e?(this.attrs.blur=e,n.filter=i+p+h+".Blur(pixelradius="+(+e||1.5)+")",n.margin=t.format("-{0}px 0 0 -{0}px",s(+e||1.5))):(n.filter=i,n.margin=0,delete this.attrs.blur)},t._engine.path=function(t,e){var n=j("shape");n.style.cssText=y,n.coordsize=w+p+w,n.coordorigin=e.coordorigin;var i=new M(n,e),o={fill:"none",stroke:"#000"};t&&(o.path=t),i.type="path",i.path=[],i.Path=f,k(i,o),e.canvas.appendChild(n);var s=j("skew");return s.on=!0,n.appendChild(s),i.skew=s,i.transform(f),i},t._engine.rect=function(e,n,i,o,s,a){var r=t._rectPath(n,i,o,s,a),l=e.path(r),c=l.attrs;return l.X=c.x=n,l.Y=c.y=i,l.W=c.width=o,l.H=c.height=s,c.r=a,c.path=r,l.type="rect",l},t._engine.ellipse=function(t,e,n,i,o){{var s=t.path();s.attrs}return s.X=e-i,s.Y=n-o,s.W=2*i,s.H=2*o,s.type="ellipse",k(s,{cx:e,cy:n,rx:i,ry:o}),s},t._engine.circle=function(t,e,n,i){{var o=t.path();o.attrs}return o.X=e-i,o.Y=n-i,o.W=o.H=2*i,o.type="circle",k(o,{cx:e,cy:n,r:i}),o},t._engine.image=function(e,n,i,o,s,a){var r=t._rectPath(i,o,s,a),l=e.path(r).attr({stroke:"none"}),u=l.attrs,d=l.node,h=d.getElementsByTagName(c)[0];return u.src=n,l.X=u.x=i,l.Y=u.y=o,l.W=u.width=s,l.H=u.height=a,u.path=r,l.type="image",h.parentNode==d&&d.removeChild(h),h.rotate=!0,h.src=n,h.type="tile",l._.fillpos=[i,o],l._.fillsize=[s,a],d.appendChild(h),T(l,1,1,0,0,0),l},t._engine.text=function(e,i,o,a){var r=j("shape"),l=j("path"),c=j("textpath");i=i||0,o=o||0,a=a||"",l.v=t.format("m{0},{1}l{2},{1}",s(i*w),s(o*w),s(i*w)+1),l.textpathok=!0,c.string=n(a),c.on=!0,r.style.cssText=y,r.coordsize=w+p+w,r.coordorigin="0 0";var u=new M(r,e),d={fill:"#000",stroke:"none",font:t._availableAttrs.font,text:a};u.shape=r,u.path=l,u.textpath=c,u.type="text",u.attrs.text=n(a),u.attrs.x=i,u.attrs.y=o,u.attrs.w=1,u.attrs.h=1,k(u,d),r.appendChild(c),r.appendChild(l),e.canvas.appendChild(r);var h=j("skew");return h.on=!0,r.appendChild(h),u.skew=h,u.transform(f),u},t._engine.setSize=function(e,n){var i=this.canvas.style;return this.width=e,this.height=n,e==+e&&(e+="px"),n==+n&&(n+="px"),i.width=e,i.height=n,i.clip="rect(0 "+e+" "+n+" 0)",this._viewBox&&t._engine.setViewBox.apply(this,this._viewBox),this},t._engine.setViewBox=function(e,n,i,o,s){t.eve("raphael.setViewBox",this,this._viewBox,[e,n,i,o,s]);var r,l,c=this.width,u=this.height,d=1/a(i/c,o/u);return s&&(r=u/o,l=c/i,c>i*r&&(e-=(c-i*r)/2/r),u>o*l&&(n-=(u-o*l)/2/l)),this._viewBox=[e,n,i,o,!!s],this._viewBoxShift={dx:-e,dy:-n,scale:d},this.forEach(function(t){t.transform("...")}),this};var j;t._engine.initWin=function(t){var e=t.document;e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),j=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(n){j=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},t._engine.initWin(t._g.win),t._engine.create=function(){var e=t._getContainer.apply(0,arguments),n=e.container,i=e.height,o=e.width,s=e.x,a=e.y;if(!n)throw new Error("VML container not found.");var r=new t._Paper,l=r.canvas=t._g.doc.createElement("div"),c=l.style;return s=s||0,a=a||0,o=o||512,i=i||342,r.width=o,r.height=i,o==+o&&(o+="px"),i==+i&&(i+="px"),r.coordsize=1e3*w+p+1e3*w,r.coordorigin="0 0",r.span=t._g.doc.createElement("span"),r.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(r.span),c.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",o,i),1==n?(t._g.doc.body.appendChild(l),c.left=s+"px",c.top=a+"px",c.position="absolute"):n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),r.renderfix=function(){},r},t.prototype.clear=function(){t.eve("raphael.clear",this),this.canvas.innerHTML=f,this.span=t._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},t.prototype.remove=function(){t.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;return!0};var N=t.st;for(var E in L)L[e](E)&&!N[e](E)&&(N[E]=function(t){return function(){var e=arguments;return this.forEach(function(n){n[t].apply(n,e)})}}(E))}(window.Raphael),define("raphael",["eve"],function(t){return function(){var e;return e||t.Raphael}}(this)),function(t){t.fn.freeTransform=function(t,e,n){function i(t){("set"===t.type?t.items:[t]).map(function(t){"set"===t.type?i(t):p.items.push({el:t,attrs:{rotate:0,scale:{x:1,y:1},translate:{x:0,y:0}},transformString:t.matrix.toTransformString()})})}function o(){var t={x:p.attrs.rotate*Math.PI/180,y:(p.attrs.rotate+90)*Math.PI/180},e={x:p.attrs.size.x/2*p.attrs.scale.x,y:p.attrs.size.y/2*p.attrs.scale.y},n=[],i=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}];return i.map(function(i){n.push({x:p.attrs.center.x+p.attrs.translate.x+i.x*e.x*Math.cos(t.x)+i.y*e.y*Math.cos(t.y),y:p.attrs.center.y+p.attrs.translate.y+i.x*e.x*Math.sin(t.x)+i.y*e.y*Math.sin(t.y)})}),n}function s(){var t={x:/^([0-9]+)%$/.exec(d.width),y:/^([0-9]+)%$/.exec(d.height)};return{x:t.x?d.canvas.clientWidth||d.canvas.parentNode.clientWidth*parseInt(t.x[1],10)*.01:d.canvas.clientWidth||d.width,y:t.y?d.canvas.clientHeight||d.canvas.parentNode.clientHeight*parseInt(t.y[1],10)*.01:d.canvas.clientHeight||d.height}}function a(t){if(t&&p.opts.snap.drag){var e=t.x,n=t.y,i={x:0,y:0},o={x:0,y:0};[0,1].map(function(){i.x=e-Math.round(e/p.opts.snap.drag)*p.opts.snap.drag,i.y=n-Math.round(n/p.opts.snap.drag)*p.opts.snap.drag,Math.abs(i.x)<=p.opts.snapDist.drag&&(o.x=i.x),Math.abs(i.y)<=p.opts.snapDist.drag&&(o.y=i.y),e+=t.width-o.x,n+=t.height-o.y}),p.attrs.translate.x-=o.x,p.attrs.translate.y-=o.y}if(p.opts.boundary){var a=p.opts.boundary;a.width=a.width||s().x,a.height=a.height||s().y,p.attrs.center.x+p.attrs.translate.x<a.x&&(p.attrs.translate.x+=a.x-(p.attrs.center.x+p.attrs.translate.x)),p.attrs.center.y+p.attrs.translate.y<a.y&&(p.attrs.translate.y+=a.y-(p.attrs.center.y+p.attrs.translate.y)),p.attrs.center.x+p.attrs.translate.x>a.x+a.width&&(p.attrs.translate.x+=a.x+a.width-(p.attrs.center.x+p.attrs.translate.x)),p.attrs.center.y+p.attrs.translate.y>a.y+a.height&&(p.attrs.translate.y+=a.y+a.height-(p.attrs.center.y+p.attrs.translate.y))}if(i=Math.abs(p.attrs.rotate%p.opts.snap.rotate),i=Math.min(i,p.opts.snap.rotate-i),i<p.opts.snapDist.rotate&&(p.attrs.rotate=Math.round(p.attrs.rotate/p.opts.snap.rotate)*p.opts.snap.rotate),i={x:Math.abs(p.attrs.scale.x*p.attrs.size.x%p.opts.snap.scale),y:Math.abs(p.attrs.scale.y*p.attrs.size.x%p.opts.snap.scale)},i={x:Math.min(i.x,p.opts.snap.scale-i.x),y:Math.min(i.y,p.opts.snap.scale-i.y)},i.x<p.opts.snapDist.scale&&(p.attrs.scale.x=Math.round(p.attrs.scale.x*p.attrs.size.x/p.opts.snap.scale)*p.opts.snap.scale/p.attrs.size.x),i.y<p.opts.snapDist.scale&&(p.attrs.scale.y=Math.round(p.attrs.scale.y*p.attrs.size.y/p.opts.snap.scale)*p.opts.snap.scale/p.attrs.size.y),p.opts.range.rotate){var r=(360+p.attrs.rotate)%360;r>180&&(r-=360),r<p.opts.range.rotate[0]&&(p.attrs.rotate+=p.opts.range.rotate[0]-r),r>p.opts.range.rotate[1]&&(p.attrs.rotate+=p.opts.range.rotate[1]-r)}p.opts.range.scale&&(p.attrs.scale.x*p.attrs.size.x<p.opts.range.scale[0]&&(p.attrs.scale.x=p.opts.range.scale[0]/p.attrs.size.x),p.attrs.scale.y*p.attrs.size.y<p.opts.range.scale[0]&&(p.attrs.scale.y=p.opts.range.scale[0]/p.attrs.size.y),p.attrs.scale.x*p.attrs.size.x>p.opts.range.scale[1]&&(p.attrs.scale.x=p.opts.range.scale[1]/p.attrs.size.x),p.attrs.scale.y*p.attrs.size.y>p.opts.range.scale[1]&&(p.attrs.scale.y=p.opts.range.scale[1]/p.attrs.size.y))}function r(){return{x:p.attrs.scale.x*p.attrs.size.x>=p.opts.range.scale[0]&&p.attrs.scale.x*p.attrs.size.x<=p.opts.range.scale[1],y:p.attrs.scale.y*p.attrs.size.y>=p.opts.range.scale[0]&&p.attrs.scale.y*p.attrs.size.y<=p.opts.range.scale[1]}}function l(t){"x"===t?p.attrs.scale.y=p.attrs.scale.x/p.attrs.ratio:p.attrs.scale.x=p.attrs.scale.y*p.attrs.ratio}function c(t){var e,n={};for(e in t)n[e]="object"==typeof t[e]?c(t[e]):t[e];return n}function u(t){if(p.callback){var e=[];t.map(function(t){t&&e.push(t)}),clearTimeout(f),f=setTimeout(function(){p.callback&&p.callback(p,e)},1)}}if(t.freeTransform)return t.freeTransform;Array.prototype.hasOwnProperty("map")||(Array.prototype.map=function(t,e){var n,i=[];for(n in this)this.hasOwnProperty(n)&&(i[n]=t.call(e,this[n],n,this));return i}),Array.prototype.hasOwnProperty("indexOf")||(Array.prototype.indexOf=function(t,e){for(var n=e||0,i=this.length;i>n;n++)if(this[n]===t)return n;return-1});var d=this,h=t.getBBox(!0),p=t.freeTransform={attrs:{x:h.x,y:h.y,size:{x:h.width,y:h.height},center:{x:h.x+h.width/2,y:h.y+h.height/2},rotate:0,scale:{x:1,y:1},translate:{x:0,y:0},ratio:1},axes:null,bbox:null,callback:null,items:[],handles:{center:null,x:null,y:null},offset:{rotate:0,scale:{x:1,y:1},translate:{x:0,y:0}},opts:{animate:!1,attrs:{fill:"#fff",stroke:"#000"},boundary:{x:d._left||0,y:d._top||0,width:null,height:null},distance:1.3,drag:!0,draw:!1,keepRatio:!1,range:{rotate:[-180,180],scale:[-99999,99999]},rotate:!0,scale:!0,snap:{rotate:0,scale:0,drag:0},snapDist:{rotate:0,scale:0,drag:7},size:5},subject:t};p.updateHandles=function(){if(p.handles.bbox||p.opts.rotate.indexOf("self")>=0)var t=o();var e={x:p.attrs.rotate*Math.PI/180,y:(p.attrs.rotate+90)*Math.PI/180},n={x:p.attrs.size.x/2*p.attrs.scale.x,y:p.attrs.size.y/2*p.attrs.scale.y};if(p.axes.map(function(t){if(p.handles[t]){var i=p.attrs.center.x+p.attrs.translate.x+n[t]*p.opts.distance*Math.cos(e[t]),o=p.attrs.center.y+p.attrs.translate.y+n[t]*p.opts.distance*Math.sin(e[t]);p.opts.boundary&&(i=Math.max(Math.min(i,p.opts.boundary.x+(p.opts.boundary.width||s().x)),p.opts.boundary.x),o=Math.max(Math.min(o,p.opts.boundary.y+(p.opts.boundary.height||s().y)),p.opts.boundary.y)),p.handles[t].disc.attr({cx:i,cy:o}),p.handles[t].line.toFront().attr({path:[["M",p.attrs.center.x+p.attrs.translate.x,p.attrs.center.y+p.attrs.translate.y],["L",p.handles[t].disc.attrs.cx,p.handles[t].disc.attrs.cy]]}),p.handles[t].disc.toFront()}}),p.bbox){p.bbox.toFront().attr({path:[["M",t[0].x,t[0].y],["L",t[1].x,t[1].y],["L",t[2].x,t[2].y],["L",t[3].x,t[3].y],["L",t[0].x,t[0].y]]});var i=[[-1,-1],[1,-1],[1,1],[-1,1],[0,-1],[1,0],[0,1],[-1,0]];p.handles.bbox&&p.handles.bbox.map(function(e,n){var o,s,a,r;e.isCorner?(o=t[n].x,s=t[n].y):(a=n%4,r=(a+1)%t.length,o=(t[a].x+t[r].x)/2,s=(t[a].y+t[r].y)/2),e.element.toFront().attr({x:o-(e.isCorner?p.opts.size.bboxCorners:p.opts.size.bboxSides),y:s-(e.isCorner?p.opts.size.bboxCorners:p.opts.size.bboxSides)}).transform("R"+p.attrs.rotate),e.x=i[n][0],e.y=i[n][1]
})}return p.circle&&p.circle.attr({cx:p.attrs.center.x+p.attrs.translate.x,cy:p.attrs.center.y+p.attrs.translate.y,r:Math.max(n.x,n.y)*p.opts.distance}),p.handles.center&&p.handles.center.disc.toFront().attr({cx:p.attrs.center.x+p.attrs.translate.x,cy:p.attrs.center.y+p.attrs.translate.y}),p.opts.rotate.indexOf("self")>=0&&(n=Math.max(Math.sqrt(Math.pow(t[1].x-t[0].x,2)+Math.pow(t[1].y-t[0].y,2)),Math.sqrt(Math.pow(t[2].x-t[1].x,2)+Math.pow(t[2].y-t[1].y,2)))/2),p},p.showHandles=function(){if(p.hideHandles(),p.axes.map(function(t){p.handles[t]={},p.handles[t].line=d.path(["M",p.attrs.center.x,p.attrs.center.y]).attr({stroke:p.opts.attrs.stroke,"stroke-dasharray":"- ",opacity:.5}),p.handles[t].disc=d.circle(p.attrs.center.x,p.attrs.center.y,p.opts.size.axes).attr(p.opts.attrs)}),p.opts.draw.indexOf("bbox")>=0){p.bbox=d.path("").attr({stroke:p.opts.attrs.stroke,"stroke-dasharray":"- ",opacity:.5}),p.handles.bbox=[];var e,n;for(e=p.opts.scale.indexOf("bboxCorners")>=0?0:4;e<(-1===p.opts.scale.indexOf("bboxSides")?4:8);e++)n={},n.axis=e%2?"x":"y",n.isCorner=4>e,n.element=d.rect(p.attrs.center.x,p.attrs.center.y,2*p.opts.size[n.isCorner?"bboxCorners":"bboxSides"],2*p.opts.size[n.isCorner?"bboxCorners":"bboxSides"]).attr(p.opts.attrs),p.handles.bbox[e]=n}-1!==p.opts.draw.indexOf("circle")&&(p.circle=d.circle(0,0,0).attr({stroke:p.opts.attrs.stroke,"stroke-dasharray":"- ","stroke-width":"4",opacity:.3})),-1!==p.opts.drag.indexOf("center")&&(p.handles.center={},p.handles.center.disc=d.circle(p.attrs.center.x,p.attrs.center.y,p.opts.size.center).attr(p.opts.attrs)),p.axes.map(function(t){if(p.handles[t]){var e=-1!==p.opts.rotate.indexOf("axis"+t.toUpperCase()),n=-1!==p.opts.scale.indexOf("axis"+t.toUpperCase());p.handles[t].disc.drag(function(i,o){p.o.viewBoxRatio&&(i*=p.o.viewBoxRatio.x,o*=p.o.viewBoxRatio.y);var r=i+p.handles[t].disc.ox,c=o+p.handles[t].disc.oy,d={x:p.o.scale.x<0,y:p.o.scale.y<0};if(e){var h=Math.atan2(c-p.o.center.y-p.o.translate.y,r-p.o.center.x-p.o.translate.x);p.attrs.rotate=180*h/Math.PI-("y"===t?90:0),d[t]&&(p.attrs.rotate-=180)}p.opts.boundary&&(r=Math.max(Math.min(r,p.opts.boundary.x+(p.opts.boundary.width||s().x)),p.opts.boundary.x),c=Math.max(Math.min(c,p.opts.boundary.y+(p.opts.boundary.height||s().y)),p.opts.boundary.y));var f=Math.sqrt(Math.pow(r-p.o.center.x-p.o.translate.x,2)+Math.pow(c-p.o.center.y-p.o.translate.y,2));n&&(p.attrs.scale[t]=f/(p.o.size[t]/2*p.opts.distance),d[t]&&(p.attrs.scale[t]*=-1)),a(),-1!==p.opts.keepRatio.indexOf("axis"+t.toUpperCase())?l(t):p.attrs.ratio=p.attrs.scale.x/p.attrs.scale.y,p.attrs.scale.x&&p.attrs.scale.y&&p.apply(),u([e?"rotate":null,n?"scale":null])},function(){p.o=c(p.attrs),d._viewBox&&(p.o.viewBoxRatio={x:d._viewBox[2]/s().x,y:d._viewBox[3]/s().y}),p.handles[t].disc.ox=this.attrs.cx,p.handles[t].disc.oy=this.attrs.cy,u([e?"rotate start":null,n?"scale start":null])},function(){u([e?"rotate end":null,n?"scale end":null])})}}),p.opts.draw.indexOf("bbox")>=0&&(-1!==p.opts.scale.indexOf("bboxCorners")||-1!==p.opts.scale.indexOf("bboxSides"))&&p.handles.bbox.map(function(t){t.element.drag(function(e,n){p.o.viewBoxRatio&&(e*=p.o.viewBoxRatio.x,n*=p.o.viewBoxRatio.y);var i,o,s,d,h,f,g,m,v,b,y=c(p.attrs);if(i=p.o.rotate.sin,o=p.o.rotate.cos,s=e*o-n*i,d=e*i+n*o,s*=Math.abs(t.x),d*=Math.abs(t.y),h=s*o+d*i,f=s*-i+d*o,p.attrs.translate={x:p.o.translate.x+h/2,y:p.o.translate.y+f/2},g=p.o.handlePos.cx+e-p.attrs.center.x-p.attrs.translate.x,m=p.o.handlePos.cy+n-p.attrs.center.y-p.attrs.translate.y,s=g*o-m*i,d=g*i+m*o,t.isCorner&&-1!==p.opts.keepRatio.indexOf("bboxCorners")){var w=p.attrs.size.x*p.attrs.scale.x/(p.attrs.size.y*p.attrs.scale.y),_=s*t.x*(1/w),x=d*t.y*w;x>_*w?s=x*t.x:d=_*t.y}if(v=2*s*t.x/p.o.size.x,b=2*d*t.y/p.o.size.y,p.attrs.scale={x:v||p.attrs.scale.x,y:b||p.attrs.scale.y},r().x&&r().y||(p.attrs=y),a(),t.isCorner&&-1!==p.opts.keepRatio.indexOf("bboxCorners")||!t.isCorner&&-1!==p.opts.keepRatio.indexOf("bboxSides")){l(t.axis);var C={x:(p.attrs.scale.x-p.o.scale.x)*p.o.size.x*t.x,y:(p.attrs.scale.y-p.o.scale.y)*p.o.size.y*t.y};s=C.x*o+C.y*i,d=-C.x*i+C.y*o,p.attrs.translate.x=p.o.translate.x+s/2,p.attrs.translate.y=p.o.translate.y+d/2}p.attrs.ratio=p.attrs.scale.x/p.attrs.scale.y,u(["scale"]),p.apply()},function(){var e=(360-p.attrs.rotate)%360/180*Math.PI,n=t.element.attr(["x","y"]);p.o=c(p.attrs),p.o.handlePos={cx:n.x+p.opts.size[t.isCorner?"bboxCorners":"bboxSides"],cy:n.y+p.opts.size[t.isCorner?"bboxCorners":"bboxSides"]},p.o.rotate={sin:Math.sin(e),cos:Math.cos(e)},d._viewBox&&(p.o.viewBoxRatio={x:d._viewBox[2]/s().x,y:d._viewBox[3]/s().y}),u(["scale start"])},function(){u(["scale end"])})});var i=[];p.opts.drag.indexOf("self")>=0&&-1===p.opts.scale.indexOf("self")&&-1===p.opts.rotate.indexOf("self")&&i.push(t),p.opts.drag.indexOf("center")>=0&&i.push(p.handles.center.disc),i.map(function(e){e.drag(function(t,e){p.o.viewBoxRatio&&(t*=p.o.viewBoxRatio.x,e*=p.o.viewBoxRatio.y),p.attrs.translate.x=p.o.translate.x+t,p.attrs.translate.y=p.o.translate.y+e;var n=c(p.o.bbox);n.x+=t,n.y+=e,a(n),u(["drag"]),p.apply()},function(){p.o=c(p.attrs),p.opts.snap.drag&&(p.o.bbox=t.getBBox()),d._viewBox&&(p.o.viewBoxRatio={x:d._viewBox[2]/s().x,y:d._viewBox[3]/s().y}),p.axes.map(function(t){p.handles[t]&&(p.handles[t].disc.ox=p.handles[t].disc.attrs.cx,p.handles[t].disc.oy=p.handles[t].disc.attrs.cy)}),u(["drag start"])},function(){u(["drag end"])})});var o=p.opts.rotate.indexOf("self")>=0,h=p.opts.scale.indexOf("self")>=0;return(o||h)&&t.drag(function(t,e,n,i){if(o){var s=Math.atan2(i-p.o.center.y-p.o.translate.y,n-p.o.center.x-p.o.translate.x);p.attrs.rotate=p.o.rotate+180*s/Math.PI-p.o.deg}var r={x:p.o.scale.x<0,y:p.o.scale.y<0};if(h){var l=Math.sqrt(Math.pow(n-p.o.center.x-p.o.translate.x,2)+Math.pow(i-p.o.center.y-p.o.translate.y,2));p.attrs.scale.x=p.attrs.scale.y=(r.x?-1:1)*p.o.scale.x+(l-p.o.radius)/(p.o.size.x/2),r.x&&(p.attrs.scale.x*=-1),r.y&&(p.attrs.scale.y*=-1)}a(),p.apply(),u([o?"rotate":null,h?"scale":null])},function(t,e){p.o=c(p.attrs),p.o.deg=180*Math.atan2(e-p.o.center.y-p.o.translate.y,t-p.o.center.x-p.o.translate.x)/Math.PI,p.o.radius=Math.sqrt(Math.pow(t-p.o.center.x-p.o.translate.x,2)+Math.pow(e-p.o.center.y-p.o.translate.y,2)),d._viewBox&&(p.o.viewBoxRatio={x:d._viewBox[2]/s().x,y:d._viewBox[3]/s().y}),u([o?"rotate start":null,h?"scale start":null])},function(){u([o?"rotate end":null,h?"scale end":null])}),p.updateHandles(),p},p.hideHandles=function(t){var t=t||{};return void 0===t.undrag&&(t.undrag=!0),t.undrag&&p.items.map(function(t){t.el.undrag()}),p.handles.center&&(p.handles.center.disc.remove(),p.handles.center=null),["x","y"].map(function(t){p.handles[t]&&(p.handles[t].disc.remove(),p.handles[t].line.remove(),p.handles[t]=null)}),p.bbox&&(p.bbox.remove(),p.bbox=null,p.handles.bbox&&(p.handles.bbox.map(function(t){t.element.remove()}),p.handles.bbox=null)),p.circle&&(p.circle.remove(),p.circle=null),p},p.setOpts=function(t,e){void 0!==e&&(p.callback="function"==typeof e?e:!1);var n,i;for(n in t)if(t[n]&&t[n].constructor===Object){p.opts[n]===!1&&(p.opts[n]={});for(i in t[n])t[n].hasOwnProperty(i)&&(p.opts[n][i]=t[n][i])}else p.opts[n]=t[n];return p.opts.animate===!0&&(p.opts.animate={delay:700,easing:"linear"}),p.opts.drag===!0&&(p.opts.drag=["center","self"]),p.opts.keepRatio===!0&&(p.opts.keepRatio=["bboxCorners","bboxSides"]),p.opts.rotate===!0&&(p.opts.rotate=["axisX","axisY"]),p.opts.scale===!0&&(p.opts.scale=["axisX","axisY","bboxCorners","bboxSides"]),["drag","draw","keepRatio","rotate","scale"].map(function(t){p.opts[t]===!1&&(p.opts[t]=[])}),p.axes=[],(p.opts.rotate.indexOf("axisX")>=0||p.opts.scale.indexOf("axisX")>=0)&&p.axes.push("x"),(p.opts.rotate.indexOf("axisY")>=0||p.opts.scale.indexOf("axisY")>=0)&&p.axes.push("y"),["drag","rotate","scale"].map(function(t){p.opts.snapDist[t]||(p.opts.snapDist[t]=p.opts.snap[t])}),p.opts.range={rotate:[parseFloat(p.opts.range.rotate[0]),parseFloat(p.opts.range.rotate[1])],scale:[parseFloat(p.opts.range.scale[0]),parseFloat(p.opts.range.scale[1])]},p.opts.snap={drag:parseFloat(p.opts.snap.drag),rotate:parseFloat(p.opts.snap.rotate),scale:parseFloat(p.opts.snap.scale)},p.opts.snapDist={drag:parseFloat(p.opts.snapDist.drag),rotate:parseFloat(p.opts.snapDist.rotate),scale:parseFloat(p.opts.snapDist.scale)},"string"==typeof p.opts.size&&(p.opts.size=parseFloat(p.opts.size)),isNaN(p.opts.size)||(p.opts.size={axes:p.opts.size,bboxCorners:p.opts.size,bboxSides:p.opts.size,center:p.opts.size}),p.showHandles(),u(["init"]),p},p.setOpts(e,n),p.apply=function(){return p.items.map(function(t,e){var n={x:p.attrs.center.x+p.offset.translate.x,y:p.attrs.center.y+p.offset.translate.y},i=p.attrs.rotate-p.offset.rotate,o={x:p.attrs.scale.x/p.offset.scale.x,y:p.attrs.scale.y/p.offset.scale.y},s={x:p.attrs.translate.x-p.offset.translate.x,y:p.attrs.translate.y-p.offset.translate.y};p.opts.animate?(u(["animate start"]),t.el.animate({transform:["R",i,n.x,n.y,"S",o.x,o.y,n.x,n.y,"T",s.x,s.y]+p.items[e].transformString},p.opts.animate.delay,p.opts.animate.easing,function(){u(["animate end"]),p.updateHandles()})):(t.el.transform(["R",i,n.x,n.y,"S",o.x,o.y,n.x,n.y,"T",s.x,s.y]+p.items[e].transformString),u(["apply"]),p.updateHandles())}),p},p.unplug=function(){var e=p.attrs;return p.hideHandles(),delete t.freeTransform,e},i(t),p.items.map(function(t,e){t.el._&&t.el._.transform&&"object"==typeof t.el._.transform&&t.el._.transform.map(function(t){if(t[0])switch(t[0].toUpperCase()){case"T":p.items[e].attrs.translate.x+=t[1],p.items[e].attrs.translate.y+=t[2];break;case"S":p.items[e].attrs.scale.x*=t[1],p.items[e].attrs.scale.y*=t[2];break;case"R":p.items[e].attrs.rotate+=t[1]}})}),"set"!==t.type&&(p.attrs.rotate=p.items[0].attrs.rotate,p.attrs.scale=p.items[0].attrs.scale,p.attrs.translate=p.items[0].attrs.translate,p.items[0].attrs={rotate:0,scale:{x:1,y:1},translate:{x:0,y:0}},p.items[0].transformString=""),p.attrs.ratio=p.attrs.scale.x/p.attrs.scale.y;var f=!1;return p.updateHandles(),p}}(Raphael),define("raphael_free",["raphael","eve"],function(){}),dhtmlx=function(t){for(var e in t)dhtmlx[e]=t[e];return dhtmlx},dhtmlx.extend_api=function(t,e,n){var i=window[t];i&&(window[t]=function(t){if(t&&"object"==typeof t&&!t.tagName){var n,o=i.apply(this,e._init?e._init(t):arguments);for(n in dhtmlx)e[n]&&this[e[n]](dhtmlx[n]);for(n in t)e[n]?this[e[n]](t[n]):0==n.indexOf("on")&&this.attachEvent(n,t[n])}else o=i.apply(this,arguments);return e._patch&&e._patch(this),o||this},window[t].prototype=i.prototype,n&&dhtmlXHeir(window[t].prototype,n))},dhtmlxAjax={get:function(t,e){var n=new dtmlXMLLoaderObject(!0);return n.async=arguments.length<3,n.waitCall=e,n.loadXML(t),n},post:function(t,e,n){var i=new dtmlXMLLoaderObject(!0);return i.async=arguments.length<4,i.waitCall=n,i.loadXML(t,!0,e),i},getSync:function(t){return this.get(t,null,!0)},postSync:function(t,e){return this.post(t,e,null,!0)}},dtmlXMLLoaderObject.count=0,dtmlXMLLoaderObject.prototype.waitLoadFunction=function(t){var e=!0;return this.check=function(){!t||null==t.onloadAction||t.xmlDoc.readyState&&4!=t.xmlDoc.readyState||!e||(e=!1,dtmlXMLLoaderObject.count++,"function"==typeof t.onloadAction&&t.onloadAction(t.mainObject,null,null,null,t),t.waitCall&&(t.waitCall.call(this,t),t.waitCall=null))}},dtmlXMLLoaderObject.prototype.getXMLTopNode=function(t,e){if(this.xmlDoc.responseXML){var n=this.xmlDoc.responseXML.getElementsByTagName(t);0==n.length&&-1!=t.indexOf(":")&&(n=this.xmlDoc.responseXML.getElementsByTagName(t.split(":")[1]));var i=n[0]}else i=this.xmlDoc.documentElement;return i?(this._retry=!1,i):!this._retry&&_isIE?(this._retry=!0,e=this.xmlDoc,this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(t,e)):(dhtmlxError.throwError("LoadXML","Incorrect XML",[e||this.xmlDoc,this.mainObject]),document.createElement("DIV"))},dtmlXMLLoaderObject.prototype.loadXMLString=function(t,e){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(t);else{var n=new DOMParser;this.xmlDoc=n.parseFromString(t,"text/xml")}e||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))},dtmlXMLLoaderObject.prototype.loadXML=function(t,e,n,i){this.rSeed&&(t+=(-1!=t.indexOf("?")?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf()),this.filePath=t,this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)),this.xmlDoc.open(e?"POST":"GET",t,this.async),i?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):e&&this.xmlDoc.setRequestHeader("Content-type",this.contenttype||"application/x-www-form-urlencoded"),this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xmlDoc.send(n),this.async||new this.waitLoadFunction(this)()},dtmlXMLLoaderObject.prototype.destructor=function(){return this.setXSLParamValue=this.getXMLTopNode=this.xmlNodeToJSON=this.doSerialization=this.loadXMLString=this.loadXML=this.doXSLTransToString=this.doXSLTransToObject=this.doXPathOpera=this.doXPath=this.xmlDoc=this.mainObject=this.onloadAction=this.filePath=this.rSeed=this.async=this._retry=this._getAllNamedChilds=this._filterXPath=null},dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(t){for(var e={},n=0;n<t.attributes.length;n++)e[t.attributes[n].name]=t.attributes[n].value;for(e._tagvalue=t.firstChild?t.firstChild.nodeValue:"",n=0;n<t.childNodes.length;n++){var i=t.childNodes[n].tagName;i&&(e[i]||(e[i]=[]),e[i].push(this.xmlNodeToJSON(t.childNodes[n])))}return e},dhtmlDragAndDropObject.prototype.removeDraggableItem=function(t){t.onmousedown=null,t.dragStarter=null,t.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(t,e){t.onmousedown=this.preCreateDragCopy,t.dragStarter=e,this.addDragLanding(t,e)},dhtmlDragAndDropObject.prototype.addDragLanding=function(t,e){t.dragLanding=e},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(t){return!t&&!window.event||2!=(t||event).button?window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(t),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),t&&t.preventDefault&&t.preventDefault(),!1):void 0},dhtmlDragAndDropObject.prototype.callDrag=function(t){if(t||(t=window.event),dragger=window.dhtmlDragAndDrop,!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(t,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,t),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var e=dragger.gldragNode;dragger.gldragNode.old&&(e=dragger.gldragNode.old),e.parentNode.removeChild(e);var n=dragger.dragNode.pWindow;if(e.pWindow&&e.pWindow.dhtmlDragAndDrop.lastLanding&&e.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(e.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var i=document.createElement("Div");i.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=i.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),n.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=t.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=t.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";var o=t.srcElement?t.srcElement:t.target;dragger.checkLanding(o,t)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(t){if(window.name){for(var e=parent.frames[window.name].frameElement.offsetParent,n=0,i=0;e;)n+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;if(parent.dhtmlDragAndDrop){var o=parent.dhtmlDragAndDrop.calculateFramePosition(1);n+=1*o.split("_")[0],i+=1*o.split("_")[1]}if(t)return n+"_"+i;this.fx=n,this.fy=i}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(t,e){t&&t.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=t,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):t&&"BODY"!=t.tagName?this.checkLanding(t.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(t,e){if(dragger=window.dhtmlDragAndDrop,!e){dragger.stopFrameRoute();var n=dragger.lastLanding;dragger.lastLanding=null,n&&n.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,n,_isIE?event.srcElement:t.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(t){t&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var e=0;e<window.frames.length;e++)try{window.frames[e]!=t&&window.frames[e].dhtmlDragAndDrop&&window.frames[e].dhtmlDragAndDrop.stopFrameRoute(window)}catch(n){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(t,e){t&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=t.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=t.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=t.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=t.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&e&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=t&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(n){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=t&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!t||e?1:0)}catch(o){}},_OperaRv=_KHTMLrv=_FFrv=_isChrome=_isMacOS=_isKHTML=_isOpera=_isIE=_isFF=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,(-1!=navigator.appVersion.indexOf("MSIE 8.0")||-1!=navigator.appVersion.indexOf("MSIE 9.0")||-1!=navigator.appVersion.indexOf("MSIE 10.0")||document.documentMode>7)&&"BackCompat"!=document.compatMode&&(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),dtmlXMLLoaderObject.prototype.doXPath=function(t,e,n,i){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(t,e);if(_isIE)return e||(e=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),e||dhtmlxError.throwError("LoadXML","Incorrect XML",[e||this.xmlDoc,this.mainObject]),null!=n&&e.setProperty("SelectionNamespaces","xmlns:xsl='"+n+"'"),"single"==i?e.selectSingleNode(t):e.selectNodes(t)||[];var o=e;e||(e=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),e||dhtmlxError.throwError("LoadXML","Incorrect XML",[e||this.xmlDoc,this.mainObject]),-1!=e.nodeName.indexOf("document")?o=e:(o=e,e=e.ownerDocument);var s=XPathResult.ANY_TYPE;"single"==i&&(s=XPathResult.FIRST_ORDERED_NODE_TYPE);var a=[],r=e.evaluate(t,o,function(){return n},s,null);if(s==XPathResult.FIRST_ORDERED_NODE_TYPE)return r.singleNodeValue;for(var l=r.iterateNext();l;)a[a.length]=l,l=r.iterateNext();return a},j.prototype.catchError=function(t,e){this.catches[t]=e},j.prototype.throwError=function(t,e,n){return this.catches[t]?this.catches[t](t,e,n):this.catches.ALL?this.catches.ALL(t,e,n):(alert("Error type: "+t+"\nDescription: "+e),null)},window.dhtmlxError=new j,dtmlXMLLoaderObject.prototype.doXPathOpera=function(t,e){var n=t.replace(/[\/]+/gi,"/").split("/"),i=null,o=1;if(!n.length)return[];if("."==n[0])i=[e];else{if(""!=n[0])return[];i=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(n[o].replace(/\[[^\]]*\]/g,"")),o++}for(;o<n.length;o++)i=this._getAllNamedChilds(i,n[o]);return-1!=n[o-1].indexOf("[")&&(i=this._filterXPath(i,n[o-1])),i},dtmlXMLLoaderObject.prototype._filterXPath=function(t,e){for(var n=[],e=e.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),i=0;i<t.length;i++)t[i].getAttribute(e)&&(n[n.length]=t[i]);return n},dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(t,e){var n=[];_isKHTML&&(e=e.toUpperCase());for(var i=0;i<t.length;i++)for(var o=0;o<t[i].childNodes.length;o++)_isKHTML?t[i].childNodes[o].tagName&&t[i].childNodes[o].tagName.toUpperCase()==e&&(n[n.length]=t[i].childNodes[o]):t[i].childNodes[o].tagName==e&&(n[n.length]=t[i].childNodes[o]);return n},dtmlXMLLoaderObject.prototype.xslDoc=null,dtmlXMLLoaderObject.prototype.setXSLParamValue=function(t,e,n){n||(n=this.xslDoc),n.responseXML&&(n=n.responseXML);var i=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+t+"']",n,"http://www.w3.org/1999/XSL/Transform","single");null!=i&&(i.firstChild.nodeValue=e)},dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(t,e){if(t||(t=this.xslDoc),t.responseXML&&(t=t.responseXML),e||(e=this.xmlDoc),e.responseXML&&(e=e.responseXML),_isIE){i=new ActiveXObject("Msxml2.DOMDocument.3.0");try{e.transformNodeToObject(t,i)}catch(n){i=e.transformNode(t)}}else{this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(t));var i=this.XSLProcessor.transformToDocument(e)}return i},dtmlXMLLoaderObject.prototype.doXSLTransToString=function(t,e){var n=this.doXSLTransToObject(t,e);return"string"==typeof n?n:this.doSerialization(n)},dtmlXMLLoaderObject.prototype.doSerialization=function(t){if(t||(t=this.xmlDoc),t.responseXML&&(t=t.responseXML),_isIE)return t.xml;var e=new XMLSerializer;return e.serializeToString(t)},dhtmlxEventable=function(a){a.attachEvent=function(t,e,n){return t="ev_"+t.toLowerCase(),this[t]||(this[t]=new this.eventCatcher(n||this)),t+":"+this[t].addEvent(e)},a.callEvent=function(t,e){return t="ev_"+t.toLowerCase(),this[t]?this[t].apply(this,e):!0},a.checkEvent=function(t){return!!this["ev_"+t.toLowerCase()]},a.eventCatcher=function(a){var c=[],d=function(){for(var t=!0,e=0;e<c.length;e++)if(null!=c[e])var n=c[e].apply(a,arguments),t=t&&n;return t};return d.addEvent=function(a){return"function"!=typeof a&&(a=eval(a)),a?c.push(a)-1:!1},d.removeEvent=function(t){c[t]=null},d},a.detachEvent=function(t){if(0!=t){var e=t.split(":");this[e[0]].removeEvent(e[1])}},a.detachAllEvents=function(){for(var t in this)0==t.indexOf("ev_")&&(this.detachEvent(t),this[t]=null)},a=null},define("dhtmlxcommon",function(t){return function(){var e;return e||t.dhtmlx}}(this)),dhtmlXToolbarObject.prototype.addSpacer=function(t){var e=this.idPrefix+t;if(null!=this._spacer){if(this._spacer.idd==t)return;if(this._spacer==this.objPull[e].obj.parentNode){for(var n=!0;n;){var i=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]),(i==t||0==this._spacer.childNodes.length)&&(null!=this.objPull[e].arw&&this.base.appendChild(this.objPull[e].arw),n=!1)}return this._spacer.idd=t,void this._fixSpacer()}if(this.base==this.objPull[e].obj.parentNode){for(var n=!0,o=null!=this.objPull[e].arw;n;){var s=this.base.childNodes.length-1;1==o&&this.base.childNodes[s]==this.objPull[e].arw&&(n=!1),this.base.childNodes[s].idd==t&&(n=!1),n&&(this._spacer.childNodes.length>0?this._spacer.insertBefore(this.base.childNodes[s],this._spacer.childNodes[0]):this._spacer.appendChild(this.base.childNodes[s]))}return this._spacer.idd=t,void this._fixSpacer()}}else{for(var a=null,s=0;s<this.base.childNodes.length;s++)this.base.childNodes[s]==this.objPull[this.idPrefix+t].obj&&(a=s,null!=this.objPull[this.idPrefix+t].arw&&(a=s+1));if(null!=a){for(this._spacer=document.createElement("DIV"),this._spacer.className="dhxtoolbar_spacer "+("right"==this.align?" float_left":" float_right"),this._spacer.dir="ltr",this._spacer.idd=t;this.base.childNodes.length>a+1;)this._spacer.appendChild(this.base.childNodes[a+1]);this.cont.appendChild(this._spacer),this._fixSpacer()}}"dhx_terrace"==this.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.removeSpacer=function(){if(this._spacer){for(;this._spacer.childNodes.length>0;)this.base.appendChild(this._spacer.childNodes[0]);this._spacer.parentNode.removeChild(this._spacer),this._spacer=null,"dhx_terrace"==this.skin&&this._improveTerraceSkin()}},dhtmlXToolbarObject.prototype._fixSpacer=function(){if(_isIE&&null!=this._spacer){this._spacer.style.borderLeft="1px solid #a4bed4";var t=this._spacer;window.setTimeout(function(){t.style.borderLeft="0px solid #a4bed4",t=null},1)}},dhtmlXToolbarObject.prototype.getType=function(t){var e=this.getParentId(t);if(null!=e){var n=null,i=this.objPull[this.idPrefix+e]._listOptions[t];return null!=i&&(n=null!=i.sep?"buttonSelectSeparator":"buttonSelectButton"),n}return null==this.objPull[this.idPrefix+t]?null:this.objPull[this.idPrefix+t].type},dhtmlXToolbarObject.prototype.getTypeExt=function(t){var e=this.getType(t);return"buttonSelectButton"==e||"buttonSelectSeparator"==e?e="buttonSelectButton"==e?"button":"separator":null},dhtmlXToolbarObject.prototype.inArray=function(t,e){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},dhtmlXToolbarObject.prototype.getParentId=function(t){var e,n=null;for(e in this.objPull)if(this.objPull[e]._listOptions)for(var i in this.objPull[e]._listOptions)i==t&&(n=String(e).replace(this.idPrefix,""));return n},dhtmlXToolbarObject.prototype._addItem=function(t,e){this._addItemToStorage(t,e),"dhx_terrace"==this.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype.addButton=function(t,e,n,i,o){this._addItem({id:t,type:"button",text:n,img:i,imgdis:o},e)},dhtmlXToolbarObject.prototype.addText=function(t,e,n){this._addItem({id:t,type:"text",text:n},e)},dhtmlXToolbarObject.prototype.addButtonSelect=function(t,e,n,i,o,s,a,r,l,c){for(var u=[],d=0;d<i.length;d++){var h={};i[d]instanceof Array?(h.id=i[d][0],h.type="obj"==i[d][1]?"button":"separator",h.text=i[d][2]||null,h.img=i[d][3]||null):i[d]instanceof Object&&null!=i[d]&&"undefined"!=typeof i[d].id&&"undefined"!=typeof i[d].type&&(h.id=i[d].id,h.type="obj"==i[d].type?"button":"separator",h.text=i[d].text,h.img=i[d].img),u[u.length]=h}this._addItem({id:t,type:"buttonSelect",text:n,img:o,imgdis:s,renderSelect:a,openAll:r,items:u,maxOpen:l,mode:c},e)},dhtmlXToolbarObject.prototype.addButtonTwoState=function(t,e,n,i,o){this._addItem({id:t,type:"buttonTwoState",img:i,imgdis:o,text:n},e)},dhtmlXToolbarObject.prototype.addSeparator=function(t,e){this._addItem({id:t,type:"separator"},e)},dhtmlXToolbarObject.prototype.addSlider=function(t,e,n,i,o,s,a,r,l){this._addItem({id:t,type:"slider",length:n,valueMin:i,valueMax:o,valueNow:s,textMin:a,textMax:r,toolTip:l},e)},dhtmlXToolbarObject.prototype.addInput=function(t,e,n,i){this._addItem({id:t,type:"buttonInput",value:n,width:i},e)},dhtmlXToolbarObject.prototype.forEachItem=function(t){for(var e in this.objPull)this.inArray(this.rootTypes,this.objPull[e].type)&&t(this.objPull[e].id.replace(this.idPrefix,""))},function(){for(var t="isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(","),e=[!1,"","",!1,"","","","","","","","","",!1,"","","",null,"",[null,null],"",[null,null],"",null],n=function(t,e){return function(n,i,o){return n=this.idPrefix+n,null!=this.objPull[n][t]?this.objPull[n][t].call(this.objPull[n],i,o):e}},i=0;i<t.length;i++){var o=t[i],s=e[i];dhtmlXToolbarObject.prototype[o]=n(o,s)}}(),dhtmlXToolbarObject.prototype.showItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].showItem&&(this.objPull[t].showItem(),"dhx_terrace"==this.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.hideItem=function(t){t=this.idPrefix+t,null!=this.objPull[t]&&null!=this.objPull[t].hideItem&&(this.objPull[t].hideItem(),"dhx_terrace"==this.skin&&this._improveTerraceSkin())},dhtmlXToolbarObject.prototype.getPosition=function(t){return this._getPosition(t)},dhtmlXToolbarObject.prototype._getPosition=function(t){if(null==this.objPull[this.idPrefix+t])return null;for(var e=null,n=0,i=0;i<this.base.childNodes.length;i++)null!=this.base.childNodes[i].idd&&(this.base.childNodes[i].idd==t&&(e=n),n++);if(!e&&null!=this._spacer)for(i=0;i<this._spacer.childNodes.length;i++)null!=this._spacer.childNodes[i].idd&&(this._spacer.childNodes[i].idd==t&&(e=n),n++);return e},dhtmlXToolbarObject.prototype.setPosition=function(t,e){this._setPosition(t,e)},dhtmlXToolbarObject.prototype._setPosition=function(t,e){if(null!=this.objPull[this.idPrefix+t]){isNaN(e)&&(e=this.base.childNodes.length),0>e&&(e=0);var n=null;this._spacer&&(n=this._spacer.idd,this.removeSpacer());var i=this.objPull[this.idPrefix+t];this.base.removeChild(i.obj),i.arw&&this.base.removeChild(i.arw);var o=this._getIdByPosition(e,!0);null==o[0]?(this.base.appendChild(i.obj),i.arw&&this.base.appendChild(i.arw)):(this.base.insertBefore(i.obj,this.base.childNodes[o[1]]),i.arw&&this.base.insertBefore(i.arw,this.base.childNodes[o[1]+1])),null!=n&&this.addSpacer(n)}},dhtmlXToolbarObject.prototype._getIdByPosition=function(t,e){for(var n=null,i=0,o=0,s=0;s<this.base.childNodes.length;s++)null!=this.base.childNodes[s].idd&&null==n&&i++==t&&(n=this.base.childNodes[s].idd),null==n&&o++;return o=null==n?null:o,1==e?[n,o]:n},dhtmlXToolbarObject.prototype.removeItem=function(t){this._removeItem(t),"dhx_terrace"==this.skin&&this._improveTerraceSkin()},dhtmlXToolbarObject.prototype._removeItem=function(t){var e=this.getType(t),t=this.idPrefix+t,n=this.objPull[t];if("button"==e&&(n.obj._doOnMouseOver=null,n.obj._doOnMouseOut=null,n.obj._doOnMouseUp=null,n.obj._doOnMouseUpOnceAnywhere=null,n.obj.onclick=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmouseup=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.renderAs=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.state=null,n.img=null,n.imgEn=null,n.imgDis=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null),"buttonTwoState"==e&&(n.obj._doOnMouseOver=null,n.obj._doOnMouseOut=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.renderAs=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.state=null,n.img=null,n.imgEn=null,n.imgDis=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null,n.setItemState=null,n.getItemState=null),"buttonSelect"==e){for(var i in n._listOptions)this.removeListOption(t,i);
n._listOptions=null,n.polygon._ie6cover&&(document.body.removeChild(n.polygon._ie6cover),n.polygon._ie6cover=null),n.p_tbl.removeChild(n.p_tbody),n.polygon.removeChild(n.p_tbl),n.polygon.onselectstart=null,document.body.removeChild(n.polygon),n.p_tbody=null,n.p_tbl=null,n.polygon=null,n.obj.onclick=null,n.obj.onmouseover=null,n.obj.onmouseout=null,n.obj.onmouseup=null,n.obj.onmousedown=null,n.obj.onselectstart=null,n.obj.idd=null,n.obj.iddPrefix=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.arw.onclick=null,n.arw.onmouseover=null,n.arw.onmouseout=null,n.arw.onmouseup=null,n.arw.onmousedown=null,n.arw.onselectstart=null,n.arw.parentNode.removeChild(n.arw),n.arw=null,n.renderSelect=null,n.state=null,n.type=null,n.id=null,n.img=null,n.imgEn=null,n.imgDis=null,n.openAll=null,n._isListButton=null,n._separatorButtonSelectObject=null,n._buttonButtonSelectObject=null,n.setWidth=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemText=null,n.getItemText=null,n.setItemImage=null,n.clearItemImage=null,n.setItemImageDis=null,n.clearItemImageDis=null,n.setItemToolTip=null,n.getItemToolTip=null,n.addListOption=null,n.removeListOption=null,n.showListOption=null,n.hideListOption=null,n.isListOptionVisible=null,n.enableListOption=null,n.disableListOption=null,n.isListOptionEnabled=null,n.setListOptionPosition=null,n.getListOptionPosition=null,n.setListOptionImage=null,n.getListOptionImage=null,n.clearListOptionImage=null,n.setListOptionText=null,n.getListOptionText=null,n.setListOptionToolTip=null,n.getListOptionToolTip=null,n.forEachListOption=null,n.getAllListOptions=null,n.setListOptionSelected=null,n.getListOptionSelected=null}if("buttonInput"==e&&(n.obj.childNodes[0].onkeydown=null,n.obj.removeChild(n.obj.childNodes[0]),n.obj.w=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setItemToolTip=null,n.getItemToolTip=null,n.setWidth=null,n.getWidth=null,n.setValue=null,n.getValue=null,n.setItemText=null,n.getItemText=null),"slider"==e){for(this._isIPad?(document.removeEventListener("touchmove",pen._doOnMouseMoveStart,!1),document.removeEventListener("touchend",pen._doOnMouseMoveEnd,!1)):"function"==typeof window.addEventListener?(window.removeEventListener("mousemove",n.pen._doOnMouseMoveStart,!1),window.removeEventListener("mouseup",n.pen._doOnMouseMoveEnd,!1)):(document.body.detachEvent("onmousemove",n.pen._doOnMouseMoveStart),document.body.detachEvent("onmouseup",n.pen._doOnMouseMoveEnd)),n.pen.allowMove=null,n.pen.initXY=null,n.pen.maxX=null,n.pen.minX=null,n.pen.nowX=null,n.pen.newNowX=null,n.pen.valueMax=null,n.pen.valueMin=null,n.pen.valueNow=null,n.pen._definePos=null,n.pen._detectLimits=null,n.pen._doOnMouseMoveStart=null,n.pen._doOnMouseMoveEnd=null,n.pen.onmousedown=null,n.obj.removeChild(n.pen),n.pen=null,n.label.tip=null,document.body.removeChild(n.label),n.label=null,n.obj.onselectstart=null,n.obj.idd=null;n.obj.childNodes.length>0;)n.obj.removeChild(n.obj.childNodes[0]);n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.state=null,n.enableItem=null,n.disableItem=null,n.isEnabled=null,n.setItemToolTipTemplate=null,n.getItemToolTipTemplate=null,n.setMaxValue=null,n.setMinValue=null,n.getMaxValue=null,n.getMinValue=null,n.setValue=null,n.getValue=null,n.showItem=null,n.hideItem=null,n.isVisible=null}"separator"==e&&(n.obj.onselectstart=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.showItem=null,n.hideItem=null,n.isVisible=null),"text"==e&&(n.obj.onselectstart=null,n.obj.idd=null,n.obj.parentNode.removeChild(n.obj),n.obj=null,n.id=null,n.type=null,n.showItem=null,n.hideItem=null,n.isVisible=null,n.setWidth=null,n.setItemText=null,n.getItemText=null),n=e=null,this.objPull[this.idPrefix+t]=null,delete this.objPull[this.idPrefix+t]},function(){for(var t="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(","),e=function(t){return function(e,n,i,o,s,a){return e=this.idPrefix+e,null!=this.objPull[e]?"buttonSelect"!=this.objPull[e].type?void 0:this.objPull[e][t].call(this.objPull[e],n,i,o,s,a):void 0}},n=0;n<t.length;n++){var i=t[n];dhtmlXToolbarObject.prototype[i]=e(i)}}(),dhtmlXToolbarObject.prototype._rtlParseBtn=function(t,e){return t+e},dhtmlXToolbarObject.prototype._separatorObject=function(t,e,n){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_sep",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.onselectstart=function(t){t=t||event,t.returnValue=!1},t._isIPad&&(this.obj.ontouchstart=function(t){return t=t||event,t.returnValue=!1,t.cancelBubble=!0,!1}),t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this},dhtmlXToolbarObject.prototype._textObject=function(t,e,n){return this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_text",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.onselectstart=function(t){t=t||event,t.returnValue=!1},t._isIPad&&(this.obj.ontouchstart=function(t){return t=t||event,t.returnValue=!1,t.cancelBubble=!0,!1}),this.obj.innerHTML=n.text||"",t.base.appendChild(this.obj),this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(t){this.obj.innerHTML=t},this.getItemText=function(){return this.obj.innerHTML},this.setWidth=function(t){this.obj.style.width=t+"px"},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null!=n.enabled?!1:!0,this.imgEn=n.img||"",this.imgDis=n.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.allowClick=!1,this.obj.extAction=n.action||null,this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.imagePath+this.img+"'>":"",null!=n.text?"<div>"+n.text+"</div>":"");var i=this;return this.obj.onselectstart=function(t){t=t||event,t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){this.allowClick=!0,0!=i.state&&"none"==t.anyUsed&&(this.renderAs=this.className="dhx_toolbar_btn over")},this.obj._doOnMouseOut=function(){this.allowClick=!1,0!=i.state&&"none"==t.anyUsed&&(this.className="dhx_toolbar_btn def",this.renderAs=this.renderAs)},this.obj.onclick=function(e){if(0!=i.state&&0!=this.allowClick){var e=e||event,n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n)}catch(o){}t&&t.callEvent&&t.callEvent("onClick",[n])}},this.obj[t._isIPad?"ontouchstart":"onmousedown"]=function(e){return 0==i.state?(e=e||event,e.returnValue=!1,e.cancelBubble=!0,!1):"none"==t.anyUsed?(t.anyUsed=this.idd,this.className="dhx_toolbar_btn pres",this.pressed=!0,this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){t.anyUsed="none",this._doOnMouseOut()},!1):void 0},this.obj[t._isIPad?"ontouchend":"onmouseup"]=function(){if(0!=i.state&&("none"==t.anyUsed||t.anyUsed==this.idd)){var e=t.anyUsed;this._doOnMouseUp(),t._isIPad&&"none"!=e&&t.callEvent("onClick",[this.idd.replace(t.idPrefix,"")])}},t._isIPad&&(this.obj.ontouchmove=function(){this._doOnMouseUp()}),this.obj._doOnMouseUp=function(){t.anyUsed="none",this.className=this.renderAs,this.pressed=!1},this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp(),this.onmouseover=function(){this._doOnMouseOver()},this.onmouseout=function(){this._doOnMouseOut()}},t.base.appendChild(this.obj),this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._buttonSelectObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null!=n.enabled?"true"==n.enabled?!0:!1:!0,this.imgEn=n.img||"",this.imgDis=n.imgdis||"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.mode=n.mode||"button","select"==this.mode?(this.openAll=!0,this.renderSelect=!1,n.text&&0!=n.text.length||(n.text="&nbsp;")):(this.openAll="true"==n.openAll||1==n.openAll||1==n.openAll||"1"==n.openAll||"yes"==n.openAll||"on"==n.openAll,this.renderSelect=null!=n.renderSelect&&("false"==n.renderSelect||"disabled"==n.renderSelect)?!1:!0),this.maxOpen=isNaN(n.maxOpen?n.maxOpen:"")?null:n.maxOpen,this._maxOpenTest=function(){if(!isNaN(this.maxOpen)&&!t._sbw){var e=document.createElement("DIV");e.className="dhxtoolbar_maxopen_test",document.body.appendChild(e);var n=document.createElement("DIV");n.className="dhxtoolbar_maxopen_test2",e.appendChild(n),t._sbw=e.offsetWidth-n.offsetWidth,e.removeChild(n),n=null,document.body.removeChild(e),e=null}},this._maxOpenTest(),this.obj=document.createElement("DIV"),this.obj.allowClick=!1,this.obj.extAction=n.action||null,this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.onselectstart=function(t){t=t||event,t.returnValue=!1},this.obj.idd=String(e),this.obj.title=n.title||"",this.callEvent=this.obj.pressed=!1,this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.imagePath+this.img+"'>":"",null!=n.text?"<div>"+n.text+"</div>":""),t.base.appendChild(this.obj),this.arw=document.createElement("DIV"),this.arw.className="dhx_toolbar_arw "+(this.state?"def":"dis"),this.arw.style.display=this.obj.style.display,this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>",this.arw.title=this.obj.title,this.arw.onselectstart=function(t){t=t||event,t.returnValue=!1},t.base.appendChild(this.arw);var i=this;if(this.obj.onmouseover=function(e){e=e||event,"none"==t.anyUsed&&i.state&&(i.obj.renderAs="dhx_toolbar_btn over",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"))},this.obj.onmouseout=function(){i.obj.allowClick=!1,"none"==t.anyUsed&&i.state&&(i.obj.renderAs="dhx_toolbar_btn def",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),i.callEvent=!1)},this.arw.onmouseover=this.obj.onmouseover,this.arw.onmouseout=this.obj.onmouseout,1!=this.openAll&&(this.obj.onclick=function(e){if(e=e||event,i.obj.allowClick&&i.state&&"none"==t.anyUsed){var n=i.obj.idd.replace(t.idPrefix,"");if(i.obj.extAction)try{window[i.obj.extAction](n)}catch(o){}t.callEvent("onClick",[n])}},this.obj[t._isIPad?"ontouchstart":"onmousedown"]=function(e){e=e||event,"none"==t.anyUsed&&i.state&&(i.obj.allowClick=!0,i.obj.className="dhx_toolbar_btn pres",i.arw.className="dhx_toolbar_arw pres",i.callEvent=!0)},this.obj[t._isIPad?"ontouchend":"onmouseup"]=function(e){if(e=e||event,e.cancelBubble=!0,"none"==t.anyUsed&&i.state&&(i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),t._isIPad&&i.callEvent)){var n=i.obj.idd.replace(t.idPrefix,"");t.callEvent("onClick",[n])}}),t._isIPad&&(this.obj.ontouchmove=this.obj.onmouseout),this.arw[t._isIPad?"ontouchstart":"onmousedown"]=function(e){var e=e||event,n=0===this.className.indexOf("dhx_toolbar_arw")?this:this.nextSibling;if(n._skip?(e=e||event,e.cancelBubble=!0):n._skip=!0,n=null,i.state){if(t.anyUsed==i.obj.idd)i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),t.anyUsed="none",i.polygon.style.display="none",i.polygon._ie6cover&&(i.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.skin&&t._improveTerraceButtonSelect(i.id,!0);else{if("none"!=t.anyUsed&&"buttonSelect"==t.objPull[t.idPrefix+t.anyUsed].type){var o=t.objPull[t.idPrefix+t.anyUsed];"none"!=o.polygon.style.display&&(o.obj.renderAs="dhx_toolbar_btn def",o.obj.className=o.obj.renderAs,o.arw.className=String(i.obj.renderAs).replace("btn","arw"),o.polygon.style.display="none",o.polygon._ie6cover&&(o.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.skin&&t._improveTerraceButtonSelect(o.id,!0))}i.obj.className="dhx_toolbar_btn over",i.arw.className="dhx_toolbar_arw pres",t.anyUsed=i.obj.idd,i.polygon.style.top="0px",i.polygon.style.visibility="hidden",i.polygon.style.display="","dhx_terrace"==t.skin&&t._improveTerraceButtonSelect(i.id,!1),i._fixMaxOpenHeight(i.maxOpen||null),t._autoDetectVisibleArea();var s=getAbsoluteTop(i.obj)+i.obj.offsetHeight+t.selectPolygonOffsetTop,a=i.polygon.offsetHeight;if(s+a>t.tY2){var r=null!=i.maxOpen?Math.floor((t.tY2-s)/22):0;r>=1?i._fixMaxOpenHeight(r):(s=getAbsoluteTop(i.obj)-a-t.selectPolygonOffsetTop,0>s&&(s=0))}if(i.polygon.style.top=s+"px",t.rtl)i.polygon.style.left=getAbsoluteLeft(i.obj)+i.obj.offsetWidth-i.polygon.offsetWidth+t.selectPolygonOffsetLeft+"px";else{var l=document.body.scrollLeft,c=l+(window.innerWidth||document.body.clientWidth),u=getAbsoluteLeft(i.obj)+t.selectPolygonOffsetLeft;u+i.polygon.offsetWidth>c&&(u=getAbsoluteLeft(i.arw)+i.arw.offsetWidth-i.polygon.offsetWidth),i.polygon.style.left=u+"px"}i.polygon.style.visibility="visible",i.polygon._ie6cover&&(i.polygon._ie6cover.style.left=i.polygon.style.left,i.polygon._ie6cover.style.top=i.polygon.style.top,i.polygon._ie6cover.style.width=i.polygon.offsetWidth+"px",i.polygon._ie6cover.style.height=i.polygon.offsetHeight+"px",i.polygon._ie6cover.style.display="")}return!1}},this.arw.onclick=function(t){t=t||event,t.cancelBubble=!0},this.arw[t._isIPad?"ontouchend":"onmouseup"]=function(t){t=t||event,t.cancelBubble=!0},this.openAll===!0&&(this.obj.onclick=this.arw.onclick,this.obj.onmousedown=this.arw.onmousedown,this.obj.onmouseup=this.arw.onmouseup,t._isIPad)&&(this.obj.ontouchstart=this.arw.ontouchstart,this.obj.ontouchend=this.arw.ontouchend),this.obj.iddPrefix=t.idPrefix,this._listOptions={},this._fixMaxOpenHeight=function(e){var n="auto",o=!1;if(null!==e){var s,a=0;for(s in this._listOptions)a++;a>e?(this._ph=22*e,n=this._ph+"px"):o=!0}this.polygon.style.width="auto",this.polygon.style.height="auto",o||null==i.maxOpen||(this.polygon.style.width=this.p_tbl.offsetWidth+t._sbw+"px",this.polygon.style.height=n)},this._separatorButtonSelectObject=function(t,e,n){return this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.className="tr_sep",this.obj.tr.onselectstart=function(t){return t=t||event,t.returnValue=!1},this.obj.td=document.createElement("TD"),this.obj.td.colSpan="2",this.obj.td.className="td_btn_sep",this.obj.td.onselectstart=function(t){return t=t||event,t.returnValue=!1},isNaN(n)?n=i.p_tbody.childNodes.length+1:1>n&&(n=1),n>i.p_tbody.childNodes.length?i.p_tbody.appendChild(this.obj.tr):i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[n-1]),this.obj.tr.appendChild(this.obj.td),this.obj.sep=document.createElement("DIV"),this.obj.sep.className="btn_sep",this.obj.sep.onselectstart=function(t){return t=t||event,t.returnValue=!1},this.obj.td.appendChild(this.obj.sep),i._listOptions[t]=this.obj,this},this._buttonButtonSelectObject=function(e,n,o){this.obj={},this.obj.tr=document.createElement("TR"),this.obj.tr.en="false"==n.enabled?!1:"true"==n.disabled?!1:!0,this.obj.tr.extAction=n.action||null,this.obj.tr._selected=null!=n.selected,this.obj.tr.className="tr_btn"+(this.obj.tr.en?this.obj.tr._selected&&i.renderSelect?" tr_btn_selected":"":" tr_btn_disabled"),this.obj.tr.onselectstart=function(t){return t=t||event,t.returnValue=!1},this.obj.tr.idd=String(e),n.userdata&&(this.obj.userData=n.userdata),isNaN(o)?o=i.p_tbody.childNodes.length+1:1>o&&(o=1),o>i.p_tbody.childNodes.length?i.p_tbody.appendChild(this.obj.tr):i.p_tbody.insertBefore(this.obj.tr,i.p_tbody.childNodes[o-1]),this.obj.td_a=document.createElement("TD"),this.obj.td_a.className="td_btn_img",this.obj.td_a.onselectstart=function(t){return t=t||event,t.returnValue=!1},this.obj.td_b=document.createElement("TD"),this.obj.td_b.className="td_btn_txt",this.obj.td_b.onselectstart=function(t){return t=t||event,t.returnValue=!1},t.rtl?(this.obj.tr.appendChild(this.obj.td_b),this.obj.tr.appendChild(this.obj.td_a)):(this.obj.tr.appendChild(this.obj.td_a),this.obj.tr.appendChild(this.obj.td_b)),null!=n.img&&(this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+t.imagePath+n.img+"' border='0'>",this.obj.tr._img=n.img);var s=null!=n.text?n.text:n.itemText||"";return this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+s+"</div>",this.obj.tr[t._isIPad?"ontouchstart":"onmouseover"]=function(){!this.en||this._selected&&i.renderSelect||(this.className="tr_btn tr_btn_over")},this.obj.tr.onmouseout=function(){this.en&&(this._selected&&i.renderSelect?-1==String(this.className).search("tr_btn_selected")&&(this.className="tr_btn tr_btn_selected"):this.className="tr_btn")},this.obj.tr[t._isIPad?"ontouchend":"onclick"]=function(e){if(e=e||event,e.cancelBubble=!0,this.en){i.setListOptionSelected(this.idd.replace(t.idPrefix,"")),i.obj.renderAs="dhx_toolbar_btn def",i.obj.className=i.obj.renderAs,i.arw.className=String(i.obj.renderAs).replace("btn","arw"),i.polygon.style.display="none",i.polygon._ie6cover&&(i.polygon._ie6cover.style.display="none"),"dhx_terrace"==t.skin&&t._improveTerraceButtonSelect(i.id,!0),t.anyUsed="none";var n=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](n)}catch(o){}t.callEvent("onClick",[n])}},i._listOptions[e]=this.obj,this},this.polygon=document.createElement("DIV"),this.polygon.dir="ltr",this.polygon.style.display="none",this.polygon.style.zIndex=101,this.polygon.className="dhx_toolbar_poly_"+t.iconSize+"_"+t.skin+(t.rtl?" rtl":""),this.polygon.onselectstart=function(t){t=t||event,t.returnValue=!1},this.polygon.onmousedown=function(t){t=t||event,t.cancelBubble=!0},this.polygon.style.overflowY="auto",t._isIPad&&(this.polygon.ontouchstart=function(t){return t=t||event,t.returnValue=!1,t.cancelBubble=!0,!1}),this.p_tbl=document.createElement("TABLE"),this.p_tbl.className="buttons_cont",this.p_tbl.cellSpacing="0",this.p_tbl.cellPadding="0",this.p_tbl.border="0",this.polygon.appendChild(this.p_tbl),this.p_tbody=document.createElement("TBODY"),this.p_tbl.appendChild(this.p_tbody),n.items)for(var o=0;o<n.items.length;o++){var s="_"+(n.items[o].type||"")+"ButtonSelectObject";"function"==typeof this[s]&&new this[s](n.items[o].id||t._genStr(24),n.items[o])}return document.body.appendChild(this.polygon),t._isIE6&&(this.polygon._ie6cover=document.createElement("IFRAME"),this.polygon._ie6cover.frameBorder=0,this.polygon._ie6cover.style.position="absolute",this.polygon._ie6cover.style.border="none",this.polygon._ie6cover.style.backgroundColor="#000000",this.polygon._ie6cover.style.filter="alpha(opacity=100)",this.polygon._ie6cover.style.display="none",this.polygon._ie6cover.setAttribute("src","javascript:false;"),document.body.appendChild(this.polygon._ie6cover)),this.setWidth=function(t){this.obj.style.width=t-this.arw.offsetWidth+"px",this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px",this.p_tbl.style.width=this.polygon.style.width},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display="",this.arw.style.display=""},this.hideItem=function(){this.obj.style.display="none",this.arw.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t,this.arw.title=t},this.getItemToolTip=function(){return this.obj.title},this.addListOption=function(t,e,n,i,o){if("button"==n||"separator"==n){var s={id:t,type:n,text:i,img:o};new this["_"+n+"ButtonSelectObject"](t,s,e)}},this.removeListOption=function(t){if(this._isListButton(t,!0)){var e=this._listOptions[t];if(null!=e.td_a&&null!=e.td_b){for(e.td_a.onselectstart=null,e.td_b.onselectstart=null;e.td_a.childNodes.length>0;)e.td_a.removeChild(e.td_a.childNodes[0]);for(;e.td_b.childNodes.length>0;)e.td_b.removeChild(e.td_b.childNodes[0]);for(e.tr.onselectstart=null,e.tr.onmouseover=null,e.tr.onmouseout=null,e.tr.onclick=null;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.td_a=null,e.td_b=null}else{for(e.sep.onselectstart=null,e.td.onselectstart=null,e.tr.onselectstart=null;e.td.childNodes.length>0;)e.td.removeChild(e.td.childNodes[0]);for(;e.tr.childNodes.length>0;)e.tr.removeChild(e.tr.childNodes[0]);e.tr.parentNode.removeChild(e.tr),e.sep=null,e.td=null}e=e.tr=null,this._listOptions[t]=null;try{delete this._listOptions[t]}catch(n){}}},this.showListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="")},this.hideListOption=function(t){this._isListButton(t,!0)&&(this._listOptions[t].tr.style.display="none")},this.isListOptionVisible=function(t){return this._isListButton(t,!0)?"none"!=this._listOptions[t].tr.style.display:void 0},this.enableListOption=function(e){this._isListButton(e)&&(this._listOptions[e].tr.en=!0,this._listOptions[e].tr.className="tr_btn"+(this._listOptions[e].tr._selected&&t.renderSelect?" tr_btn_selected":""))},this.disableListOption=function(t){this._isListButton(t)&&(this._listOptions[t].tr.en=!1,this._listOptions[t].tr.className="tr_btn tr_btn_disabled")},this.isListOptionEnabled=function(t){return this._isListButton(t)?this._listOptions[t].tr.en:void 0},this.setListOptionPosition=function(t,e){if(this._listOptions[t]&&this.getListOptionPosition(t)!=e&&!isNaN(e)){1>e&&(e=1);var n=this._listOptions[t].tr;this.p_tbody.removeChild(n),e>this.p_tbody.childNodes.length?this.p_tbody.appendChild(n):this.p_tbody.insertBefore(n,this.p_tbody.childNodes[e-1]),n=null}},this.getListOptionPosition=function(t){var e=-1;if(!this._listOptions[t])return e;for(var n=0;n<this.p_tbody.childNodes.length;n++)this.p_tbody.childNodes[n]==this._listOptions[t].tr&&(e=n+1);return e},this.setListOptionImage=function(e,n){if(this._isListButton(e)){var i=this._listOptions[e].tr.childNodes[t.rtl?1:0];if(i.childNodes.length>0)i.childNodes[0].src=t.imagePath+n;else{var o=document.createElement("IMG");o.className="btn_sel_img",o.src=t.imagePath+n,i.appendChild(o)}i=null}},this.getListOptionImage=function(e){if(this._isListButton(e)){var n=this._listOptions[e].tr.childNodes[t.rtl?1:0],i=null;return n.childNodes.length>0&&(i=n.childNodes[0].src),n=null,i}},this.clearListOptionImage=function(e){if(this._isListButton(e)){for(var n=this._listOptions[e].tr.childNodes[t.rtl?1:0];n.childNodes.length>0;)n.removeChild(n.childNodes[0]);n=null}},this.setListOptionText=function(e,n){this._isListButton(e)&&(this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML=n)},this.getListOptionText=function(e){return this._isListButton(e)?this._listOptions[e].tr.childNodes[t.rtl?0:1].childNodes[0].innerHTML:void 0},this.setListOptionToolTip=function(t,e){this._isListButton(t)&&(this._listOptions[t].tr.title=e)},this.getListOptionToolTip=function(t){return this._isListButton(t)?this._listOptions[t].tr.title:void 0},this.forEachListOption=function(t){for(var e in this._listOptions)t(e)},this.getAllListOptions=function(){var t,e=[];for(t in this._listOptions)e[e.length]=t;return e},this.setListOptionSelected=function(t){for(var e in this._listOptions){var n=this._listOptions[e];null!=n.td_a&&null!=n.td_b&&n.tr.en&&(e==t?(n.tr._selected=!0,n.tr.className="tr_btn"+(this.renderSelect?" tr_btn_selected":""),"select"==this.mode&&(n.tr._img?this.setItemImage(n.tr._img):this.clearItemImage(),this.setItemText(this.getListOptionText(t)))):(n.tr._selected=!1,n.tr.className="tr_btn")),n=null}},this.getListOptionSelected=function(){var t,e=null;for(t in this._listOptions)1==this._listOptions[t].tr._selected&&(e=t);return e},this._isListButton=function(t,e){return null==this._listOptions[t]?!1:e||"tr_sep"!=this._listOptions[t].tr.className?!0:!1},this.setMaxOpen=function(t){this._ph=null,"number"==typeof t?(this.maxOpen=t,this._maxOpenTest()):this.maxOpen=null},n.width&&this.setWidth(n.width),"select"==this.mode&&"undefined"!=typeof n.selected&&this.setListOptionSelected(n.selected),this},dhtmlXToolbarObject.prototype._buttonInputObject=function(t,e,n){this.id=t.idPrefix+e,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn def",this.obj.style.display=null!=n.hidden?"none":"",this.obj.idd=String(e),this.obj.w=null!=n.width?n.width:100,this.obj.title=null!=n.title?n.title:"",this.obj.innerHTML="<input class='inp' type='text' style='-moz-user-select:text;width:"+this.obj.w+"px;'"+(null!=n.value?" value='"+n.value+"'":"")+">";var i=t,o=this;return this.obj.childNodes[0].onkeydown=function(t){t=t||event,13==t.keyCode&&i.callEvent("onEnter",[o.obj.idd,this.value])},t.base.appendChild(this.obj),this.enableItem=function(){this.obj.childNodes[0].disabled=!1},this.disableItem=function(){this.obj.childNodes[0].disabled=!0},this.isEnabled=function(){return!this.obj.childNodes[0].disabled},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return"none"!=this.obj.style.display},this.setValue=function(t){this.obj.childNodes[0].value=t},this.getValue=function(){return this.obj.childNodes[0].value},this.setWidth=function(t){this.obj.w=t,this.obj.childNodes[0].style.width=this.obj.w+"px"},this.getWidth=function(){return this.obj.w},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this.getInput=function(){return this.obj.firstChild},this},dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null!=n.enabled?!1:!0,this.imgEn=null!=n.img?n.img:"",this.imgDis=null!=n.imgdis?n.imgdis:"",this.img=this.state?""!=this.imgEn?this.imgEn:"":""!=this.imgDis?this.imgDis:"",this.obj=document.createElement("DIV"),this.obj.pressed=null!=n.selected,this.obj.extAction=n.action||null,this.obj.className="dhx_toolbar_btn "+(this.obj.pressed?"pres"+(this.state?"":"_dis"):this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.renderAs=this.obj.className,this.obj.idd=String(e),this.obj.title=n.title||"",this.obj.pressed&&(this.obj.renderAs="dhx_toolbar_btn over"),this.obj.innerHTML=t._rtlParseBtn(""!=this.img?"<img src='"+t.imagePath+this.img+"'>":"",null!=n.text?"<div>"+n.text+"</div>":""),t.base.appendChild(this.obj);var i=this;return this.obj.onselectstart=function(t){t=t||event,t.returnValue=!1},this.obj.onmouseover=function(){this._doOnMouseOver()},this.obj.onmouseout=function(){this._doOnMouseOut()},this.obj._doOnMouseOver=function(){0!=i.state&&"none"==t.anyUsed&&(this.renderAs=this.pressed?"dhx_toolbar_btn over":this.className="dhx_toolbar_btn over")},this.obj._doOnMouseOut=function(){0!=i.state&&"none"==t.anyUsed&&(this.renderAs=this.pressed?"dhx_toolbar_btn def":this.className="dhx_toolbar_btn def")},this.obj[t._isIPad?"ontouchstart":"onmousedown"]=function(){if((!t.checkEvent("onBeforeStateChange")||t.callEvent("onBeforeStateChange",[this.idd.replace(t.idPrefix,""),this.pressed]))&&0!=i.state&&"none"==t.anyUsed){this.className=(this.pressed=!this.pressed)?"dhx_toolbar_btn pres":this.renderAs;var e=this.idd.replace(t.idPrefix,"");if(this.extAction)try{window[this.extAction](e,this.pressed)}catch(n){}return t.callEvent("onStateChange",[e,this.pressed]),!1}},this.setItemState=function(e,n){if(this.obj.pressed!=e&&(1==e?(this.obj.pressed=!0,this.obj.className="dhx_toolbar_btn pres"+(this.state?"":"_dis"),this.obj.renderAs="dhx_toolbar_btn over"):(this.obj.pressed=!1,this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis"),this.obj.renderAs=this.obj.className),1==n)){var i=this.obj.idd.replace(t.idPrefix,"");if(this.obj.extAction)try{window[this.obj.extAction](i,this.obj.pressed)}catch(o){}t.callEvent("onStateChange",[i,this.obj.pressed])}},this.getItemState=function(){return this.obj.pressed},this.enableItem=function(){t._enableItem(this)},this.disableItem=function(){t._disableItem(this)},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setItemText=function(e){t._setItemText(this,e)},this.getItemText=function(){return t._getItemText(this)},this.setItemImage=function(e){t._setItemImage(this,e,!0)},this.clearItemImage=function(){t._clearItemImage(this,!0)},this.setItemImageDis=function(e){t._setItemImage(this,e,!1)},this.clearItemImageDis=function(){t._clearItemImage(this,!1)},this.setItemToolTip=function(t){this.obj.title=t},this.getItemToolTip=function(){return this.obj.title},this},dhtmlXToolbarObject.prototype._sliderObject=function(t,e,n){this.id=t.idPrefix+e,this.state=null!=n.enabled?"true"==n.enabled?!0:!1:!0,this.obj=document.createElement("DIV"),this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis"),this.obj.style.display=null!=n.hidden?"none":"",this.obj.onselectstart=function(t){t=t||event,t.returnValue=!1},this.obj.idd=String(e),this.obj.len=null!=n.length?Number(n.length):50,this.obj.innerHTML="<div>"+(n.textMin||"")+"</div><div class='sl_bg_l'></div><div class='sl_bg_m' style='width:"+this.obj.len+"px;'></div><div class='sl_bg_r'></div><div>"+(n.textMax||"")+"</div>",t.base.appendChild(this.obj);var i=this;this.pen=document.createElement("DIV"),this.pen.className="sl_pen",this.obj.appendChild(this.pen);var o=this.pen;this.label=document.createElement("DIV"),this.label.dir="ltr",this.label.className="dhx_toolbar_slider_label_"+t.skin+(t.rtl?"_rtl":""),this.label.style.display="none",this.label.tip=n.toolTip||"%v",document.body.appendChild(this.label);var s=this.label;return this.pen.valueMin=null!=n.valueMin?Number(n.valueMin):0,this.pen.valueMax=null!=n.valueMax?Number(n.valueMax):100,this.pen.valueMin>this.pen.valueMax&&(this.pen.valueMin=this.pen.valueMax),this.pen.valueNow=null!=n.valueNow?Number(n.valueNow):this.pen.valueMax,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits=function(){this.minX=i.obj.childNodes[1].offsetLeft-4,this.maxX=i.obj.childNodes[3].offsetLeft-this.offsetWidth+1
},this.pen._detectLimits(),this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX),this.style.left=this.nowX+"px",this.newNowX=this.nowX},this.pen._definePos(),this.pen.initXY=0,this.pen.allowMove=!1,this.pen[t._isIPad?"ontouchstart":"onmousedown"]=function(e){0!=i.state&&(e=e||event,this.initXY=t._isIPad?e.touches[0].clientX:e.clientX,this.newValueNow=this.valueNow,this.allowMove=!0,this.className="sl_pen over",""!=s.tip)&&(s.style.visibility="hidden",s.style.display="",s.innerHTML=s.tip.replace("%v",this.valueNow),s.style.left=Math.round(getAbsoluteLeft(this)+this.offsetWidth/2-s.offsetWidth/2)+"px",s.style.top=getAbsoluteTop(this)-s.offsetHeight-3+"px",s.style.visibility="")},this.pen._doOnMouseMoveStart=function(e){if(e=e||event,o.allowMove){var n=t._isIPad?e.touches[0].clientX:e.clientX,i=n-o.initXY;if(!(n<getAbsoluteLeft(o)+Math.round(o.offsetWidth/2)&&o.nowX==o.minX||n>getAbsoluteLeft(o)+Math.round(o.offsetWidth/2)&&o.nowX==o.maxX))return o.newNowX=o.nowX+i,o.newNowX<o.minX&&(o.newNowX=o.minX),o.newNowX>o.maxX&&(o.newNowX=o.maxX),o.nowX=o.newNowX,o.style.left=o.nowX+"px",o.initXY=n,o.newValueNow=Math.round((o.valueMax-o.valueMin)*(o.newNowX-o.minX)/(o.maxX-o.minX)+o.valueMin),""!=s.tip&&(s.innerHTML=s.tip.replace(/%v/gi,o.newValueNow),s.style.left=Math.round(getAbsoluteLeft(o)+o.offsetWidth/2-s.offsetWidth/2)+"px",s.style.top=getAbsoluteTop(o)-s.offsetHeight-3+"px"),e.cancelBubble=!0,e.returnValue=!1}},this.pen._doOnMouseMoveEnd=function(){o.allowMove&&(o.className="sl_pen",o.allowMove=!1,o.nowX=o.newNowX,o.valueNow=o.newValueNow,""!=s.tip&&(s.style.display="none"),t.callEvent("onValueChange",[i.obj.idd.replace(t.idPrefix,""),o.valueNow]))},t._isIPad?(document.addEventListener("touchmove",o._doOnMouseMoveStart,!1),document.addEventListener("touchend",o._doOnMouseMoveEnd,!1)):"undefined"!=typeof window.addEventListener?(window.addEventListener("mousemove",o._doOnMouseMoveStart,!1),window.addEventListener("mouseup",o._doOnMouseMoveEnd,!1)):(document.body.attachEvent("onmousemove",o._doOnMouseMoveStart),document.body.attachEvent("onmouseup",o._doOnMouseMoveEnd)),this.enableItem=function(){this.state||(this.state=!0,this.obj.className="dhx_toolbar_btn def")},this.disableItem=function(){this.state&&(this.state=!1,this.obj.className="dhx_toolbar_btn dis")},this.isEnabled=function(){return this.state},this.showItem=function(){this.obj.style.display=""},this.hideItem=function(){this.obj.style.display="none"},this.isVisible=function(){return""==this.obj.style.display},this.setValue=function(e,n){e=Number(e),e<this.pen.valueMin&&(e=this.pen.valueMin),e>this.pen.valueMax&&(e=this.pen.valueMax),this.pen.valueNow=e,this.pen._definePos(),1==n&&t.callEvent("onValueChange",[this.obj.idd.replace(t.idPrefix,""),this.pen.valueNow])},this.getValue=function(){return this.pen.valueNow},this.setMinValue=function(t,e){t=Number(t),t>this.pen.valueMax||(this.obj.childNodes[0].innerHTML=e,this.obj.childNodes[0].style.display=e.length>0?"":"none",this.pen.valueMin=t,this.pen.valueNow<this.pen.valueMin&&(this.pen.valueNow=this.pen.valueMin),this.pen._detectLimits(),this.pen._definePos())},this.setMaxValue=function(t,e){t=Number(t),t<this.pen.valueMin||(this.obj.childNodes[4].innerHTML=e,this.obj.childNodes[4].style.display=e.length>0?"":"none",this.pen.valueMax=t,this.pen.valueNow>this.pen.valueMax&&(this.pen.valueNow=this.pen.valueMax),this.pen._detectLimits(),this.pen._definePos())},this.getMinValue=function(){var t=this.obj.childNodes[0].innerHTML,e=this.pen.valueMin;return[e,t]},this.getMaxValue=function(){var t=this.obj.childNodes[4].innerHTML,e=this.pen.valueMax;return[e,t]},this.setItemToolTipTemplate=function(t){this.label.tip=t},this.getItemToolTipTemplate=function(){return this.label.tip},this},dhtmlXToolbarObject.prototype.unload=function(){for(this._isIPad?document.removeEventListener("touchstart",this._doOnClick,!1):"function"==typeof window.addEventListener?window.removeEventListener("mousedown",this._doOnClick,!1):document.body.detachEvent("onmousedown",this._doOnClick),this._doOnClick=null,this.clearAll(),this.objPull=null,this._xmlLoader&&(this._xmlLoader.destructor(),this._xmlLoader=null);this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);for(this.cont.removeChild(this.base),this.base=null;this.cont.childNodes.length>0;)this.cont.removeChild(this.cont.childNodes[0]);this.cont.className="",this.cont=null,this.detachAllEvents(),this.items=this.setMaxOpen=this.getUserData=this.setUserData=this.unload=this.getListOptionSelected=this.setListOptionSelected=this.getAllListOptions=this.forEachListOption=this.clearListOptionImage=this.getListOptionImage=this.setListOptionImage=this.getListOptionToolTip=this.setListOptionToolTip=this.getListOptionText=this.setListOptionText=this.getListOptionPosition=this.setListOptionPosition=this.isListOptionEnabled=this.disableListOption=this.enableListOption=this.isListOptionVisible=this.hideListOption=this.showListOption=this.removeListOption=this.addListOption=this.removeItem=this.setPosition=this.getPosition=this.getWidth=this.setWidth=this.getMaxValue=this.setMaxValue=this.getMinValue=this.setMinValue=this.getValue=this.setValue=this.getItemToolTipTemplate=this.setItemToolTipTemplate=this.getItemState=this.setItemState=this.clearItemImageDis=this.clearItemImage=this.setItemImageDis=this.setItemImage=this.getItemToolTip=this.setItemToolTip=this.getItemText=this.setItemText=this.isEnabled=this.disableItem=this.enableItem=this.isVisible=this.hideItem=this.showItem=this.forEachItem=this.addInput=this.addSlider=this.addSeparator=this.addButtonTwoState=this.addButtonSelect=this.addText=this.addButton=this.getParentId=this.inArray=this.getTypeExt=this.getType=this.removeSpacer=this.addSpacer=this.clearAll=this.detachAllEvents=this.detachEvent=this.eventCatcher=this.checkEvent=this.callEvent=this.attachEvent=this.loadXMLString=this.loadXML=this.setIconPath=this.setIconsPath=this.setSkin=this.setAlign=this._removeItem=this._autoDetectVisibleArea=this._sliderObject=this._buttonTwoStateObject=this._buttonInputObject=this._buttonSelectObject=this._buttonObject=this._textObject=this._separatorObject=this._getIdByPosition=this._setPosition=this._getPosition=this._addItem=this._genStr=this._addItemToStorage=this._doOnLoad=this._xmlParser=this._disableItem=this._enableItem=this._getItemText=this._setItemText=this._clearItemImage=this._setItemImage=this._addImgObj=this._getObj=this._sbw=this.setRTL=this._rtlParseBtn=this._rtl=this.skin=this.selectPolygonOffsetTop=this.selectPolygonOffsetLeft=this.rootTypes=this.imagePath=this.idPrefix=this.anyUsed=this.align=this._isWebToolbar=this._isIE6=this.tY2=this.tY1=this.tX2=this.tX1=null},dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){this.tX1=document.body.scrollLeft,this.tX2=this.tX1+(window.innerWidth||document.body.clientWidth),this.tY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),this.tY2=this.tY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)},dhtmlXToolbarObject.prototype.setUserData=function(t,e,n){if(null!=this.objPull[this.idPrefix+t]){var i=this.objPull[this.idPrefix+t];null==i.userData&&(i.userData={}),i.userData[e]=n}},dhtmlXToolbarObject.prototype.getUserData=function(t,e){return null==this.objPull[this.idPrefix+t]?null:null==this.objPull[this.idPrefix+t].userData?null:null==this.objPull[this.idPrefix+t].userData[e]?null:this.objPull[this.idPrefix+t].userData[e]},dhtmlXToolbarObject.prototype._isListOptionExists=function(t,e){if(null==this.objPull[this.idPrefix+t])return!1;var n=this.objPull[this.idPrefix+t];return"buttonSelect"!=n.type?!1:null==n._listOptions[e]?!1:!0},dhtmlXToolbarObject.prototype.setListOptionUserData=function(t,e,n,i){if(this._isListOptionExists(t,e)){var o=this.objPull[this.idPrefix+t]._listOptions[e];null==o.userData&&(o.userData={}),o.userData[n]=i}},dhtmlXToolbarObject.prototype.getListOptionUserData=function(t,e,n){if(!this._isListOptionExists(t,e))return null;var i=this.objPull[this.idPrefix+t]._listOptions[e];return i.userData&&i.userData[n]?i.userData[n]:null},function(){dhtmlx.extend_api("dhtmlXToolbarObject",{_init:function(t){return[t.parent,t.skin]},icon_path:"setIconsPath",xml:"loadXML",items:"items",align:"setAlign",rtl:"setRTL",skin:"setSkin"},{items:function(t){for(var e=0;e<t.length;e++){var n=t[e];"button"==n.type&&this.addButton(n.id,null,n.text,n.img,n.img_disabled),"separator"==n.type&&this.addSeparator(n.id,null),"text"==n.type&&this.addText(n.id,null,n.text),"buttonSelect"==n.type&&this.addButtonSelect(n.id,null,n.text,n.options,n.img,n.img_disabled,n.renderSelect,n.openAll,n.maxOpen),"buttonTwoState"==n.type&&this.addButtonTwoState(n.id,null,n.text,n.img,n.img_disabled),"buttonInput"==n.type&&this.addInput(n.id,null,n.text),"slider"==n.type&&this.addSlider(n.id,null,n.length,n.value_min,n.value_max,n.value_now,n.text_min,n.text_max,n.tip_template),n.width&&this.setWidth(n.id,n.width),n.disabled&&this.disableItem(n.id),n.tooltip&&this.setItemToolTip(n.id,n.tooltip),n.pressed===!0&&this.setItemState(n.id,!0)}}})}(),define("dhtmlxtoolbar",["dhtmlxcommon"],function(t){return function(){var e;return e||t.dhtmlXToolbarObject}}(this)),define("fptool",[],function(){"use strict";function t(t,e){return window.File&&window.FileReader&&window.FileList&&window.Blob?(fe=!1,Y=e,G=t,N=$(t.target_div),X=t.original_kml,W="Untitled Image Overlay",p(),f(),g(G),D(),void k()):void alert("The File APIs are not fully supported in this browser. This page will most likely not work as expected in your browswer.")}function e(t,e,n){var i=($(K.getDiv()).offset(),new google.maps.Point($(K.getDiv()).width()/2,$(K.getDiv()).height()/2)),o=K.getBounds(),s=R.getProjection().fromContainerPixelToLatLng(i);o.contains(s)&&m(s,t,e,n)}function n(){C(!1),S(!1),null!=N&&N.empty(),$(".dhx_toolbar_poly_18_dhx_web").remove(),$(".dhx_toolbar_slider_label_dhx_web").remove(),N=null,E=null,O=null,A=null,P=null,R=null,F=null,z=null,V=null,B=null,H=null,W=null,q=null,U=null,X=null,G=null,J=null,Y=null}function i(){return y(),B}function o(){return K}function s(t){if(null==O)return void $("#internal_rc").css("pointer-events","none");var e,n=t.pageX-N.offset().left,i=t.pageY-N.offset().top,o=L(n,i,A,O);for(e=0;2>e;e++)he[e]&&(o=o||L(n,i,he[e],pe[e]));$("#internal_rc").css("pointer-events",o?"auto":"none")}function a(t,e){(-1!=e.indexOf("drag end")||-1!=e.indexOf("scale end")||-1!=e.indexOf("rotate end")||-1!=e.indexOf("init"))&&(b(),Y&&"init"!=e[0]&&Y(),I())}function r(t){"zoomin"==t&&(K.setZoom(K.getZoom()+1),w()),"zoomout"==t&&(K.setZoom(K.getZoom()-1),w()),("satellite"==t||"map"==t)&&T(t),"shapes"==t&&T(t),"clear"==t&&C(!0)&&S(!1),"frame"==t&&C(!0)&&(S(!1),null==z&&(z=K.getCenter()),m(z,le,200,200),O.setOpts({rotate:!1}))}function l(){var t,e,n,i,o,s,a,r,l,c,u,d,h,p;he[0]&&he[1]&&(p=pe[0],t=p.attrs.center.x+p.attrs.translate.x,e=p.attrs.center.y+p.attrs.translate.y+p.attrs.size.y*p.attrs.scale.y/2,p=pe[1],n=p.attrs.center.x+p.attrs.translate.x,i=p.attrs.center.y+p.attrs.translate.y+p.attrs.size.y*p.attrs.scale.y/2,o=n-t,s=i-e,r=Math.atan2(s,o),a=180*r/Math.PI,Q&&Q.remove(),Q=E.path(sprintf("M%d,%dL%d,%d",Math.round(t),Math.round(e),Math.round(n),Math.round(i))),l=R.getProjection().fromContainerPixelToLatLng(new google.maps.Point(t,e)),c=R.getProjection().fromContainerPixelToLatLng(new google.maps.Point(n,i)),u=google.maps.geometry.spherical.computeDistanceBetween(l,c),Z&&Z.remove(),te&&te.remove(),d=sprintf("%.1f m",u),(a>=90||-90>=a)&&(a-=180),Z=E.text(10*Math.sin(r)+(t+n)/2,10*Math.cos(r)+(e+i)/2,d).attr("font-weight","bold"),h=Z.getBBox(),te=E.rect(h.x,h.y,h.width,h.height).attr("stroke","none").glow({width:20,color:Raphael.getRGB("white"),fill:!0}),he[0].toFront(),he[1].toFront(),Z=Z.rotate(a),te=te.rotate(a),Z.toFront())}function c(t){ee=t}function u(){return ee}function d(t,e){$.injectCSS({"#internal_mc":{position:"absolute",width:t,height:e},"#internal_rc":{position:"absolute",width:t,height:e,events:"none"},"#internal_tb":{position:"absolute",margin_left:30,margin_top:13,opacity:"0.9",width:t-60},"#internal_tb_poly":{position:"absolute",margin_left:30,margin_top:13,opacity:"0.9",width:t-60},"#control_shelf":{position:"absolute",left:t+30,top:20,width:200,height:200,font_family:"Verdana",font_size:14},".thumb":{height:100,border:"2px solid #FFFF00",margin:"5px 0px 5px 0px"},"#image_file":{margin_top:5,margin_bottom:5},"#internal_db":{position:"absolute",left:t+30,top:220,font_size:12,font_family:"Verdana"}})}function h(){clearTimeout(window.resizeEvt),window.resizeEvt=setTimeout(function(){var t=N.width(),e=N.height();d(t,e);var n=K.getCenter();google.maps.event.trigger(K,"resize"),K.setCenter(n),E.setViewBox(0,0,t,e),E.setSize(t,e)},250)}function p(){$(window).bind("resize sidebar:toggle map:fullscreen",h),$(".sidebar-scroll").mouseleave(h);var t=N.width(),e=N.height();d(t,e),N.append("<div id='internal_mc'></div>"),N.append("<svg id='internal_rc'></svg>"),N.append("<div id='internal_tb''></div>"),N.append("<div id='internal_tb_poly''></div>"),fe&&N.append("<div id='internal_db''></div>"),E=Raphael("internal_rc",N.find("#internal_rc").width(),N.find("#internal_rc").height()),N.mousemove(s)}function f(){var t={center:G.map_center||new google.maps.LatLng(0,0),zoom:G.map_zoom||2,disableDefaultUI:!0,mapTypeId:google.maps.MapTypeId.SATELLITE};K=new google.maps.Map(document.getElementById("internal_mc"),t),K.setTilt(0),V=K.getZoom(),R=new google.maps.OverlayView,R.draw=function(){},R.setMap(K),google.maps.event.addListener(K,"idle",function(){null!=X&&void 0!=R.getProjection()?(v(X),X=null):b()}),google.maps.event.addListener(K,"zoom_changed",function(){w(),l(null,null)}),google.maps.event.addListener(K,"center_changed",function(){_()})}function g(){var t;P=new dhtmlXToolbarObject("internal_tb"),P.setIconsPath(ne),P.setSkin(ie),t=[["satellite","obj","Satellite","checked.png"],["map","obj","Map","blank.png"]],P.addButtonSelect("options",0,"View",t,"blank.png","blank.png"),P.addSeparator("sep1",1),P.setListOptionSelected("options","satellite"),P.addButton("zoomin",2,"Zoom In","zoom_in.png","zoom_in.png"),P.addButton("zoomout",3,"Zoom Out","zoom_out.png","zoom_out.png"),P.addSeparator("sep2",4),P.addSlider("opacity",5,70,0,100,70,"Opacity","%",""),P.addButtonTwoState("aspect_ratio",6,"Aspect Ratio","blank.png","blank.png"),P.setItemState("aspect_ratio",!0),P.addButtonTwoState("ruler",7,"Ruler",null,null),P.attachEvent("onStateChange",function(t,e){"aspect_ratio"==t?null!=O&&O.setOpts({keepRatio:P.getItemState(t)}):"ruler"==t&&M(e)}),P.attachEvent("onValueChange",function(t,e){"opacity"==t&&null!=A&&A.attr("opacity",e/100)}),P.attachEvent("onClick",r),N.find("#internal_tb").show()}function m(t,e,n,i){var o,s=0;null!=O?(A.remove(),O.unplug(),A=E.image(e,F.x-O.attrs.size.x*O.attrs.scale.x/2,F.y-O.attrs.size.y*O.attrs.scale.y/2,O.attrs.size.x*O.attrs.scale.x,O.attrs.size.y*O.attrs.scale.y),s=O.attrs.rotate):(F=R.getProjection().fromLatLngToContainerPixel(t),A=E.image(e,F.x-n/2,F.y-i/2,n,i)),A.attr("opacity",ae),P.setValue("opacity",100*ae),o=ce,o.keepRatio=P.getItemState("aspect_ratio"),O=E.freeTransform(A,o,a),O.attrs.rotate=s,O.apply(),O.showHandles()}function v(t){"undefined"!=typeof t&&($.support.cors=!0,$.ajax({url:t,beforeSend:function(){},crossDomain:!0,type:"GET",success:function(t){if(null!=t){var e=$(t).find("GroundOverlay");if(null!=e){var n=$(e).find("name").text(),i=$(e).find("Icon").find("href").text(),o=$(e).find("LatLonBox");if(null!=o){C(!1),S(!1);var s=$(o).find("north").text(),r=$(o).find("south").text(),l=$(o).find("east").text(),c=$(o).find("west").text(),u=$(o).find("rotation").text();H={n:s,s:r,e:l,w:c,r:u},W=n,q=i,U=null;var d=new google.maps.LatLng(r,c),h=new google.maps.LatLng(s,l),p=new google.maps.LatLngBounds(d,h);K.fitBounds(p);var f=R.getProjection().fromLatLngToContainerPixel(d),g=R.getProjection().fromLatLngToContainerPixel(h),m=Math.abs(g.x-f.x),v=Math.abs(g.y-f.y);J=new google.maps.GroundOverlay(i,p),z=p.getCenter(),K.setCenter(z),F=R.getProjection().fromLatLngToContainerPixel(z),A=E.image(i,F.x-m/2,F.y-v/2,m,v),A.attr("opacity",.7),P.setValue("opacity",70);var b=ce;b.keepRatio=P.getItemState("aspect_ratio"),O=E.freeTransform(A,b,a),O.attrs.rotate=-u,O.apply()}}}},error:function(t){alert("Error: "+t.responseText)}}))}function b(){null!=O&&void 0!=R.getProjection()&&(F=new google.maps.Point(O.attrs.center.x+O.attrs.translate.x,O.attrs.center.y+O.attrs.translate.y),z=R.getProjection().fromContainerPixelToLatLng(F))}function y(){var t=-O.attrs.rotate%360,e=F.x-O.attrs.size.x/2*O.attrs.scale.x,n=F.x+O.attrs.size.x/2*O.attrs.scale.x,i=F.y-O.attrs.size.y/2*O.attrs.scale.y,o=F.y+O.attrs.size.y/2*O.attrs.scale.y,s=R.getProjection().fromContainerPixelToLatLng(new google.maps.Point(e,i)),a=R.getProjection().fromContainerPixelToLatLng(new google.maps.Point(n,o)),r=Math.round(1e6*s.lat())/1e6,l=Math.round(1e6*s.lng())/1e6,c=Math.round(1e6*a.lat())/1e6,u=Math.round(1e6*a.lng())/1e6,d=Math.round(1e6*z.lat())/1e6,h=Math.round(1e6*z.lng())/1e6;fe&&$("#internal_db").html("<strong>Center</strong><br/>"+d+" "+h+"<br/><br/><strong>BBox</strong><br/>N "+r+"<br/>W "+l+"<br/>S "+c+"<br/>E "+u+"<br/><br/><strong>Rotation</strong><br/>"+t),B=re.replace("%name%",W).replace("%href%",null==q?"":q).replace("%north%",r).replace("%west%",l).replace("%south%",c).replace("%east%",u).replace("%rotation%",t),H={n:r,w:l,s:c,e:u,r:t}}function w(){if(null==O)return void(V=K.getZoom());var t=K.getZoom(),e=Math.pow(2,Math.abs(t-V));V>t?(O.attrs.scale.x/=e,O.attrs.scale.y/=e):(O.attrs.scale.x*=e,O.attrs.scale.y*=e),V=t,x(),b()}function _(){null!=O&&(x(),b())}function x(){if(null!=O&&void 0!=R.getProjection()){var t=R.getProjection().fromLatLngToContainerPixel(z);O.attrs.translate.x+=t.x-F.x,O.attrs.translate.y+=t.y-F.y,O.apply()}}function C(t){return t&&null!=O&&!confirm("Do you really want to remove this floor plan and all it's shapes from the map?")?!1:(null!=O&&(O.unplug(),A.remove(),A=null,O=null,fe&&N.find("#internal_db").html(""),B=null,H=null,q=null,U=null),!0)}function S(){null!=J&&(J.setMap(null),J=null)}function T(t){var e=P.getAllListOptions("options");e.forEach(function(t){P.setListOptionImage("options",t,"blank.png")}),P.setListOptionSelected("options",t);var n={satellite:google.maps.MapTypeId.SATELLITE,map:google.maps.MapTypeId.ROADMAP,shapes:"shapes"};K.setMapTypeId(n[t])}function D(){Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){null==e?e=0:0>e&&(e=Math.max(0,this.length+e));for(var n=e,i=this.length;i>n;n++)if(this[n]===t)return n;return-1})}function k(){}function I(){var t,e,n,i,o;for($("#internal_rc").css("cursor","hand"),O.handles.x.disc[0].style.cursor="url(img/rotate_cursor.cur), pointer",O.handles.y.disc[0].style.cursor="url(img/rotate_cursor.cur), pointer",o=Math.round(O.attrs.rotate/45),t=0;t<O.handles.bbox.length;t++)n=O.handles.bbox[t],e=n.x.toString()+","+n.y.toString(),i=se.indexOf(e),-1!=i&&(i-=o,0>i&&(i+=i),n.element[0].style.cursor=oe[i%8])}function M(t){var e;for(e=0;2>e;e++)he[e]&&(pe[e].unplug(),he[e].remove(),he[e]=null);if(Z&&Z.remove(),te&&te.remove(),Q&&Q.remove(),t)for(e=0;2>e;e++)he[e]=E.image("../../img/marker_ruler.png",0,0,21,34).toFront(),pe[e]=E.freeTransform(he[e],de,l),pe[e].attrs.scale={x:ue,y:ue},pe[e].attrs.translate={x:(1+2*e)*E.width/4,y:E.height/2},pe[e].apply(),pe[e].showHandles()}function L(t,e,n,i){var o=i.attrs.size.x/2+10,s=i.attrs.size.y/2+10;return j(t,e,n.matrix.x(i.attrs.center.x-o,i.attrs.center.y-s),n.matrix.y(i.attrs.center.x-o,i.attrs.center.y-s),n.matrix.x(i.attrs.center.x+o,i.attrs.center.y-s),n.matrix.y(i.attrs.center.x+o,i.attrs.center.y-s),n.matrix.x(i.attrs.center.x-o,i.attrs.center.y+s),n.matrix.y(i.attrs.center.x-o,i.attrs.center.y+s))}function j(t,e,n,i,o,s,a,r){var l=o-n,c=s-i,u=a-n,d=r-i;return 0>(t-n)*l+(e-i)*c?!1:(t-o)*l+(e-s)*c>0?!1:0>(t-n)*u+(e-i)*d?!1:(t-a)*u+(e-r)*d>0?!1:!0}var N,E,O,A,P,R,F,z,V,B,H,W,q,U,X,G,J,Y,K,Q,Z,te,ee,ne="js/vendor/dhtmlxToolbar/common/imgs/",ie="dhx_web",oe=["e-resize","ne-resize","n-resize","nw-resize","w-resize","sw-resize","s-resize","se-resize"],se=["1,0","1,-1","0,-1","-1,-1","-1,0","-1,1","0,1","1,1"],ae=.7,re='<?xml version="1.0" encoding="UTF-8"?>\n<kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="http://www.google.com/kml/ext/2.2" xmlns:kml="http://www.opengis.net/kml/2.2" xmlns:atom="http://www.w3.org/2005/Atom">\n   <GroundOverlay>\n        <name>%name%</name>\n        <Icon>\n            <href>%href%</href>\n            <viewBoundScale>0.75</viewBoundScale>\n        </Icon>\n        <LatLonBox>\n            <north>%north%</north>\n            <south>%south%</south>\n            <east>%east%</east>\n            <west>%west%</west>\n            <rotation>%rotation%</rotation>\n        </LatLonBox>\n   </GroundOverlay>\n</kml>\n',le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAEJGlDQ1BJQ0MgUHJvZmlsZQAAOBGFVd9v21QUPolvUqQWPyBYR4eKxa9VU1u5GxqtxgZJk6XtShal6dgqJOQ6N4mpGwfb6baqT3uBNwb8AUDZAw9IPCENBmJ72fbAtElThyqqSUh76MQPISbtBVXhu3ZiJ1PEXPX6yznfOec7517bRD1fabWaGVWIlquunc8klZOnFpSeTYrSs9RLA9Sr6U4tkcvNEi7BFffO6+EdigjL7ZHu/k72I796i9zRiSJPwG4VHX0Z+AxRzNRrtksUvwf7+Gm3BtzzHPDTNgQCqwKXfZwSeNHHJz1OIT8JjtAq6xWtCLwGPLzYZi+3YV8DGMiT4VVuG7oiZpGzrZJhcs/hL49xtzH/Dy6bdfTsXYNY+5yluWO4D4neK/ZUvok/17X0HPBLsF+vuUlhfwX4j/rSfAJ4H1H0qZJ9dN7nR19frRTeBt4Fe9FwpwtN+2p1MXscGLHR9SXrmMgjONd1ZxKzpBeA71b4tNhj6JGoyFNp4GHgwUp9qplfmnFW5oTdy7NamcwCI49kv6fN5IAHgD+0rbyoBc3SOjczohbyS1drbq6pQdqumllRC/0ymTtej8gpbbuVwpQfyw66dqEZyxZKxtHpJn+tZnpnEdrYBbueF9qQn93S7HQGGHnYP7w6L+YGHNtd1FJitqPAR+hERCNOFi1i1alKO6RQnjKUxL1GNjwlMsiEhcPLYTEiT9ISbN15OY/jx4SMshe9LaJRpTvHr3C/ybFYP1PZAfwfYrPsMBtnE6SwN9ib7AhLwTrBDgUKcm06FSrTfSj187xPdVQWOk5Q8vxAfSiIUc7Z7xr6zY/+hpqwSyv0I0/QMTRb7RMgBxNodTfSPqdraz/sDjzKBrv4zu2+a2t0/HHzjd2Lbcc2sG7GtsL42K+xLfxtUgI7YHqKlqHK8HbCCXgjHT1cAdMlDetv4FnQ2lLasaOl6vmB0CMmwT/IPszSueHQqv6i/qluqF+oF9TfO2qEGTumJH0qfSv9KH0nfS/9TIp0Wboi/SRdlb6RLgU5u++9nyXYe69fYRPdil1o1WufNSdTTsp75BfllPy8/LI8G7AUuV8ek6fkvfDsCfbNDP0dvRh0CrNqTbV7LfEEGDQPJQadBtfGVMWEq3QWWdufk6ZSNsjG2PQjp3ZcnOWWing6noonSInvi0/Ex+IzAreevPhe+CawpgP1/pMTMDo64G0sTCXIM+KdOnFWRfQKdJvQzV1+Bt8OokmrdtY2yhVX2a+qrykJfMq4Ml3VR4cVzTQVz+UoNne4vcKLoyS+gyKO6EHe+75Fdt0Mbe5bRIf/wjvrVmhbqBN97RD1vxrahvBOfOYzoosH9bq94uejSOQGkVM6sN/7HelL4t10t9F4gPdVzydEOx83Gv+uNxo7XyL/FtFl8z9ZAHF4bBsrEwAAAB1JREFUGBljZGBgkAJigoCJoAqoglGFeEOK6OABADraAC49qSG+AAAAAElFTkSuQmCC",ce={draw:["bbox"],size:6,attrs:{fill:"yellow"},distance:.7,scale:["bboxCorners","bboxSides"],drag:["center","self"]},ue=1.5,de={draw:[],drag:["self"],rotate:!1,scale:!1},he=[],pe=[],fe=!1;return{init:t,deinit:n,insertImage:e,getFloorplanKml:i,getGoogleMap:o,setInitialFloorplanPosition:c,getInitialFloorplanPosition:u}}),function(t){"use strict";"function"==typeof define&&define.amd?define("jquery-form",["jquery"],t):t("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(t){"use strict";function e(e){var n=e.data;e.isDefaultPrevented()||(e.preventDefault(),t(e.target).ajaxSubmit(n))}function n(e){var n=e.target,i=t(n);if(!i.is("[type=submit],[type=image]")){var o=i.closest("[type=submit]");if(0===o.length)return;n=o[0]}var s=this;if(s.clk=n,"image"==n.type)if(void 0!==e.offsetX)s.clk_x=e.offsetX,s.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var a=i.offset();s.clk_x=e.pageX-a.left,s.clk_y=e.pageY-a.top}else s.clk_x=e.pageX-n.offsetLeft,s.clk_y=e.pageY-n.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)}function i(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var o={};o.fileapi=void 0!==t("<input type='file'/>").get(0).files,o.formdata=void 0!==window.FormData;var s=!!t.fn.prop;t.fn.attr2=function(){if(!s)return this.attr.apply(this,arguments);var t=this.prop.apply(this,arguments);return t&&t.jquery||"string"==typeof t?t:this.attr.apply(this,arguments)},t.fn.ajaxSubmit=function(e){function n(n){var i,o,s=t.param(n,e.traditional).split("&"),a=s.length,r=[];for(i=0;a>i;i++)s[i]=s[i].replace(/\+/g," "),o=s[i].split("="),r.push([decodeURIComponent(o[0]),decodeURIComponent(o[1])]);return r}function a(i){for(var o=new FormData,s=0;s<i.length;s++)o.append(i[s].name,i[s].value);if(e.extraData){var a=n(e.extraData);for(s=0;s<a.length;s++)a[s]&&o.append(a[s][0],a[s][1])}e.data=null;var r=t.extend(!0,{},t.ajaxSettings,e,{contentType:!1,processData:!1,cache:!1,type:l||"POST"});e.uploadProgress&&(r.xhr=function(){var n=t.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(t){var n=0,i=t.loaded||t.position,o=t.total;t.lengthComputable&&(n=Math.ceil(i/o*100)),e.uploadProgress(t,i,o,n)},!1),n}),r.data=null;var c=r.beforeSend;return r.beforeSend=function(t,n){n.data=e.formData?e.formData:o,c&&c.call(this,t,n)},t.ajax(r)}function r(n){function o(t){var e=null;try{t.contentWindow&&(e=t.contentWindow.document)}catch(n){i("cannot get iframe.contentWindow document: "+n)}if(e)return e;try{e=t.contentDocument?t.contentDocument:t.document}catch(n){i("cannot get iframe.contentDocument: "+n),e=t.document}return e}function a(){function e(){try{var t=o(v).readyState;i("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(n){i("Server abort: ",n," (",n.name,")"),r(D),x&&clearTimeout(x),x=void 0}}var n=d.attr2("target"),s=d.attr2("action"),a="multipart/form-data",c=d.attr("enctype")||d.attr("encoding")||a;C.setAttribute("target",f),(!l||/post/i.test(l))&&C.setAttribute("method","POST"),s!=h.url&&C.setAttribute("action",h.url),h.skipEncodingOverride||l&&!/post/i.test(l)||d.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),h.timeout&&(x=setTimeout(function(){_=!0,r(T)},h.timeout));var u=[];try{if(h.extraData)for(var p in h.extraData)h.extraData.hasOwnProperty(p)&&u.push(t.isPlainObject(h.extraData[p])&&h.extraData[p].hasOwnProperty("name")&&h.extraData[p].hasOwnProperty("value")?t('<input type="hidden" name="'+h.extraData[p].name+'">').val(h.extraData[p].value).appendTo(C)[0]:t('<input type="hidden" name="'+p+'">').val(h.extraData[p]).appendTo(C)[0]);h.iframeTarget||m.appendTo("body"),v.attachEvent?v.attachEvent("onload",r):v.addEventListener("load",r,!1),setTimeout(e,15);try{C.submit()}catch(g){var b=document.createElement("form").submit;b.apply(C)}}finally{C.setAttribute("action",s),C.setAttribute("enctype",c),n?C.setAttribute("target",n):d.removeAttr("target"),t(u).remove()}}function r(e){if(!b.aborted&&!j){if(L=o(v),L||(i("cannot access response document"),e=D),e===T&&b)return b.abort("timeout"),void S.reject(b,"timeout");if(e==D&&b)return b.abort("server abort"),void S.reject(b,"error","server abort");if(L&&L.location.href!=h.iframeSrc||_){v.detachEvent?v.detachEvent("onload",r):v.removeEventListener("load",r,!1);var n,s="success";try{if(_)throw"timeout";var a="xml"==h.dataType||L.XMLDocument||t.isXMLDoc(L);if(i("isXml="+a),!a&&window.opera&&(null===L.body||!L.body.innerHTML)&&--N)return i("requeing onLoad callback, DOM not available"),void setTimeout(r,250);var l=L.body?L.body:L.documentElement;b.responseText=l?l.innerHTML:null,b.responseXML=L.XMLDocument?L.XMLDocument:L,a&&(h.dataType="xml"),b.getResponseHeader=function(t){var e={"content-type":h.dataType};return e[t.toLowerCase()]},l&&(b.status=Number(l.getAttribute("status"))||b.status,b.statusText=l.getAttribute("statusText")||b.statusText);var c=(h.dataType||"").toLowerCase(),u=/(json|script|text)/.test(c);if(u||h.textarea){var d=L.getElementsByTagName("textarea")[0];if(d)b.responseText=d.value,b.status=Number(d.getAttribute("status"))||b.status,b.statusText=d.getAttribute("statusText")||b.statusText;else if(u){var f=L.getElementsByTagName("pre")[0],g=L.getElementsByTagName("body")[0];f?b.responseText=f.textContent?f.textContent:f.innerText:g&&(b.responseText=g.textContent?g.textContent:g.innerText)}}else"xml"==c&&!b.responseXML&&b.responseText&&(b.responseXML=E(b.responseText));try{M=A(b,c,h)}catch(y){s="parsererror",b.error=n=y||s}}catch(y){i("error caught: ",y),s="error",b.error=n=y||s}b.aborted&&(i("upload aborted"),s=null),b.status&&(s=b.status>=200&&b.status<300||304===b.status?"success":"error"),"success"===s?(h.success&&h.success.call(h.context,M,"success",b),S.resolve(b.responseText,"success",b),p&&t.event.trigger("ajaxSuccess",[b,h])):s&&(void 0===n&&(n=b.statusText),h.error&&h.error.call(h.context,b,s,n),S.reject(b,"error",n),p&&t.event.trigger("ajaxError",[b,h,n])),p&&t.event.trigger("ajaxComplete",[b,h]),p&&!--t.active&&t.event.trigger("ajaxStop"),h.complete&&h.complete.call(h.context,b,s),j=!0,h.timeout&&clearTimeout(x),setTimeout(function(){h.iframeTarget?m.attr("src",h.iframeSrc):m.remove(),b.responseXML=null},100)}}}var c,u,h,p,f,m,v,b,y,w,_,x,C=d[0],S=t.Deferred();if(S.abort=function(t){b.abort(t)},n)for(u=0;u<g.length;u++)c=t(g[u]),s?c.prop("disabled",!1):c.removeAttr("disabled");if(h=t.extend(!0,{},t.ajaxSettings,e),h.context=h.context||h,f="jqFormIO"+(new Date).getTime(),h.iframeTarget?(m=t(h.iframeTarget),w=m.attr2("name"),w?f=w:m.attr2("name",f)):(m=t('<iframe name="'+f+'" src="'+h.iframeSrc+'" />'),m.css({position:"absolute",top:"-1000px",left:"-1000px"})),v=m[0],b={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var n="timeout"===e?"timeout":"aborted";i("aborting upload... "+n),this.aborted=1;try{v.contentWindow.document.execCommand&&v.contentWindow.document.execCommand("Stop")}catch(o){}m.attr("src",h.iframeSrc),b.error=n,h.error&&h.error.call(h.context,b,n,e),p&&t.event.trigger("ajaxError",[b,h,n]),h.complete&&h.complete.call(h.context,b,n)}},p=h.global,p&&0===t.active++&&t.event.trigger("ajaxStart"),p&&t.event.trigger("ajaxSend",[b,h]),h.beforeSend&&h.beforeSend.call(h.context,b,h)===!1)return h.global&&t.active--,S.reject(),S;if(b.aborted)return S.reject(),S;y=C.clk,y&&(w=y.name,w&&!y.disabled&&(h.extraData=h.extraData||{},h.extraData[w]=y.value,"image"==y.type&&(h.extraData[w+".x"]=C.clk_x,h.extraData[w+".y"]=C.clk_y)));var T=1,D=2,k=t("meta[name=csrf-token]").attr("content"),I=t("meta[name=csrf-param]").attr("content");I&&k&&(h.extraData=h.extraData||{},h.extraData[I]=k),h.forceSync?a():setTimeout(a,10);var M,L,j,N=50,E=t.parseXML||function(t,e){return window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},O=t.parseJSON||function(t){return window.eval("("+t+")")},A=function(e,n,i){var o=e.getResponseHeader("content-type")||"",s="xml"===n||!n&&o.indexOf("xml")>=0,a=s?e.responseXML:e.responseText;return s&&"parsererror"===a.documentElement.nodeName&&t.error&&t.error("parsererror"),i&&i.dataFilter&&(a=i.dataFilter(a,n)),"string"==typeof a&&("json"===n||!n&&o.indexOf("json")>=0?a=O(a):("script"===n||!n&&o.indexOf("javascript")>=0)&&t.globalEval(a)),a};return S}if(!this.length)return i("ajaxSubmit: skipping submit process - no element selected"),this;var l,c,u,d=this;"function"==typeof e?e={success:e}:void 0===e&&(e={}),l=e.type||this.attr2("method"),c=e.url||this.attr2("action"),u="string"==typeof c?t.trim(c):"",u=u||window.location.href||"",u&&(u=(u.match(/^([^#]+)/)||[])[1]),e=t.extend(!0,{url:u,success:t.ajaxSettings.success,type:l||t.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var h={};if(this.trigger("form-pre-serialize",[this,e,h]),h.veto)return i("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&e.beforeSerialize(this,e)===!1)return i("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var p=e.traditional;
void 0===p&&(p=t.ajaxSettings.traditional);var f,g=[],m=this.formToArray(e.semantic,g);if(e.data&&(e.extraData=e.data,f=t.param(e.data,p)),e.beforeSubmit&&e.beforeSubmit(m,this,e)===!1)return i("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[m,this,e,h]),h.veto)return i("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var v=t.param(m,p);f&&(v=v?v+"&"+f:f),"GET"==e.type.toUpperCase()?(e.url+=(e.url.indexOf("?")>=0?"&":"?")+v,e.data=null):e.data=v;var b=[];if(e.resetForm&&b.push(function(){d.resetForm()}),e.clearForm&&b.push(function(){d.clearForm(e.includeHidden)}),!e.dataType&&e.target){var y=e.success||function(){};b.push(function(n){var i=e.replaceTarget?"replaceWith":"html";t(e.target)[i](n).each(y,arguments)})}else e.success&&b.push(e.success);if(e.success=function(t,n,i){for(var o=e.context||this,s=0,a=b.length;a>s;s++)b[s].apply(o,[t,n,i||d,d])},e.error){var w=e.error;e.error=function(t,n,i){var o=e.context||this;w.apply(o,[t,n,i,d])}}if(e.complete){var _=e.complete;e.complete=function(t,n){var i=e.context||this;_.apply(i,[t,n,d])}}var x=t("input[type=file]:enabled",this).filter(function(){return""!==t(this).val()}),C=x.length>0,S="multipart/form-data",T=d.attr("enctype")==S||d.attr("encoding")==S,D=o.fileapi&&o.formdata;i("fileAPI :"+D);var k,I=(C||T)&&!D;e.iframe!==!1&&(e.iframe||I)?e.closeKeepAlive?t.get(e.closeKeepAlive,function(){k=r(m)}):k=r(m):k=(C||T)&&D?a(m):t.ajax(e),d.removeData("jqxhr").data("jqxhr",k);for(var M=0;M<g.length;M++)g[M]=null;return this.trigger("form-submit-notify",[this,e]),this},t.fn.ajaxForm=function(o){if(o=o||{},o.delegation=o.delegation&&t.isFunction(t.fn.on),!o.delegation&&0===this.length){var s={s:this.selector,c:this.context};return!t.isReady&&s.s?(i("DOM not ready, queuing ajaxForm"),t(function(){t(s.s,s.c).ajaxForm(o)}),this):(i("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return o.delegation?(t(document).off("submit.form-plugin",this.selector,e).off("click.form-plugin",this.selector,n).on("submit.form-plugin",this.selector,o,e).on("click.form-plugin",this.selector,o,n),this):this.ajaxFormUnbind().bind("submit.form-plugin",o,e).bind("click.form-plugin",o,n)},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(e,n){var i=[];if(0===this.length)return i;var s,a=this[0],r=this.attr("id"),l=e?a.getElementsByTagName("*"):a.elements;if(l&&!/MSIE [678]/.test(navigator.userAgent)&&(l=t(l).get()),r&&(s=t(':input[form="'+r+'"]').get(),s.length&&(l=(l||[]).concat(s))),!l||!l.length)return i;var c,u,d,h,p,f,g;for(c=0,f=l.length;f>c;c++)if(p=l[c],d=p.name,d&&!p.disabled)if(e&&a.clk&&"image"==p.type)a.clk==p&&(i.push({name:d,value:t(p).val(),type:p.type}),i.push({name:d+".x",value:a.clk_x},{name:d+".y",value:a.clk_y}));else if(h=t.fieldValue(p,!0),h&&h.constructor==Array)for(n&&n.push(p),u=0,g=h.length;g>u;u++)i.push({name:d,value:h[u]});else if(o.fileapi&&"file"==p.type){n&&n.push(p);var m=p.files;if(m.length)for(u=0;u<m.length;u++)i.push({name:d,value:m[u],type:p.type});else i.push({name:d,value:"",type:p.type})}else null!==h&&"undefined"!=typeof h&&(n&&n.push(p),i.push({name:d,value:h,type:p.type,required:p.required}));if(!e&&a.clk){var v=t(a.clk),b=v[0];d=b.name,d&&!b.disabled&&"image"==b.type&&(i.push({name:d,value:v.val()}),i.push({name:d+".x",value:a.clk_x},{name:d+".y",value:a.clk_y}))}return i},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var n=[];return this.each(function(){var i=this.name;if(i){var o=t.fieldValue(this,e);if(o&&o.constructor==Array)for(var s=0,a=o.length;a>s;s++)n.push({name:i,value:o[s]});else null!==o&&"undefined"!=typeof o&&n.push({name:this.name,value:o})}}),t.param(n)},t.fn.fieldValue=function(e){for(var n=[],i=0,o=this.length;o>i;i++){var s=this[i],a=t.fieldValue(s,e);null===a||"undefined"==typeof a||a.constructor==Array&&!a.length||(a.constructor==Array?t.merge(n,a):n.push(a))}return n},t.fieldValue=function(e,n){var i=e.name,o=e.type,s=e.tagName.toLowerCase();if(void 0===n&&(n=!0),n&&(!i||e.disabled||"reset"==o||"button"==o||("checkbox"==o||"radio"==o)&&!e.checked||("submit"==o||"image"==o)&&e.form&&e.form.clk!=e||"select"==s&&-1==e.selectedIndex))return null;if("select"==s){var a=e.selectedIndex;if(0>a)return null;for(var r=[],l=e.options,c="select-one"==o,u=c?a+1:l.length,d=c?a:0;u>d;d++){var h=l[d];if(h.selected){var p=h.value;if(p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value),c)return p;r.push(p)}}return r}return t(e).val()},t.fn.clearForm=function(e){return this.each(function(){t("input,select,textarea",this).clearFields(e)})},t.fn.clearFields=t.fn.clearInputs=function(e){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,o=this.tagName.toLowerCase();n.test(i)||"textarea"==o?this.value="":"checkbox"==i||"radio"==i?this.checked=!1:"select"==o?this.selectedIndex=-1:"file"==i?/MSIE/.test(navigator.userAgent)?t(this).replaceWith(t(this).clone(!0)):t(this).val(""):e&&(e===!0&&/hidden/.test(i)||"string"==typeof e&&t(this).is(e))&&(this.value="")})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var n=this.type;if("checkbox"==n||"radio"==n)this.checked=e;else if("option"==this.tagName.toLowerCase()){var i=t(this).parent("select");e&&i[0]&&"select-one"==i[0].type&&i.find("option").selected(!1),this.selected=e}})},t.fn.ajaxSubmit.debug=!1}),define("general/floorplans/floorplan_views",["app","common/server","common/common_views","common/entities","text!general/floorplans/floorplan_templates.html","bootbox","util","fptool","jquery-form"],function(t,e,n,i,o,s,a,r){"use strict";function l(t){t.stopPropagation();var e,n=t.target.files[0];return n?!c(n.name,u)||n.size>d?(e="<p>Supported image files are: <strong>"+u.join(", ")+"</strong></p>",e+="<p>Max image file size is <strong>1MB</strong></p>",s.dialog({message:e,title:"Invalid Image",buttons:{main:{label:"Dismiss",className:"btn-primary",callback:function(){}}}}),null):n:null}function c(t,e){var n,i;return t&&""!=t?(n=t.split(".").pop().toLowerCase(),i=n&&-1!=e.indexOf(n)):!1}var u=["gif","png","jpg","jpeg"],d=1048576,h="Uploading:",p="Processing...",f=null,g=[];return t.module("General.Floorplans",function(t,i,m,v,b,y){t.MainView=v.LayoutView.extend({template:y.template(b(o).filter("#main_view_template").html()),regions:{floorplanTable:"#floorplan_table",editSection:"#edit_section"},ui:{table_section:"#table_section",edit_section:"#edit_section",new_floorplan_image:"#new_floorplan_image",new_floorplan_kml:"#new_floorplan_kml"},triggers:{"click @ui.new_floorplan_kml":"floorplan:new:kml","click @ui.new_floorplan_image":"floorplan:new:image"},onShow:function(){this.ui.edit_section.hide()},configureFor:function(e,n){var i=this;return f&&(f.destroy(),f=null),"list"===e?(this.ui.table_section.show(),this.ui.edit_section.hide()):(f=new t.EditView({type:e,model:n}),this.editSection.show(f),"new"===e?(this.ui.table_section.show(),this.ui.edit_section.hide(),f.on("image:new",function(){i.ui.table_section.hide(),i.ui.edit_section.show()}),f.openNewImage()):(this.ui.table_section.hide(),this.ui.edit_section.show())),f},setLevels:function(t){g=t}}),t.FloorplanTableView=n.DatatableView.extend({template:y.template(b(o).filter("#floorplan_table_template").html()),columns:[n.DatatableView.getColumn("id","fpId"),n.DatatableView.getColumn("name"),n.DatatableView.getColumn("desc"),n.DatatableView.getColumn("id","levelId"),n.DatatableView.getButtonColumn("fpId",["show","edit","delete"])],datatableParams:{iDisplayLength:5}}),t.EditView=v.ItemView.extend({template:y.template(b(o).filter("#show_edit_template").html()),_imageFileEvent:null,behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}},ui:{gmap:".gmap",replace_image:"#replace_image",save_button:"#save",discard_button:"#discard",close_preview:"#close_edit",imagefile:"#upload_form input:file",form:"#upload_form",progress:"#progress",button_row:"#button_row"},triggers:{"click @ui.close_preview":"close","click @ui.discard_button":"close","click @ui.save_button":"save"},events:{"click @ui.replace_image":function(){this._imageFileEvent="image:replace",this.ui.imagefile.trigger("click")},"change select":function(){this.enableSaveDiscardButtons(!0),this.trigger("metadata:changed")},"keypress input":function(){this.enableSaveDiscardButtons(!0),this.trigger("metadata:changed")},"change @ui.imagefile":function(t){var e=l(t);null==e&&this.ui.imagefile.val(""),"image:new"===this._imageFileEvent?this.trigger("image:new",e):"image:replace"===this._imageFileEvent&&this.trigger("image:replaced",e)}},initialize:function(){this.options.type&&(this.type=this.options.type)},onShow:function(){if(this._setupAjaxForm(),this.enableSaveDiscardButtons(!1),this.$el.find("h4").html("edit"===this.options.type||"show"===this.options.type?sprintf("%s floor plan <strong>%s</strong>",this.options.type.toUpperCase(),this.model.id):"New Floor Plan"),this.ui.form.find("select").html(a.getLevelsAsHtmlOptions(g,!0)),("edit"===this.options.type||"show"===this.options.type)&&(this.ui.form.find('input[name="fp_id"]').val(this.model.id),this.ui.form.find('input[name="name"]').val(this.model.get("name")),this.ui.form.find('input[name="desc"]').val(this.model.get("desc")),this.ui.form.find('input[name="levelId"]').val(this.model.get("levelId"))),"show"===this.type){var t=this.ui.form.find("input");y.each(t,function(t){"hidden"!==b(t).attr("type")&&b(t).replaceWith(b("<p>").addClass("form-control-static").text(b(t).val()))}),this.ui.form.find("select").replaceWith(b("<p>").addClass("form-control-static").text(this.ui.form.find('select option[value="'+this.model.get("levelId")+'"]').text())),this.ui.button_row.hide()}},enableSaveDiscardButtons:function(t){this.ui.save_button.attr("disabled",!t),this.ui.discard_button.attr("disabled",!t)},openNewImage:function(){var t,n,i,o=0,a=0,l=e.getSiteLatLng(),c=this;l&&l.lat&&(o=l.lat()),l&&l.lng&&(a=l.lng()),t='<div class="row">',t+='<div class="col-md-12">',t+='<div class="form-group">',t+='<label class="col-md-4 control-label" for="address">Where do you want to place your floor plan?</label>',t+='<div class="col-md-4"> <div class="radio"> <label for="site-address">',t+='<input type="radio" name="address" id="site-address" checked="checked">',t+="Default Site Address",t+=0!=o&&0!=a?" ("+o.toFixed(7)+","+a.toFixed(7)+") </label>":"",t+='</div><div class="radio"> <label for="custom-address">',t+='<input type="radio" name="address" id="custom-address"> Custom address </label> ',t+='<input class="autocomplete" id="autocomplete" type="text" placeholder="Address">',t+="</div>",t+="</div> </div>",t+="</form> </div> </div>",b("body").on("focus","#autocomplete",function(){b("#custom-address").attr("checked",!0)}),b("body").on("blur","#autocomplete",function(){if(!n){var t,e=b(this).val();if(!e)return void s.alert("Please insert a valid address");t=new google.maps.Geocoder,t.geocode({address:e},function(t,e){return e!=google.maps.GeocoderStatus.OK?void s.alert("Please insert a valid address"):(n=t[0].geometry.location,void log.debug(n))})}}),s.dialog({message:t,title:"Floor plan position",onEscape:function(){c.trigger("floorplan:image:cancel")},buttons:{danger:{label:"Cancel",callback:function(){c.trigger("floorplan:image:cancel")}},success:{label:"Next: Select Image",className:"btn btn-success",callback:function(){if(b("#custom-address").is(":checked")){if(!n)return void s.alert("Please insert a valid address");r.setInitialFloorplanPosition(n)}else r.setInitialFloorplanPosition(l);c._imageFileEvent="image:new",c.ui.imagefile.trigger("click")}}}}),i=new google.maps.places.SearchBox(document.getElementById("autocomplete")),google.maps.event.addListener(i,"places_changed",function(){var t=i.getPlaces();return 0==t.length?void s.alert("Please insert a valid address"):void(n=t[0].geometry.location)})},getGmapDivElement:function(){return y.first(this.ui.gmap.get())},_setupAjaxForm:function(){var t=this;this.ui.form.ajaxForm({success:function(e){t.ui.progress.find("p").addClass("text-success").html('<i class="fa fa-check"></i> Success'),t.trigger("upload:success",e)},error:function(){t.ui.progress.find("p").addClass("text-error").html('<i class="fa fa-times"></i> Error'),i.vent.trigger("error:show")},uploadProgress:function(e,n,i,o){t.ui.progress.show(),t.ui.progress.find("p").html(100>o?h+" "+o+"%":'<i class="fa fa-spinner fa-spin"></i> '+p+"</p>")}}),t.ui.progress.hide()}}),t.UploadKmlDialog=n.EditDialogView.extend({template:y.template(b(o).filter("#kml-dialog-template").html()),type:"new",validationParams:{rules:{kml:{required:!0},image:{required:!0}}},onShow:function(){var t=this;n.EditDialogView.prototype.onShow.apply(this,[]),this.ui.form=this.$el.find("form"),this.ui.progress=this.$el.find("#progress"),this._setupAjaxForm(),this.$el.find("select").html(a.getLevelsAsHtmlOptions(this.renderParams.levels,!0)),this.on("submit",function(){var n="",i=t.$el.find('input[name="image"]')[0].files[0];return c(i.name,u)||(n+="Unsupported image format."),i.size>d&&(n+="Image size ("+i.size+" bytes) exceeds limit"),n.length>0?void t.$validator.showErrors({image:n}):(t.ui.form.find('input[name="username"]').val(e.getUsername()),t.ui.form.find('input[name="password"]').val(e.getPassword()),t.ui.form.attr("action",e.getResourceUrl("/floorplans/")),void t.ui.form.submit())})},_setupAjaxForm:function(){var t=this;this.ui.form.ajaxForm({success:function(e){t.ui.progress.find("p").addClass("text-success").html('<i class="fa fa-check"></i> Success'),t.triggerMethod("submit:success",e)},error:function(){t.ui.progress.find("p").addClass("text-error").html('<i class="fa fa-times"></i> Error'),t.trigger("submit:error"),setTimeout(function(){i.vent.trigger("error:show")},100)},uploadProgress:function(e,n,i,o){t.ui.progress.show(),t.ui.progress.find("p").html(100>o?h+" "+o+"%":'<i class="fa fa-spinner fa-spin"></i> '+p+"</p>")}}),t.ui.progress.hide()}}),t.DeleteDialog=n.EditDialogView.extend({template:y.template(b(o).filter("#delete-dialog-template").html()),type:"delete"})})}),define("general/floorplans/floorplans_controller",["app","common/server","common/entities","common/common_views","general/floorplans/floorplan_views","bootbox","fptool","syphon"],function(t,e,n,i,o,s,a){"use strict";function r(t){b(),L=t,k=T.configureFor("show",t),k.on("close",v),y=new google.maps.Map(k.getGmapDivElement(),{}),$(window).bind("map:fullscreen",function(){google.maps.event.trigger(y,"resize")}),w=new google.maps.KmlLayer({map:y,url:t.get("kmlAligned"),clickable:!1,preserveViewport:!1,suppressInfoWindows:!0})}function l(t){b(),L=t,k=T.configureFor("edit",t),k.on("close",v),k.on("save",h),k.on("upload:success",f),k.on("metadata:changed",function(){j=!0}),k.on("image:replaced",m),a.deinit();var e={target_div:k.getGmapDivElement(),original_kml:L.get("kml")};a.init(e,function(){j=!0,E=!0,k.enableSaveDiscardButtons(!0)})}function c(t){var e,n;return null==t?void u():(j=N=E=!0,k.enableSaveDiscardButtons(!0),k.on("close",v),k.on("save",h),k.on("upload:success",f),k.on("image:replaced",m),e=new FileReader,e.onload=function(t){n=t.target.result;var e=new Image;e.src=n,e.onload=function(){log.debug(sprintf("new image dimensions:  %d x %d pixels",this.width,this.height)),d(n,this.width,this.height)}},void e.readAsDataURL(t))}function u(){a.deinit(),b(),T.configureFor("list")}function d(t,e,n){var i,o,s={target_div:k.getGmapDivElement(),map_center:new google.maps.LatLng(0,0),map_zoom:2,metadata_editing:!1},r=a.getInitialFloorplanPosition();a.deinit(),r&&(s.map_center=r,s.map_zoom=18),a.init(s,function(){}),e>n?(i=x,o=Math.round(i*n/e)):(o=x,i=Math.round(o*e/n)),setTimeout(function(){a.insertImage(t,i,o)},500)}function h(){return j&&null!=L?E||N?(k.ui.form.find('input[name="fp_id"]').val(L.id),k.ui.form.find('input[name="username"]').val(e.getUsername()),k.ui.form.find('input[name="password"]').val(e.getPassword()),k.ui.form.find('input[name="kml_content"]').val(a.getFloorplanKml()),k.ui.form.attr("action",e.getResourceUrl("/floorplans/")),void k.ui.form.submit()):void p():void s.alert("nothing to save")}function p(){L.set({name:k.ui.form.find('input[name="name"]').val(),desc:k.ui.form.find('input[name="desc"]').val(),levelId:k.ui.form.find('select[name="levelId"]').val()}),L.save().success(function(){f(L.toJSON())}).error(function(){t.vent.trigger("error:show")})}function f(t){L&&L.id&&C.remove(L.id),b(),L=new n.FloorplanModel(t),C.add(L),k&&k.enableSaveDiscardButtons(!1)}function g(){s.confirm(_,function(t){t&&(a.deinit(),b(),T.configureFor("list"))})}function m(t){var e,n;t&&0!=t.name.length&&(j=!0,N=!0,E=!0,k.enableSaveDiscardButtons(!0),e=new FileReader,e.onload=function(t){n=t.target.result,a.insertImage(n)},e.readAsDataURL(t))}function v(){j?g():T.configureFor("list")}function b(){I=null,M=null,L=null,j=!1,N=!1,E=!1,O=!1}var y,w,_="Discard changes?",x=250,C=null,S=null,T=null,D=null,k=null,I=null,M=null,L=null,j=!1,N=!1,E=!1,O=!1;return i.EditController.extend({DialogViewClass:o.DeleteDialog,initialize:function(){log.info("General Floor plan Controller initialized")},show:function(){var e=this;C=new n.FloorplanCollection,S=new n.LevelCollection,T=new o.MainView({}),D=new o.FloorplanTableView({collection:C}),S.on("reset",function(){T.setLevels(this.toJSON())}),T.on("show",function(){k=T.configureFor("list"),T.floorplanTable.show(D),D.on("show",r),D.on("edit",l),D.on("delete",function(t){e._deleteFloorplan(t)}),T.on("floorplan:new:image",function(){b(),L=new n.FloorplanModel,k=T.configureFor("new",L),k.on("image:new",c)}),T.on("floorplan:new:kml",function(){log.debug("new"),e._onUploadKml()}),C.fetch({reset:!0}),S.fetch({reset:!0})}),t.main.show(T)},_onUploadKml:function(){var e=new o.UploadKmlDialog({model:new n.FloorplanModel,renderParams:{levels:S.toJSON()}});e.on("submit:success",function(t){f(t)}),t.modal.show(e)},_deleteFloorplan:function(t){var e=t.clone();e.set({kml:""}),this.openDeleteDialog(e,{renderParams:{levels:S.toJSON()}},function(t){C.remove(t.id)})}})}),define("text!general/map/map_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="map_template">\n\n    <div class="block full">\n        <div class="block-title">\n            <h4><strong>Accuware</strong> Abstract Map </h4>\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n            </div>\n        </div>\n\n        <p>\n            <span id="nodes">0 nodes</span> -&nbsp; <span id="stations">0 known devices</span>\n        </p>\n\n        <div class="block block-gmap">\n            <div class="gmap">\n                <!-- Google map goes here -->\n            </div>\n        </div>\n\n        <div class="row">\n            <div class="col-lg-12">\n                <button class="openImageFromCamera">Open camera tool</button>\n                <button class="dumpMarkers">Dump markers</button>\n            </div>\n            <div class="col-lg-12">\n                Display\n                <div class="btn-group btn-group-xs">\n                    <button id="showNodes"              class="js-toolbar btn btn-alt btn-primary">Nodes</button>\n                    <button id="showNodeLabels"         class="js-toolbar btn btn-alt btn-primary">Node Labels</button>\n                </div>\n                &nbsp;&nbsp;Stations\n                <div class="btn-group btn-group-xs">\n                    <button id="showSelectedStations"   class="js-toolbar btn btn-alt btn-primary">Selected</button>\n                    <button id="showKnownStations"      class="js-toolbar btn btn-alt btn-primary">All Known</button>\n                    <button id="showAllStations"        class="js-toolbar btn btn-alt btn-primary">All Devices</button>\n                    <button id="showStationLabels"      class="js-toolbar btn btn-alt btn-primary">Station Labels</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n'}),function(t){"function"==typeof define&&define.amd?define("jquery-ui",["jquery"],t):t(jQuery)}(function(t){function e(e,i){var o,s,a,r=e.nodeName.toLowerCase();return"area"===r?(o=e.parentNode,s=o.name,e.href&&s&&"map"===o.nodeName.toLowerCase()?(a=t("img[usemap='#"+s+"']")[0],!!a&&n(a)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!e.disabled:"a"===r?e.href||i:i)&&n(e)}function n(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var n=this.css("position"),i="absolute"===n,o=e?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var e=t(this);return i&&"static"===e.css("position")?!1:o.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==n&&s.length?s:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(n){return!!t.data(n,e)}}):function(e,n,i){return!!t.data(e,i[3])},focusable:function(n){return e(n,!isNaN(t.attr(n,"tabindex")))},tabbable:function(n){var i=t.attr(n,"tabindex"),o=isNaN(i);return(o||i>=0)&&e(n,!o)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,n){function i(e,n,i,s){return t.each(o,function(){n-=parseFloat(t.css(e,"padding"+this))||0,i&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(n-=parseFloat(t.css(e,"margin"+this))||0)}),n}var o="Width"===n?["Left","Right"]:["Top","Bottom"],s=n.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(e){return void 0===e?a["inner"+n].call(this):this.each(function(){t(this).css(s,i(this,e)+"px")})},t.fn["outer"+n]=function(e,o){return"number"!=typeof e?a["outer"+n].call(this,e):this.each(function(){t(this).css(s,i(this,e,!0,o)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(n){return arguments.length?e.call(this,t.camelCase(n)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(n,i){return"number"==typeof n?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),i&&i.call(e)},n)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var n,i,o=t(this[0]);o.length&&o[0]!==document;){if(n=o.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(i=parseInt(o.css("zIndex"),10),!isNaN(i)&&0!==i))return i;o=o.parent()}return 0}}),t.ui.plugin={add:function(e,n,i){var o,s=t.ui[e].prototype;for(o in i)s.plugins[o]=s.plugins[o]||[],s.plugins[o].push([n,i[o]])},call:function(t,e,n,i){var o,s=t.plugins[e];if(s&&(i||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(o=0;s.length>o;o++)t.options[s[o][0]]&&s[o][1].apply(t.element,n)}};var i=0,o=Array.prototype.slice;t.cleanData=function(e){return function(n){var i,o,s;for(s=0;null!=(o=n[s]);s++)try{i=t._data(o,"events"),i&&i.remove&&t(o).triggerHandler("remove")}catch(a){}e(n)}}(t.cleanData),t.widget=function(e,n,i){var o,s,a,r,l={},c=e.split(".")[0];return e=e.split(".")[1],o=c+"-"+e,i||(i=n,n=t.Widget),t.expr[":"][o.toLowerCase()]=function(e){return!!t.data(e,o)},t[c]=t[c]||{},s=t[c][e],a=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,s,{version:i.version,_proto:t.extend({},i),_childConstructors:[]}),r=new n,r.options=t.widget.extend({},r.options),t.each(i,function(e,i){return t.isFunction(i)?void(l[e]=function(){var t=function(){return n.prototype[e].apply(this,arguments)},o=function(t){return n.prototype[e].apply(this,t)};return function(){var e,n=this._super,s=this._superApply;return this._super=t,this._superApply=o,e=i.apply(this,arguments),this._super=n,this._superApply=s,e}}()):void(l[e]=i)}),a.prototype=t.widget.extend(r,{widgetEventPrefix:s?r.widgetEventPrefix||e:e},l,{constructor:a,namespace:c,widgetName:e,widgetFullName:o}),s?(t.each(s._childConstructors,function(e,n){var i=n.prototype;t.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete s._childConstructors):n._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var n,i,s=o.call(arguments,1),a=0,r=s.length;r>a;a++)for(n in s[a])i=s[a][n],s[a].hasOwnProperty(n)&&void 0!==i&&(e[n]=t.isPlainObject(i)?t.isPlainObject(e[n])?t.widget.extend({},e[n],i):t.widget.extend({},i):i);return e},t.widget.bridge=function(e,n){var i=n.prototype.widgetFullName||e;t.fn[e]=function(s){var a="string"==typeof s,r=o.call(arguments,1),l=this;return a?this.each(function(){var n,o=t.data(this,i);return"instance"===s?(l=o,!1):o?t.isFunction(o[s])&&"_"!==s.charAt(0)?(n=o[s].apply(o,r),n!==o&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+s+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+s+"'")}):(r.length&&(s=t.widget.extend.apply(null,[s].concat(r))),this.each(function(){var e=t.data(this,i);e?(e.option(s||{}),e._init&&e._init()):t.data(this,i,new n(s,this))})),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,n){var i,o,s,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},i=e.split("."),e=i.shift(),i.length){for(o=a[e]=t.widget.extend({},this.options[e]),s=0;i.length-1>s;s++)o[i[s]]=o[i[s]]||{},o=o[i[s]];if(e=i.pop(),1===arguments.length)return void 0===o[e]?null:o[e];o[e]=n}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,n,i){var o,s=this;"boolean"!=typeof e&&(i=n,n=e,e=!1),i?(n=o=t(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),t.each(i,function(i,a){function r(){return e||s.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?s[a]:a).apply(s,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+s.eventNamespace,u=l[2];u?o.delegate(u,c,r):n.bind(c,r)})},_off:function(e,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(n).undelegate(n),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function n(){return("string"==typeof t?i[t]:t).apply(i,arguments)}var i=this;return setTimeout(n,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,n,i){var o,s,a=this.options[e];if(i=i||{},n=t.Event(n),n.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(o in s)o in n||(n[o]=s[o]);return this.element.trigger(n,i),!(t.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,n){t.Widget.prototype["_"+e]=function(i,o,s){"string"==typeof o&&(o={effect:o});var a,r=o?o===!0||"number"==typeof o?n:o.effect||n:e;o=o||{},"number"==typeof o&&(o={duration:o}),a=!t.isEmptyObject(o),o.complete=s,o.delay&&i.delay(o.delay),a&&t.effects&&t.effects.effect[r]?i[e](o):r!==e&&i[r]?i[r](o.duration,o.easing,s):i.queue(function(n){t(this)[e](),s&&s.call(i[0]),n()})}}),t.widget;var s=!1;t(document).mouseup(function(){s=!1}),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(n){return!0===t.data(n.target,e.widgetName+".preventClickEvent")?(t.removeData(n.target,e.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!s){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var n=this,i=1===e.which,o="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return i&&!o&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)
},this._mouseUpDelegate=function(t){return n._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),s=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),s=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.widget("ui.draggable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var n=this.options;return this._blurActiveElement(e),this.helper||n.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blockFrames(n.iframeFix===!0?"iframe":n.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var n=this.document[0];if(this.handleElement.is(e.target))try{n.activeElement&&"body"!==n.activeElement.nodeName.toLowerCase()&&t(n.activeElement).blur()}catch(i){}},_mouseStart:function(e){var n=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,n){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",e,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var n=this,i=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(i=t.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",e)!==!1&&n._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var n=this.options,i=t.isFunction(n.helper),o=i?t(n.helper.apply(this.element[0],[e])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return o.parents("body").length||o.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i&&o[0]===this.element[0]&&this._setPositionRelative(),o[0]===this.element[0]||/(fixed|absolute)/.test(o.css("position"))||o.css("position","absolute"),o},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,i,o=this.options,s=this.document[0];return this.relativeContainer=null,o.containment?"window"===o.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,t(s).width()-this.helperProportions.width-this.margins.left,(t(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),n=t(o.containment),i=n[0],void(i&&(e=/(scroll|auto)/.test(n.css("overflow")),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=n))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var n="absolute"===t?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:e.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(t,e){var n,i,o,s,a=this.options,r=this._isRootNode(this.scrollParent[0]),l=t.pageX,c=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(i=this.relativeContainer.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),a.grid&&(o=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=n?o-this.offset.click.top>=n[1]||o-this.offset.click.top>n[3]?o:o-this.offset.click.top>=n[1]?o-a.grid[1]:o+a.grid[1]:o,s=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-a.grid[0]:s+a.grid[0]:s),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,n,i){return i=i||this._uiHash(),t.ui.plugin.call(this,e,[n,i,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,n,i){var o=t.extend({},n,{item:i.element});i.sortables=[],t(i.options.connectToSortable).each(function(){var n=t(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push(n),n.refreshPositions(),n._trigger("activate",e,o))})},stop:function(e,n,i){var o=t.extend({},n,{item:i.element});i.cancelHelperRemoval=!1,t.each(i.sortables,function(){var t=this;t.isOver?(t.isOver=0,i.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,o))})},drag:function(e,n,i){t.each(i.sortables,function(){var o=!1,s=this;s.positionAbs=i.positionAbs,s.helperProportions=i.helperProportions,s.offset.click=i.offset.click,s._intersectsWith(s.containerCache)&&(o=!0,t.each(i.sortables,function(){return this.positionAbs=i.positionAbs,this.helperProportions=i.helperProportions,this.offset.click=i.offset.click,this!==s&&this._intersectsWith(this.containerCache)&&t.contains(s.element[0],this.element[0])&&(o=!1),o})),o?(s.isOver||(s.isOver=1,i._parent=n.helper.parent(),s.currentItem=n.helper.appendTo(s.element).data("ui-sortable-item",!0),s.options._helper=s.options.helper,s.options.helper=function(){return n.helper[0]},e.target=s.currentItem[0],s._mouseCapture(e,!0),s._mouseStart(e,!0,!0),s.offset.click.top=i.offset.click.top,s.offset.click.left=i.offset.click.left,s.offset.parent.left-=i.offset.parent.left-s.offset.parent.left,s.offset.parent.top-=i.offset.parent.top-s.offset.parent.top,i._trigger("toSortable",e),i.dropped=s.element,t.each(i.sortables,function(){this.refreshPositions()}),i.currentItem=i.element,s.fromOutside=i),s.currentItem&&(s._mouseDrag(e),n.position=s.position)):s.isOver&&(s.isOver=0,s.cancelHelperRemoval=!0,s.options._revert=s.options.revert,s.options.revert=!1,s._trigger("out",e,s._uiHash(s)),s._mouseStop(e,!0),s.options.revert=s.options._revert,s.options.helper=s.options._helper,s.placeholder&&s.placeholder.remove(),n.helper.appendTo(i._parent),i._refreshOffsets(e),n.position=i._generatePosition(e,!0),i._trigger("fromSortable",e),i.dropped=!1,t.each(i.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,n,i){var o=t("body"),s=i.options;o.css("cursor")&&(s._cursor=o.css("cursor")),o.css("cursor",s.cursor)},stop:function(e,n,i){var o=i.options;o._cursor&&t("body").css("cursor",o._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,n,i){var o=t(n.helper),s=i.options;o.css("opacity")&&(s._opacity=o.css("opacity")),o.css("opacity",s.opacity)},stop:function(e,n,i){var o=i.options;o._opacity&&t(n.helper).css("opacity",o._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(e,n,i){var o=i.options,s=!1,a=i.scrollParentNotHidden[0],r=i.document[0];a!==r&&"HTML"!==a.tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+a.offsetHeight-e.pageY<o.scrollSensitivity?a.scrollTop=s=a.scrollTop+o.scrollSpeed:e.pageY-i.overflowOffset.top<o.scrollSensitivity&&(a.scrollTop=s=a.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+a.offsetWidth-e.pageX<o.scrollSensitivity?a.scrollLeft=s=a.scrollLeft+o.scrollSpeed:e.pageX-i.overflowOffset.left<o.scrollSensitivity&&(a.scrollLeft=s=a.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(e.pageY-t(r).scrollTop()<o.scrollSensitivity?s=t(r).scrollTop(t(r).scrollTop()-o.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<o.scrollSensitivity&&(s=t(r).scrollTop(t(r).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(e.pageX-t(r).scrollLeft()<o.scrollSensitivity?s=t(r).scrollLeft(t(r).scrollLeft()-o.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<o.scrollSensitivity&&(s=t(r).scrollLeft(t(r).scrollLeft()+o.scrollSpeed)))),s!==!1&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,n,i){var o=i.options;i.snapElements=[],t(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var e=t(this),n=e.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:n.top,left:n.left})})},drag:function(e,n,i){var o,s,a,r,l,c,u,d,h,p,f=i.options,g=f.snapTolerance,m=n.offset.left,v=m+i.helperProportions.width,b=n.offset.top,y=b+i.helperProportions.height;for(h=i.snapElements.length-1;h>=0;h--)l=i.snapElements[h].left-i.margins.left,c=l+i.snapElements[h].width,u=i.snapElements[h].top-i.margins.top,d=u+i.snapElements[h].height,l-g>v||m>c+g||u-g>y||b>d+g||!t.contains(i.snapElements[h].item.ownerDocument,i.snapElements[h].item)?(i.snapElements[h].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,e,t.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(o=g>=Math.abs(u-y),s=g>=Math.abs(d-b),a=g>=Math.abs(l-v),r=g>=Math.abs(c-m),o&&(n.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top),s&&(n.position.top=i._convertPositionTo("relative",{top:d,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),r&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c}).left)),p=o||s||a||r,"outer"!==f.snapMode&&(o=g>=Math.abs(u-b),s=g>=Math.abs(d-y),a=g>=Math.abs(l-m),r=g>=Math.abs(c-v),o&&(n.position.top=i._convertPositionTo("relative",{top:u,left:0}).top),s&&(n.position.top=i._convertPositionTo("relative",{top:d-i.helperProportions.height,left:0}).top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),r&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left)),!i.snapElements[h].snapping&&(o||s||a||r||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,e,t.extend(i._uiHash(),{snapItem:i.snapElements[h].item})),i.snapElements[h].snapping=o||s||a||r||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,n,i){var o,s=i.options,a=t.makeArray(t(s.stack)).sort(function(e,n){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(n).css("zIndex"),10)||0)});a.length&&(o=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each(function(e){t(this).css("zIndex",o+e)}),this.css("zIndex",o+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,n,i){var o=t(n.helper),s=i.options;o.css("zIndex")&&(s._zIndex=o.css("zIndex")),o.css("zIndex",s.zIndex)},stop:function(e,n,i){var o=i.options;o._zIndex&&t(n.helper).css("zIndex",o._zIndex)}}),t.ui.draggable,t.widget("ui.resizable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(e,n){if("hidden"===t(e).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",o=!1;return e[i]>0?!0:(e[i]=1,o=e[i]>0,e[i]=0,o)},_create:function(){var e,n,i,o,s,a=this,r=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},n=0;e.length>n;n++)i=t.trim(e[n]),s="ui-resizable-"+i,o=t("<div class='ui-resizable-handle "+s+"'></div>"),o.css({zIndex:r.zIndex}),"se"===i&&o.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(o);this._renderAxis=function(e){var n,i,o,s;e=e||this.element;for(n in this.handles)this.handles[n].constructor===String?this.handles[n]=this.element.children(this.handles[n]).first().show():(this.handles[n].jquery||this.handles[n].nodeType)&&(this.handles[n]=t(this.handles[n]),this._on(this.handles[n],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=t(this.handles[n],this.element),s=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth(),o=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),e.css(o,s),this._proportionallyResize()),this._handles=this._handles.add(this.handles[n])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=o&&o[1]?o[1]:"se")}),r.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(t(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){r.disabled||a.resizing||(t(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,n=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(e){var n,i,o=!1;for(n in this.handles)i=t(this.handles[n])[0],(i===e.target||t.contains(i,e.target))&&(o=!0);return!this.options.disabled&&o},_mouseStart:function(e){var n,i,o,s=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),n=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),s.containment&&(n+=t(s.containment).scrollLeft()||0,i+=t(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:n,top:i},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===o?this.axis+"-resize":o),a.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var n,i,o=this.originalMousePosition,s=this.axis,a=e.pageX-o.left||0,r=e.pageY-o.top||0,l=this._change[s];return this._updatePrevProperties(),l?(n=l.apply(this,[e,a,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(n=this._updateRatio(n,e)),n=this._respectSize(n,e),this._updateCache(n),this._propagate("resize",e),i=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(e){this.resizing=!1;var n,i,o,s,a,r,l,c=this.options,u=this;return this._helper&&(n=this._proportionallyResizeElements,i=n.length&&/textarea/i.test(n[0].nodeName),o=i&&this._hasScroll(n[0],"left")?0:u.sizeDiff.height,s=i?0:u.sizeDiff.width,a={width:u.helper.width()-s,height:u.helper.height()-o},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,l=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(t.extend(a,{top:l,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,n,i,o,s,a=this.options;s={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=s.minHeight*this.aspectRatio,i=s.minWidth/this.aspectRatio,n=s.maxHeight*this.aspectRatio,o=s.maxWidth/this.aspectRatio,e>s.minWidth&&(s.minWidth=e),i>s.minHeight&&(s.minHeight=i),s.maxWidth>n&&(s.maxWidth=n),s.maxHeight>o&&(s.maxHeight=o)),this._vBoundaries=s},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,n=this.size,i=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===i&&(t.left=e.left+(n.width-t.width),t.top=null),"nw"===i&&(t.top=e.top+(n.height-t.height),t.left=e.left+(n.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,n=this.axis,i=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,o=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,s=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,c=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return s&&(t.width=e.minWidth),a&&(t.height=e.minHeight),i&&(t.width=e.maxWidth),o&&(t.height=e.maxHeight),s&&c&&(t.left=r-e.minWidth),i&&c&&(t.left=r-e.maxWidth),a&&u&&(t.top=l-e.minHeight),o&&u&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,n=[],i=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],o=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)n[e]=parseInt(i[e],10)||0,n[e]+=parseInt(o[e],10)||0;return{height:n[0]+n[2],width:n[1]+n[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,n=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:n.height()-this.outerDimensions.height||0,width:n.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,n=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var n=this.originalSize,i=this.originalPosition;return{left:i.left+e,width:n.width-e}},n:function(t,e,n){var i=this.originalSize,o=this.originalPosition;return{top:o.top+n,height:i.height-n}},s:function(t,e,n){return{height:this.originalSize.height+n}},se:function(e,n,i){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,n,i]))},sw:function(e,n,i){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,n,i]))},ne:function(e,n,i){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,n,i]))},nw:function(e,n,i){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,n,i]))}},_propagate:function(e,n){t.ui.plugin.call(this,e,[n,this.ui()]),"resize"!==e&&this._trigger(e,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var n=t(this).resizable("instance"),i=n.options,o=n._proportionallyResizeElements,s=o.length&&/textarea/i.test(o[0].nodeName),a=s&&n._hasScroll(o[0],"left")?0:n.sizeDiff.height,r=s?0:n.sizeDiff.width,l={width:n.size.width-r,height:n.size.height-a},c=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,u=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;
n.element.animate(t.extend(l,u&&c?{top:u,left:c}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};o&&o.length&&t(o[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,n,i,o,s,a,r,l=t(this).resizable("instance"),c=l.options,u=l.element,d=c.containment,h=d instanceof t?d.get(0):/parent/.test(d)?u.parent().get(0):d;h&&(l.containerElement=t(h),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(h),n=[],t(["Top","Right","Left","Bottom"]).each(function(t,i){n[t]=l._num(e.css("padding"+i))}),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-n[3],width:e.innerWidth()-n[1]},i=l.containerOffset,o=l.containerSize.height,s=l.containerSize.width,a=l._hasScroll(h,"left")?h.scrollWidth:s,r=l._hasScroll(h)?h.scrollHeight:o,l.parentData={element:h,left:i.left,top:i.top,width:a,height:r}))},resize:function(e){var n,i,o,s,a=t(this).resizable("instance"),r=a.options,l=a.containerOffset,c=a.position,u=a._aspectRatio||e.shiftKey,d={top:0,left:0},h=a.containerElement,p=!0;h[0]!==document&&/static/.test(h.css("position"))&&(d=l),c.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-d.left),u&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=r.helper?l.left:0),c.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),u&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?l.top:0),o=a.containerElement.get(0)===a.element.parent().get(0),s=/relative|absolute/.test(a.containerElement.css("position")),o&&s?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),n=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-d.left:a.offset.left-l.left)),i=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-d.top:a.offset.top-l.top)),n+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-n,u&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),i+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-i,u&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),n=e.options,i=e.containerOffset,o=e.containerPosition,s=e.containerElement,a=t(e.helper),r=a.offset(),l=a.outerWidth()-e.sizeDiff.width,c=a.outerHeight()-e.sizeDiff.height;e._helper&&!n.animate&&/relative/.test(s.css("position"))&&t(this).css({left:r.left-o.left-i.left,width:l,height:c}),e._helper&&!n.animate&&/static/.test(s.css("position"))&&t(this).css({left:r.left-o.left-i.left,width:l,height:c})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance"),n=e.options;t(n.alsoResize).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})},resize:function(e,n){var i=t(this).resizable("instance"),o=i.options,s=i.originalSize,a=i.originalPosition,r={height:i.size.height-s.height||0,width:i.size.width-s.width||0,top:i.position.top-a.top||0,left:i.position.left-a.left||0};t(o.alsoResize).each(function(){var e=t(this),i=t(this).data("ui-resizable-alsoresize"),o={},s=e.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(s,function(t,e){var n=(i[e]||0)+(r[e]||0);n&&n>=0&&(o[e]=n||null)}),e.css(o)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),n=e.options,i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,n=t(this).resizable("instance"),i=n.options,o=n.size,s=n.originalSize,a=n.originalPosition,r=n.axis,l="number"==typeof i.grid?[i.grid,i.grid]:i.grid,c=l[0]||1,u=l[1]||1,d=Math.round((o.width-s.width)/c)*c,h=Math.round((o.height-s.height)/u)*u,p=s.width+d,f=s.height+h,g=i.maxWidth&&p>i.maxWidth,m=i.maxHeight&&f>i.maxHeight,v=i.minWidth&&i.minWidth>p,b=i.minHeight&&i.minHeight>f;i.grid=l,v&&(p+=c),b&&(f+=u),g&&(p-=c),m&&(f-=u),/^(se|s|e)$/.test(r)?(n.size.width=p,n.size.height=f):/^(ne)$/.test(r)?(n.size.width=p,n.size.height=f,n.position.top=a.top-h):/^(sw)$/.test(r)?(n.size.width=p,n.size.height=f,n.position.left=a.left-d):((0>=f-u||0>=p-c)&&(e=n._getPaddingPlusBorderDimensions(this)),f-u>0?(n.size.height=f,n.position.top=a.top-h):(f=u-e.height,n.size.height=f,n.position.top=a.top+s.height-f),p-c>0?(n.size.width=p,n.position.left=a.left-d):(p=c-e.width,n.size.width=p,n.position.left=a.left+s.width-p))}}),t.ui.resizable}),define("general/map/map_views",["app","common/common_views","text!general/map/map_templates.html","util","sprintf","jquery-ui"],function(t,e,n,i){return t.module("General.Map",function(t,e,o,s,a,r){t.MainView=s.LayoutView.extend({template:r.template(a(n).filter("#map_template").html()),regions:{stationTable:"#station_table",nodeTable:"#node_table"},ui:{station_label:"#stations",node_label:"#nodes"},events:{"click button.js-toolbar":"onToolbarClick","click button.openImageFromCamera":"openImageFromCamera","click button.dumpMarkers":"dumpMarkers"},options:{showNodes:!0,showNodeLabels:!0,showSelectedStations:!0,showKnownStations:!1,showAllStations:!1,showStationLabels:!0},behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}},onToolbarClick:function(t){t.stopPropagation();var e,n=a(t.currentTarget).attr("id");"showSelectedStations"===n||"showKnownStations"===n||"showAllStations"===n?(e=this.options[n],e||(this.options.showSelectedStations=!1,this.options.showKnownStations=!1,this.options.showAllStations=!1,this.options[n]=!0)):(this.options[n]=!this.options[n],this.options[n]||a(t.currentTarget).blur()),this._refreshToolbarStatus(),this.trigger("toolbar:click")},openImageFromCamera:function(t){function e(t,e){return Math.floor(Math.random()*(e-t+1))+t}t.stopPropagation();var n,i=a(".gmap");n='<div class="block gmap-camera-tool"><div class="block-title"><H4>CameraTOOL</H4></div>',n+='<div class="gmap-camera-tool-img"></div>',n+='<div class="btn-group">',n+='<button id="discard" type="button" class="btn btn-alt btn-warning"><i class="fa fa-times-circle"></i> Cancel</button>',n+='<button id="save" type="button" class="btn btn-alt btn-primary"><i class="fa fa-save"></i> Save</button>',n+="</div>",n+="</div>",i.append(n),setTimeout(function(){var t="https://s3.amazonaws.com/f.cl.ly/items/0N31101S0K383m3t3A13/Image%202015-02-22%20at%2010.21.20%20PM.png";a(".gmap-camera-tool-img").append('<img src="'+t+'">')},100);var o,s,r,l,c=["green","blue","red","yellow"];for(this.randomDivs=[],o=0;o<c.length;o++)s=e(0,240),r=e(0,240),l=a('<div class="randomDiv">'),l.css({top:r,left:s,borderColor:c[o]}),l.attr("div-id",c[o]),l.on("dblclick",function(){var t=a(this).position();log.debug(t.top,t.left)}),a(".gmap-camera-tool-img").append(l),l.draggable({containment:"parent"}),this.randomDivs.push(l)},dumpMarkers:function(){var t,e,n,i,o,s,a,r;for(t=0;t<this.markers.length;t++)for(e=0;e<this.randomDivs.length;e++)n=this.markers[t],i=this.randomDivs[e],n.id==i.attr("div-id")&&(o=n.getPosition().lat(),s=n.getPosition().lng(),a=i.position().top,r=i.position().left,log.debug("marker "+n.id+" ("+o+","+s+") --> ("+a+","+r+")"))},onShow:function(){this._refreshToolbarStatus()},updateNodeStatus:function(t){this.ui.node_label.text(t.length+" nodes")},updateStationStatus:function(t){var e,n,o="";e=t.get("known_sta"),n=t.get("other_sta"),e&&(o=e.active+" known devices active in the last "+i.formatTimeApprox(1e3*e.active_lrrt)),n&&(o+=" - "+n.count+" other devices seen in the last "+i.formatTimeApprox(1e3*n.max_lrrt)),this.ui.station_label.text(o)},_refreshToolbarStatus:function(){var t=this;r.each(this.options,function(e,n){t.$el.find("#"+n).toggleClass("btn-alt",!e)})}})})}),eval(function(t,e,n,i,o,s){if(o=function(t){return(e>t?"":o(parseInt(t/e)))+((t%=e)>35?String.fromCharCode(t+29):t.toString(36))},!"".replace(/^/,String)){for(;n--;)s[o(n)]=i[n]||o(n);i=[function(t){return s[t]}],o=function(){return"\\w+"},n=1}for(;n--;)i[n]&&(t=t.replace(new RegExp("\\b"+o(n)+"\\b","g"),i[n]));return t}('7 1G(b,a){7 1u(){};1u.v=a.v;b.2B=a.v;b.v=1b 1u();b.v.3h=b}7 u(c,b,a){2.3=c;2.1L=c.2y;2.6=K.1A("2k");2.6.4.S="Z: 1p; 15: 1P;";2.q=K.1A("2k");2.q.4.S=2.6.4.S;2.q.1M("2A","1d A;");2.q.1M("2w","1d A;");2.U=u.P(b)}1G(u,8.5.3g);u.P=7(b){t a;9(C u.P.1j==="B"){a=K.1A("30");a.4.S="Z: 1p; z-2Y: 2W; M: 13;";a.4.1l="-2P";a.4.1x="-2M";a.2I=b;u.P.1j=a}1d u.P.1j};u.v.2D=7(){t g=2;t m=A;t c=A;t f;t j,1e;t p;t d;t h;t o;t n=20;t i="3p("+2.1L+")";t k=7(e){9(e.2q){e.2q()}e.3l=G;9(e.2n){e.2n()}};t l=7(){g.3.2m(3c)};2.1E().1J.X(2.6);2.1E().36.X(2.q);9(C u.P.2e==="B"){2.1E().1J.X(2.U);u.P.2e=G}2.1t=[8.5.r.O(2.q,"2c",7(e){9(g.3.R()||g.3.W()){2.4.19="25";8.5.r.D(g.3,"2c",e)}}),8.5.r.O(2.q,"21",7(e){9((g.3.R()||g.3.W())&&!c){2.4.19=g.3.2V();8.5.r.D(g.3,"21",e)}}),8.5.r.O(2.q,"1X",7(e){c=A;9(g.3.R()){m=G;2.4.19=i}9(g.3.R()||g.3.W()){8.5.r.D(g.3,"1X",e);k(e)}}),8.5.r.O(K,"1s",7(a){t b;9(m){m=A;g.q.4.19="25";8.5.r.D(g.3,"1s",a)}9(c){9(d){b=g.Y().1v(g.3.Q());b.y+=n;g.3.J(g.Y().1S(b));2O{g.3.2m(8.5.2N.2L);2J(l,2H)}2E(e){}}g.U.4.M="13";g.3.11(f);p=G;c=A;a.L=g.3.Q();8.5.r.D(g.3,"1N",a)}}),8.5.r.w(g.3.1g(),"2C",7(a){t b;9(m){9(c){a.L=1b 8.5.2z(a.L.1f()-j,a.L.1i()-1e);b=g.Y().1v(a.L);9(d){g.U.4.14=b.x+"H";g.U.4.T=b.y+"H";g.U.4.M="";b.y-=n}g.3.J(g.Y().1S(b));9(d){g.q.4.T=(b.y+n)+"H"}8.5.r.D(g.3,"1K",a)}V{j=a.L.1f()-g.3.Q().1f();1e=a.L.1i()-g.3.Q().1i();f=g.3.1c();h=g.3.Q();o=g.3.1g().2x();d=g.3.F("16");c=G;g.3.11(1I);a.L=g.3.Q();8.5.r.D(g.3,"1H",a)}}}),8.5.r.O(K,"2v",7(e){9(c){9(e.3r===27){d=A;g.3.J(h);g.3.1g().3q(o);8.5.r.D(K,"1s",e)}}}),8.5.r.O(2.q,"2u",7(e){9(g.3.R()||g.3.W()){9(p){p=A}V{8.5.r.D(g.3,"2u",e);k(e)}}}),8.5.r.O(2.q,"2s",7(e){9(g.3.R()||g.3.W()){8.5.r.D(g.3,"2s",e);k(e)}}),8.5.r.w(2.3,"1H",7(a){9(!c){d=2.F("16")}}),8.5.r.w(2.3,"1K",7(a){9(!c){9(d){g.J(n);g.6.4.N=1I+(2.F("17")?-1:+1)}}}),8.5.r.w(2.3,"1N",7(a){9(!c){9(d){g.J(0)}}}),8.5.r.w(2.3,"3o",7(){g.J()}),8.5.r.w(2.3,"3n",7(){g.11()}),8.5.r.w(2.3,"3m",7(){g.18()}),8.5.r.w(2.3,"3j",7(){g.18()}),8.5.r.w(2.3,"3i",7(){g.1C()}),8.5.r.w(2.3,"3f",7(){g.1y()}),8.5.r.w(2.3,"3e",7(){g.1z()}),8.5.r.w(2.3,"3d",7(){g.1a()}),8.5.r.w(2.3,"3b",7(){g.1a()})]};u.v.3a=7(){t i;2.6.2j.2i(2.6);2.q.2j.2i(2.q);2h(i=0;i<2.1t.39;i++){8.5.r.38(2.1t[i])}};u.v.37=7(){2.1y();2.1C();2.1a()};u.v.1y=7(){t a=2.3.F("1w");9(C a.35==="B"){2.6.12=a;2.q.12=2.6.12}V{2.6.12="";2.6.X(a);a=a.34(G);2.q.X(a)}};u.v.1C=7(){2.q.33=2.3.32()||""};u.v.1a=7(){t i,E;2.6.1r=2.3.F("1q");2.q.1r=2.6.1r;2.6.4.S="";2.q.4.S="";E=2.3.F("E");2h(i 31 E){9(E.2Z(i)){2.6.4[i]=E[i];2.q.4[i]=E[i]}}2.2b()};u.v.2b=7(){2.6.4.Z="1p";2.6.4.15="1P";9(C 2.6.4.I!=="B"&&2.6.4.I!==""){2.6.4.2a="\\"29:28.26.2f(I="+(2.6.4.I*24)+")\\"";2.6.4.23="22(I="+(2.6.4.I*24)+")"}2.q.4.Z=2.6.4.Z;2.q.4.15=2.6.4.15;2.q.4.I=0.2X;2.q.4.2a="\\"29:28.26.2f(I=1)\\"";2.q.4.23="22(I=1)";2.1z();2.J();2.18()};u.v.1z=7(){t a=2.3.F("1o");2.6.4.1l=-a.x+"H";2.6.4.1x=-a.y+"H";2.q.4.1l=-a.x+"H";2.q.4.1x=-a.y+"H"};u.v.J=7(a){t b=2.Y().1v(2.3.Q());9(C a==="B"){a=0}2.6.4.14=1Z.1Y(b.x)+"H";2.6.4.T=1Z.1Y(b.y-a)+"H";2.q.4.14=2.6.4.14;2.q.4.T=2.6.4.T;2.11()};u.v.11=7(){t a=(2.3.F("17")?-1:+1);9(C 2.3.1c()==="B"){2.6.4.N=2U(2.6.4.T,10)+a;2.q.4.N=2.6.4.N}V{2.6.4.N=2.3.1c()+a;2.q.4.N=2.6.4.N}};u.v.18=7(){9(2.3.F("1n")){2.6.4.M=2.3.2T()?"2S":"13"}V{2.6.4.M="13"}2.q.4.M=2.6.4.M};7 1m(a){a=a||{};a.1w=a.1w||"";a.1o=a.1o||1b 8.5.2R(0,0);a.1q=a.1q||"2Q";a.E=a.E||{};a.17=a.17||A;9(C a.1n==="B"){a.1n=G}9(C a.16==="B"){a.16=G}9(C a.2d==="B"){a.2d=G}9(C a.1W==="B"){a.1W=A}9(C a.1B==="B"){a.1B=A}a.1k=a.1k||"1V"+(K.1U.1T==="2g:"?"s":"")+"://5.1R.1Q/2t/2l/2o/2K.3k";a.1F=a.1F||"1V"+(K.1U.1T==="2g:"?"s":"")+"://5.1R.1Q/2t/2l/2o/2G.2F";a.1B=A;2.2p=1b u(2,a.1k,a.1F);8.5.1D.1O(2,2r)}1G(1m,8.5.1D);1m.v.1h=7(a){8.5.1D.v.1h.1O(2,2r);2.2p.1h(a)};',62,214,"||this|marker_|style|maps|labelDiv_|function|google|if|||||||||||||||||eventDiv_|event||var|MarkerLabel_|prototype|addListener||||false|undefined|typeof|trigger|labelStyle|get|true|px|opacity|setPosition|document|latLng|display|zIndex|addDomListener|getSharedCross|getPosition|getDraggable|cssText|top|crossDiv_|else|getClickable|appendChild|getProjection|position||setZIndex|innerHTML|none|left|overflow|raiseOnDrag|labelInBackground|setVisible|cursor|setStyles|new|getZIndex|return|cLngOffset|lat|getMap|setMap|lng|crossDiv|crossImage|marginLeft|MarkerWithLabel|labelVisible|labelAnchor|absolute|labelClass|className|mouseup|listeners_|tempCtor|fromLatLngToDivPixel|labelContent|marginTop|setContent|setAnchor|createElement|optimized|setTitle|Marker|getPanes|handCursor|inherits|dragstart|1000000|overlayImage|drag|handCursorURL_|setAttribute|dragend|apply|hidden|com|gstatic|fromDivPixelToLatLng|protocol|location|http|draggable|mousedown|round|Math||mouseout|alpha|filter|100|pointer|Microsoft||DXImageTransform|progid|MsFilter|setMandatoryStyles|mouseover|clickable|processed|Alpha|https|for|removeChild|parentNode|div|en_us|setAnimation|stopPropagation|mapfiles|label|preventDefault|arguments|dblclick|intl|click|keydown|ondragstart|getCenter|handCursorURL|LatLng|onselectstart|superClass_|mousemove|onAdd|catch|cur|closedhand_8_8|1406|src|setTimeout|drag_cross_67_16|BOUNCE|9px|Animation|try|8px|markerLabels|Point|block|getVisible|parseInt|getCursor|1000002|01|index|hasOwnProperty|img|in|getTitle|title|cloneNode|nodeType|overlayMouseTarget|draw|removeListener|length|onRemove|labelstyle_changed|null|labelclass_changed|labelanchor_changed|labelcontent_changed|OverlayView|constructor|title_changed|labelvisible_changed|png|cancelBubble|visible_changed|zindex_changed|position_changed|url|setCenter|keyCode".split("|"),0,{})),define("markerwithlabel",function(){}),define("const",[],function(){var t={};return t.ACTIVE_STA_MAX_LRRT=300,t.ACTIVE_NODE_MAX_LRRT=20,t}),define("wifidevice",["util","const","ouiresolver"],function(t,e,n){function i(t,e){this._obj=t,this.type=e}function o(){var t,e,n,i,o;return t="img/node_neutral.png",e=33,n=33,i=16,o=13,new google.maps.MarkerImage(t,new google.maps.Size(e,n),new google.maps.Point(0,0),new google.maps.Point(i,o))}function s(t){var e,n,o,s,a=a;return latLng=a.getValue(t.find("#latlng")),o=latLng.split(",")[0].trim(),s=latLng.split(",")[1].trim(),e={mac:a.getValue(t.find("#mac")),desc:a.getValue(t.find("#desc")),name:a.getValue(t.find("#name")),loc:{lat:o,lng:s,alt:a.getValue(t.find("#alt"))}},n=new i(e),n.getInfoWndDiv(!0)}function a(t,e){return(null!=t||null!=e&&""!=e)&&(null!=e||null!=t&&""!=t)?t==e:!0}function r(t,e,n,i){var o,s;return o=$("<label></label>").append(t),i?o.append($('<span class="small">'+i+"</span>")):o.addClass("nohint"),s=$('<input type="text" value="'+(n||"")+'" />').attr("id",e),$("<div></div>").append(o).append(s)}function l(t,e,n,i){var t,o;return t=$("<label></label>").append(t),i?t.append($('<span class="small">'+i+"</span>")):t.addClass("nohint"),o=$('<input type="text" disabled="disabled" value="'+(n||"")+'" />').attr("id",e),$("<div></div>").append(t).append(o)}var c=5,u=15;return i.prototype.getMac=function(){return this._obj.mac},i.prototype.getLevelId=function(){var t;return this._obj.hasOwnProperty("loc")&&(t=this._obj.loc,t.hasOwnProperty("levelId"))?t.levelId:null},i.prototype.setLevelId=function(t){this._obj.hasOwnProperty("loc")&&(this._obj.loc.levelId=t)},i.prototype.hasLocation=function(){return this._obj.hasOwnProperty("loc")&&null!=this._obj.loc&&this._obj.loc.hasOwnProperty("lat")&&this._obj.loc.hasOwnProperty("lng")&&null!=this._obj.loc.lat&&null!=this._obj.loc.lng},i.prototype.getLatLng=function(){return this.hasLocation()?new google.maps.LatLng(this._obj.loc.lat,this._obj.loc.lng):null},i.prototype.hasName=function(){return this._obj.hasOwnProperty("name")&&null!==this._obj.name},i.prototype.isTag=function(){return this._obj.hasOwnProperty("events")},i.prototype.isTagMobile=function(){return this.isTag()&&this._obj.events.hasOwnProperty("motion")&&this._obj.events.motion<c},i.prototype.isTagAlert=function(){return this.isTag()&&(this._obj.events.hasOwnProperty("button1")&&this._obj.events.button1<u||this._obj.events.hasOwnProperty("button2")&&this._obj.events.button2<u)},i.prototype.isActive=function(){var n=t.getProperty(this._obj,"lrrt");return null!=n?this.type===i.NODE_TYPE?n<e.ACTIVE_NODE_MAX_LRRT:n<e.ACTIVE_STA_MAX_LRRT:!1},i.prototype.getInfoWndDiv=function(e,i){var o,s,a,c,u,d,h,p;return o=$(e?'<div id="infownd_edit_div" class="form_div infownd_edit"></div>':'<div class="form_div infownd_status"></div>'),i?(s=i.lat().toFixed(6),a=i.lng().toFixed(6)):(s=this._obj.loc.lat,a=this._obj.loc.lng),e?(o.append(null==this._obj.mac?r("Mac:","mac",this._obj.mac):l("Mac:","mac",t.formatMac(this._obj.mac))),o.append(r("Name:","name",this._obj.name,"Max 20 chars")),o.append(r("Description:","desc",this._obj.desc,"Max 60 chars"))):(o.append(l("Mac:","mac",t.formatMac(this._obj.mac))),this.isTag()||o.append(l("Mfr:","mfr",n.getCompanyName(this._obj.mac.slice(0,6)))),o.append(l("Name:","name",this._obj.name)),o.append(l("Description:","desc",this._obj.desc))),o.append(l("Lat, Lng:","latlng",s+", "+a)),e||(c=t.getProperty(this._obj,"lrrt"),u=null!=c?t.formatTime(1e3*c):"N/A",o.append(l("Last Seen","last_seen",u)),this.isTag()&&(d=this._obj.events.button1?t.formatTime(1e3*this._obj.events.button1):"N/A",h=this._obj.events.button2?t.formatTime(1e3*this._obj.events.button2):"N/A",p=this._obj.events.hasOwnProperty("motion")?t.formatTime(1e3*this._obj.events.motion):"N/A",o.append(l("Motion","motion",p,"last tag event")),o.append(l("Buttons","btns","btn1: "+d+",   btn2: "+h,"last tag event")))),o},i.prototype.getMarkerIcon=function(){var t,e,n,o,s;return this.type===i.NODE_TYPE?(t=this.isActive()?"img/node_active.png":"img/node_inactive.png",e=33,n=33,o=16,s=13):this.hasName()?(e=36,n=36,o=18,s=15,this.isTag()?(t=this.isTagAlert()?"img/tag_alert.gif":this.isTagMobile()?"img/tag_mobile.gif":this.isActive()?"img/tag_stationary.png":"img/tag_inactive.png","gif"==t.slice(-3)&&(e=22,n=22,o=11,s=11)):t=this.isActive()?"img/indoor-map-dotactive.png":"img/indoor-map-dotactive.png"):(t="img/indoor-map-dotactive.png",e=33,n=30,o=15,s=12),new google.maps.MarkerImage(t,new google.maps.Size(e,n),new google.maps.Point(0,0),new google.maps.Point(o,s))},i.prototype.setType=function(t){this.type=t},i.prototype.getType=function(){return this.type},i.prototype.getMarkerTitle=function(){return this._obj.name||this._obj.mac},i.prototype.getMarkerLabelContent=function(){return this._obj.name||this._obj.mac},i.prototype.hasChanged=function(e){var n,i,o,s,r,l,c,u=t;return null==this._obj.mac?!0:(n=u.getValue(e.find("#name")),i=u.getValue(e.find("#desc")),o=t.getValue(e.find("#latlng")),s=o.split(",")[0].trim(),r=o.split(",")[1].trim(),l=u.getValue(e.find("#alt")),c=!a(n,u.getProperty(this._obj,"name")),c=c||!a(i,u.getProperty(this._obj,"desc")),c=c||s!=u.getProperty(this._obj.loc,"lat"),c=c||r!=u.getProperty(this._obj.loc,"lng"))},i.NODE_TYPE=0,i.STATION_TYPE=1,i.getDefaultIcon=o,i.infoWndContentToDiv=s,i}),define("its-system-map",["wifidevice","util","common/server"],function(t,e,n){"use strict";function i(t){var e;W=t,q=t.$el,k(),ae={showNodes:!0,showNodeLabels:!0,showSelectedStations:!0,showKnownStations:!1,showAllStations:!1,showStationLabels:!0},de=t.stationsToDisplay,P(),e={zoom:2,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.SATELLITE,tilt:0,scaleControl:!0,mapTypeControlOptions:{mapTypeIds:["Floorplan",google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE]}},U=new google.maps.Map(document.getElementsByClassName(t.mapDivClass)[0],e),U.mapTypes.set("Floorplan",re),F=new google.maps.InfoWindow,N(),google.maps.event.addListener(F,"closeclick",function(){w()}),google.maps.event.addListener(F,"domready",function(){x()}),$(window).bind("map:fullscreen",function(){google.maps.event.trigger(U,"resize")})}function o(){return U}function s(t,e){Z||d(t,e)}function a(t){var n;n=e.sortLevels(t),E().html(e.getLevelsAsHtmlOptions(n)),E().val(X)}function r(t){E().val(t)}function l(t){R=t}function c(t){le=t,M()}function u(n,i){var o,s,a,r,l,c={};for(s=n.length,i==t.NODE_TYPE?(c=K,Q={}):(c=J,Y={}),o=0;s>o;o++){if(r=new t(n[o],i),i==t.NODE_TYPE)Q[r.getMac()]=n[o];else{if(l=e.getProperty(n[o],"lrrt"),!r.hasName()&&!ae.showAllStations)continue;Y[r.getMac()]=n[o]}r.hasLocation()&&(a=c[n[o].mac],void 0===a&&(a=new MarkerWithLabel({position:r.getLatLng(),draggable:i==t.STATION_TYPE&&ee,raiseOnDrag:!0,visible:!0,map:U,labelAnchor:new google.maps.Point(-15,20),labelClass:"marker_label",labelStyle:{opacity:.9}}),c[n[o].mac]=a,google.maps.event.addListener(a,"click",function(){v(this)}),google.maps.event.addListener(a,"dragstart",function(){b(this)}),google.maps.event.addListener(a,"dragend",function(){y(this)})),a._wifiDev&&delete a._wifiDev,a._wifiDev=r)}I(i),Z||(Z=e.repositionMap(U,n))}function d(t,e){U.setCenter(t),G=t,U.setZoom(e)}function h(){Z=!1}function p(){U&&google.maps.event.trigger(U,"resize")}function f(t,e){ae[t]=e,log.debug(t+":"+ae[t])}function g(t){return ae[t]}function m(){I(t.STATION_TYPE),I(t.NODE_TYPE)}function v(t){var e;ne==B||ne==V&&te==t||(te=t,ne=z,e=$("<dummy></dummy>").append(t._wifiDev.getInfoWndDiv(!1)).html(),F.setContent(e),F.open(U,te))}function b(t){te=t,ne=V}function y(t){var e;te=t,e='<div id="infownd_training"><p>Collect training data at this location?</p>',e+='<button id="infownd_train_ok">OK, train '+H+" sec</button>",e+='<button id="infownd_train_cancel">Cancel</button>',e+='<span class="ajax_spinner" id="infownd_training_spinner"><img src="img/loading.gif" alt="processing"><span class="ajax_msg">&nbsp;</span></span></div>',F.setContent(e),F.open(U,te)}function w(){S()}function x(){var t,n;null!=te&&ne==V&&(t=q.find("#infownd_train_ok"),n=q.find("#infownd_train_cancel"),t&&t.unbind("click").click(C),n&&n.unbind("click").click(S),ie=new e.AjaxSpinner(q.find("#infownd_training_spinner"),"Saved"))}function C(){var t=te._wifiDev,e=X;n.setStationStatus({mac:t.getMac(),status:"stationary",error:function(){setTimeout(A(),1e3)},success:function(){ne=B,oe=(new Date).getTime(),ie.start(),q.find("#infownd_train_ok").attr("disabled",!0),se=setInterval(function(){O(t.getMac(),e,te.getPosition().lat(),te.getPosition().lng())},1e3)}})}function S(){te.setPosition(te._wifiDev.getLatLng()),se&&n.setStationStatus({mac:te._wifiDev.getMac(),status:"mobile"}),A()}function T(t){X=t,m(),R&&R(t),M()}function D(t){ee=t}function k(){U=null,X=0,J={},Y={},K={},Q={},Z=!1,F=null,te=null,ee=!1,ne=z,ie=null,oe=null,se=null,ae={},re=null,le=[],ce=[],ue={},de={}}function I(n){var i,o,s,a,r,l,c,u,d,h,p,f=0;f=0,u=0,d=(new Date).getTime(),n==t.NODE_TYPE?(i=K,s=Q):(i=J,s=Y);for(p in i)o=i[p],a=o._wifiDev,(o!=te||ne==z)&&(void 0!==s[p]?(a.getMarkerTitle()!=o.getTitle()&&(o.setTitle(a.getMarkerTitle()),r=!0),0!=e.compareLatLng(a.getLatLng(),o.getPosition())&&(o.setPosition(a.getLatLng()),r=!0),(null==o.getIcon()||a.getMarkerIcon().url!=o.getIcon().url)&&(o.setIcon(a.getMarkerIcon()),r=!0),a.getMarkerLabelContent()!=o.labelContent&&(o.set("labelContent",a.getMarkerLabelContent()),r=!0),n==t.STATION_TYPE&&o.draggable!=ee&&(o.draggable=ee,r=!0),l=n==t.NODE_TYPE?ae.showNodeLabels:ae.showStationLabels,o.labelVisible!==l&&(o.set("labelVisible",l),r=!0),c=n==t.NODE_TYPE?ae.showNodes:ae.showAllStations||ae.showKnownStations&&a.hasName()||ae.showSelectedStations&&null!=de[a.getMac()],a.getLevelId()!=X&&(c=!1),o.getVisible()!==c&&(o.setVisible(c),r=!0),r&&f++,u++):(o.setMap(null),delete i[p]));h=(new Date).getTime(),log.debug("Updated "+f+" devices in "+(h-d)+" msec - total devices "+u)}function M(){var t,e,n,i,o,s=!0,a=ce.length,r=[],l={};for(t=0;a>t;t++)e=ce[t],i=s,i=i&&e._fpObj.levelId==X,i=i&&-1!=j(e._fpObj.fpId),i?(r.push(e),l[e._fpObj.fpId]=!0):e._kmlLayer.setMap(null);for(o=le?le.length:0,t=0;o>t;t++)n=le[t],i=s,i=i&&n.levelId==X,i=i&&!l[n.fpId],i&&(e=ue[n.fpId],e||(e=L(n),ue[n.fpId]=e),_.has(e,"_mapTiler")?(U.overlayMapTypes.clear(),U.overlayMapTypes.setAt(0,e._mapTiler)):e._kmlLayer.setMap(U),r.push(e));ce=r}function L(t){var e={};if(e._fpObj=t,e._kmlLayer=new google.maps.KmlLayer(t.kmlAligned,{suppressInfoWindows:!0,preserveViewport:!0,clickable:!1}),!_.isEmpty(t.tiles)){var n,i,o,s,a,r=U.getProjection();n=t.tiles.bbox,i=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east)),o=t.tiles.maxZoom,s=t.tiles.minZoom,a=t.tiles.folder,e._mapTiler=new google.maps.ImageMapType({getTileUrl:function(t,e){var n=Math.pow(2,e),l=256/n,c=256/n,u=new google.maps.LatLngBounds(r.fromPointToLatLng(new google.maps.Point(t.x*l,(t.y+1)*c)),r.fromPointToLatLng(new google.maps.Point((t.x+1)*l,t.y*c))),d=t.y;return i.intersects(u)&&e>=s&&o>=e?a+e+"/"+t.x+"/"+d+".png":null},tileSize:new google.maps.Size(256,256),isPng:!0,opacity:1})}return e}function j(t){var e,n;if(!le)return-1;for(n=le.length,e=0;n>e;e++)if(le[e].fpId==t)return e;return-1}function N(){var t,e,n,i;n=$('<select id="system_map_level_selector" class="map_level_selector"></select>'),e=$("<dummy></dummy>").append(n),i=e.html(),t=document.createElement("DIV"),t.innerHTML=i,t.index=1,U.controls[google.maps.ControlPosition.TOP_RIGHT].push(t),q.on("change","#system_map_level_selector",function(){T($(this).val())})}function E(){return q.find("#system_map_level_selector")}function O(t,e,i,o){var s,a;s=(new Date).getTime()-oe,a=Math.floor(H-s/1e3),q.find("#infownd_train_ok").text(a+" sec remaining"),0==a&&(clearInterval(se),se=null,n.train({levelId:e,station:t,lat:i,lng:o,complete:function(){n.setStationStatus({mac:t,status:"mobile"}),A()}}))}function A(){F.close(),te=null,ne=z,oe=null,se&&(clearInterval(se),se=null)}function P(){function t(){}t.prototype.tileSize=new google.maps.Size(256,256),t.prototype.maxZoom=25,t.prototype.getTile=function(t,e,n){var i=n.createElement("div");return i.innerHTML="&copy; Navizon Inc",i.style.width=this.tileSize.width+"px",i.style.height=this.tileSize.height+"px",i.style.fontSize="12px",i.style.borderWidth="0px",i.style.borderColor="#494949",i.style.backgroundColor="#494949",i},t.prototype.name="Floor plan",t.prototype.alt="Floor plan Map Type",re=new t}var R,F,z=0,V=1,B=2,H=15,W=null,q=null,U=null,X=0,G=null,J={},Y={},K={},Q={},Z=!1,te=null,ee=!1,ne=z,ie=null,oe=null,se=null,ae={},re=null,le=[],ce=[],ue={},de={};return{init:i,getMap:o,setDefaultLocation:s,setDevices:u,setAutoRepositionOnce:h,repositionMap:d,resizeMap:p,setOption:f,getOption:g,refreshMarkers:m,setLevels:a,setCurrentLevel:r,setLevelChangedListener:l,setFloorplans:c,enableTraining:D}}),define("general/map/map_controller",["app","common/server","common/entities","common/common_views","general/map/map_views","bootbox","its-system-map","wifidevice","const"],function(t,e,n,i,o){"use strict";return i.EditController.extend({initialize:function(){log.info("Its Map Controller initialized")},show:function(){var e,s,a,r;s=new o.MainView({}),a=new n.LevelCollection,r=new n.FloorplanCollection,s.on("show",function(){log.debug("The map div is rendered so I can instantiate and show the Map"),e=new i.FloorplanMap({parentView:s,$gmapDiv:s.$el.find(".gmap"),levels:a,_floorplanObjs:r}),e.show();var t,n,o,l,c=[{lat:44.007317,lng:11.2358109,color:"green"},{lat:44.007317,lng:11.2358309,color:"red"},{lat:44.007317,lng:11.2358409,color:"blue"},{lat:44.007317,lng:11.2358509,color:"yellow"}],u=e.getMap(),d=[];for(t=0;t<c.length;t++)n=new google.maps.LatLng(c[t].lat,c[t].lng),o={path:0,fillOpacity:1,fillColor:c[t].color,strokeOpacity:1,strokeColor:c[t].color,strokeWeight:1,scale:8},l=new google.maps.Marker({position:n,icon:o,map:u,id:c[t].color,draggable:!0}),d.push(l);this.markers=d}),t.main.show(s)}})}),define("general/general_app",["app","common/server","general/login/login_controller","general/sites/sites_controller","general/levels/levels_controller","general/users/users_controller","general/floorplans/floorplans_controller","general/map/map_controller"],function(t,e,n,i,o,s,a,r){return t.module("GeneralApp",function(t,l,c,u){function d(){if(e.isLoggedIn())return!0;var t=c.history.fragment;c.history.navigate("#login"),n.Controller.show(t)}var h=new i,p=new o,f=new s,g=new a,m=new r;t.Router=u.AppRouter.extend({appRoutes:{"":"showSites","general/sites":"showSites","general/levels":"showLevels","general/users":"showUsers","general/floorplans":"showFloorplans","general/map":"showMap"}});var v={showSites:function(){d()&&h.show()},showUsers:function(){d()&&f.show()},showLevels:function(){d()&&p.show()},showFloorplans:function(){d()&&g.show()},showMap:function(){d()&&m.show()}};t.addInitializer(function(){log.info("GeneralApp Router initialized"),new t.Router({controller:v})})})}),define("text!its/map/its_map_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="its_map_template">\n\n    <div class="block full">\n        <div class="block-title">\n            <h4><strong>Wi-Fi Location Monitor</strong> Map</h4>\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n            </div>\n        </div>\n\n        <p>\n            <span id="nodes">0 nodes</span> -&nbsp; <span id="stations">0 known devices</span>\n        </p>\n\n        <div class="block block-gmap">\n            <div class="gmap">\n                <!-- Google map goes here -->\n            </div>\n        </div>\n\n        <div class="row">\n            <div class="col-lg-12">\n                Display\n                <div class="btn-group btn-group-xs">\n                    <button id="showNodes"              class="js-toolbar btn btn-alt btn-primary">Nodes</button>\n                    <button id="showNodeLabels"         class="js-toolbar btn btn-alt btn-primary">Node Labels</button>\n                </div>\n                &nbsp;&nbsp;Stations\n                <div class="btn-group btn-group-xs">\n                    <button id="showSelectedStations"   class="js-toolbar btn btn-alt btn-primary">Selected</button>\n                    <button id="showKnownStations"      class="js-toolbar btn btn-alt btn-primary">All Known</button>\n                    <button id="showAllStations"        class="js-toolbar btn btn-alt btn-primary">All Devices</button>\n                    <button id="showStationLabels"      class="js-toolbar btn btn-alt btn-primary">Station Labels</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Node table -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Devices</strong></h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="station_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Node table -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Nodes</strong></h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="node_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n</script>\n\n\n<!-- station table-->\n<script type="text/x-template" id="station_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Name </th>\n            <th> MAC </th>\n            <th> Mfr/Type </th>\n            <th> Description </th>\n            <th> Last Seen </th>\n            <th> Show</th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- node table-->\n<script type="text/x-template" id="node_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Name </th>\n            <th> MAC </th>\n            <th> Description </th>\n            <th> Last Report </th>\n            <th> Devices in Range</th>\n            <th> Status</th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n'
}),define("its/map/its_map_views",["app","common/common_views","text!its/map/its_map_templates.html","util","sprintf"],function(t,e,n,i){return t.module("Its.Map",function(t,o,s,a,r,l){t.MainView=a.LayoutView.extend({template:l.template(r(n).filter("#its_map_template").html()),regions:{stationTable:"#station_table",nodeTable:"#node_table"},ui:{station_label:"#stations",node_label:"#nodes"},events:{"click button.js-toolbar":"onToolbarClick"},options:{showNodes:!0,showNodeLabels:!0,showSelectedStations:!0,showKnownStations:!1,showAllStations:!1,showStationLabels:!0},behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}},onToolbarClick:function(t){t.stopPropagation();var e,n=r(t.currentTarget).attr("id");"showSelectedStations"===n||"showKnownStations"===n||"showAllStations"===n?(e=this.options[n],e||(this.options.showSelectedStations=!1,this.options.showKnownStations=!1,this.options.showAllStations=!1,this.options[n]=!0)):(this.options[n]=!this.options[n],this.options[n]||r(t.currentTarget).blur()),this._refreshToolbarStatus(),this.trigger("toolbar:click")},onShow:function(){this._refreshToolbarStatus()},updateNodeStatus:function(t){this.ui.node_label.text(t.length+" nodes")},updateStationStatus:function(t){var e,n,o="";e=t.get("known_sta"),n=t.get("other_sta"),e&&(o=e.active+" known devices active in the last "+i.formatTimeApprox(1e3*e.active_lrrt)),n&&(o+=" - "+n.count+" other devices seen in the last "+i.formatTimeApprox(1e3*n.max_lrrt)),this.ui.station_label.text(o)},_refreshToolbarStatus:function(){var t=this;l.each(this.options,function(e,n){t.$el.find("#"+n).toggleClass("btn-alt",!e)})}}),t.StationTableView=e.DatatableView.extend({template:l.template(r(n).filter("#station_table_template").html()),columns:[e.DatatableView.getColumn("name"),e.DatatableView.getColumn("id","mac"),e.DatatableView.getColumn("mfr"),e.DatatableView.getColumn("desc"),e.DatatableView.getColumn("lrrt"),e.DatatableView.getButtonColumn("mac",["check"])]}),t.NodeTableView=e.DatatableView.extend({template:l.template(r(n).filter("#node_table_template").html()),columns:[e.DatatableView.getColumn("name"),e.DatatableView.getColumn("id","mac"),e.DatatableView.getColumn("desc"),e.DatatableView.getColumn("lrrt"),{data:"lrne",searchable:!1,render:function(t,e){return"display"==e&&isNaN(t)?"n/a":t}},{data:null,render:function(t){return isFinite(t.lrrt)&&t.lrrt<15?"Active":"Not Active"}}]})})}),define("its/map/its_map_controller",["app","common/server","common/entities","common/common_views","its/map/its_map_views","bootbox","its-system-map","wifidevice","const"],function(t,e,n,i,o,s,a,r,l){"use strict";function c(){m.fetch({reset:!0}),w.options.showAllStations?g.fetch({reset:!0}):f.fetch({reset:!0})}function u(t){t.checked?D[t.id]=!0:delete D[t.id],S.refreshMarkers()}function d(){_.each(w.options,function(t,e){S.setOption(e,t)}),S.refreshMarkers()}function h(){$('input[type="checkbox"].js-check').each(function(){var t=$(this)[0];_.each(D,function(e,n){n==t.getAttribute("data-id")&&(t.checked=e)})})}var p=5e3,f=null,g=null,m=null,v=null,b=null,y=null,w=null,x=null,C=null,S=null,T={},D={},k=null;return i.EditController.extend({initialize:function(){log.info("Its Map Controller initialized")},show:function(){f=t.reqres.request("known_stations_loc:entities"),g=t.reqres.request("all_stations_loc:entities"),m=new n.NodeCollection,v=new n.LevelCollection,b=new n.FloorplanCollection,y=t.reqres.request("stations_count:entities",l.ACTIVE_STA_MAX_LRRT),w=new o.MainView({}),x=new o.StationTableView({collection:f}),C=new o.NodeTableView({collection:m}),S=a,T={},D={},v.on("reset",function(){S.setLevels(this.toJSON())}),b.on("reset",function(){S.setFloorplans(this.toJSON())}),m.on("reset",function(){S.setDevices(this.toJSON(),r.NODE_TYPE),w.updateNodeStatus(this)}),f.on("reset",function(){S.setDevices(this.toJSON(),r.STATION_TYPE),h()}),g.on("reset",function(){S.setDevices(this.toJSON(),r.STATION_TYPE),h()}),y.on("change",function(){w.updateStationStatus(this)}),w.on("show",function(){w.stationTable.show(x),w.nodeTable.show(C),x.on("check",u),w.on("toolbar:click",d),S.init({$el:this.$el,mapDivClass:"gmap",stationsToDisplay:D}),setTimeout(function(){m.fetch({reset:!0}),f.fetch({reset:!0}),y.fetch({reset:!0}),v.fetch({reset:!0}),b.fetch({reset:!0})},1e3),k=setInterval(c,p)}),w.on("destroy",function(){log.debug("mainview on destroy"),k&&clearInterval(k)}),t.main.show(w)}})}),define("text!its/nodes/nodes_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="its_nodes_template">\n\n    <div class="block full">\n        <!-- Map with Markers Title -->\n        <div class="block-title">\n            <h4><strong>Node</strong> Map</h4>\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n            </div>\n        </div>\n\n        <div class="block block-gmap">\n            <div class="gmap">\n                <!-- Google map goes here -->\n            </div>\n        </div>\n    </div>\n\n    <!-- Nodes -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Nodes</strong></h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="node_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n</script>\n\n<!-- node table-->\n<script type="text/x-template" id="node_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Name </th>\n            <th> MAC </th>\n            <th> Description </th>\n            <th> Level ID </th>\n            <th> Latitude</th>\n            <th> Longitude</th>\n            <th> Action </th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Dialog for Add, Edit, Delete operations -->\n<script type="text/x-template" id="dialog-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <% if(type === \'new\') { %>\n                        <h4 class="modal-title">Add Node</h4>\n                    <% } else if (type === \'delete\'){ %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= mac %> </h4>\n                    <% } else { %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= mac %> </h4>\n                    <% } %>\n                </div>\n\n                <div class="modal-body">\n                    <form class="form-horizontal">\n\n                        <!-- MAC Address -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">MAC</label>\n                            <div class="col-md-9">\n                                <p name="mac" class="form-control-static"><%= mac %></p>\n                            </div>\n                        </div>\n\n                        <!-- Name -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Name</label>\n                            <div class="col-md-9">\n                                <input name="name" value="" class="form-control" placeholder="Name">\n                            </div>\n                        </div>\n\n                        <!-- Desc -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Description</label>\n                            <div class="col-md-9">\n                                <input name="desc" value="" class="form-control" placeholder="Description">\n                            </div>\n                        </div>\n\n                        <!-- Level ID -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Level</label>\n                            <div class="col-md-9">\n                                <select name="loc[levelId]" class="form-control">\n                                    <% _.each(levels, function(l) { %>\n                                        <option value="<%= l.levelId %>"><%= l.levelId + \' - \' + l.name %></option>\n                                    <% }); %>\n                                </select>\n                            </div>\n                        </div>\n\n                        <!-- Lat -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Latitude</label>\n                            <div class="col-md-9">\n                                <input name="loc[lat]" value="" class="form-control" placeholder="Latitude">\n                            </div>\n                        </div>\n\n                        <!-- Lng -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Longitude</label>\n                            <div class="col-md-9">\n                                <input name="loc[lng]" value="" class="form-control" placeholder="Longitude">\n                            </div>\n                        </div>\n\n                    </form>\n                </div>\n\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <% if (type === \'delete\') { %>\n                        <button type="button" class="btn btn-warning js-submit"><i class="fa fa-trash-o"></i> Delete Node</button>\n                    <% } else { %>\n                        <button type="button" class="btn btn-primary js-submit"><i class="fa fa-save"></i> Save</button>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n'}),define("its/nodes/nodes_views",["app","common/common_views","text!its/nodes/nodes_templates.html"],function(t,e,n){return log.info("Its.Nodes.Views initialized"),t.module("Its.Nodes",function(t,i,o,s,a,r){t.MainView=s.LayoutView.extend({template:r.template(a(n).filter("#its_nodes_template").html()),ui:{},regions:{nodeTable:"#node_table"},behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}},triggers:{},events:{}}),t.NodeTableView=e.DatatableView.extend({template:r.template(a(n).filter("#node_table_template").html()),columns:[{data:"name"},{data:"mac"},{data:"desc"},{data:"loc.levelId"},{data:"loc.lat"},{data:"loc.lng"},e.DatatableView.getButtonColumn("mac",["edit","delete"])]}),t.ModalView=e.EditDialogView.extend({template:r.template(a(n).filter("#dialog-template").html())})})}),!function(t){"function"==typeof define&&define.amd?define("maskedinput",["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){var e,n=navigator.userAgent,i=/iphone/i.test(n),o=/chrome/i.test(n),s=/android/i.test(n);t.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]",X:"[A-Fa-f0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},t.fn.extend({caret:function(t,e){var n;return 0===this.length||this.is(":hidden")?void 0:"number"==typeof t?(e="number"==typeof e?e:t,this.each(function(){this.setSelectionRange?this.setSelectionRange(t,e):this.createTextRange&&(n=this.createTextRange(),n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",t),n.select())})):(this[0].setSelectionRange?(t=this[0].selectionStart,e=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),t=0-n.duplicate().moveStart("character",-1e5),e=t+n.text.length),{begin:t,end:e})},unmask:function(){return this.trigger("unmask")},mask:function(n,a){var r,l,c,u,d,h,p,f;if(!n&&this.length>0){r=t(this[0]);var g=r.data(t.mask.dataName);return g?g():void 0}return a=t.extend({autoclear:t.mask.autoclear,placeholder:t.mask.placeholder,completed:null},a),l=t.mask.definitions,c=[],u=p=n.length,d=null,t.each(n.split(""),function(t,e){"?"==e?(p--,u=t):l[e]?(c.push(new RegExp(l[e])),null===d&&(d=c.length-1),u>t&&(h=c.length-1)):c.push(null)}),this.trigger("unmask").each(function(){function r(){if(a.completed){for(var t=d;h>=t;t++)if(c[t]&&I[t]===g(t))return;a.completed.call(k)}}function g(t){return a.placeholder.charAt(t<a.placeholder.length?t:0)}function m(t){for(;++t<p&&!c[t];);return t}function v(t){for(;--t>=0&&!c[t];);return t}function b(t,e){var n,i;if(!(0>t)){for(n=t,i=m(e);p>n;n++)if(c[n]){if(!(p>i&&c[n].test(I[i])))break;I[n]=I[i],I[i]=g(i),i=m(i)}T(),k.caret(Math.max(d,t))}}function y(t){var e,n,i,o;for(e=t,n=g(t);p>e;e++)if(c[e]){if(i=m(e),o=I[e],I[e]=n,!(p>i&&c[i].test(o)))break;n=o}}function w(){var t=k.val(),e=k.caret();if(t.length<f.length){for(D(!0);e.begin>0&&!c[e.begin-1];)e.begin--;if(0===e.begin)for(;e.begin<d&&!c[e.begin];)e.begin++;k.caret(e.begin,e.begin)}else{for(D(!0);e.begin<p&&!c[e.begin];)e.begin++;k.caret(e.begin,e.begin)}r()}function _(){D(),k.val()!=L&&k.change()}function x(t){if(!k.prop("readonly")){var e,n,o,s=t.which||t.keyCode;f=k.val(),8===s||46===s||i&&127===s?(e=k.caret(),n=e.begin,o=e.end,o-n===0&&(n=46!==s?v(n):o=m(n-1),o=46===s?m(o):o),S(n,o),b(n,o-1),t.preventDefault()):13===s?_.call(this,t):27===s&&(k.val(L),k.caret(0,D()),t.preventDefault())}}function C(e){if(!k.prop("readonly")){var n,i,o,a=e.which||e.keyCode,l=k.caret();if(!(e.ctrlKey||e.altKey||e.metaKey||32>a)&&a&&13!==a){if(l.end-l.begin!==0&&(S(l.begin,l.end),b(l.begin,l.end-1)),n=m(l.begin-1),p>n&&(i=String.fromCharCode(a),c[n].test(i))){if(y(n),I[n]=i,T(),o=m(n),s){var u=function(){t.proxy(t.fn.caret,k,o)()};setTimeout(u,0)}else k.caret(o);l.begin<=h&&r()}e.preventDefault()}}}function S(t,e){var n;for(n=t;e>n&&p>n;n++)c[n]&&(I[n]=g(n))}function T(){k.val(I.join(""))}function D(t){var e,n,i,o=k.val(),s=-1;for(e=0,i=0;p>e;e++)if(c[e]){for(I[e]=g(e);i++<o.length;)if(n=o.charAt(i-1),c[e].test(n)){I[e]=n,s=e;break}if(i>o.length){S(e+1,p);break}}else I[e]===o.charAt(i)&&i++,u>e&&(s=e);return t?T():u>s+1?a.autoclear||I.join("")===M?(k.val()&&k.val(""),S(0,p)):T():(T(),k.val(k.val().substring(0,s+1))),u?e:d}var k=t(this),I=t.map(n.split(""),function(t,e){return"?"!=t?l[t]?g(e):t:void 0}),M=I.join(""),L=k.val();k.data(t.mask.dataName,function(){return t.map(I,function(t,e){return c[e]&&t!=g(e)?t:null}).join("")}),k.one("unmask",function(){k.off(".mask").removeData(t.mask.dataName)}).on("focus.mask",function(){if(!k.prop("readonly")){clearTimeout(e);var t;L=k.val(),t=D(),e=setTimeout(function(){T(),t==n.replace("?","").length?k.caret(0,t):k.caret(t)},10)}}).on("blur.mask",_).on("keydown.mask",x).on("keypress.mask",C).on("input.mask paste.mask",function(){k.prop("readonly")||setTimeout(function(){var t=D(!0);k.caret(t),r()},0)}),o&&s&&k.off("input.mask").on("input.mask",w),D()})}})}),define("its-node-map",["wifidevice","util","bootbox","jquery"],function(t,e,n,i){"use strict";function o(t){k(),V=t,H=t.$el,z();var e={zoom:2,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.SATELLITE,tilt:0,scaleControl:!0,mapTypeControlOptions:{mapTypeIds:["Floorplan",google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE]}};B=new google.maps.Map(document.getElementsByClassName(t.mapDivClass)[0],e),B.mapTypes.set("Floorplan",ae),U=new google.maps.InfoWindow,google.maps.event.addListener(U,"closeclick",function(){_()}),google.maps.event.addListener(U,"domready",function(){x()}),google.maps.event.addListenerOnce(B,"click",function(t){w(t.latLng)}),i(window).bind("map:fullscreen",function(){google.maps.event.trigger(B,"resize")}),R()}function s(n){var i,o,s,a,r={};for(a in q)q[a].setMap(null);for(q={},s=n.length,i=0;s>i;i++)o=new t(n[i],t.NODE_TYPE),o.hasLocation()&&(r=new MarkerWithLabel({title:o.getMarkerTitle(),icon:o.getMarkerIcon(),position:o.getLatLng(),draggable:se,clickable:se,raiseOnDrag:!0,map:B,labelContent:o.getMarkerLabelContent(),labelAnchor:new google.maps.Point(-15,20),labelClass:"marker_label",labelStyle:{opacity:.9}}),r._wifiNode=o,q[n[i].mac]=r,se&&(google.maps.event.addListener(r,"click",function(){b(this)}),google.maps.event.addListener(r,"dragend",function(){y(this)})));te=e.repositionMap(B,n),m()}function a(t){{var n;t.length}n=e.sortLevels(t),F().html(e.getLevelsAsHtmlOptions(n)),r(J)}function r(t){F().val(t)}function l(t){Y=t,I()}function c(t,e){q[t]&&(q[t]._wifiNode.setLevelId(e),m())}function u(t,e){te||d(t,e)}function d(t,e){B.setCenter(t),B.setZoom(e),$=t}function h(){te=!1}function p(){B&&google.maps.event.trigger(B,"resize")}function f(t){ne=t}function g(t){ie=t}function m(){var t,e,n,i;for(t in q)n=q[t],e=!1,i=!1,n._wifiNode&&n._wifiNode.getLevelId()==J&&(e=!0),n.getVisible()!==e&&(n.setVisible(e),i=!0),i&&n.setMap(B)}function v(t){oe=t}function b(t){(!X||t===X||G)&&(X=t,L(t))}function y(t){var e;X=t,e=t._wifiNode.getInfoWndDiv(!0,t.getPosition()),N(e),U.open(B,t)}function w(e){var n,i;V.canWrite()&&null==X&&(i="Unsaved Node"+Z,Z+=1,n=new MarkerWithLabel({title:i,icon:t.getDefaultIcon(),position:e,draggable:!0,raiseOnDrag:!0,map:B,labelContent:i,labelAnchor:new google.maps.Point(-20,25),labelClass:"marker_label",labelStyle:{opacity:.9}}),n._wifiNode=new t({mac:null,loc:{lat:e.lat().toFixed(6),lng:e.lng().toFixed(6)}},t.NODE_TYPE),google.maps.event.addListener(n,"click",function(){b(this)}),google.maps.event.addListener(n,"dragend",function(){y(this)}),X=n,b(n))}function _(){O(!0)}function x(){var t=A(),n=t.find("#infownd_save"),i=t.find("#infownd_delete");ee=new e.AjaxSpinner(t.find("#infownd_spinner"),"Saved"),G=!P(X,t),n.attr("disabled",G),t.find("input:text").unbind("keyup").keyup(function(){G=!P(X,t),n.attr("disabled",G)}),"text"===t.find("#mac").attr("type")&&t.find("#mac").mask("XX:XX:XX:XX:XX:XX"),n.unbind("click").click(C),i.unbind("click").click(S)}function C(){function n(){ee.stopSuccess(),X._wifiNode=new t(o,t.NODE_TYPE),X.set("labelContent",X._wifiNode.getMarkerLabelContent()),q[o.mac]=X,G=!0,X=null,U.close()}function i(){ee.stopError()}var o,s=e,a=A(),r=s.getValue(a.find("#mac")),l=s.getValue(a.find("#name")),c=s.getValue(a.find("#desc")),u=s.getValue(a.find("#latlng")),d=u.split(",")[0].trim(),h=u.split(",")[1].trim(),p=s.getValue(a.find("#alt"));return log.debug("OnSave "+r),r=s.validateMac(r),null===r?void ee.stopError("Invalid MAC address"):(p=s.validateAlt(p),null===p?void ee.stopError("Invalid value for node altitude"):(o={mac:r,name:l,desc:c,loc:{lat:d,lng:h,alt:p,levelId:J}},ee.start(),void V.saveFn(o,n,i)))}function S(){function t(){ee.stopSuccess(),X.setMap(null),delete q[n],X=null,U.close()}function e(){ee.stopError()}var n=X._wifiNode.getMac();if(log.debug("OnDelete "+n),null!=X&&null!=X._wifiNode){if(null==X._wifiNode.getMac())return void O(!1,!0);ee.start(),V.deleteFn(n,t,e)}}function T(t){J=t,m(),I()}function D(t){se=t,t?google.maps.event.addListenerOnce(B,"click",function(t){w(t.latLng)}):google.maps.event.clearListeners(B,"click")}function k(){V=null,B=null,H=null,W=null,$=null,q={},U=null,X=null,G=!1,J=0,Y=[],K={},Q=[],Z=0,te=!1,ee=null,ne=null,ie=null,oe=null,se=!0,ae=null}function I(){var t,e,n,i,o,s=!0,a=Q.length,r=[],l={};for(t=0;a>t;t++)e=Q[t],i=s,i=i&&e._fpObj.levelId==J,i=i&&-1!=M(e._fpObj.fpId),i?(r.push(e),l[e._fpObj.fpId]=!0):e._kmlLayer.setMap(null);for(o=Y?Y.length:0,t=0;o>t;t++)n=Y[t],i=s,i=i&&n.levelId==J,i=i&&!l[n.fpId],i&&(e=K[n.fpId],e||(e={},e._fpObj=n,e._kmlLayer=new google.maps.KmlLayer(n.kmlAligned,{suppressInfoWindows:!0,preserveViewport:!0,clickable:!1}),K[n.fpId]=e),e._kmlLayer.setMap(B),r.push(e));Q=r}function M(t){var e,n;if(!Y)return-1;for(n=Y.length,e=0;n>e;e++)if(Y[e].fpId==t)return e;return-1}function L(t){j(t),U.setOptions({maxWidth:500}),U.open(B,t)}function j(t){N(t._wifiNode.getInfoWndDiv(!0,t.getPosition()))}function N(t){var e=E(t),n=i("<dummy></dummy>").append(e).html();U.setContent(n)}function E(t){var e;return e=i('<div><label>&nbsp;</label><button id="infownd_delete" class="btn btn-alt btn-xs btn-warning"><i class="fa fa-trash-o"></i> Delete Node</button><button id="infownd_save" class="btn btn-alt btn-xs btn-primary"><i class="fa fa-save"></i> Save</button></div>'),t.append(e),e=i("<div></div>").append("<label>&nbsp;</label>").append('<span class="ajax_spinner" id="infownd_spinner"><img src="img/loading.gif" alt="processing"><span class="ajax_msg">&nbsp;</span></span>'),t.append(e),t}function O(e,i){function o(){null!=X._wifiNode.getMac()?X.setPosition(X._wifiNode.getLatLng()):X.setMap(null),X=null}var s=A();X&&!G?0==e?o():n.confirm("Discard changes?",function(e){e?o():(N(t.infoWndContentToDiv(s)),U.open(B,X))}):X=null,i&&U.close()}function A(){return i("#infownd_edit_div")}function P(t,e){return t._wifiNode.hasChanged(e)}function R(){var t,e,n,o,s,a=[];for(o=i('<select id="node_map_level_selector" class="map_level_selector"></select>'),e=0;10>e;e++)a.push('<option value="'+e+'" >'+e+"</option>");o.html(a.join("")),n=i("<dummy></dummy>").append(o),s=n.html(),t=document.createElement("DIV"),t.innerHTML=s,t.index=1,B.controls[google.maps.ControlPosition.TOP_RIGHT].push(t),H.on("change","#node_map_level_selector",function(){log.debug("change level"),T(i(this).val())})}function F(){return H.find("#node_map_level_selector")}function z(){function t(){}t.prototype.tileSize=new google.maps.Size(256,256),t.prototype.maxZoom=25,t.prototype.getTile=function(t,e,n){var i=n.createElement("div");return i.innerHTML="&copy; Navizon Inc",i.style.width=this.tileSize.width+"px",i.style.height=this.tileSize.height+"px",i.style.fontSize="12px",i.style.borderWidth="0px",i.style.borderColor="#494949",i.style.backgroundColor="#494949",i},t.prototype.name="Floor plan",t.prototype.alt="Floor plan Map Type",ae=new t}var V=null,B=null,H=null,W=null,$=null,q={},U=null,X=null,G=!1,J=0,Y=[],K={},Q=[],Z=0,te=!1,ee=null,ne=null,ie=null,oe=null,se=!0,ae=null;return{init:o,setNodes:s,setLevels:a,setCurrentLevel:r,setNodeLevel:c,resizeMap:p,setDefaultLocation:u,autoRepositionOnce:h,repositionMap:d,setNodeChangedListener:f,setNodeDeletedListener:g,setLevelChangedListener:v,refreshMarkers:m,setFloorplans:l,enableEditing:D}}),define("its/nodes/nodes_controller",["app","common/server","common/entities","common/common_views","its/nodes/nodes_views","bootbox","its-node-map"],function(t,e,n,i,o,s,a){"use strict";function r(t){f.openEditDialog(t,{renderParams:{levels:h.toJSON()}},function(t){t.get("loc");d.get(t.id).set(t.pick("name","desc","loc"))})}function l(t){f.openDeleteDialog(t,{renderParams:{levels:h.toJSON()}},function(t){console.dir(t)})}function c(e,i,o){var s=d.get(e.mac),a=!1;s||(s=new n.NodeModel(e),a=!0),s.set(e),s.save().success(function(){i(),a&&d.add(s)}).error(function(){o(),t.vent.trigger("error:show")})}function u(e,n,i){var o=d.get(e);o&&o.destroy().success(n).error(function(){i(),t.vent.trigger("error:show")})}var d,h,p,f,g,m;return i.EditController.extend({initialize:function(){log.info("Nodes Controller initialized"),this.DialogViewClass=o.ModalView,f=this},show:function(){d=new n.NodeCollection,h=new n.LevelCollection,p=new n.FloorplanCollection,g=new o.MainView({}),m=new o.NodeTableView({collection:d}),h.on("reset",function(){a.setLevels(this.toJSON())}),p.on("reset",function(){a.setFloorplans(this.toJSON())}),d.on("reset change",function(){a.setNodes(this.toJSON())}),g.on("show",function(){g.nodeTable.show(m),m.on("edit",r),m.on("delete",l),a.init({$el:this.$el,mapDivClass:"gmap",canWrite:function(){return!0},saveFn:c,deleteFn:u}),setTimeout(function(){h.fetch({reset:!0}),p.fetch({reset:!0}),d.fetch({reset:!0})},1e3)}),t.main.show(g)}})}),define("text!its/devices/devices_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="its_devices_template">\n\n    <!-- Known Stations -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Known</strong> devices</h2>\n            <div class="block-options pull-right">\n                <a id="refresh_known" href="javascript:void(0)" class="btn btn-alt btn-sm btn-default" data-toggle="tooltip" title="" data-original-title="Refresh"><i class="fa fa-refresh"></i></a>\n            </div>\n        </div>\n        <!-- Name a device button -->\n        <div class="row">\n            <div class="col-lg-12">\n                <div class="form-group">\n                    <button type="button" class="btn btn-primary js-register"><i class="fa fa-plus-circle"></i>&nbsp;Add Device&nbsp;</button>\n                </div>\n            </div>\n        </div>\n        <!-- Table -->\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="known_sta_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n\n    <!--Other Stations-->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Other</strong> devices</h2>\n            <div class="block-options pull-right">\n                <a id="refresh_other" href="javascript:void(0)" class="btn btn-alt btn-sm btn-default" data-toggle="tooltip" title="" data-original-title="Refresh"><i class="fa fa-refresh"></i></a>\n            </div>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="other_sta_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n</script>\n\n<!--known sta table-->\n<script type="text/x-template" id="known_sta_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Name </th>\n            <th> MAC </th>\n            <th> Mfr/Type </th>\n            <th> Desc </th>\n            <th> Last Seen </th>\n            <th> Action</th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!--Other sta table-->\n<script type="text/x-template" id="other_sta_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Mac </th>\n            <th> Mfr/Type </th>\n            <th> Last Seen </th>\n            <th> Action</th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody></table>\n</script>\n\n<!-- Dialog for Add, Edit, Delete operations -->\n<script type="text/x-template" id="modal-view-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <% if(type === \'new\') { %>\n                        <h4 class="modal-title">Register Device</h4>\n                    <% } else if (type === \'delete\'){ %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= name %>?</h4>\n                    <% } else { %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= name %></h4>\n                    <% } %>\n                </div>\n\n                <div class="modal-body">\n\n                    <form class="form-horizontal">\n                        <!-- MAC Address -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">MAC</label>\n                            <div class="col-md-4">\n                                <% if (type === \'new\') {%>\n                                    <input name="mac" value="" class="form-control" placeholder="MAC Address">\n                                <% } else { %>\n                                    <p name="mac" class="form-control-static"><%= mac %></p>\n                                <% } %>\n                            </div>\n                        </div>\n\n                        <!-- Name -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Name</label>\n                            <div class="col-md-9">\n                                <% if (type === \'new\' || type === \'edit\') {%>\n                                    <input name="name" value="" class="form-control" placeholder="Name">\n                                <% } else { %>\n                                    <p class="form-control-static"><%= name %></p>\n                                <% } %>\n                            </div>\n                        </div>\n\n                        <!-- Desc -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Description</label>\n                            <div class="col-md-9">\n                                <% if (type === \'new\' || type === \'edit\') {%>\n                                    <input name="desc" value="" class="form-control" placeholder="Description">\n                                <% } else { %>\n                                    <p class="form-control-static"><%= desc %></p>\n                                <% } %>\n                            </div>\n                        </div>\n\n                    </form>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <% if (type === \'delete\') { %>\n                        <button type="button" class="btn btn-warning js-submit"><i class="fa fa-trash-o"></i> Delete Device</button>\n                    <% } else { %>\n                        <button type="button" class="btn btn-primary js-submit"><i class="fa fa-save"></i> Save</button>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n'}),define("its/devices/devices_view",["app","common/common_views","text!its/devices/devices_templates.html","ouiresolver"],function(t,e,n,i){return t.module("Its.Devices",function(t,o,s,a,r,l){t.addInitializer(function(){i.init()}),t.MainView=a.LayoutView.extend({template:l.template(r(n).filter("#its_devices_template").html()),triggers:{"click button.js-register":"device:new","click #refresh_known":"refresh","click #refresh_other":"refresh"},regions:{knownStas:"#known_sta_table",otherStas:"#other_sta_table"}}),t.KnownStaTableView=e.DatatableView.extend({template:l.template(r(n).filter("#known_sta_table_template").html()),columns:[e.DatatableView.getColumn("name"),e.DatatableView.getColumn("id","mac"),e.DatatableView.getColumn("mfr"),e.DatatableView.getColumn("desc"),e.DatatableView.getColumn("lrrt"),e.DatatableView.getButtonColumn("mac",["edit","delete"])]}),t.OtherStaTableView=e.DatatableView.extend({template:l.template(r(n).filter("#other_sta_table_template").html()),columns:[e.DatatableView.getColumn("id","mac"),e.DatatableView.getColumn("mfr"),e.DatatableView.getColumn("lrrt"),e.DatatableView.getButtonColumn("mac",["edit"])]}),t.ModalView=e.EditDialogView.extend({template:l.template(r(n).filter("#modal-view-template").html()),validationParams:{rules:{mac:{required:!0}}},onShow:function(){e.EditDialogView.prototype.onShow.apply(this,[]),"new"===this.type&&this.$el.find('input[name="mac"]').mask("**:**:**:**:**:**")}})})}),define("its/devices/devices_controller",["app","common/entities","common/common_views","its/devices/devices_view"],function(t,e,n,i){return n.EditController.extend({initialize:function(){log.info("Devices Controller initialized"),this.DialogViewClass=i.ModalView},show:function(){function n(){l()}function o(){c.openNewDialog(new e.StationModel,{},function(t){h.add(t),p.get(t.id)&&p["delete"](t.id)
})}function s(t){c.openEditDialog(t,{},function(e){t.set(e.pick("name","desc"))})}function a(t){c.openDeleteDialog(t,{},function(t){h.remove(t.id)})}function r(t){c.openEditDialog(t,{},function(t){h.add(t),p.remove(t)})}function l(n){var i=new e.StationCollection,o=new e.StationCollection;d=t.reqres.request("all_stations:entities"),$.when(d.fetch()).done(function(){d.each(function(t){null===t.get("name")?o.add(t):i.add(t)}),h.reset(i.toArray()),p.reset(o.toArray()),n&&n()})}var c=this,u=new i.MainView({}),d=new e.StationCollection,h=new e.StationCollection,p=new e.StationCollection,f=new i.KnownStaTableView({collection:h}),g=new i.OtherStaTableView({collection:p});u.on("show",function(){u.knownStas.show(f),u.otherStas.show(g),f.on("edit",s),f.on("delete",a),g.on("edit",r),u.on("device:new",o),u.on("refresh",n)}),t.main.show(u),l()}})}),define("text!its/settings/its_settings_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="its_settings_template">\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Wi-Fi Location Monitor</strong> Settings</h2>\n        </div>\n\n        <div class="row">\n            <div class="col-xs-6">\n                <form class="form-horizontal">\n\n                    <!-- Report Frequency -->\n                    <div class="form-group">\n                        <label class="col-md-3 control-label">Report Frequency</label>\n                        <div class="col-md-9">\n                            <select name="reportPeriod" value="<%= reportPeriod %>" class="form-control" disabled="">\n                                <option value="5000">5 sec</option>\n                                <option value="10000">10 sec</option>\n                                <option value="15000">15 sec</option>\n                                <option value="30000">30 sec</option>\n                                <option value="60000">60 sec</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <!-- Node Type -->\n                    <div class="form-group">\n                        <label class="col-md-3 control-label">Node Type</label>\n                        <div class="col-md-9">\n                            <select name="nodeType" value="<%= nodeType %>" class="form-control" disabled="">\n                                <option value="OM1P">OM1P</option>\n                                <option value="OM2P">OM2P</option>\n                                <option value="OM2P-LC">OM2P-LC</option>\n                                <option value="OM2P-HS">OM2P-HS</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <!-- RSS Model -->\n                    <div class="form-group">\n                        <label class="col-md-3 control-label">RSS Model</label>\n                        <div class="col-md-9">\n                            <select name="rssModel" value="<%= rssModel %>" class="form-control">\n                                <option value="auto">Auto</option>\n                                <option value="linear">Linear</option>\n                                <option value="log">Logarithmic</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <!-- Noise Reduction -->\n                    <div class="form-group">\n                        <label class="col-md-3 control-label">Noise Reduction</label>\n                        <div class="col-md-9">\n                            <select name="posFilter" value="<%= posFilter %>" class="form-control">\n                                <option value="none">None</option>\n                                <option value="low">Low</option>\n                                <option value="medium">Medium</option>\n                                <option value="high">High</option>\n                            </select>\n                        </div>\n                    </div>\n                </form>\n                <div class="row">\n                    <label class="col-md-3 control-label"></label>\n                    <div class="col-md-9">\n                        <button type="button" class="btn btn-primary js-submit pull-right"><i class="fa fa-save"></i> Save</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>'}),define("its/settings/its_settings_controller",["app","common/entities","text!its/settings/its_settings_templates.html","syphon"],function(t,e,n){var i=Marionette.ItemView.extend({template:_.template($(n).filter("#its_settings_template").html()),modelEvents:{change:function(){Backbone.Syphon.deserialize(this,this.model.toJSON())}},ui:{submitButton:"button.js-submit"},triggers:{"click @ui.submitButton":"save"}});return Marionette.Controller.extend({initialize:function(){log.info("Its Settings Controller initialized")},show:function(){var n=new e.SiteSettingModel,o=new i({model:n});o.on("save",function(){n.set(Backbone.Syphon.serialize(this)),n.save().success(function(){o.ui.submitButton.addClass("btn-success"),setTimeout(function(){o.ui.submitButton.removeClass("btn-success")},1e3)})}),t.main.show(o),n.fetch()}})}),define("text!its/cloudtrax/cloudtrax_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="cloudtrax_template">\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>CloudTrax</strong></h2>\n        </div>\n        <p></p>\n        <iframe width="100%" height="600px" frameborder="no" scrolling="no"></iframe>\n    </div>\n</script>'}),define("its/cloudtrax/cloudtrax_controller",["app","common/entities","text!its/cloudtrax/cloudtrax_templates.html","syphon"],function(t,e,n){var i="//www.cloudtrax.com/map.php?id=",o=Marionette.ItemView.extend({template:_.template($(n).filter("#cloudtrax_template").html()),ui:{iframe:"iframe",msg:"p"},modelEvents:{change:function(){var t=this.model.get("cloudtrax_network");t?(this.ui.msg.html("Showing Cloudtrax dashboard for account <strong>"+t+"</strong>"),this.ui.iframe.attr("src",i+t)):this.ui.msg.text("Sorry, no Cloudtrax information available for this site"),log.debug("model changed"),log.debug(this.model)}}});return Marionette.Controller.extend({initialize:function(){log.info("Its Cloudtrax Controller initialized")},show:function(){var n=new e.SiteModel,i=new o({model:n});t.main.show(i),n.fetch()}})}),define("its/its_app",["app","common/server","general/login/login_controller","its/map/its_map_controller","its/nodes/nodes_controller","its/devices/devices_controller","its/settings/its_settings_controller","its/cloudtrax/cloudtrax_controller"],function(t,e,n,i,o,s,a,r){return t.module("ItsApp",function(t,l,c,u){function d(){if(e.isLoggedIn())return!0;var t=c.history.fragment;return c.history.navigate("#login"),n.Controller.show(t),!1}var h=new i,p=new s,f=new o,g=new a,m=new r;t.Router=u.AppRouter.extend({appRoutes:{"wifitrack/map":"showMap","wifitrack/nodes":"showNodes","wifitrack/devices":"showDevices","wifitrack/settings":"showSettings","wifitrack/cloudtrax":"showCloudtrax"}});var v={showMap:function(){d()&&h.show()},showNodes:function(){d()&&f.show()},showDevices:function(){d()&&p.show()},showSettings:function(){d()&&g.show()},showCloudtrax:function(){d()&&m.show()}};l.addInitializer(function(){log.info("ItsApp Router initialized"),new t.Router({controller:v})})})}),define("text!indoors/training/indoors_training_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="indoors_training_main_view_template">\n\n    <!-- Navizon Indoors Main View -->\n    <div class="block full">\n        <div class="block-title">\n            <h4><strong>Indoors</strong> Training </h4>\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n                <a id="refresh_known" href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary" data-toggle="tooltip" title="" data-original-title="Refresh"><i class="fa fa-refresh"></i></a>\n            </div>\n        </div>\n        <div class="block block-gmap">\n            <div class="gmap">\n                <!-- Google map goes here -->\n            </div>\n        </div>\n    </div>\n\n    <!-- Fingerprints: Table View -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Devices</strong></h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="fingerprints_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Devices used for fingerprinting -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Devices used for fingerprinting</strong></h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="usedDevices"></div>\n            </div>\n        </div>\n    </div>\n\n</script>\n\n<!-- Fingerprints Table-->\n<script type="text/x-template" id="indoors_training_table_template">\n    <table>\n        <thead>\n            <tr>\n                <th> Mac </th>\n                <th> Mfr </th>\n                <th> Max </th>\n                <th> Min </th>\n                <th> Delta </th>\n                <th> Points </th>\n                <th> Show </th>\n            </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Dialog for Add, Edit, Delete operations -->\n<script type="text/x-template" id="dialog-template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <h4 class="modal-title">Delete</h4>\n                </div>\n\n                <div class="modal-body">\n                    <h5>Are you sure you want to delete these fingerprints/routes?</h5>\n                </div>\n\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">No</button>\n                    <button type="button" class="btn btn-primary js-submit">Yes</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>'}),define("indoors/training/indoors_training_views",["app","common/common_views","bootbox","text!indoors/training/indoors_training_templates.html"],function(t,e,n,i){return t.module("Indoors.Training",function(t,o,s,a,r,l){function c(t,e,n,i,o,s){var a=document.createElement("div");a.style["float"]="left",a.style.color="#333",a.style.fontWeight="lighter";var r=document.createElement("button");r.className="menuButton",r.style.cursor="pointer",r.style.padding="0px",r.style.backgroundColor="white",r.style["float"]="left",r.style.minWidth="30px",r.style.height="34px",r.style.textAlign="center",r.style.border="0",r.style.borderRight="1px solid #ccc",r.title=e,a.appendChild(r);var l=document.createElement("div");if(l.style.fontFamily="Roboto,Arial,sans-serif",l.style.fontSize="16px",l.style.lineHeight="30px",l.style.paddingLeft="5px",l.style.paddingRight="5px",l.style.padding="0px 10px",void 0!=s){var c=document.createElement("i");c.className=s,r.style.opacity="0.6",l.appendChild(c)}else l.innerHTML=t;return r.appendChild(l),r.addEventListener("click",o),n&&(r.style.cursor="pointer",r.addEventListener("mouseover",function(){r.style.backgroundColor="rgb(225, 240, 255)"}),r.addEventListener("mouseout",function(){r.style.backgroundColor="white"})),a.index=i,{controlDiv:a,UI:r,text:l}}function u(t,e){var n=r(t);e?(n.removeAttr("disabled"),n.css("background-color","white")):(n.attr("disabled","disabled"),n.css("background-color",ae))}function d(t){var e=ce.getGridSize()-Z;K>e&&(e=K),t.setAttInLocalStorage("tolerance",e),console.log(e),ce.setGridSize(e),ce.repaint(),g(ce.getGridSize().toFixed(0))}function h(t){var e=ce.getGridSize()+Z;e>Q&&(e=Q),t.setAttInLocalStorage("tolerance",e),ce.setGridSize(e),ce.repaint(),g(ce.getGridSize().toFixed(0))}function p(){de-=se,ie>de&&(de=ie)}function f(){de+=se,de>oe&&(de=oe)}function g(t){t.toString().length<2&&(t="0"+t),V.text.innerHTML="Tolerance: "+t}function m(t,e){t.controls[e].clear(),void 0!=he&&he.setMap(null),l.each(pe,function(t){t.overlay.setMap(null)}),pe=[]}function v(t,e){switch(e.type){case"rectangle":return e.overlay.getBounds().contains(t);case"circle":return e.overlay.getBounds().contains(t)&&google.maps.geometry.spherical.computeDistanceBetween(e.overlay.getCenter(),t)<=e.overlay.getRadius();case"polygon":return google.maps.geometry.poly.containsLocation(t,e.overlay);default:return!1}return!1}function b(){var t;q=l.reject(q,function(e){return t=!1,l.each(pe,function(n){v(new google.maps.LatLng(e.position.lat(),e.position.lng()),n)&&(t=!0)}),t||e.setIcon(A(e.rss,!1)),0==t})}function y(){U=l.reject(U,function(t){return void 0==t.isInShape})}function w(t){z=document.createElement("div");var e=c(" - ","Decrease tolerance",!0,1,function(){d(t)});e.UI.style.marginLeft="10px",z.appendChild(e.controlDiv),V=c("Tolerance: 00","",!1,1,function(){}),z.appendChild(V.controlDiv),z.appendChild(c(" + ","Increase tolerance",!0,1,function(){h(t)}).controlDiv),R.appendChild(z)}function _(t){var e=[{value:"Floorplan",text:"Floorplan"},{value:google.maps.MapTypeId.ROADMAP,text:"Map"},{value:google.maps.MapTypeId.SATELLITE,text:"Satellite"}],n=document.createElement("select");n.className="menuButton",n.style["float"]="left",n.style.height="34px",n.style.marginRight="10px",n.addEventListener("change",function(){t.setMapTypeId(r(this).val())});for(var i,o=0;o<e.length;o++)i=document.createElement("option"),i.value=e[o].value,i.text=e[o].text,i.selected=i.value==t.getMapTypeId()?!0:!1,n.appendChild(i);R.appendChild(n)}function x(t){t.controls[google.maps.ControlPosition.BOTTOM_LEFT].clear(),X=document.createElement("div"),X.style.backgroundColor="rgba(255, 255, 255, 0.8)",X.style.marginLeft="16px",X.style.padding="5px",t.controls[google.maps.ControlPosition.BOTTOM_LEFT].push(X);var e=document.createElement("div");e.innerHTML="Weak Signals",e.style["float"]="left",X.appendChild(e);var n=document.createElement("div");n.style["float"]="left",n.style.width="100px",n.style.borderRadius="20px",n.style.height="15px",n.style.margin="0 5px";var i=["rgb("+G[0][0]+","+G[0][1]+","+G[0][2]+")","rgb("+G[G.length/4][0]+","+G[G.length/4][1]+","+G[G.length/4][2]+")","rgb("+G[G.length/2][0]+","+G[G.length/2][1]+","+G[G.length/2][2]+")","rgb("+G[G.length/4*3][0]+","+G[G.length/4*3][1]+","+G[G.length/4*3][2]+")","rgb("+G[G.length-1][0]+","+G[G.length-1][1]+","+G[G.length-1][2]+")"];n.style.background="-moz-linear-gradient(left,"+i[0]+" 0%, "+i[1]+" 25%, "+i[2]+" 50%, "+i[3]+" 75%, "+i[4]+" 100%)",n.style.background="-webkit-linear-gradient(left, "+i[0]+" 0%, "+i[1]+" 25%, "+i[2]+" 50%, "+i[3]+" 75%, "+i[4]+" 100%)",n.style.background="linear-gradient(to right, "+i[0]+" 0%, "+i[1]+" 25%, "+i[2]+" 50%, "+i[3]+" 75%, "+i[4]+" 100%)",n.style.filter="progid:DXImageTransform.Microsoft.gradient( startColorstr='"+i[0]+"', endColorstr='"+i[i.length-1]+"',GradientType=1 )",X.appendChild(n);var o=document.createElement("div");o.innerHTML="Strong Signals",o.style["float"]="left",X.appendChild(o)}function C(t){B.style.opacity="0.6",B=t,B.style.opacity="1"}function S(t,e,n){if(ge)l.each(re,function(e){v(new google.maps.LatLng(e.position.lat(),e.position.lng()),t)&&(q.push(e),e.setIcon(P(e.rss,!1)))});else{var i,o;l.each(e.models,function(e){for(i=e.get("waypoints"),o=0;o<i.length;o++)if(v(new google.maps.LatLng(i[o].lat,i[o].lng),t)){l.contains(U,e)||(e.isInShape=!0,U.push(e));break}}),n()}}function T(t,e,n){he=new google.maps.drawing.DrawingManager({drawingControl:!1}),google.maps.event.addListener(he,"overlaycomplete",function(t){pe.push({overlay:t.overlay,type:t.type}),he.setOptions({drawingMode:null}),fe=!0,C(H),u(".deleteMenuButton",!0),S({overlay:t.overlay,type:t.type},e,n)}),he.setMap(t);var i=document.createElement("div"),o=c("","Stop drawing",!0,1,function(){he.setOptions({drawingMode:null}),C(this),fe=!0},"fa fa-hand-rock-o");o.UI.style.marginLeft="10px",o.UI.style.opacity="1",H=o.UI,B=o.UI,i.appendChild(o.controlDiv),i.appendChild(c("","Draw circle",!0,1,function(){he.setOptions({drawingMode:google.maps.drawing.OverlayType.CIRCLE}),C(this),fe=!1},"fa fa-circle-thin").controlDiv),i.appendChild(c("","Draw polygon",!0,1,function(){he.setOptions({drawingMode:google.maps.drawing.OverlayType.POLYGON}),C(this),fe=!1},"fa fa-star-o").controlDiv),i.appendChild(c("","Draw rectangle",!0,1,function(){he.setOptions({drawingMode:google.maps.drawing.OverlayType.RECTANGLE}),C(this),fe=!1},"fa fa-square-o").controlDiv),R.appendChild(i)}function D(){var t=document.getElementById("system_map_level_selector");t.style["float"]="right",t.style.top="0px",t.style.height="34px",R.appendChild(t),$=document.createElement("span"),$.style["float"]="right",$.style.top="0px",$.style.height="34px",$.style.fontSize="14px",$.style.paddingTop="7px",$.style.marginRight="10px",$.innerHTML="0 fingerprint(s)",R.appendChild($)}function k(t){W=document.createElement("div");var e=c(" - ","Decrease line width",!0,1,function(){N(!1),p(),t.fetch({reset:!0})});e.UI.style.marginLeft="10px",W.appendChild(e.controlDiv),W.appendChild(c("Line width","",!1,1,function(){}).controlDiv),W.appendChild(c(" + ","Increase line width",!0,1,function(){N(!1),f(),t.fetch({reset:!0})}).controlDiv),R.appendChild(W)}function I(t){console.log("Deleting markers"),re=l.difference(re,q),ce.removeMarkers(q);var e=[];l.each(q,function(t){e.push({lat:t.position.lat(),lng:t.position.lng()})}),t(e),l.each(pe,function(t){t.overlay.setMap(null)}),pe=[],u(".deleteMenuButton",!1),console.log("Number of markers deleted: "+q.length),q=[]}function M(t){console.log("Deleting routes"),t(U,!1),l.each(pe,function(t){t.overlay.setMap(null)}),pe=[],u(".deleteMenuButton",!1),console.log("Number of routes deleted: "+U.length),U=[]}function L(t,e,i,o){var s;s={title:t,buttons:{ok:{label:"No",className:"btn btn-default",callback:o},next:{label:"Yes",className:"btn btn-primary",callback:i}}},s.message=e,n.dialog(s)}function j(t,e,n,i,o){fe=!0;var s=document.createElement("div"),a=c("Clear","Clear",!0,1,function(){l.each(q,function(t){t.setIcon(A(t.rss,!1))}),q=[],U=[],0==ge&&n(),l.each(pe,function(t){t.overlay.setMap(null)}),pe=[],u(".deleteMenuButton",!1)});a.UI.style.marginLeft="50px",a.UI.className="deleteMenuButton",s.appendChild(a.controlDiv);var r=c("Delete","Delete",!0,1,function(){var n="Are you sure you want to delete ";n+=ge?q.length+" fingerprint(s) ?":e(U,!0),L("Delete",n,function(){(0!=pe.length||0!=q.length||0!=U.length)&&(ge?I(t):M(e))},function(){})});r.UI.style.border="2px dotted red",r.UI.className="deleteMenuButton",s.appendChild(r.controlDiv);var d=c("Delete All","Delete All",!0,1,function(){L("Delete","Are you sure you want to delete all the fingerprints and the routes?",function(){L("Delete","This action cannot be undone, are you sure?",function(){l.each(pe,function(t){t.overlay.setMap(null)}),pe=[],re=[],ce.clearMarkers(),q=[],o(),U=[],l.each(i.models,function(t){U.push(t)}),M(e),u(".deleteMenuButton",!1)},function(){})},function(){})});d.UI.style.border="2px solid red",d.UI.style.borderLeft="0",s.appendChild(d.controlDiv),R.appendChild(s)}function N(t,e,n,i){$.innerHTML=void 0!=n&&null!=n?n+", "+i+" fingerprint(s)":i+" fingerprint(s)",t?(F.style.display="inline",u(".menuButton",!1),u("table input.js-check",!1)):(F.style.display="none",u(".menuButton",!0),u("table input.js-check",!0)),void 0!=e&&(e?(z.style.display="inline",W.style.display="none"):(z.style.display="none",W.style.display="inline"))}function E(){F=document.createElement("img"),F.src="./img/spin.gif",F.style.width="34px",F.style.height="34px",F.style.marginLeft="10px",R.appendChild(F)}function O(t){var e,n,i=G.length;return e=J>t?0:t>Y?i-1:Math.round((i-1)*(t-J)/(Y-J)),n=G[e],"rgb("+n[0]+", "+n[1]+", "+n[2]+")"}function A(t,e){var n={path:google.maps.SymbolPath.CIRCLE,fillColor:"white",fillOpacity:ee,scale:te,strokeColor:"black",strokeWeight:ne};return void 0!==t&&null!==t&&(n.fillColor=O(t)),e&&(n.fillColor="transparent"),n}function P(t,e){var n={path:google.maps.SymbolPath.CIRCLE,fillColor:"white",fillOpacity:ee,scale:te,strokeColor:"red",strokeWeight:2*ne};return void 0!==t&&null!==t&&(n.fillColor=O(t)),e&&(n.fillColor="transparent"),n}var R,F,z,V,B,H,W,$,q,U,X,G=[[0,0,143],[0,0,159],[0,0,175],[0,0,191],[0,0,207],[0,0,223],[0,0,239],[0,0,255],[0,16,255],[0,32,255],[0,48,255],[0,64,255],[0,80,255],[0,96,255],[0,112,255],[0,128,255],[0,143,255],[0,159,255],[0,175,255],[0,191,255],[0,207,255],[0,223,255],[0,239,255],[0,255,255],[16,255,239],[32,255,223],[48,255,207],[64,255,191],[80,255,175],[96,255,159],[112,255,143],[128,255,128],[143,255,112],[159,255,96],[175,255,80],[191,255,64],[207,255,48],[223,255,32],[239,255,16],[255,255,0],[255,239,0],[255,223,0],[255,207,0],[255,191,0],[255,175,0],[255,159,0],[255,143,0],[255,128,0],[255,112,0],[255,96,0],[255,80,0],[255,64,0],[255,48,0],[255,32,0],[255,16,0],[255,0,0],[239,0,0],[223,0,0],[207,0,0],[191,0,0],[175,0,0],[159,0,0],[143,0,0],[128,0,0]],J=-110,Y=-30,K=0,Q=30,Z=2,te=5,ee=1,ne=1,ie=1,oe=10,se=1,ae="rgb(225, 225, 225)",re=[],le=[],ce=void 0,ue=8,de=5,he=void 0,pe=[],fe=!0,ge=!0;t.addInitializer(function(){console.log("Indoors.Training initialized")}),t.MainView=a.LayoutView.extend({template:l.template(r(i).filter("#indoors_training_main_view_template").html()),regions:{fingerprintsTable:"#fingerprints_table"},behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}},triggers:{"click #refresh_known":"refresh"}}),t.TableView=e.DatatableView.extend({template:l.template(r(i).filter("#indoors_training_table_template").html()),columns:[e.DatatableView.getColumn("id","mac"),e.DatatableView.getColumn("mfr"),e.DatatableView.getColumn("id","maxRss"),e.DatatableView.getColumn("id","minRss"),{data:null,width:"120px",render:function(t){return Math.abs(t.maxRss-t.minRss)}},{data:null,width:"120px",render:function(t){return t.entries.length}},{data:null,orderable:!1,searchable:!1,width:"1px",render:function(t){return e.DatatableView.getHtmlForButtons([t.mac],0,"check")}}]}),t.MapView=e.FloorplanMap.extend({generateCluster:function(t){console.log("Number of markers: "+re.length);var e={styles:[{textColor:"white",url:"",height:10,width:10}]};ce=new MarkerClusterer(t,re,e),ce.setGridSize(ue),g(ce.getGridSize().toFixed(0)),ce.setZoomOnClick(!1)},updateCurrentSelectedLevelLabel:function(t){var e=r("#system_map_level_selector option:selected");if(e){var n=e.text();if(n){var i=n.split(",");i.length>0&&(i[i.length-1]=t),n="";for(var o=0;o<i.length;o++)n+=0==o?i[o]:","+i[o];e.text(n)}}},setTolerance:function(t){K>t&&(t=K),t>Q&&(t=Q),this.setAttInLocalStorage("tolerance",t),void 0!=ce&&(ce.setGridSize(t),ce.repaint(),g(ce.getGridSize().toFixed(0)))},disableMenu:function(t,e,n,i){N(t,e,n,i)},setMode:function(t){ge=t,l.each(q,function(t){t.setIcon(A(t.rss,!1))}),q=[],U=[],l.each(pe,function(t){t.overlay.setMap(null)}),pe=[],u(".deleteMenuButton",!1)},initMenu:function(t,e,n,i,o,s,a){if(void 0!=R){var l=document.getElementById("system_map_level_selector");document.body.appendChild(l)}void 0!=this.getAttFromLocalStorage("tolerance")&&(ue=this.getAttFromLocalStorage("tolerance")),this.map.setOptions({mapTypeControl:!1}),m(this.map,google.maps.ControlPosition.LEFT_TOP),R=document.createElement("div"),R.style.position="relative",R.style.display="inline",R.style.backgroundColor="rgba(255, 255, 255, 0.8)",R.style.borderRadius="5px",R.style.margin="1%",R.style.marginTop="7px",R.style.padding="5px 10px",R.style.width="98%",_(this.map);var l=document.createElement("select");l.className="menuButton",l.style["float"]="left",l.style.height="34px",l.addEventListener("change",function(){n(r(this).val())});for(var c,d=0;d<t.length;d++)c=document.createElement("option"),c.value=t[d].text,c.text=t[d].text,c.selected=t[d].selected,l.appendChild(c);R.appendChild(l),this.map.controls[google.maps.ControlPosition.LEFT_TOP].push(R),D(),w(this),k(e),T(this.map,e,s),j(i,o,s,e,a),E(),x(this.map),u(".deleteMenuButton",!1)},addMarker:function(t,e,n,i,o){var s=new google.maps.Marker({position:new google.maps.LatLng(t,e),title:n.toString(),station:i,icon:A(n,o),rss:n});re.push(s),google.maps.event.addListener(s,"click",function(t){if(fe)if(t.Qb.ctrlKey)l.contains(q,s)?(s.setIcon(A(s.rss,o)),q=l.without(q,s),0==q.length&&0==pe.length&&u(".deleteMenuButton",!1)):(s.setIcon(P(s.rss,o)),q.push(s),u(".deleteMenuButton",!0));else{var e=!1;l.each(pe,function(t){v(new google.maps.LatLng(s.position.lat(),s.position.lng()),t)&&(e=!0)}),0==e&&(b(),s.setIcon(P(s.rss,o)),q.push(s),u(".deleteMenuButton",!0))}})},deleteMarkers:function(){void 0!=ce&&ce.clearMarkers(),l.each(le,function(t){t.setMap(null)}),re=[],le=[]},addLine:function(t,e,n,i,o){if(i!=-1/0){var s=new google.maps.Polyline({path:n,geodesic:!0,strokeColor:O(i),strokeOpacity:.75,strokeWeight:de});l.contains(U,e)&&s.setOptions({strokeColor:"red",strokeWeight:de+4,strokeOpacity:1}),s.setMap(t),le.push(s),google.maps.event.addListener(s,"click",function(){fe&&(window.event.ctrlKey?(l.contains(U,e)?U=l.without(U,e):U.push(e),0==U.length&&0==pe.length?u(".deleteMenuButton",!1):u(".deleteMenuButton",!0)):(y(),l.contains(U,e)||U.push(e),u(".deleteMenuButton",!0)),o())})}}})})}),define("indoors/training/indoors_training_controller",["app","common/server","common/entities","common/common_views","indoors/training/indoors_training_views","ouiresolver"],function(t,e,n,i,o,s){"use strict";function a(t,e){var i,o,s,a,r,l,c,u,d,h=t.length;E=[],I={};var p=new n.Indoors.AccessPointCollection;for(i=0;h>i;i++){for(I[t[i].get("station")]?I[t[i].get("station")].count+=1:I[t[i].get("station")]={station:t[i].get("station"),count:1},a=t[i].get("lat"),r=t[i].get("lng"),c=-1/0,o=0,s=t[i].get("entries").length;s>o;o++)l=t[i].get("entries")[o].rss,p.addAccessPoint(t[i].get("entries")[o].ap,l,a,r),l>c&&(c=l);E.push({rss:c,lat:a,lng:r,time:t[i].get("time"),station:t[i].get("station")})}u=$("<ul>"),$.each(Object.keys(I),function(t,e){d="u"==I[e].station[0].toLowerCase()?"<i class='fa fa-apple'></i>":"n"==I[e].station[0].toLowerCase()?"<i class='fa fa-android'></i>":"",u.append($("<li>").append(d).append(sprintf(" %s, %s, %d fps",I[e].station,P.getCompanyName(e.slice(0,6)),I[e].count)))}),$("body").find("#usedDevices").html(u),e&&O.reset(p.models)}function r(t){0==t.checked?N=null:(null!=N&&$("input:checkbox[data-id!='"+t.id+"']").attr("checked",!1),N=t.id),R?(C.disableMenu(!0,!0,N,j.length),f(C.map,function(){C.disableMenu(!1,!0,N,j.length),C.setTolerance(0==t.checked?A:0)})):(C.disableMenu(!0,!1,N,j.length),b(C.map))}function l(){if(null==N)j=JSON.parse(JSON.stringify(E));else{var t=O.get(N);j=void 0==t?[]:JSON.parse(JSON.stringify(t.get("entries")))}}function c(t,n){if(!(t.length<=0)){var i=e.getResourceUrl("/levels/"+C.getLevelId()+"/fingerprints/?ids="+t);console.log("Delete fps request: "+i),$.ajax({url:i,type:"DELETE",success:function(t){n(),C.updateCurrentSelectedLevelLabel(" "+j.length+" fps"),console.log(t)}})}}function u(t){var e,n="",i=[];_.each(t,function(t){for(var o=0;o<T.models.length;o++)e=T.models[o],e.get("lat").toFixed(6)==t.lat.toFixed(6)&&e.get("lng").toFixed(6)==t.lng.toFixed(6)&&(void 0==e.get("id")||_.contains(i,e)||(n+=0==n.length?e.get("id").toString():","+e.get("id").toString(),i.push(e)))}),c(n,function(){T.remove(i),a(T.models,!0),l(),null!=N&&0==j.length&&(N=null),null!=N&&$("input:checkbox[data-id='"+N+"']").attr("checked",!0),f(C.map,function(){C.disableMenu(!1,!0,N,j.length)})})}function d(){for(var t="",e=0;e<T.models.length;e++)void 0!=T.models[e].get("id")&&(t+=0==t.length?T.models[e].get("id").toString():","+T.models[e].get("id").toString());c(t,function(){T.reset(),N=null,a(T.models,!0),l(),f(C.map,function(){C.disableMenu(!1,!0,N,T.length)})})}function h(t,e,n){var i,o=t.splice(-20,20);_.each(o,function(t){i=void 0!=t.station?t.station:N,C.addMarker(t.lat,t.lng,t.rss,i,n)}),setTimeout(function(){0==t.length?e():h(t,e,n)},1)}function p(t,e,n){_.each(j,function(t){e=_.reject(e,function(e){return google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(e.lat,e.lng),new google.maps.LatLng(t.lat,t.lng))<1})}),h(e,function(){n()},!0)}function f(t,e){console.log("Display the fingerprints"),margin30(),C.deleteMarkers(),C.disableMenu(!0,!0,N,j.length),j=JSON.parse(null==N?JSON.stringify(E):JSON.stringify(O.get(N).get("entries"))),console.time("displayMarkerTime"),h(JSON.parse(JSON.stringify(j)),function(){null!=N?p(t,JSON.parse(JSON.stringify(E)),function(){C.generateCluster(t,N),e()}):(C.generateCluster(t,N),e())},!1)}function g(t){if(void 0!=t.rss)return t.rss;var e,n=-1/0;if(E.length<=0)return n;for(;k<E.length;){if(e=new Date(E[k].time),!(e<new Date(t.time-M)))return e>new Date(t.time+M)?n:E[k].rss;k+=1}return n}function m(t,e){var n,i=1/0,o=-1/0,s=[];return _.each(t,function(t){void 0!=t&&_.each(t.get("waypoints"),function(t){o<t.time&&(o=t.time),i>t.time&&(i=t.time);for(var e=0;e<T.models.length;e++)n=T.models[e],n.get("time")<=o+M&&n.get("time")>=i-M&&!_.contains(s,n)&&s.push(n)}),e||D.remove(t)}),e?s.length+" fingerprint(s) and "+t.length+" route(s) ?":(_.each(s,function(t){T.remove(t)}),a(T.models,!1),j=JSON.parse(null==N?JSON.stringify(E):JSON.stringify(O.get(N).get("entries"))),C.disableMenu(!0,!1,N,j.length),void b(C.map))}function v(t,e,n,i){var o=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(n.lat,n.lng),new google.maps.LatLng(i.lat,i.lng)),s=Math.floor(o/L);if(0>=s)C.addLine(t,e,[n,i],(g(n)+g(i))/2,function(){b(t)});else for(var a,r={lat:(i.lat-n.lat)/s,lng:(i.lng-n.lng)/s,time:(i.time-n.time)/s};s>=1;)a={lat:n.lat+r.lat,lng:n.lng+r.lng,time:n.time+r.time},C.addLine(t,e,[n,a],(g(n)+g(a))/2,function(){b(t)}),n=a,s-=1}function b(t){console.log("Display the routes"),C.deleteMarkers();var e;_.each(D.models,function(n){k=0,e=void 0,_.each(n.get("waypoints"),function(i){void 0!=e&&v(t,n,e,i),e=i})}),C.disableMenu(!1,!1,N,j.length)}function y(t){var e=[{text:"Fingerprints",selected:!0}];t&&e.push({text:"Routes",selected:!1}),C.initMenu(e,D,function(t){"Fingerprints"==t?(R=!0,C.setMode(!0),C.disableMenu(!0,!0,N,j.length),a(T.models,!1),f(C.map,function(){C.disableMenu(!1,!0,N,j.length)})):(R=!1,C.setMode(!1),C.disableMenu(!0,!1,N,j.length),b(C.map))},u,m,function(){b(C.map)},d)}function w(){R=!1,C.setMode(!1),N=null,y(!1),C.disableMenu(!0,!1,N,0),T.fetch({reset:!1,success:function(){a(T.models,!0),D.fetch({reset:!1,success:function(){var t=D.length>0?!0:!1;R=!0,C.setMode(!0),y(t),T.trigger("reset")}})}})}var x,C,S,T,D,k,I,M=5e3,L=1,j=[],N=null,E=[],O=new n.Indoors.AccessPointCollection,A=8,P=null,R=!1;return i.EditController.extend({initialize:function(){console.log("Indoors Training Controller initialized"),P=s,P.init()},show:function(){T=new n.Indoors.FingerprintCollection,D=new n.Indoors.RouteCollection,x=new o.MainView({}),S=new o.TableView({collection:O}),C=new o.MapView({parentView:x,localStorageId:"indoors_training"}),T.on("reset",function(){a(T.models,!0),f(C.map,function(){j=JSON.parse(null==N?JSON.stringify(E):JSON.stringify(O.get(N).get("entries"))),C.disableMenu(!1,!0,N,j.length)})}),D.on("reset",function(){b(C.map)}),S.on("check",r),x.on("show",function(){x.fingerprintsTable.show(S),S.$table.order([5,"desc"]).draw(),C.show(x.$el.find(".gmap")),C.on("level:change",function(t){T.setLevelId(t),D.setLevelId(t),w()}),x.on("refresh",function(){console.log("Refresh"),w()
}),C.map.addListener("zoom_changed",function(){})}),t.main.show(x)}})}),define("text!general/wip/wip_template.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="wip_template">\n\n    <!-- Current site -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Work</strong> in progress</h2>\n        </div>\n        <div class="row">\n            <div class="col-md-12">\n                <p>To be implemented...</p>\n            </div>\n        </div>\n    </div>\n</script>'}),define("general/wip/wip_controller",["app","text!general/wip/wip_template.html"],function(t,e){var n=Marionette.ItemView.extend({template:_.template($(e).filter("#wip_template").html())});return Marionette.Controller.extend({initialize:function(){log.info("Wip controller initialized")},show:function(){t.main.show(new n)}})}),define("indoors/indoors_app",["app","common/server","general/login/login_controller","indoors/training/indoors_training_controller","general/wip/wip_controller"],function(t,e,n,i,o){return t.module("IndoorsApp",function(t,s,a,r){function l(){if(e.isLoggedIn())return!0;var t=a.history.fragment;return a.history.navigate("#login"),n.Controller.show(t),!1}var c=new i,u=new o;t.Router=r.AppRouter.extend({appRoutes:{"indoors/map":"showMap","indoors/devices":"showDevices","indoors/training":"showTraining"}});var d={showMap:function(){u.show()},showDevices:function(){u.show()},showTraining:function(){l()&&c.show()}};s.addInitializer(function(){log.info("Navizon Indoors initialized"),new t.Router({controller:d})})})}),define("common/map_marker",["app","bootbox","syphon","markerwithlabel","sprintf"],function(t,e){"use strict";var n=['<form class="form-horizontal">','<button type="button" class="btn btn-primary btn-xs js-save"><i class="fa fa-save"></i> Save</button>',"</form>"].join("\n"),i={path:0,fillOpacity:1,fillColor:"red",strokeOpacity:1,strokeColor:"black",strokeWeight:1,scale:8},o={draggable:!0,raiseOnDrag:!0,visible:!0,labelAnchor:new google.maps.Point(-15,20),labelClass:"marker_label",labelStyle:{opacity:.9}},s={url:"img/yellow_dot.png",size:new google.maps.Size(36,36),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(18,15),scaledSize:new google.maps.Size(36,36)},a={url:"img/indoor-map-dotactive.png",size:new google.maps.Size(36,36),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(18,15),scaledSize:new google.maps.Size(36,36)},r={url:"img/indoor-map-dotactive.png",size:new google.maps.Size(36,36),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(18,15),scaledSize:new google.maps.Size(36,36)},l={url:"img/indoor-map-dotactive.png",size:new google.maps.Size(36,36),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(18,15),scaledSize:new google.maps.Size(36,36)};return t.module("Common.Markers",function(t,c,u,d,h,p){t.MapMakerInfoWnd=d.ItemView.extend({template:p.template(n),ui:{saveButton:"button.js-save"},events:{"click @ui.saveButton":function(){log.debug("save from infoWnd view on ",this.model.cid)}},show:function(){log.debug("show from infoWnd view on ",this.model.cid)}}),t.MapMakerInfoWnd.template=p.template(n),t.MapMarker=d.Object.extend({model:null,modelOrig:null,marker:null,map:null,infoWnd:null,infoWndViewClass:null,markerOptions:{},radiusOfConfidence:void 0,radius:0,_infoWndDivId:null,_infoWndView:null,_locationChanged:!1,initialize:function(){var e=this;log.debug("MapMarker initialized"),this.map=this.options.map,this.model=this.options.model,this.radius=this.options.radius?this.options.radius:0,this.modelOrig=this.model.clone(),this.model.on("sync",function(){e.modelOrig=e.model.clone(),e.update(),e.infoWnd.close(),e.trigger("sync")}),this.model.on("destroy",function(){e.infoWnd.close(),e.destroy(),e.trigger("destroy")}),this.infoWndViewClass=this.infoWndViewClass||t.MapMakerInfoWnd,this.infoWnd=this.options.infoWnd||new google.maps.InfoWindow,google.maps.event.addListener(this.infoWnd,"domready",function(){e._onInfoWndDomReady()}),google.maps.event.addListener(this.infoWnd,"closeclick",function(){e._onInfoWndCloseClick()}),this.options.markerOptions&&p.extend(this.markerOptions,this.options.markerOptions)},show:function(){var t,e=this,n=this.getLatLng();if(null!=n)return null==this.marker&&(t=p.extend({map:this.map},o,this.markerOptions),this.marker=new MarkerWithLabel(t),google.maps.event.addListener(this.marker,"click",function(){e._onMarkerClick()}),google.maps.event.addListener(this.marker,"dragend",function(){e._onMarkerDragEnd()})),this.update(),this.marker.setVisible(!0),this.marker},isRadiusActive:function(){return void 0!=this.radiusOfConfidence},showIfOnLevel:function(t){t==this.getLevelId()?this.show():this.hide()},hide:function(){this.marker&&this.marker.setVisible(!1)},detach:function(){this.marker&&this.marker.setMap(null)},update:function(){var t="n/a",e=this.getLatLng();if(null!=e&&(this.marker.setIcon(this.getMarkerIcon()),this.marker.setPosition(this.getLatLng()),this.model&&(t=this.model.get("name")||this.model.id||t),this.marker.set("labelContent",t),void 0!=this.radiusOfConfidence)){this.radiusOfConfidence.setCenter(e);var n=this.model.get("loc");n.prec&&this.radiusOfConfidence.setRadius(n.prec)}},destroy:function(){this.marker&&this.marker.setMap(null)},openInfoWnd:function(){var t;this._infoWndDivId="infoWnd-"+this.model.cid,t=h("<div>").attr("id",this._infoWndDivId),t.html(this.infoWndViewClass.template(this.model)),this.infoWnd.setContent(t[0].outerHTML),this.infoWnd.open(this.map,this.marker)},closeInfoWnd:function(){this.infoWnd.close()},getId:function(){return this.model?this.model.id:null},getLatLng:function(){var t=this.model.get("loc");return p.isObject(t)&&p.isFinite(t.lat)&&p.isFinite(t.lng)?new google.maps.LatLng(t.lat,t.lng):null},getLevelId:function(){var t=this.model.get("loc");return t?t.levelId:null},getMarkerIcon:function(){return i},_toggleROC:function(){if(void 0!=this.radiusOfConfidence)this.radiusOfConfidence.setMap(null),this.radiusOfConfidence=void 0;else{var t=this.model.get("loc");0!=this.radius&&t&&t.lat&&t.lng&&(this.radiusOfConfidence=new google.maps.Circle({center:new google.maps.LatLng(t.lat,t.lng),map:this.map,strokeColor:"#000",strokeWeight:2,strokeOpacity:.5,fillColor:"#f0f0f0",fillOpacity:.3,radius:parseFloat(this.radius)}))}},_onMarkerClick:function(){this.openInfoWnd()},_onMarkerDragEnd:function(){var t=p.extend({},this.model.get("loc"));t.lat=this.marker.getPosition().lat(),t.lng=this.marker.getPosition().lng(),this.model.set("loc",t),this._locationChanged=!0,this.openInfoWnd()},_onInfoWndDomReady:function(){log.debug("_onInfoWndDomReady"),this._infoWndView=new this.infoWndViewClass({el:h(this.map.getDiv()).find("#"+this._infoWndDivId),model:this.model,infoWnd:this.infoWnd}),this._infoWndView.bindUIElements(),this._infoWndView.show(),this._infoWndView.checkRocButton&&this._infoWndView.checkRocButton(this.model.get("mac"),void 0!=this.radiusOfConfidence,"#1bbae1")},_onInfoWndCloseClick:function(){var t=this;(this._locationChanged||this.model.isNew())&&e.confirm("Discard Changes?",function(e){if(e){if(t.model.isNew())return void t.model.destroy();t._locationChanged&&(t.model.set("loc",t.modelOrig.get("loc")),t.update(),t._locationChanged=!1)}else t.openInfoWnd()})}}),t.YELLOW_DOT_ICON=s,t.YELLOW_DOT_SEMITRANPARENT_ICON=a,t.GRAY_DOT_ICON=r,t.GRAY_DOT_SEMITRANPARENT_ICON=l})}),define("text!navimote/map/navimote_map_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="navimote_map_main_view_template">\n\n    <!-- Navimote Devices: Map View -->\n    <div class="block full">\n        <div class="block-title">\n            <h4><strong>Wearabouts</strong> Map </h4>\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n            </div>\n        </div>\n        <div class="block block-gmap">\n            <p id="nbDevicesKnown"></p>\n            <div id="location-sources"></div>\n            <div class="gmap">\n                <!-- Google map goes here -->\n            </div>\n        </div>\n    </div>\n\n    <!-- Navimote Devices: Table View -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Devices</strong></h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="device_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n</script>\n\n<!-- Navimote Devices Table-->\n<script type="text/x-template" id="navimote_map_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> MAC </th>\n            <th> Name </th>\n            <th> Position </th>\n            <th> Source </th>\n            <th> Battery </th>\n            <th> Last Seen </th>\n            <th> Action</th>\n            <!--<th> Show</th>-->\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Navimote Devices Table-->\n<script type="text/x-template" id="navimote_map_infownd_template">\n    <div class="form_div infownd_status">\n        <form>\n            <div>\n                <label class="nohint">Mac:</label>\n                <input name="mac" type="text" disabled="disabled">\n            </div>\n\n            <div>\n                <label class="nohint">Name</label>\n                <input name="name" type="text" disabled="disabled">\n            </div>\n\n            <div>\n                <label class="nohint">Mfr:</label>\n                <input name="mfr" type="text" disabled="disabled">\n            </div>\n\n            <div>\n                <label class="nohint">Battery</label>\n                <input name="battery" type="text" disabled="disabled">\n            </div>\n\n            <div>\n                <label class="nohint">Lat, Lng:</label>\n                <input name="latlng" type="text" disabled="disabled">\n            </div>\n\n            <div>\n                <label class="nohint">Source</label>\n                <input name="source" type="text" disabled="disabled">\n            </div>\n\n            <div>\n                <label class="nohint">Last Seen</label>\n                <input name="last" type="text" disabled="disabled">\n            </div>\n\n            <div>\n                <label class="nohint"></label>\n                <input name="push" type="button" value="Request Location Update" class="js-push-device btn btn-alt btn-primary">\n            </div>\n\n            <div>\n                <label class="nohint"></label>\n                <input name="radius" type="button" value="Toggle Radius of Confidence" class="js-radius btn btn-alt btn-primary">\n            </div>\n        </form>\n    </div>\n</script>'}),define("navimote/map/navimote_map_views",["app","common/common_views","common/map_marker","text!navimote/map/navimote_map_templates.html","ouiresolver","util","markerwithlabel","sprintf"],function(t,e,n,i,o,s){function a(t){var e="n/a",n=r(t);if(isFinite(n)){if(-101==n)return"fully charged";e=Math.abs(n)+"%",0>n&&(e+=" (charging)")}return e}function r(t){return null!=t&&_.has(t,"device_status")&&_.has(t.device_status,"battery")?t.device_status.battery:0/0}function l(t){var e=t?t.toUpperCase():"",n=d[e];return void 0==n?"n/a":n}{var c=900,u={VIDEO_CAMERA:"M64.512 -51.767v39.168q0 1.512 -1.404 2.124 -0.468 0.18 -0.9 0.18 -0.972 0 -1.62 -0.684l-14.508 -14.508v5.976q0 4.284 -3.042 7.326t-7.326 3.042h-25.344q-4.284 0 -7.326 -3.042t-3.042 -7.326v-25.344q0 -4.284 3.042 -7.326t7.326 -3.042h25.344q4.284 0 7.326 3.042t3.042 7.326v5.94l14.508 -14.472q0.648 -0.684 1.62 -0.684 0.432 0 0.9 0.18 1.404 0.612 1.404 2.124z"},d={N1:"Global",GLOBAL:"Global",N3:"Indoors","INDOORS/N3":"Indoors",ITS:"Indoors","INDOORS/ITS":"Indoors",CAM:"Camera",CAMERA:"Camera",CORE:"Core"};({path:u.VIDEO_CAMERA,scale:.3,strokeWeight:1.5,strokeColor:"black",strokeOpacity:1,fillColor:"green",fillOpacity:1})}return t.module("Navimote.Map",function(t,u,h,p,f,g){t.MainView=p.LayoutView.extend({template:g.template(f(i).filter("#navimote_map_main_view_template").html()),regions:{deviceTable:"#device_table"},triggers:{"click button#fetch":"fetch"},behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}},showLocationSources:function(t){var e,n,i=document.createElement("div");g.each(t,function(t,o){e=document.createElement("span"),n=d[o.toUpperCase()],void 0==n&&(n="n/a"),e.innerHTML=t?'<i class="fa fa-check"></i> '+n+": Enabled":'<i class="fa fa-remove"></i> '+n+": Disabled",e.style.color=t?"green":"red",e.style.marginRight="20px",e.style.padding="5px",e.style.border="1px solid #cacaca",i.appendChild(e)}),f("#location-sources").append(i),f("#location-sources").css("margin-bottom","20px")}}),t.DeviceTableView=e.DatatableView.extend({template:g.template(f(i).filter("#navimote_map_table_template").html()),events:{"click button.js-push-device":"_onPushDevice","click button.js-radius":"_toggleRoc","click a.js-goto":"_onGoto"},columns:[e.DatatableView.getColumn("id","mac"),{data:{name:"name",mac:"mac",loc:"loc"},width:"200px",render:function(t){return t.loc&&t.loc.lat&&t.loc.lng?sprintf('<a href="#" class="js-goto normalLink" data-id="%s" data-toggle="tooltip" data-original-title="Go To Location">%s</a>',t.mac,t.name):sprintf("<span>%s</span>",t.name)}},{data:null,searchable:!1,sortable:!1,render:function(t){var e="",n="";return void 0!=t.loc.lat&&void 0!=t.loc.lng?(e+=t.loc.lat+", "+t.loc.lng,n='<i class="gi gi-log_out"></i>'):e+="n/a",t.loc&&t.loc.source&&"n3"==t.loc.source.toLowerCase()&&null!=t.loc.levelId&&(e+=", L"+t.loc.levelId),sprintf('<a href="#" class="js-goto" data-id="%s" data-toggle="tooltip" data-original-title="Go To Location">%s</a> %s',t.mac,n,e)}},{data:"loc.source",render:function(t,e){return"display"==e?l(t):t}},{data:null,render:function(t,e){return"display"==e?a(t,!1):r(t)}},e.DatatableView.getColumn("lrrt"),e.DatatableView.getButtonColumn("mac",["pushDevice","radius"])],_onGoto:function(t){var e=f(t.currentTarget).attr("data-id");t.preventDefault(),t.stopPropagation(),f(t.currentTarget).tooltip("hide"),this.triggerMethod("goto",e)},_toggleRoc:function(t){this.trigger("toggleRoc",this._baseHandler(t))},_onPushDevice:function(t){this.trigger("pushDevice",this._baseHandler(t))},_getDeviceModel:function(t){return this.collection.get(t)}}),t.NavimoteMapView=e.FloorplanMap.extend({showDevice:function(t){var e=t.get("loc");(null!=e.lat||null!=e.lng)&&(null!=e.levelId&&this.displayLevel(e.levelId,!1),this.map.setZoom(18),this.map.setCenter(new google.maps.LatLng(e.lat,e.lng)))}}),t.NavimoteMarkerInfoWnd=p.ItemView.extend({template:g.template(f(i).filter("#navimote_map_infownd_template").html()),events:{"click input.js-push-device":"_onPushDevice","click input.js-radius":"_toggleRadius"},show:function(){this._updateInfo(),this.listenTo(h,"updateRoc",function(t,e,n){this.checkRocButton(t,e,n)},this),this.listenTo(h,"updateInfoWindow",function(){this._updateInfo()},this)},_updateInfo:function(){var t,e="n/a";t=this.model.toJSON(),null!=t.loc.lat&&null!=t.loc.lng&&(e=t.loc.lat+", "+t.loc.lng,t.loc&&void 0!=t.loc.levelId&&(e+=", Level "+t.loc.levelId)),h.Syphon.deserialize(this,g.extend(t,{mfr:o.getCompanyName(t.mac.slice(0,6)),battery:a(t,!1),latlng:e,source:l(t.loc.source.toUpperCase())+", precision: "+t.loc.prec+" m",last:s.formatTime(1e3*t.lrrt)}))},_onPushDevice:function(){var t=this.$el.parent().parent().find('input[name="mac"]').val();h.trigger("pushDevice"+t,t)},_toggleRadius:function(){var t=this.$el.parent().parent().find('input[name="mac"]').val();h.trigger("toggleRadius"+t,t)},checkRocButton:function(t,e,n){f('input[name="mac"]').each(function(){f(this).val()==t&&(e?f(this).parent().parent().find(".js-radius").css("background-color",n).css("color","white"):f(this).parent().parent().find(".js-radius").css("background-color","white").css("color",n))})}}),t.NavimoteMarkerInfoWnd.template=g.template(f(i).filter("#navimote_map_infownd_template").html()),t.NavimoteMarker=n.MapMarker.extend({currMapLevelId:null,infoWndViewClass:t.NavimoteMarkerInfoWnd,markerOptions:{draggable:!1},setPushDeviceListener:function(t){this.listenTo(h,"pushDevice"+t,function(t){this.trigger("pushDevice",t)},this)},setRocListener:function(t){this.listenTo(h,"toggleRadius"+t,function(t){this.trigger("toggleRadius",t)},this)},setCurrMapLevelId:function(t){this.currMapLevelId=t},updateROC:function(t,e,n){h.trigger("updateRoc",t,e,n)},updateInfoWindow:function(){h.trigger("updateInfoWindow")},getMarkerIcon:function(){var t=this.model.get("lrrt");return isFinite(t)&&c>=t?this.getLevelId()==this.currMapLevelId?n.YELLOW_DOT_ICON:n.YELLOW_DOT_SEMITRANPARENT_ICON:this.getLevelId()==this.currMapLevelId?n.GRAY_DOT_ICON:n.GRAY_DOT_SEMITRANPARENT_ICON}})})}),define("navimote/map/navimote_map_controller",["app","common/server","common/entities","common/common_views","navimote/map/navimote_map_views","util","bootbox"],function(t,e,n,i,o){"use strict";function s(t){b[t].isRadiusActive()?$('.js-radius[data-id="'+t+'"').css("background-color",m).css("color","white"):$('.js-radius[data-id="'+t+'"').css("background-color","white").css("color",m),b[t].updateROC(t,b[t].isRadiusActive(),m)}function a(){log.debug("_refreshMarkers, %d elements",u.size()),$("body .tooltip.in").hide();var t,e,n;u.each(function(i){t=i.get("loc"),e=t&&t.prec?t.prec:void 0,n=b[i.get("mac")],null==n?(n=new o.NavimoteMarker({model:i,map:p.map,radius:e}),n.setPushDeviceListener(i.id),n.setRocListener(i.id),n.on("pushDevice",r),n.on("toggleRadius",l),b[i.get("mac")]=n):(delete n.model,n.model=i,n.setCurrMapLevelId(p.getLevelId()),n.show(),n.updateInfoWindow()),s(i.get("mac"))})}function r(t){t.push||(t=f._getDeviceModel(t)),t.push&&t.push(function(){console.log("Device pushed")},function(){console.log("Error, cannot push device")})}function l(t){var e=t.get?t.get("mac"):t;void 0!=b[e]&&(b[e]._toggleROC(),void 0!=t.get&&($("html, body").animate({scrollTop:0},"slow"),p.showDevice(u.get(e))),s(e))}function c(){_.each(_.keys(b),function(t){b[t].detach(),delete b[t]}),b={}}var u,d,h,p,f,g=5e3,m="#1bbae1",v=null,b={};return i.EditController.extend({initialize:function(){log.info("Navimote Map Controller initialized")},show:function(){u=new n.Navimote.DeviceStatusCollection,d=new n.Navimote.SiteConfig({}),h=new o.MainView({}),f=new o.DeviceTableView({collection:u}),p=new o.NavimoteMapView({parentView:h,localStorageId:"navimote_map"}),u.on("reset",function(){$("#nbDevicesKnown").text(u.length?u.length+" known devices active in the last "+g/1e3+" seconds":""),a()}),f.on("goto",function(t){log.debug("goto",t),$("html, body").animate({scrollTop:0},"slow"),p.showDevice(u.get(t)),b[t].isRadiusActive()||l(t)}),f.on("pushDevice",r),f.on("toggleRoc",l),h.on("show",function(){h.deviceTable.show(f),p.show(h.$el.find(".gmap")),p.on("level:change",function(){a()}),null==v&&(v=setInterval(function(){u.fetch({reset:!0})},g)),u.fetch({reset:!0}),e.isSuperuser(e.getSiteId())&&d.fetch({success:function(){log.debug("config site fetch success",d.toJSON()),d&&d.get("location_source_config")&&h.showLocationSources(d.get("location_source_config"))}}),a()}),h.on("fetch",function(){log.debug("fetch"),u.fetch({reset:!0})}),h.on("destroy",function(){log.debug("mainview on destroy"),v&&(clearInterval(v),v=null),c()}),t.main.show(h)}})}),define("common/session_storage",[],function(){"use strict";function t(t){if("undefined"==typeof Storage)return{};var e=sessionStorage.getItem(t);return null==e&&(e="{}"),JSON.parse(e)}function e(t,e,n){if("undefined"!=typeof Storage){var i=sessionStorage.getItem(t);null==i&&(i="{}"),i=JSON.parse(i),i[e]=n,sessionStorage.setItem(t,JSON.stringify(i))}}return{getItem:t,setField:e}}),define("text!navimote/config/navimote_config_templates.html",[],function(){return'<script type="text/x-template" id="navimote_config_template">\n    <div class="block full">\n        <!-- Overview -->\n        <div id="device_config_overview">\n        </div>\n\n        <!-- Error -->\n        <div id="device_config_error">\n        </div>\n\n        <!-- WiFi Configuration -->\n        <div id="device_config_wifi_view">\n        </div>\n\n        <!-- General Configuration -->\n        <div id="device_config_general_view">\n        </div>\n\n        <!-- Location Source Configuration -->\n        <div id="device_config_location_source_view">\n        </div>\n    </div>\n</script>\n\n<script type="text/x-template" id="navimote_config_overview_template">\n\n    <div class="block-title">\n        <% if (mode === \'site\') { %>\n        <h2><strong>Site</strong> configuration</h2>\n        <% } else { %>\n        <h2><strong>Device</strong> configuration for <%= deviceMac %></h2>\n        <% } %>\n    </div>\n\n    <form class="form-horizontal">\n\n        <div class="form-group">\n            <label class="col-md-3 control-label">Controls</label>\n            <div class="col-md-6">\n                <button id="dump" class="btn btn-default"><i class="fa fa-search"></i> Inspect... </button>\n                <button id="save" class="btn btn-primary"><i class="fa fa-save"></i> Save</button>\n                <button id="reset" class="btn btn-warning"><i class="fa fa-times"></i> Reset</button>\n                <% if (mode === \'device\') { %>\n                <button id="delete-device" class="btn btn-warning"><i class="fa fa-trash-o"></i> Delete...</button>\n                <% } %>\n            </div>\n        </div>\n\n\n        <% if (mode === \'site\') { %>\n\n        <!--<div class="form-group">-->\n            <!--<label class="col-md-3 control-label">Created</label>-->\n            <!--<div class="col-md-2">-->\n                <!--<p name="created" class="form-control-static">NaN ago</p>-->\n            <!--</div>-->\n            <!--<label class="col-md-2 control-label">Last Updated</label>-->\n            <!--<div class="col-md-3">-->\n                <!--<p name="updated" class="form-control-static">NaN ago</p>-->\n            <!--</div>-->\n        <!--</div>-->\n\n\n        <div class="form-group">\n            <label class="col-md-3 control-label">Last Updated</label>\n            <div class="col-md-6">\n                <p name="updated" class="form-control-static">NaN ago</p>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-md-3 control-label">Show Config For</label>\n            <div class="col-md-4">\n                <select id="config_type" class="form-control" size="1">\n                    <option value="PLEASE_SELECT">Please select</option>\n                    <option value="">All</option>\n                    <option value="SMART_TAG">Smart Tag</option>\n                    <option value="WEARABOUT">Wearabouts</option>\n                </select>\n            </div>\n        </div>\n\n        <!-- |HIDDEN| Controls to Add/Delete/Select specific configurations -->\n        <div style="display: none">\n            <div class="form-group">\n                <label class="col-md-3 control-label">Device Type</label>\n                <div class="col-md-4">\n                    <select id="device_type" class="form-control" size="1">\n                        <option value=""></option>\n                    </select>\n                </div>\n                <button id="add" class="btn btn-primary btn-md"><i class="fa fa-plus-circle"></i> Add...</button>\n                <button id="delete" class="btn btn-warning btn-md"><i class="fa fa-trash-o"></i> Delete...</button>\n            </div>\n        </div>\n\n        <% } else { %>\n\n        <div class="form-group">\n            <label class="col-md-3 control-label">Associated</label>\n            <div class="col-md-6">\n                <p name="associated" class="form-control-static">NaN ago</p>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-md-3 control-label">Configured</label>\n            <div class="col-md-6">\n                <p name="configured" class="form-control-static">NaN ago</p>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-md-3 control-label">Show Config For</label>\n            <div class="col-md-4">\n                <select id="config_type" class="form-control" size="1">\n                    <option value="PLEASE_SELECT">Please select</option>\n                    <option value="">All</option>\n                    <option value="SMART_TAG">Smart Tag</option>\n                    <option value="WEARABOUT">Wearabouts</option>\n                </select>\n            </div>\n        </div>\n\n        <% } %>\n\n    </form>\n\n</script>\n\n<script type="text/x-template" id="navimote_config_error_template">\n\n    <h5><%= error %></h5>\n\n</script>\n\n<script type="text/x-template" id="navimote_config_wifi_template">\n\n    <!--<h4 class="sub-header"><strong>WiFi</strong> parameters for: <strong><span></span></strong></h4>-->\n\n    <h4 class="sub-header">WiFi</h4>\n\n    <form class="form-horizontal">\n\n        <!-- SSID -->\n        <div class="form-group">\n            <label class="col-md-3 control-label">SSID</label>\n            <div class="col-md-6">\n                <input name="ssid" type="text" class="form-control">\n                <span class="help-block">WiFi network to join after initialization</span>\n            </div>\n        </div>\n\n        <!-- Security Mode -->\n        <div class="form-group">\n            <label class="col-md-3 control-label">Security Mode</label>\n            <div class="col-md-6">\n                <select name="security" class="form-control" size="1">\n                    <!-- <option value=""></option> -->\n                    <option value="open">Open</option>\n                    <option value="wep40">WEP40 - 5 chars password</option>\n                    <option value="wep104">WEP104 - 13 chars password</option>\n                    <option value="wpa_auto">WPA</option>\n                </select>\n                <span class="help-block">Default WPA</span>\n            </div>\n        </div>\n\n        <!-- Security passphrase -->\n        <div class="form-group">\n            <label class="col-md-3 control-label">Passphrase</label>\n            <div class="col-md-6">\n                <div class="input-group">\n                    <input name="passphrase" type="password" class="form-control">\n                    <span class="input-group-addon"><a href="#" class="js-toggle-password" data-placement="bottom" data-toggle="tooltip" data-original-title="Show Password"><i class="gi gi-keyboard-wireless"></i></a></span>\n                </div>\n                <span class="help-block">Password to join the WiFi network</span>\n            </div>\n        </div>\n\n\n\n        <div class="form-group">\n            <label class="col-md-3 control-label"></label>\n            <div class="col-md-6">\n                <a href="#" class="js-toggle-settings">Advanced WiFi Settings...</a>\n            </div>\n        </div>\n\n        <div class="js-advanced-settings" style="display: none">\n\n            <!--&lt;!&ndash; Security passkey &ndash;&gt;-->\n            <!--<div class="form-group">-->\n                <!--<label class="col-md-3 control-label">Passkey</label>-->\n                <!--<div class="col-md-6">-->\n                    <!--<input name="passkey" type="text" class="form-control" placeholder="none">-->\n                    <!--<span class="help-block">Hex string representation of the passphrase. Default none</span>-->\n                <!--</div>-->\n            <!--</div>-->\n\n            <!-- Channel List -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Channel List</label>\n                <div class="col-md-6">\n                    <input name="channels" type="text" class="form-control">\n                    <span class="help-block">Comma separated list of WiFi channels to be scanned (e.g: 1, 6, 11). If first element is 0, ALL channels are scanned. Default ALL</span>\n                </div>\n            </div>\n\n            <!-- Security Domain -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Security Domain</label>\n                <div class="col-md-6">\n                    <select name="domain" class="form-control">\n                        <!-- <option value="" class="text-muted">&lt;use default&gt;</option> -->\n                        <option value="fcc">FCC</option>\n                        <option value="etsi">ETSI</option>\n                        <option value="jp">JP</option>\n                    </select>\n                    <span class="help-block">Regulator domain. Default ETSI</span>\n                </div>\n            </div>\n        </div>\n    </form>\n\n</script>\n\n<script type="text/x-template" id="navimote_config_general_template">\n\n    <!--<h4 class="sub-header"><strong>Configuration</strong> parameters for: <strong><span></span></strong></h4>-->\n    <h4 class="sub-header">Position Updates Frequency</h4>\n\n    <form class="form-horizontal">\n\n\n        <!-- Moving Info Period -->\n        <div class="form-group">\n            <label class="col-md-3 control-label ">Moving</label>\n            <div class="col-md-6">\n                <input name="moving_info_period" min="5" max="65535" type="number" class="form-control" placeholder="10">\n                <span class="help-block ">Seconds between position updates when the device is moving. Can be 0, 5, 10, 15, ...etc. Default 10 seconds</span>\n            </div>\n        </div>\n\n        <!-- Stationary Info Period -->\n        <div class="form-group">\n            <label class="col-md-3 control-label ">Stationary</label>\n            <div class="col-md-6">\n                <input name="stationary_info_period" min="5" max="65535" type="number" class="form-control" placeholder="3600">\n                <span class="help-block ">Seconds between position updates when the device is stationary. Can be 0, 5, 10, 15, ...etc. Default 3600 seconds</span>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label class="col-md-3 control-label"></label>\n            <div class="col-md-6">\n                <a href="#" class="js-toggle-settings">More Settings...</a>\n            </div>\n        </div>\n\n        <div class="js-advanced-settings" style="display: none">\n\n            <h4 class="sub-header">Advanced Settings</h4>\n\n            <!-- Stationary Info Threshold -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Stationary Info Threshold</label>\n                <div class="col-md-6">\n                    <input name="stationary_info_period_thr" min="0" max="65535" type="number" class="form-control" placeholder="30">\n                    <span class="help-block ">Seconds with no movement before entering stationary state. Default 30</span>\n                </div>\n            </div>\n\n            <!-- Alarm Discard -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Alarm Discard</label>\n                <div class="col-md-6">\n                    <input name="alarm_discard" min="0" max="65535" type="number" class="form-control" placeholder="7200">\n                    <span class="help-block">Seconds to retain alarm, if impossible to notify server. Default 7200</span>\n                </div>\n            </div>\n\n            <!-- Buzzer -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Buzzer</label>\n                <div class="col-md-6">\n                    <select name="buzzer_on_button_press" class="form-control" size="1">\n                        <option value="true">Enabled</option>\n                        <option value="false">Disabled</option>\n                    </select>\n                    <span class="help-block">Buzzer feedback on panic button alarm. Default Enabled</span>\n                </div>\n            </div>\n\n            <!-- Connection Timeout -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Connection Timeout</label>\n                <div class="col-md-6">\n                    <input name="con_timeout" min="0" max="255" type="number" class="form-control" placeholder="20">\n                    <span class="help-block">Timeout waiting for server response (value * 100 ms). Default 20</span>\n                </div>\n            </div>\n\n            <!-- Core Location (GPS Configuration) -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Core Location</label>\n                <div class="col-md-6">\n                    <select name="gps_config" class="form-control" size="1">\n                        <option value="0">Off</option>\n                        <option value="1">On</option>\n                        <option value="2">Auto</option>\n                    </select>\n                    <span class="help-block ">Mode configuration of Core and (optional) GPS chip. Default Off</span>\n                </div>\n            </div>\n\n            <!-- WiFi Comparison Threshold -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">WiFi Cmp Threshold</label>\n                <div class="col-md-6">\n                    <input name="wifi_cmp_thresh" min="0" max="255" type="number" class="form-control" placeholder="10">\n                    <span class="help-block ">WiFi comparison threshold for Accuware Wearabouts devices (value * 10). Default 10</span>\n                </div>\n            </div>\n\n            <!-- Info Without Config -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Info Without Config</label>\n                <div class="col-md-6">\n                    <input name="info_wo_cfg" min="0" max="255" type="number" class="form-control" placeholder="4">\n                    <span class="help-block ">Number of updates sent w/o waiting for server response. Default 4</span>\n                </div>\n            </div>\n\n            <!-- Moving Sensitivity -->\n            <div class="form-group">\n                <label class="col-md-3 control-label ">Moving Sensitivity</label>\n                <div class="col-md-6">\n                    <input name="moving_sensitivity" min="0" max="255" type="number" class="form-control" placeholder="10">\n                    <span class="help-block">Acceleration necessary to put the device into active state (value * 0.1 ). Default 10</span>\n                </div>\n            </div>\n\n            <!-- Panic Button -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Panic Button</label>\n                <div class="col-md-6">\n                    <input name="panic_button_en" min="0" max="255" type="number" class="form-control" placeholder="20">\n                    <span class="help-block ">Seconds between PanicButton press and alarm (value * 10 ms). Default 20</span>\n                </div>\n            </div>\n\n            <!-- Shutdown -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Shutdown</label>\n                <div class="col-md-6">\n                    <input name="shutdown_en" min="0" max="255" type="number" class="form-control" placeholder="10">\n                    <span class="help-block ">Seconds between PanicButton press and shutdown (0: disable). Default 10</span>\n                </div>\n            </div>\n\n            <!-- Camera positioning selection -->\n            <div class="form-group">\n                <label class="col-md-3 control-label">Camera positioning</label>\n                <div class="col-md-6">\n                    <select name="camera_positioning" class="form-control" size="1">\n                        <option value="0">No camera</option>\n                        <option value="1">Rear camera only</option>\n                        <option value="2">Front camera only</option>\n                        <option value="3">Front and rear cameras</option>\n                    </select>\n                    <span class="help-block">Controls whether the device should shoot and upload pictures taken on the fly. Default No camera</span>\n                </div>\n            </div>\n\n        </div>\n\n    </form>\n\n</script>\n\n<script type="text/x-template" id="navimote_config_location_source_template">\n\n    <h4 class="sub-header">Enabled Sources</h4>\n\n    <!-- Location sources -->\n    <form class="form-horizontal">\n\n        <div class="form-group">\n            <!-- N1 -->\n            <label class="col-md-3 control-label">Location sources</label>\n            <div class="col-md-9">\n                    <span class="locationCheckbox">\n                        <input name="n1" type="checkbox" class="form-control">\n                        Global\n                    </span>\n                    <span class="help-block">\n                        Enable location reports coming from <strong>Global</strong>. Default checked\n                    </span>\n            </div>\n            <!-- N3 -->\n            <label class="col-md-3 control-label"></label>\n            <div class="col-md-9">\n                    <span class="locationCheckbox">\n                        <input name="n3" type="checkbox" class="form-control">\n                        Indoors\n                    </span>\n                    <span class="help-block">\n                        Enable location reports coming from <strong>Indoors</strong>. Default checked\n                    </span>\n            </div>\n            <!-- Core -->\n            <label class="col-md-3 control-label"></label>\n            <div class="col-md-9">\n                    <span class="locationCheckbox">\n                        <input name="core" type="checkbox" class="form-control">\n                        Core\n                    </span>\n                    <span class="help-block">\n                        Enable location reports coming from the <strong>Core OS</strong>. Default checked\n                    </span>\n            </div>\n            <!-- Cam -->\n            <label class="col-md-3 control-label"></label>\n            <div class="col-md-9">\n                <span class="locationCheckbox">\n                    <input name="cam" type="checkbox" class="form-control">\n                    Camera\n                </span>\n                <span class="help-block">\n                    Enable location reports coming fromt the <strong>Camera</strong>. Default checked\n                </span>\n            </div>\n        </div>\n\n    </form>\n\n</script>\n'
}),define("navimote/config/navimote_config_views",["app","common/common_views","util","text!navimote/config/navimote_config_templates.html","syphon"],function(t,e,n,i){function o(t,e){var n;_.each(_.keys(s),function(i){n=!0,"PLEASE_SELECT"==e?n=!1:"SMART_TAG"==e?n=-1!=s[i].indexOf("T"):"WEARABOUT"==e&&(n=-1!=s[i].indexOf("W")),t.find('input[name="'+i+'"]').parent().parent().toggle(n),t.find('select[name="'+i+'"]').parent().parent().toggle(n)})}var s={alarm_discard:"T",buzzer_on_button_press:"T",con_timeout:"T",gps_config:"W",wifi_cmp_thresh:"W",info_wo_cfg:"TW",moving_info_period:"TW",moving_sensitivity:"W",panic_button_en:"T",shutdown_en:"T",stationary_info_period:"TW",stationary_info_period_thr:"T",camera_positioning:"W",n1:"TW",n3:"TW",core:"TW",cam:"TW"},a={moving_info_period:[0],stationary_info_period:[0]},r="gi-keyboard-wireless",l="gi-asterisk";return t.module("Navimote.Config",function(t,e,c,u,d,h){t.addInitializer(function(){log.info("Navimote.Config initialized")}),t.MainView=u.LayoutView.extend({template:h.template(d(i).filter("#navimote_config_template").html()),regions:{overviewView:"#device_config_overview",generalConfigView:"#device_config_general_view",wifiConfigView:"#device_config_wifi_view",locationSourceConfigView:"#device_config_location_source_view",errorMessageView:"#device_config_error"},setViewsVisible:function(t){this.generalConfigView.$el.toggle(t),this.wifiConfigView.$el.toggle(t),this.locationSourceConfigView.$el.toggle(t)}}),t.OverviewView=u.ItemView.extend({template:h.template(d(i).filter("#navimote_config_overview_template").html()),behaviors:{SpinButton:{button:"button#save",autoReset:!0,autoResetTime:1e3}},modelEvents:{change:"onShow"},ui:{timeCreatedLabel:'p[name="created"]',timeUpdatedLabel:'p[name="updated"]',timeAssociatedLabel:'p[name="associated"]',timeConfiguredLabel:'p[name="configured"]',deviceSelect:"#device_type",configType:"#config_type"},triggers:{"click button#reload":"config:reload","click button#dump":"config:dump","click button#save":"config:save","click button#reset":"config:reset","click button#add":"config:add","click button#delete":"config:delete","click button#delete-device":"config:device:delete","change @ui.deviceSelect":"device:changed","change @ui.configType":"config:type:changed"},onShow:function(){var t=new Date;"site"===this.options.mode?(this.ui.timeCreatedLabel.text(n.formatTimeApprox(t.getTime()-1e3*this.model.get("created"))+" ago"),this.ui.timeUpdatedLabel.text(n.formatTimeApprox(t.getTime()-1e3*this.model.get("updated"))+" ago")):(this.ui.timeAssociatedLabel.text(n.formatTimeApprox(t.getTime()-1e3*this.model.get("associated"))+" ago"),this.ui.timeConfiguredLabel.text(n.formatTimeApprox(t.getTime()-1e3*this.model.get("configured"))+" ago"))},render:function(){log.debug("Overview render");var t=h.extend({},this.model.toJSON(),{mode:this.options.mode,deviceMac:this.options.deviceMac});this.$el.html(this.template(t)),this.bindUIElements()},updateDeviceLabels:function(t){var e=this.ui.deviceSelect.html("");h.each(t,function(t){e.append(d("<option>").attr("value",t).text(t))})},setVisible:function(t){t?this.$el.show():this.$el.hide()},getModelWithType:function(t,e){t.device_configs&&t.device_configs["default"]&&t.device_configs["default"].wifi_config&&t.device_configs["default"].wifi_config.passphrase&&(t.device_configs["default"].wifi_config.passphrase="*".repeat(t.device_configs["default"].wifi_config.passphrase.length)),"SMART_TAG"!=e&&""!=e&&t.device_configs&&t.device_configs["default"]&&t.device_configs["default"].wifi_config&&delete t.device_configs["default"].wifi_config;var n;return h.each(h.keys(s),function(i){n=!0,"PLEASE_SELECT"==e?n=!1:"SMART_TAG"==e?n=-1!=s[i].indexOf("T"):"WEARABOUT"==e&&(n=-1!=s[i].indexOf("W")),t.device_configs&&t.device_configs["default"]&&(t.device_configs["default"][i]&&0==n||null==t.device_configs["default"][i]||isNaN(t.device_configs["default"][i]))&&delete t.device_configs["default"][i]}),t}}),t.ErrorMessageView=u.ItemView.extend({template:h.template(d(i).filter("#navimote_config_error_template").html()),render:function(){var t=this.options.error?this.options.error:"Error",e=h.extend({},{},{error:t});this.$el.html(this.template(e))}}),t.GeneralConfigView=u.ItemView.extend({template:h.template(d(i).filter("#navimote_config_general_template").html()),triggers:{"change input,select":"form:changed",keyup:"form:keyup"},ui:{toggleSettings:"a.js-toggle-settings",settingsDiv:"div.js-advanced-settings"},events:{"click @ui.toggleSettings":function(t){t.preventDefault(),this.ui.settingsDiv.toggle()}},onShow:function(){c.Syphon.deserialize(this,this.model.toJSON()),this.$el.find("h4 span").text(this.options.deviceLabel),this.$el.find('[data-toggle="tooltip"], .enable-tooltip').tooltip({container:"body",animation:!1})},onFormChanged:function(){this.model.set(c.Syphon.serialize(this))},setDeviceLabel:function(t){this.$el.find("h2 span").text(t)},resetDeviceLabels:function(t){var e=this.model,n=this.$el;h.each(t,function(t,i){e.set(i,t),n.find('input[name="'+i+'"]').val(t)})},setConfigType:function(t){o(this.$el,t)},checkLabelsValues:function(){var t,e,n,i=this.model,o=this.$el;o.find('input[type="number"]').each(function(){e=d(this),t=parseInt(e.val()),n=!1,h.each(a,function(i,o){o==e.attr("name")&&h.each(i,function(e){e==t&&(n=!0)})}),0==n&&e.attr("min")&&t<parseInt(e.attr("min"))&&(t=parseInt(e.attr("min"))),0==n&&e.attr("max")&&t>parseInt(e.attr("max"))&&(t=parseInt(e.attr("max"))),i.set(e.attr("name"),t),e.val(t)})},storeConfig:function(){this.model&&delete this.model,this.model=new c.Model(n.removeEmptyAttrs(c.Syphon.serialize(this)))}}),t.WiFiConfigView=t.GeneralConfigView.extend({template:h.template(d(i).filter("#navimote_config_wifi_template").html()),ui:{togglePassword:"a.js-toggle-password",toggleSettings:"a.js-toggle-settings",settingsDiv:"div.js-advanced-settings"},events:{"click @ui.togglePassword":function(t){var e;t.preventDefault(),e=this.$el.find('input[name="passphrase"]'),"text"===e.attr("type")?(e.attr("type","password"),this.$el.find("a.js-toggle-password i").removeClass().addClass("gi "+r),this.$el.find("a.js-toggle-password").attr("data-original-title","Show Password")):(e.attr("type","text"),this.$el.find("a.js-toggle-password i").removeClass().addClass("gi "+l),this.$el.find("a.js-toggle-password").attr("data-original-title","Hide Password"))},"click @ui.toggleSettings":function(t){t.preventDefault(),this.ui.settingsDiv.toggle()}},setConfigType:function(t){this.$el.toggle("WEARABOUT"!=t)}}),t.LocationSourceConfigView=t.GeneralConfigView.extend({template:h.template(d(i).filter("#navimote_config_location_source_template").html())})})}),define("navimote/config/navimote_config_controller",["app","common/server","common/entities","common/session_storage","navimote/config/navimote_config_views","bootbox"],function(t,e,n,i,o,s){"use strict";function a(){alert("_onReloadConfig")}function r(){b();var t=L.getModelWithType(y().toJSON(),L.ui.configType.val());s.dialog({title:"Device Config",message:'<pre style="color: green">'+JSON.stringify(t,null,"    ")+"</pre>",className:"large"})}function l(){return j&&j.checkLabelsValues(),b(),w(y().toJSON())?(y().has("device_configs")&&y().get("device_configs")&&y().get("device_configs")["default"]&&(y().get("device_configs")["default"].camera_positioning&&(y().get("device_configs")["default"].camera_positioning=parseInt(y().get("device_configs")["default"].camera_positioning)),y().get("device_configs")["default"].gps_config&&(y().get("device_configs")["default"].gps_config=parseInt(y().get("device_configs")["default"].gps_config))),L.triggerMethod("submit"),void y().save().success(function(){L.triggerMethod("submit:success"),L.ui.timeUpdatedLabel.text("just now")}).error(function(){L.triggerMethod("submit:error"),t.vent.trigger("error:show")})):void s.dialog({title:"Invalid WiFi Passphrase Length",message:"Please make sure the WiFi passphrase matches the length required by the WEP protocol",buttons:{close:{label:"Close",className:"btn-default"}}})}function c(){s.prompt("Create a new configuration for:",function(t){t&&(y().addConfig(t,{}),L.updateDeviceLabels(y().getDeviceLabels()),L.ui.deviceSelect.val(t),m(t))})}function u(){return"default"===k?void s.alert("The default configuration cannot be deleted"):void s.confirm("Remove configuration for "+k+"?",function(t){t&&(y().removeConfig(k),L.updateDeviceLabels(y().getDeviceLabels()),L.ui.deviceSelect.val("default"),m("default"))})}function d(){log.debug("_onDeviceDeleteConfig"),s.confirm("Remove configuration for "+S+"?",function(t){t&&y().destroy({success:function(){log.debug("_deviceConfig.destroy success"),T=new n.Navimote.DeviceConfig({mac:S}),y().set("device_configs",{}),y().addConfig("default",{}),m("default")}})})}function h(){var t=L.ui.deviceSelect.val();log.debug("_onDeviceChanged %s (changed %s) --> %s",k,I,t),I&&(b(),I=!1),m(t)}function p(){var t=L.ui.configType.val();i.setField(F,"configType",t),log.debug("_onConfigTypeChanged",t),g("PLEASE_SELECT"!=t),j.setConfigType(t),N.setConfigType(t),E.setConfigType(t),$('input[type="number"]').keydown(function(t){return t.keyCode>95&&t.keyCode<106||t.keyCode>47&&t.keyCode<58||8==t.keyCode?void 0:!1})}function f(){log.debug("current config changed"),j.checkLabelsValues(),I=!0}function g(t){M.setViewsVisible(t)}function m(t){var n;-1!=y().getDeviceLabels().indexOf(t)&&(j&&j.destroy(),E&&E.destroy(),N&&N.destroy(),k=t,I=!1,j=new o.GeneralConfigView({model:y().getGeneralConfig(k),deviceLabel:k}),E=new o.WiFiConfigView({model:y().getWiFiConfig(k),deviceLabel:k}),N=new o.LocationSourceConfigView({model:y().getLocationSourceConfig()}),j.on("form:changed",f),E.on("form:changed",f),N.on("form:changed",f),n=L.ui.configType.val(),M.generalConfigView.show(j),"site"===C&&e.isSuperuser(e.getSiteId())&&M.locationSourceConfigView.show(N),M.wifiConfigView.show(E),g("PLEASE_SELECT"!=n),j.setConfigType(n),N.setConfigType(n),E.setConfigType(n))}function v(){j.resetDeviceLabels(A)}function b(){if(log.debug("_storeConfig",k),j&&E&&N){j.storeConfig(),j.checkLabelsValues(),E.storeConfig();var t;"site"===C&&e.isSuperuser(e.getSiteId())&&(N.storeConfig(),t=N.model),y().storeConfig(k,j.model,E.model,t)}}function y(){return"site"===C?D:T}function w(t){var e=[],n=!0;return _.has(t,"device_configs")&&(e=_.keys(t.device_configs),_.each(e,function(e){var i=t.device_configs[e].wifi_config;i&&"wep40"==i.security&&5!=i.passphrase.length&&(n=!1),i&&"wep104"==i.security&&13!=i.passphrase.length&&(n=!1)})),n}function x(t){L.setVisible(!1),O&&O.destroy(),O=new o.ErrorMessageView({error:t}),M.errorMessageView&&M.errorMessageView.show(O)}var C,S,T,D,k,I,M,L,j,N,E,O,A={alarm_discard:7200,buzzer_on_button_press:!0,con_timeout:20,gps_config:0,info_wo_cfg:4,moving_info_period:10,moving_sensitivity:10,panic_button_en:20,shutdown_en:10,stationary_info_period:3600,stationary_info_period_thr:30,firmware_update_config:0,camera_positioning:0,wifi_cmp_thresh:10},P={security:"wpa_auto",channels:[0],domain:"etsi"},R={n1:!0,n3:!0,core:!0,cam:!0},F="wearabouts_config",z={};return Marionette.Controller.extend({initialize:function(){log.info("Navimote Config Controller initialized")},show:function(e){log.debug("Navimote Config controller show",e),e?(S=e,C="device",D=null,T=new n.Navimote.DeviceConfig({mac:S}),new n.Navimote.DeviceModel({mac:S}).fetch({success:function(t){L.ui.configType.val(t.get("type"))}})):(S=null,C="site",D=new n.Navimote.SiteConfig({}),T=null),M=new o.MainView({}),L=new o.OverviewView({model:y(),mode:C,deviceMac:S}),M.on("show",function(){this.overviewView.show(L)}),L.on("config:reload",a),L.on("config:dump",r),L.on("config:save",l),L.on("config:reset",v),L.on("config:add",c),L.on("config:delete",u),L.on("config:device:delete",d),L.on("device:changed",h),L.on("config:type:changed",p),y().fetch({success:function(){y().has("device_configs")||(y().set("device_configs",{}),y().addConfig("default",{})),y().has("location_source_config")||"site"!==C||y().set("location_source_config",R);var t=y().get("device_configs")["default"];t&&(t.wifi_config?_.each(P,function(e,n){void 0==t.wifi_config[n]&&(t.wifi_config[n]=e)}):t.wifi_config=P),log.debug("_config %s fetch success",C,y().toJSON()),F&&(z=i.getItem(F)),z.configType&&L.ui.configType.val(z.configType),L.updateDeviceLabels(y().getDeviceLabels()),m("default")},error:function(t,e){if(log.debug("_config fetch error"),e&&e.responseJSON&&e.responseJSON.errors&&e.responseJSON.errors[0])var n=e.responseJSON.errors[0];else{var n="Cannot display the configuration for that ";n+="device"==C?"device":"site"}x(n)}}),t.main.show(M)}})}),define("text!navimote/devices/navimote_devices_templates.html",[],function(){return'<!-- Navimote Devices: Main View -->\n<script type="text/x-template" id="navimote_devices_main_view_template">\n    <div class="row">\n\n        <!-- Registered Devices  -->\n        <div class="block full">\n            <div class="block-title">\n                <h2><strong>Registered</strong> devices</h2>\n                <div class="block-options pull-right">\n                    <a id="refresh" href="javascript:void(0)" class="btn btn-alt btn-sm btn-default" data-toggle="tooltip" title="" data-original-title="Refresh"><i class="fa fa-refresh"></i></a>\n                </div>\n            </div>\n            <!-- Name a device button -->\n            <div class="row">\n                <div class="col-lg-12">\n                    <div class="form-group">\n                        <button type="button" class="btn btn-primary js-add"><i class="fa fa-plus-circle"></i>&nbsp;Add Device&nbsp;</button>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Table -->\n            <div class="row">\n                <div class="col-lg-12">\n                    <div id="devices_table" class="table-responsive"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n\n<!--Navimote Devices: Device Table-->\n<script type="text/x-template" id="navimote_devices_table_template">\n    <table>\n        <thead>\n        <tr>\n            <th> MAC </th>\n            <th> Name</th>\n            <th> Desc</th>\n            <th> Type</th>\n            <th> Last Seen</th>\n            <th> Action</th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Navimote Devices: Dialog for Config/Delete operations -->\n<script type="text/x-template" id="navimote_devices_dialog_template">\n    <!-- Modal -->\n    <div class="modal fade js-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n                    <% if(type === \'new\') { %>\n                        <h4 class="modal-title">Register Device</h4>\n                    <% } else if(type === \'config\') { %>\n                        <h4 class="modal-title">Configure Device</h4>\n                    <% } else if (type === \'delete\'){ %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= mac %> </h4>\n                    <% } else { %>\n                        <h4 class="modal-title"><strong><%= type.toUpperCase() %></strong> <%= mac %> </h4>\n                    <% } %>\n                </div>\n\n                <div class="modal-body">\n\n                    <form class="form-horizontal">\n\n                        <!-- MAC Address -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">MAC</label>\n                            <div class="col-md-4">\n                                <% if (type === \'new\') { %>\n                                <input name="mac" value="" class="form-control" placeholder="MAC Address">\n                                <% } else { %>\n                                <p name="mac" class="form-control-static"><%= mac %></p>\n                                <% } %>\n                            </div>\n                        </div>\n\n                        <!-- Name -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Name</label>\n                            <div class="col-md-6">\n                                <% if (type === \'new\' || type === \'edit\') {%>\n                                <input name="name" value="" class="form-control" placeholder="Name" maxlength="20">\n                                <% } else { %>\n                                <p class="form-control-static"><%= name %></p>\n                                <% } %>\n                            </div>\n                        </div>\n\n                        <!-- Desc -->\n                        <div class="form-group">\n                            <label class="col-md-3 control-label">Description</label>\n                            <div class="col-md-6">\n                                <% if (type === \'new\' || type === \'edit\') {%>\n                                <input name="desc" value="" class="form-control" placeholder="Description" maxlength="60">\n                                <% } else { %>\n                                <p class="form-control-static"><%= desc %></p>\n                                <% } %>\n                            </div>\n                        </div>\n\n                        <!-- Type -->\n                        <!--<div class="form-group">-->\n                            <!--<label class="col-md-3 control-label">Type</label>-->\n                            <!--<% if (type !== \'delete\') { %>-->\n                                <!--<div class="col-md-6">-->\n                                    <!--<select name="type" class="form-control">-->\n                                        <!--<option value=""> </option>-->\n                                        <!--<option value="SMART_TAG"> Smart Tag</option>-->\n                                        <!--<option value="WEARABOUT"> Wearabout</option>-->\n                                    <!--</select>-->\n                                <!--</div>-->\n                            <!--<% } else { %>-->\n                                <!--<p id="device_type" class="form-control-static"></p>-->\n                            <!--<% } %>-->\n                        <!--</div>-->\n                        <!-- Access -->\n                        <!--<div class="form-group">-->\n                            <!--<p class="form-control-static col-lg-12">Remove device from this site?</p>-->\n                        <!--</div>-->\n                    </form>\n                </div>\n\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n                    <% if (type === \'delete\') { %>\n                        <button type="button" class="btn btn-warning js-submit"><i class="fa fa-trash-o"></i> Remove Device</button>\n                    <% } else { %>\n                        <button type="button" class="btn btn-primary js-submit"><i class="fa fa-save"></i> Save</button>\n                    <% } %>\n                </div>\n            </div>\n        </div>\n    </div>\n</script>\n'}),define("navimote/devices/navimote_devices_views",["app","common/common_views","text!navimote/devices/navimote_devices_templates.html","util","maskedinput"],function(t,e,n){"use strict";function i(t){return _.has(o,t)?o[t]:t}var o={SMART_TAG:"Smart Tag",WEARABOUT:"Wearabout"};return t.module("Navimote.Devices",function(t,o,s,a,r,l){t.addInitializer(function(){log.info("Navimote.Devices initialized")}),t.MainView=a.LayoutView.extend({$validator:null,template:l.template(r(n).filter("#navimote_devices_main_view_template").html()),regions:{devicesTable:"#devices_table"},ui:{addButton:"button.js-add",macInput:'input[name="mac"]'},triggers:{"click @ui.addButton":"device:new","click #refresh":"refresh"},behaviors:{SpinButton:{button:"button.js-add",autoReset:!0,autoResetTime:1e3}},onShow:function(){this.$el.find('input[name="mac"]').mask("**:**:**:**:**:**"),this.$validator=this.$el.find("form").validate(l.extend({},e.ValidationConfig,{rules:{mac:{required:!0}}}))}}),t.TableView=e.DatatableView.extend({template:l.template(r(n).filter("#navimote_devices_table_template").html()),columns:[e.DatatableView.getColumn("id","mac"),e.DatatableView.getColumn("name"),e.DatatableView.getColumn("desc"),{data:null,render:function(t){var e=l.has(t,"device_type")?t.device_type:"";return e.startsWith("NWA")?"Wearabout":e.startsWith("NZ")?"SmartTag":"n/a"}},e.DatatableView.getColumn("lrrt"),e.DatatableView.getButtonColumn("mac",["edit","config","delete"])]}),t.DialogView=e.EditDialogView.extend({template:l.template(r(n).filter("#navimote_devices_dialog_template").html()),validationParams:{rules:{mac:{required:!0}}},onShow:function(){e.EditDialogView.prototype.onShow.apply(this,[]),"new"===this.type&&this.$el.find('input[name="mac"]').mask("**:**:**:**:**:**"),"delete"===this.type&&this.$el.find("#device_type").text(i(this.model.get("type")))}})})}),define("navimote/devices/navimote_devices_controller",["app","common/server","common/entities","common/common_views","navimote/devices/navimote_devices_views","bootbox"],function(t,e,n,i,o,s){"use strict";function a(){p.openNewDialog(new n.Navimote.DeviceModel,{},function(t){u.add(t)})}function r(t){p.openEditDialog(t,{},function(e){t.set(e.pick("name","desc","type"))})}function l(t){p.openDeleteDialog(t,{},function(t){log.debug("removed",t.id),u.remove(t)})}function c(t){s.confirm("Create/Edit configuration for "+t.id+"?",function(e){e&&Backbone.history.navigate("#wearabouts/config/"+t.id,{trigger:!0})})}var u,d,h,p,f=null,g=5e3;return i.EditController.extend({initialize:function(){log.info("Navimote Devices Controller initialized"),this.DialogViewClass=o.DialogView},show:function(){p=this,u=new n.Navimote.DeviceCollection,d=new o.MainView({}),h=new o.TableView({collection:u}),d.on("show",function(){d.devicesTable.show(h),null==f&&(f=setInterval(function(){u.fetch({reset:!0}),$("body .tooltip.in").hide()},g)),u.fetch({reset:!0})}),d.on("device:new",a),h.on("edit",r),h.on("delete",l),h.on("config",c),d.on("refresh",function(){u.fetch({reset:!0})}),d.on("destroy",function(){log.debug("mainview on destroy"),f&&(clearInterval(f),f=null)}),t.main.show(d)}})}),define("navimote/navimote_app",["app","common/server","general/login/login_controller","navimote/map/navimote_map_controller","navimote/config/navimote_config_controller","navimote/devices/navimote_devices_controller"],function(t,e,n,i,o,s){return t.module("NavimoteApp",function(t,a,r,l){function c(){if(e.isLoggedIn())return!0;var t=r.history.fragment;return r.history.navigate("#login"),n.Controller.show(t),!1}var u=new i,d=new o,h=new s;t.Router=l.AppRouter.extend({appRoutes:{"wearabouts/map":"showMap","wearabouts/config":"showConfig","wearabouts/config/:device":"showConfig","wearabouts/devices":"showDevices"}});var p={showMap:function(){c()&&u.show()},showConfig:function(t){c()&&d.show(t)},showDevices:function(){c()&&h.show()}};a.addInitializer(function(){log.info("NavimoteApp Router initialized"),new t.Router({controller:p})})})}),define("text!cvtrack/cameras/cameras_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="cvtrack_cameras_main_view_template">\n\n    <!-- Cameras: Map View -->\n    <div class="block full">\n        <div class="block-title">\n            <h4><strong>Camera</strong> Configuration </h4>\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n            </div>\n        </div>\n\n        <div class="block block-gmap">\n            <div class="gmap">\n                <!-- Google map goes here -->\n            </div>\n        </div>\n    </div>\n\n    <!--Cameras: Table View -->\n    <div class="block full">\n        <div class="block-title">\n            <h2><strong>Cameras</strong></h2>\n        </div>\n        <div class="row">\n            <div class="col-lg-12">\n                <div id="camera_table" class="table-responsive"></div>\n            </div>\n        </div>\n    </div>\n</script>\n\n<!-- Camera table-->\n<script type="text/x-template" id="cvtrack_cameras_table_view_template">\n    <table>\n        <thead>\n        <tr>\n            <th> Name </th>\n            <th> MAC </th>\n            <th> Description </th>\n            <th> Level ID </th>\n            <th> Latitude</th>\n            <th> Longitude</th>\n            <th> Action </th>\n        </tr>\n        </thead>\n        <tbody>\n        </tbody>\n    </table>\n</script>\n\n<!-- Camera calibration window -->\n<script type="text/x-template" id="cvtrack_cameras_calibration_window_template">\n        <div id="camera-window-calibration">\n            <div id="title-window-calibration">\n                <h4><strong>Calibration:</strong> <%= id %></h4>\n            </div>\n            <div id="container-block-center">\n                    <div id="container-img-window">    \n                        <img src="<%= imgUrl %>" draggable="false">\n                    </div>\n            </div>\n\n            <div id="footer-window-calibration">\n                <form id="upload_camera_image_form" method="POST" enctype="multipart/form-data" action="" >\n                    <div class="form-group">\n                        <p></p>\n                    </div>\n                    <!--Hidden fields-->\n                    <input type="file" name="image" accept="image/gif,image/jpeg,image/png" style="display: none">\n                    <input type="hidden" name="username" value="" placeholder="username">\n                    <input type="hidden" name="password" value="" placeholder="password">\n                    <input type="hidden" name="calib" value="" placeholder="password">\n                    <!--Buttons-->\n         \n                    <div class="form-group">\n\n                        <button type="button" class="js-dump-calibration btn btn-alt btn-warning btn-sm"><i class="fa fa-times-circle"></i> Dump</button>\n\n                        <button type="button" class="js-discard-calibration btn btn-alt btn-warning btn-sm"><i class="fa fa-times-circle"></i> Cancel</button>\n                        <button type="button" class="js-change-image btn btn-alt btn-primary btn-sm"><i class="fa fa-picture-o"></i> Image...</button>\n                        <button type="button" class="js-save-calibration btn btn-alt btn-primary btn-sm"><i class="fa fa-save"></i> Save</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n</script>\n\n<!--InfoWnd Template for Camera Markers -->\n<script type="text/x-template" id="cvtrack_cameras_infownd_template">\n    <div id="infownd_edit_div" class="form_div infownd_edit">\n        <form>\n            <!--Mac-->\n            <div>\n                <label class="nohint">Mac:</label>\n                <input type="text" name="mac">\n            </div>\n\n            <!--Name-->\n            <div>\n                <label>\n                    Name:<span class="small">Max 20 chars</span>\n                </label>\n                <input type="text" name="name">\n            </div>\n\n            <!-- Desc -->\n            <div>\n                <label>\n                    Description:<span class="small">Max 60 chars</span>\n                </label>\n                <input type="text" name="desc">\n            </div>\n\n            <!-- Lat/Lng -->\n            <div>\n                <label class="nohint">Lat, Lng:</label>\n                <input type="text" disabled="disabled" name="latlng">\n            </div>\n\n            <!--Buttons-->\n            <div>\n                <label>&nbsp;</label>\n                <button class="js-delete btn btn-alt btn-warning btn-xs"><i class="fa fa-trash-o"></i> Delete</button>\n                <button class="js-calibrate btn btn-alt btn-default btn-xs"><i class="fa fa-cogs"></i> Calibrate</button>\n                <button class="js-save btn btn-alt btn-primary btn-xs"><i class="fa fa-save"></i> Save</button>\n            </div>\n        </form>\n    </div>\n</script>'}),function($){for(var supportedCSS,supportedCSSOrigin,styles=document.getElementsByTagName("head")[0].style,toCheck="transformProperty WebkitTransform OTransform msTransform MozTransform".split(" "),a=0;a<toCheck.length;a++)void 0!==styles[toCheck[a]]&&(supportedCSS=toCheck[a]);supportedCSS&&(supportedCSSOrigin=supportedCSS.replace(/[tT]ransform/,"TransformOrigin"),"T"==supportedCSSOrigin[0]&&(supportedCSSOrigin[0]="t")),eval('IE = "v"==""'),jQuery.fn.extend({rotate:function(t){if(0!==this.length&&"undefined"!=typeof t){"number"==typeof t&&(t={angle:t});for(var e=[],n=0,i=this.length;i>n;n++){var o=this.get(n);if(o.Wilq32&&o.Wilq32.PhotoEffect)o.Wilq32.PhotoEffect._handleRotation(t);else{var s=$.extend(!0,{},t),a=new Wilq32.PhotoEffect(o,s)._rootObj;e.push($(a))}}return e}},getRotateAngle:function(){for(var t=[],e=0,n=this.length;n>e;e++){var i=this.get(e);i.Wilq32&&i.Wilq32.PhotoEffect&&(t[e]=i.Wilq32.PhotoEffect._angle)}return t},stopRotate:function(){for(var t=0,e=this.length;e>t;t++){var n=this.get(t);n.Wilq32&&n.Wilq32.PhotoEffect&&clearTimeout(n.Wilq32.PhotoEffect._timer)}}}),Wilq32=window.Wilq32||{},Wilq32.PhotoEffect=function(){return supportedCSS?function(t,e){t.Wilq32={PhotoEffect:this},this._img=this._rootObj=this._eventObj=t,this._handleRotation(e)}:function(t,e){if(this._img=t,this._onLoadDelegate=[e],this._rootObj=document.createElement("span"),this._rootObj.style.display="inline-block",this._rootObj.Wilq32={PhotoEffect:this},t.parentNode.insertBefore(this._rootObj,t),t.complete)this._Loader();else{var n=this;jQuery(this._img).bind("load",function(){n._Loader()})}}}(),Wilq32.PhotoEffect.prototype={_setupParameters:function(t){this._parameters=this._parameters||{},"number"!=typeof this._angle&&(this._angle=0),"number"==typeof t.angle&&(this._angle=t.angle),this._parameters.animateTo="number"==typeof t.animateTo?t.animateTo:this._angle,this._parameters.step=t.step||this._parameters.step||null,this._parameters.easing=t.easing||this._parameters.easing||this._defaultEasing,this._parameters.duration=t.duration||this._parameters.duration||1e3,this._parameters.callback=t.callback||this._parameters.callback||this._emptyFunction,this._parameters.center=t.center||this._parameters.center||["50%","50%"],this._rotationCenterX="string"==typeof this._parameters.center[0]?parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW:this._parameters.center[0],this._rotationCenterY="string"==typeof this._parameters.center[1]?parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH:this._parameters.center[1],t.bind&&t.bind!=this._parameters.bind&&this._BindEvents(t.bind)},_emptyFunction:function(){},_defaultEasing:function(t,e,n,i,o){return-i*((e=e/o-1)*e*e*e-1)+n},_handleRotation:function(t,e){return supportedCSS||this._img.complete||e?(this._setupParameters(t),void(this._angle==this._parameters.animateTo?this._rotate(this._angle):this._animateStart())):void this._onLoadDelegate.push(t)},_BindEvents:function(t){if(t&&this._eventObj){if(this._parameters.bind){var e=this._parameters.bind;for(var n in e)e.hasOwnProperty(n)&&jQuery(this._eventObj).unbind(n,e[n])}this._parameters.bind=t;for(var n in t)t.hasOwnProperty(n)&&jQuery(this._eventObj).bind(n,t[n])}},_Loader:function(){return IE?function(){var t=this._img.width,e=this._img.height;this._imgWidth=t,this._imgHeight=e,this._img.parentNode.removeChild(this._img),this._vimage=this.createVMLNode("image"),this._vimage.src=this._img.src,this._vimage.style.height=e+"px",this._vimage.style.width=t+"px",this._vimage.style.position="absolute",this._vimage.style.top="0px",this._vimage.style.left="0px",this._aspectW=this._aspectH=1,this._container=this.createVMLNode("group"),this._container.style.width=t,this._container.style.height=e,this._container.style.position="absolute",this._container.style.top="0px",this._container.style.left="0px",this._container.setAttribute("coordsize",t-1+","+(e-1)),this._container.appendChild(this._vimage),this._rootObj.appendChild(this._container),this._rootObj.style.position="relative",this._rootObj.style.width=t+"px",this._rootObj.style.height=e+"px",this._rootObj.setAttribute("id",this._img.getAttribute("id")),this._rootObj.className=this._img.className,this._eventObj=this._rootObj;
for(var n;n=this._onLoadDelegate.shift();)this._handleRotation(n,!0)}:function(){this._rootObj.setAttribute("id",this._img.getAttribute("id")),this._rootObj.className=this._img.className,this._imgWidth=this._img.naturalWidth,this._imgHeight=this._img.naturalHeight;var t=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*t,this._height=3*t,this._aspectW=this._img.offsetWidth/this._img.naturalWidth,this._aspectH=this._img.offsetHeight/this._img.naturalHeight,this._img.parentNode.removeChild(this._img),this._canvas=document.createElement("canvas"),this._canvas.setAttribute("width",this._width),this._canvas.style.position="relative",this._canvas.style.left=-this._img.height*this._aspectW+"px",this._canvas.style.top=-this._img.width*this._aspectH+"px",this._canvas.Wilq32=this._rootObj.Wilq32,this._rootObj.appendChild(this._canvas),this._rootObj.style.width=this._img.width*this._aspectW+"px",this._rootObj.style.height=this._img.height*this._aspectH+"px",this._eventObj=this._canvas,this._cnv=this._canvas.getContext("2d");for(var e;e=this._onLoadDelegate.shift();)this._handleRotation(e,!0)}}(),_animateStart:function(){this._timer&&clearTimeout(this._timer),this._animateStartTime=+new Date,this._animateStartAngle=this._angle,this._animate()},_animate:function(){var t=+new Date,e=t-this._animateStartTime>this._parameters.duration;if(e&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img){var n=this._parameters.easing(0,t-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate(~~(10*n)/10)}this._parameters.step&&this._parameters.step(this._angle);var i=this;this._timer=setTimeout(function(){i._animate.call(i)},10)}this._parameters.callback&&e&&(this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj))},_rotate:function(){var t=Math.PI/180;return IE?function(t){this._angle=t,this._container.style.rotation=t%360+"deg",this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+"px",this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+"px",this._container.style.top=this._rotationCenterY-this._imgHeight/2+"px",this._container.style.left=this._rotationCenterX-this._imgWidth/2+"px"}:supportedCSS?function(t){this._angle=t,this._img.style[supportedCSS]="rotate("+t%360+"deg)",this._img.style[supportedCSSOrigin]=this._parameters.center.join(" ")}:function(e){this._angle=e,e=e%360*t,this._canvas.width=this._width,this._canvas.height=this._height,this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH),this._cnv.translate(this._rotationCenterX,this._rotationCenterY),this._cnv.rotate(e),this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY),this._cnv.scale(this._aspectW,this._aspectH),this._cnv.drawImage(this._img,0,0)}}()},IE&&(Wilq32.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{return!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<rvml:"+t+' class="rvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}}())}(jQuery),define("jquery-rotate",function(){}),define("cvtrack/cameras/cameras_views",["app","common/server","common/common_views","common/map_marker","bootbox","text!cvtrack/cameras/cameras_templates.html","jquery-form","jquery-rotate"],function(t,e,n,o,s,a){var r={VIDEO_CAMERA:"M64.512 -51.767v39.168q0 1.512 -1.404 2.124 -0.468 0.18 -0.9 0.18 -0.972 0 -1.62 -0.684l-14.508 -14.508v5.976q0 4.284 -3.042 7.326t-7.326 3.042h-25.344q-4.284 0 -7.326 -3.042t-3.042 -7.326v-25.344q0 -4.284 3.042 -7.326t7.326 -3.042h25.344q4.284 0 7.326 3.042t3.042 7.326v5.94l14.508 -14.472q0.648 -0.684 1.62 -0.684 0.432 0 0.9 0.18 1.404 0.612 1.404 2.124z"},l={path:r.VIDEO_CAMERA,scale:.3,strokeWeight:1.5,strokeColor:"black",strokeOpacity:1,fillColor:"green",fillOpacity:1},c=4,u=["green","cyan","red","yellow","green","cyan","red","yellow"],d={path:0,fillOpacity:1,fillColor:"red",strokeOpacity:1,strokeColor:"black",strokeWeight:2,scale:8},h="/img/grid.png",p=["gif","png","jpg","jpeg"],f=2097152;return t.module("CvTrack.Cameras",function(t,r,g,m,v,b){t.MainView=m.LayoutView.extend({template:b.template(v(a).filter("#cvtrack_cameras_main_view_template").html()),behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}},regions:{cameraTable:"#camera_table"}}),t.CameraTableView=n.DatatableView.extend({template:b.template(v(a).filter("#cvtrack_cameras_table_view_template").html()),columns:[{data:"name"},{data:"mac"},{data:"desc"},{data:"loc.levelId"},{data:"loc.lat"},{data:"loc.lng"},n.DatatableView.getButtonColumn("mac",["edit","delete"])]}),t.CameraMarkerInfoWnd=m.ItemView.extend({template:b.template(v(a).filter("#cvtrack_cameras_infownd_template").html()),events:{"click button.js-save":"saveCamera","click button.js-delete":"deleteCamera"},triggers:{"click button.js-calibrate":"camera:calibrate"},show:function(){var t=this.model.get("loc");g.Syphon.deserialize(this,b.extend({},this.model.toJSON(),{latlng:t.lat.toFixed(6)+", "+t.lng.toFixed(6)})),this.model.isNew()?this.$el.find('input[name="mac"]').mask("**:**:**:**:**:**"):this.$el.find('input[name="mac"]').attr("disabled","disabled")},saveCamera:function(t){var e=["mac","name","desc"];t.preventDefault(),this.model.set(g.Syphon.serialize(this,{include:e})),this.model.save({},{wait:!0})},deleteCamera:function(t){t.preventDefault(),log.debug("Delete camera ",this.model.id||this.model.cid),this.model.destroy()}}),t.CameraMarkerInfoWnd.template=b.template(v(a).filter("#cvtrack_cameras_infownd_template").html()),t.CameraMarker=o.MapMarker.extend({infoWndViewClass:t.CameraMarkerInfoWnd,markerOptions:{labelAnchor:new google.maps.Point(-25,0)},initialize:function(){o.MapMarker.prototype.initialize.apply(this,[]),this.model.on("all",function(t,e){log.debug("model event",t,e)})},_onInfoWndDomReady:function(){var t=this;o.MapMarker.prototype._onInfoWndDomReady.apply(this,[]),this._infoWndView.on("camera:calibrate",function(){log.debug("camera:calibrate"),t.trigger("camera:calibrate")})},getMarkerIcon:function(){return l}}),t.CameraCalibrationView=m.ItemView.extend({_calibrationCirclesMap:[],_calibrationCirclesImg:[],_calibrationAltitudeCirclesImg:[0,0,0,0],_imageFileEvent:null,template:b.template(v(a).filter("#cvtrack_cameras_calibration_window_template").html()),ui:{saveButton:"button.js-save-calibration",dumpButton:"button.js-dump-calibration",imageButton:"button.js-change-image",discardButton:"button.js-discard-calibration",form:"form",imageFile:"form input:file"},behaviors:{SpinButton:{button:"button.js-save-calibration"}},events:{"click @ui.saveButton":function(){log.debug("save"),this._onSaveCalibration()},"click @ui.dumpButton":function(){this._onSaveCalibration2()},"click @ui.imageButton":function(){this._imageFileEvent="image:new",this.ui.imageFile.trigger("click")},"change @ui.imageFile":function(t){var e=this._processImageChange(t);null==e&&this.ui.imageFile.val(""),"image:new"===this._imageFileEvent?this.trigger("image:new",e):"image:replace"===this._imageFileEvent&&this.trigger("image:replaced",e)},"click @ui.discardButton":function(){this.close(),this.triggerMethod("close")}},show:function(){this.triggerMethod("show"),this._displayCalibrationCirclesGmap(),this._displayCalibrationCirclesImage()},close:function(){this._removeCalibrationCirclesGmap(),this._destroyView()},initialize:function(){this.model=this.options.model,this.container=this.options.container,this.map=this.options.map,this.on("image:new",this._processImage),this.on("image:replaced",this._processImage),this.on("window:rendered",this.onRender)},render:function(){var t=this.model.get("preview")||h;this.$el.html(this.template({id:this.model.get("name")||this.model.id,imgUrl:t}));var e=new Image,n=this;return e.onload=function(){n.imgNaturalWidth=e.naturalWidth,n.imgNaturalHeight=e.naturalHeight,n.trigger("window:rendered")},e.src=t,this.bindUIElements(),this._setupAjaxForm(),this},onRender:function(){this.$el.find("#camera-window-calibration").draggable(),this.$el.find("#camera-window-calibration").resizable({alsoResize:"#container-block-center",maxWidth:this.imgNaturalWidth+25,maxHeight:this.imgNaturalHeight+125,minWidth:390,minHeight:350}),v("#camera-window-calibration").css("width",400),v("#camera-window-calibration").css("height",350),v("#container-block-center").css("width",393),v("#container-block-center").css("height",252),v("#container-img-window").css("width",this.imgNaturalWidth+12),v("#container-img-window").css("height",this.imgNaturalHeight+12)},_moveMarkersInsideContainment:function(){v(".camera-calib-image-marker").css("top","20px");v(".camera-calib-image-marker").each(function(t,e){v(e).css("left",30*t+"px")})},_updateDashedLine:function(){var t,e,n,i,o,s,a=8,r=8,l=v(this).attr("div-id"),c=v("div.camera-calib-image-marker[div-id="+l+"]");2==c.length&&(t=v(c[0]).offset().left+a,e=v(c[1]).offset().left+a,n=v(c[0]).offset().top+r,i=v(c[1]).offset().top+r,o=Math.sqrt((t-e)*(t-e)+(n-i)*(n-i)),s=Math.atan2(n-i,t-e)*(180/Math.PI),s>=90&&180>s&&(n-=n-i),s>0&&90>s&&(t-=t-e,n-=n-i),0>=s&&s>-90&&(t-=t-e),v(".line[div-id="+l+"]").queue(function(){v(this).show(),v(this).offset({top:n,left:t}),v(this).dequeue()}).queue(function(){v(this).width(o),v(this).dequeue()}).queue(function(){v(this).rotate(s),v(this).dequeue()}))},_removeDivFromCalibrationCirclesImg:function(t){for(i=0;i<this._calibrationCirclesImg.length;i++)this._calibrationCirclesImg[i]&&this._calibrationCirclesImg[i].attr("clone")&&this._calibrationCirclesImg[i].attr("div-id")==t.attr("div-id")&&(this._calibrationCirclesImg[i]=null,this._calibrationAltitudeCirclesImg[i]=null)},_clickEventOnSiblingsMarker:function(t){var e=v(this);s.dialog({title:"Altitude",message:function(){var t=e.attr("altitude")||"";return'Altitude <br><input type="text" value="'+t+'" class="marker-altitude">'},"class":"small",buttons:{main:{label:"Save",className:"btn-primary",callback:function(){var n=e.attr("index-id"),i=v(".marker-altitude").val();t._calibrationAltitudeCirclesImg[n]=i,e.attr("altitude",i)}},dismiss:{label:"Delete",className:"btn-danger",callback:function(){e.remove(),t._removeDivFromCalibrationCirclesImg(e);var n=e.attr("div-id");v("div.line[div-id='"+n+"']").remove()}}}})},_displayCalibrationCirclesImage:function(){var t,e,n,i=this.model.get("calib"),o=this;for(t=0;8>t;t++)if(null!=i.x[t]&&null!=i.y[t]){if(e=v('<div class="camera-calib-image-marker">'),e.css({top:i.y[t],left:i.x[t],"background-color":u[t]}),e.attr("div-id",u[t]),e.attr("index-id",t),e.on("dblclick",function(){var t,e,i=100,s=v(this).position().top,a=v(this).attr("div-id"),r=v(this);if(1==v(".camera-calib-image-marker[div-id="+a+"]").length){100>s&&(i=s),e=v('<div class="line" div-id="'+a+'"></div>'),e.appendTo(r.parent()),t=r.clone().draggable({containment:"#container-img-window",drag:o._updateDashedLine}).css({top:"-="+i,position:"absolute"}),t.appendTo(r.parent()),n=parseInt(r.attr("index-id")),o._calibrationCirclesImg[n+4]=t,t.attr("index-id",n+4);for(var l=0;2>l;l++)o._updateDashedLine.apply(t,[null,null]);t.on("click",function(){o._clickEventOnSiblingsMarker.call(this,o)})}}),this.container.find("#container-img-window").append(e),e.draggable({containment:"#container-img-window",drag:o._updateDashedLine}),t>=4){e.on("click",function(){o._clickEventOnSiblingsMarker.call(this,o)}),e.attr("clone",1),e.attr("altitude",i.alt[t]);var s=v('<div class="line" div-id="'+e.attr("div-id")+'"></div>');this.container.find("#container-img-window").append(s),function(t){o.on("window:rendered",function(){for(var e=0;2>e;e++)o._updateDashedLine.apply(t,[null,null])})}(e)}this._calibrationCirclesImg[t]=e}},_displayCalibrationCirclesGmap:function(){var t,e,n,i=this.model.get("calib");for(t=0;c>t;t++)this._calibrationCirclesMap[t]&&this._calibrationCirclesMap[t].setMap(null),i&&(n=new google.maps.LatLng(i.lat[t],i.lng[t]),e=b.extend({},d,{fillColor:u[t]}),this._calibrationCirclesMap[t]=new google.maps.Marker({position:n,icon:e,map:this.map,id:u[t],draggable:!0}))},_removeCalibrationCirclesGmap:function(){this._calibrationCirclesMap=b.map(this._calibrationCirclesMap,function(t){return t?(t.setMap(null),null):void 0})},_processImage:function(t){var e=this,n=new FileReader;n.onload=function(t){var n=t.target.result,i=new Image;i.src=n,i.onload=function(){log.debug("new image dimensions:  %d x %d pixels",this.width,this.height),e.imgNaturalWidth=this.naturalWidth,e.imgNaturalHeight=this.naturalHeight,e.$el.find("#container-img-window > img").attr("src",n),e.trigger("window:rendered"),e._moveMarkersInsideContainment()}},n.readAsDataURL(t)},_checkExtension:function(t,e){var n,i;return t&&""!=t?(n=t.split(".").pop().toLowerCase(),i=n&&-1!=e.indexOf(n)):!1},_onSaveCalibration2:function(){var t,e,n,i,o=this,s={x:[null,null,null,null,null,null,null,null],y:[null,null,null,null,null,null,null,null],lat:[null,null,null,null,null,null,null,null],lng:[null,null,null,null,null,null,null,null],alt:[0,0,0,0,null,null,null,null]};for(t=0;8>t;t++)this._calibrationCirclesImg[t]&&(e=this._calibrationCirclesImg[t].position(),n=e.top>4?this._calibrationCirclesImg[t].position().top+4:this._calibrationCirclesImg[t].position().top,i=e.left>4?this._calibrationCirclesImg[t].position().left+4:this._calibrationCirclesImg[t].position().left,s.x[t]=i,s.y[t]=n),this._calibrationCirclesMap[t]&&(s.lat[t]=this._calibrationCirclesMap[t].getPosition().lat(),s.lng[t]=this._calibrationCirclesMap[t].getPosition().lng()),t>3&&o._calibrationAltitudeCirclesImg[t]&&(s.alt[t]=o._calibrationAltitudeCirclesImg[t],s.lat[t]=s.lat[t-4],s.lng[t]=s.lng[t-4]);s.cols=this.imgNaturalWidth,s.rows=this.imgNaturalHeight,log.debug(s.cols),log.debug(s.rows),log.debug("calibration",s)},_onSaveCalibration:function(){var t,n,i,o,s=this,a={x:[null,null,null,null,null,null,null,null],y:[null,null,null,null,null,null,null,null],lat:[null,null,null,null,null,null,null,null],lng:[null,null,null,null,null,null,null,null],alt:[0,0,0,0,null,null,null,null]};for(t=0;8>t;t++)this._calibrationCirclesImg[t]&&(n=this._calibrationCirclesImg[t].position(),i=n.top>4?n.top:n.top,o=n.left>4?n.left:n.left,a.x[t]=o,a.y[t]=i),this._calibrationCirclesMap[t]&&(a.lat[t]=this._calibrationCirclesMap[t].getPosition().lat(),a.lng[t]=this._calibrationCirclesMap[t].getPosition().lng()),t>3&&(s._calibrationAltitudeCirclesImg[t]&&(a.alt[t]=parseFloat(s._calibrationAltitudeCirclesImg[t])),a.lat[t]=a.lat[t-4],a.lng[t]=a.lng[t-4]);a.cols=this.imgNaturalWidth,a.rows=this.imgNaturalHeight,log.debug("calibration",a),this.ui.form.find('input[name="username"]').val(e.getUsername()),this.ui.form.find('input[name="password"]').val(e.getPassword()),this.ui.form.find('input[name="calib"]').val(JSON.stringify(a)),this.ui.form.attr("action",e.CvTrack.getResourceUrl("/cameras/")+this.model.id+"/calib/"),this.triggerMethod("submit"),setTimeout(function(){s.ui.form.submit()},100)},_processImageChange:function(t){t.stopPropagation();var e,n=t.target.files[0];return n?!this._checkExtension(n.name,p)||n.size>f?(e="<p>Supported image files are: <strong>"+p.join(", ")+"</strong></p>",e+="<p>Max image file size is <strong>1MB</strong></p>",s.dialog({message:e,title:"Invalid Image",buttons:{main:{label:"Dismiss",className:"btn-primary",callback:function(){}}}}),null):n:null},_setupAjaxForm:function(){var t=this;this.ui.form.ajaxForm({success:function(e){t.model.set(e),t.close(),t.triggerMethod("submit:success",e),t.triggerMethod("close")},error:function(){t.triggerMethod("submit:error"),setTimeout(function(){r.vent.trigger("error:show")},100)},uploadProgress:function(t,e,n,i){log.debug("camera upload:",i)}})},_destroyView:function(){this.undelegateEvents(),this.$el.removeData().unbind(),this.remove()}})})}),define("cvtrack/cameras/cameras_map_view",["app","common/server","common/entities","common/common_views","common/map_marker","cvtrack/cameras/cameras_views"],function(t,e,n,i,o,s){"use strict";function a(t){p=t,f=t.options.cameras,f.on("reset",function(){r()}),google.maps.event.addListener(p.map,"click",h)}function r(){log.debug("_initializeCameraMarkers, %d objects",f.length),g=[],f.each(function(t){var e=l(t);e.showIfOnLevel(p.currLevelId),g.push(e)})}function l(t){var e=new s.CameraMarker({model:t,map:p.map});return e.on("camera:calibrate",function(){d(this)}),e.on("destroy",function(){g=_.without(g,this)}),e}function c(t,e){var i;i=new n.CvTrack.CameraModel({name:"New Camera"}),i.set("loc",{levelId:p.currLevelId,lat:t,lng:e}),i.set("calib",{x:[0,100,0,100],y:[0,0,100,100],lat:[t-5e-5,t+5e-5,t-5e-5,t+5e-5],lng:[e-5e-5,e-5e-5,e+5e-5,e+5e-5]}),m=new s.CameraMarker({model:i,map:p.map}),m.on("camera:calibrate",function(){d(this)}),m.on("destroy",function(){m=null}),m.on("sync",function(){log.debug("_newCameraMarker.sync",this),f.add(this.model),g.push(this),m=null}),m.show(),m.openInfoWnd()}function u(t){_.each(g,function(e){e.showIfOnLevel(t)})}function d(t){var e,n,i=p.$gmapDiv;v=t,n=t.model,e=n.get("calib"),e&&(t.closeInfoWnd(),u(0/0),b=new s.CameraCalibrationView({model:v.model,container:i,map:p.map}),i.append(b.render().$el),b.show(),y=!0,b.on("close",function(){y=!1,u(p.currLevelId)}))}function h(t){null!=m||y||c(t.latLng.lat(),t.latLng.lng())}var p=null,f=null,g=[],m=null,v=null,b=null,y=!1;return t.module("CvTrack.Cameras",function(t){t.MapView=i.FloorplanMap.extend({levelChangeFn:function(t){u(t)},show:function(){i.FloorplanMap.prototype.show.apply(this,[]),a(this)}})})}),define("cvtrack/cameras/cameras_controller",["app","common/server","common/entities","common/common_views","cvtrack/cameras/cameras_views","cvtrack/cameras/cameras_map_view"],function(t,e,n,i,o,s){"use strict";var a,r,l,c;return i.EditController.extend({initialize:function(){log.info("CameraDevices Controller initialized")},show:function(){a=new n.CvTrack.CameraCollection,r=new o.MainView({}),c=new o.CameraTableView({collection:a}),r.on("show",function(){r.cameraTable.show(c),l=new s.MapView({parentView:r,$gmapDiv:r.$el.find(".gmap"),cameras:a}),l.show(),a.fetch({reset:!0})}),t.main.show(r)}})}),define("cvtrack/cvtrack_app",["app","common/server","general/login/login_controller","general/wip/wip_controller","cvtrack/cameras/cameras_controller"],function(t,e,n,i,o){return t.module("CvTrackApp",function(t,s,a,r){function l(){if(e.isLoggedIn())return!0;var t=a.history.fragment;return a.history.navigate("#login"),n.Controller.show(t),!1}var c=new i,u=new o;t.Router=r.AppRouter.extend({appRoutes:{"cvtrack/map":"showMap","cvtrack/cameras":"showCameras"}});var d={showMap:function(){l()&&c.show()},showCameras:function(){l()&&u.show()}};s.addInitializer(function(){log.info("CvTrack Router initialized"),new t.Router({controller:d})})})}),define("text!vps/map/vps_map_templates.html",[],function(){return'<!-- Main View -->\n<script type="text/x-template" id="vps_main_view_template">\n\n    <!-- VPS: Map View -->\n    <div class="block full">\n        <div class="block-title">\n            <h4><strong>VPS</strong> Configuration </h4>\n            <div class="block-options pull-right">\n                <a href="javascript:void(0)" class="btn btn-alt btn-sm btn-primary js-full-screen"><i class="fa fa-desktop"></i></a>\n            </div>\n        </div>\n\n        <div class="block block-gmap">\n            <div class="gmap">\n                <!-- Google map goes here -->\n            </div>\n        </div>\n    </div>\n\n</script>\n\n<!--InfoWnd Template for VP Markers -->\n<script type="text/x-template" id="vps_infownd_template">\n    <div id="infownd_edit_div" class="form_div infownd_edit">\n        <form>\n            <!-- Orientation -->\n            <div>\n                <label class="nohint">Orientation:</label>\n                <input type="number" min="0" max="360" name="orientation">\n            </div>\n\n            <!-- Altitude -->\n            <div>\n                <label class="nohint">Altitude:</label>\n                <input type="number" name="altitude">\n            </div>\n\n            <!-- onWall -->\n            <div>\n                <label class="nohint">onWall:</label>\n                <input type="checkbox" name="onWall">\n            </div>\n\n            <!--Buttons-->\n            <div>\n                <label>&nbsp;</label>\n                <button class="js-delete btn btn-alt btn-warning btn-xs"><i class="fa fa-trash-o"></i> Delete</button>\n                <button class="js-save btn btn-alt btn-primary btn-xs"><i class="fa fa-save"></i> Save</button>\n                <button class="js-download btn btn-alt btn-primary btn-xs"><i class="fa fa-download"></i> Download QR</button>\n                <button class="js-print btn btn-alt btn-primary btn-xs"><i class="fa fa-eye"></i> Show QR</button>\n            </div>\n        </form>\n    </div>\n</script>'}),define("vps/map/vps_views",["app","common/server","common/common_views","common/map_marker","bootbox","text!vps/map/vps_map_templates.html","jquery-form","jquery-rotate"],function(t,e,n,i,o,s){var a={VIDEO_CAMERA:"M64.512 -51.767v39.168q0 1.512 -1.404 2.124 -0.468 0.18 -0.9 0.18 -0.972 0 -1.62 -0.684l-14.508 -14.508v5.976q0 4.284 -3.042 7.326t-7.326 3.042h-25.344q-4.284 0 -7.326 -3.042t-3.042 -7.326v-25.344q0 -4.284 3.042 -7.326t7.326 -3.042h25.344q4.284 0 7.326 3.042t3.042 7.326v5.94l14.508 -14.472q0.648 -0.684 1.62 -0.684 0.432 0 0.9 0.18 1.404 0.612 1.404 2.124z"},r={path:a.VIDEO_CAMERA,scale:.3,strokeWeight:1.5,strokeColor:"black",strokeOpacity:1,fillColor:"#3090C7",fillOpacity:1};return t.module("Vps.Map",function(t,n,o,a,l,c){t.MainView=a.LayoutView.extend({template:c.template(l(s).filter("#vps_main_view_template").html()),behaviors:{FullScreenMap:{button:"a.js-full-screen",map:".gmap"}}}),t.VisualPointMarkerInfoWnd=a.ItemView.extend({template:c.template(l(s).filter("#vps_infownd_template").html()),events:{"click button.js-save":"saveVp","click button.js-delete":"deleteVp","click button.js-download":"downloadQR","click button.js-print":"printQR",keyup:"onKeyup"},show:function(){},saveVp:function(t){log.debug("Save visual point"),t.preventDefault();var e=["orientation","altitude","onWall"];this.model.set(o.Syphon.serialize(this,{include:e}))},deleteVp:function(t){log.debug("Delete visual point"),t.preventDefault()},onKeyup:function(){var t=l('input[name="orientation"]'),e=parseInt(t.val());e<parseInt(t.attr("min"))&&t.val(parseInt(t.attr("min"))),e>parseInt(t.attr("max"))&&t.val(parseInt(t.attr("max")))},_updateVPModel:function(){var t=["orientation","altitude","onWall"];this.model.set(o.Syphon.serialize(this,{include:t})),this.model.get("orientation")||this.model.set("orientation",0),this.model.get("altitude")||this.model.set("altitude",0)},downloadQR:function(t){log.debug("Download QR code"),t.preventDefault(),this._updateVPModel();var n=this.model.get("loc");if(void 0!=n&&void 0!=n.lat&&void 0!=n.lng&&void 0!=n.levelId){var i=document.createElement("a");i.href="http://cvnav.accuware.com:8082/api/v1/sites/"+e.getSiteId()+"/levels/"+n.levelId+"/vbeacons/?lat="+n.lat+"&lng="+n.lng+"&alt="+this.model.get("altitude")+"&orient="+this.model.get("orientation")+"&onwall="+this.model.get("onWall"),i.download="QR_Code_"+e.getSiteId()+"_"+n.levelId+".png",i.click()}},printQR:function(t){log.debug("Print QR code"),t.preventDefault(),this._updateVPModel();var n=this.model.get("loc");if(void 0!=n&&void 0!=n.lat&&void 0!=n.lng&&void 0!=n.levelId){var i="http://cvnav.accuware.com:8082/api/v1/sites/"+e.getSiteId()+"/levels/"+n.levelId+"/vbeacons/?lat="+n.lat+"&lng="+n.lng+"&alt="+this.model.get("altitude")+"&orient="+this.model.get("orientation")+"&onwall="+this.model.get("onWall");window.open(i)}}}),t.VisualPointMarkerInfoWnd.template=c.template(l(s).filter("#vps_infownd_template").html()),t.VisualPointMarker=i.MapMarker.extend({infoWndViewClass:t.VisualPointMarkerInfoWnd,markerOptions:{labelAnchor:new google.maps.Point(-25,0)},initialize:function(){i.MapMarker.prototype.initialize.apply(this,[])},_onInfoWndDomReady:function(){i.MapMarker.prototype._onInfoWndDomReady.apply(this,[])},getMarkerIcon:function(){return r}})})}),define("vps/map/vps_map_views",["app","common/server","common/entities","common/common_views","common/map_marker","vps/map/vps_views"],function(t,e,n,i,o,s){"use strict";function a(t){h=t,p=t.options.vps,p.on("reset",function(){r()}),google.maps.event.addListener(h.map,"click",d)}function r(){log.debug("_initializeVpsMarkers, %d objects",p.length),f=[],p.each(function(t){var e=l(t);e.showIfOnLevel(h.currLevelId),f.push(e)})}function l(t){var e=new s.VisualPointMarker({model:t,map:h.map});return e.on("destroy",function(){f=_.without(f,this)}),e}function c(t,e){var i;i=new n.Vps.VisualPointModel({name:"New Visual Point"}),i.set("loc",{levelId:h.currLevelId,lat:t,lng:e}),g=new s.VisualPointMarker({model:i,map:h.map}),g.on("destroy",function(){g=null}),g.on("sync",function(){log.debug("_newVpMarker.sync",this),p.add(this.model),f.push(this),g=null}),g.show(),g.openInfoWnd()}function u(t){_.each(f,function(e){e.showIfOnLevel(t)})}function d(t){null==g&&c(t.latLng.lat(),t.latLng.lng())}var h=null,p=null,f=[],g=null;return t.module("Vps.VisualPoints",function(t){t.MapView=i.FloorplanMap.extend({levelChangeFn:function(t){u(t)},show:function(){i.FloorplanMap.prototype.show.apply(this,[]),a(this)}})})}),define("vps/map/vps_map_controller",["app","common/server","common/entities","common/common_views","vps/map/vps_views","vps/map/vps_map_views"],function(t,e,n,i,o,s){"use strict";var a,r,l;return i.EditController.extend({initialize:function(){log.info("Vps Controller initialized")},show:function(){a=new n.Vps.VisualPointCollection,r=new o.MainView({}),r.on("show",function(){l=new s.MapView({parentView:r,$gmapDiv:r.$el.find(".gmap"),vps:a}),l.show()}),t.main.show(r)}})}),define("vps/vps_app",["app","common/server","general/login/login_controller","vps/map/vps_map_controller"],function(t,e,n,i){return t.module("VpsApp",function(t,o,s,a){function r(){if(e.isLoggedIn())return!0;var t=s.history.fragment;return s.history.navigate("#login"),n.Controller.show(t),!1}var l=new i;t.Router=a.AppRouter.extend({appRoutes:{"vps/map":"showMap"}});var c={showMap:function(){r()&&l.show()}};o.addInitializer(function(){log.info("Vps Router initialized"),new t.Router({controller:c})})})}),define("text!ui/header/header_template.html",[],function(){return'<ul class="nav navbar-nav-custom">\n    <li>\n        <a id="spinner" href="javascript:void(0)" style="visibility: hidden"><i class="fa fa-spinner fa-spin"></i></a>\n    </li>\n    <li>\n        <a id="error" class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)" style="visibility: hidden" ><i class="fa fa-exclamation-triangle text-danger"></i> <span>Some message here</span></a>\n        <ul class="dropdown-menu dropdown-custom dropdown-menu-right">\n            <li class="dropdown-header text-center">Error</li>\n            <li>\n                <a id=\'show_error_details\' href="#">\n                    <i class="fa fa-search pull-right"></i>\n                    Inspect...\n                </a>\n                <a id=\'clear_error\' href="#">\n                    <i class="fa fa-times-circle pull-right"></i>\n                    Clear\n                </a>\n            </li>\n        </ul>\n    </li>\n</ul>\n<ul class="nav navbar-nav-custom pull-right">\n    <li class="dropdown">\n        <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">\n            <% if (loggedIn) { %>\n                <i class="gi gi-user"></i> <strong><%=username%></strong>&nbsp;<i class="fa fa-angle-down"></i>\n            <% } else { %>\n                <i class="gi gi-user"></i> <strong>not logged in</strong>&nbsp;<i class="fa fa-angle-down"></i>\n            <% } %>\n        </a>\n        <ul class="dropdown-menu dropdown-custom dropdown-menu-right">\n            <li class="dropdown-header text-center">Account</li>\n            <li>\n                <a id=\'logout\' href="#">\n                    <i class="gi gi-log_out pull-right"></i>\n                    Logout\n                </a>\n            </li>\n        </ul>\n    </li>\n    <% if (username != null) { %>\n        <li class="dropdown">\n            <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">\n                <i class="gi gi-tag"></i> Site: <strong><%=siteId%></strong>&nbsp;<i class="fa fa-angle-down"></i>\n            </a>\n            <ul class="dropdown-menu dropdown-custom dropdown-menu-right">\n                <li class="dropdown-header text-center">Site</li>\n                <li>\n                    <a id=\'change_site\' href="#">\n                        <i class="gi gi-log_out pull-right"></i>\n                        Change Site\n                    </a>\n                </li>\n            </ul>\n        </li>\n    <% } %>\n</ul>'}),define("ui/header/header_views",["app","text!ui/header/header_template.html","bootbox"],function(t,e,n){var i={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",419:"Authentication Timeout",420:"Method Failure",420:"Enhance Your Calm",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",440:"Login Timeout",444:"No Response",449:"Retry With",450:"Blocked by Windows Parental Controls",451:"Unavailable For Legal Reasons",451:"Redirect",494:"Request Header Too Large",495:"Cert Error",496:"No Cert",497:"HTTP to HTTPS",499:"Client Closed Request",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required",520:"Origin Error",521:"Web server is down",522:"Connection timed out",523:"Proxy Declined Request",524:"A timeout occurred",598:"Network read timeout error",599:"Network connect timeout error"},o=3e4,s=null,a=null;return t.module("General.Header",function(t,r,l,c,u,d){t.MainView=c.ItemView.extend({template:d.template(e),ui:{spinner:"#spinner",error:"#error",error_msg:"#error > span",error_icon:"#error > i",show_error_details:"#show_error_details",clear_error:"#clear_error"},events:{"click @ui.clear_error":"clearError","click @ui.show_error_details":"showErrorDetails","click a#logout":function(t){t.preventDefault(),this.trigger("logout")},"click a#change_site":function(t){t.preventDefault(),this.trigger("change:site")}},modelEvents:{change:function(){this.render()}},clearError:function(t){t&&t.preventDefault(),s=null,this.ui.error_msg.text(""),this.ui.error.css("visibility","hidden"),this.ui.error_icon.css("visibility","hidden"),this.ui.error_msg.css("visibility","hidden"),a&&(clearTimeout(a),a=null)},showErrorDetails:function(t){var e,o,a,r=this;t&&t.preventDefault(),o=u("<div>"),null==s?o.append(u("<p>").text("no details")):(e=u("<ul>"),s.request.responseJSON&&s.request.responseJSON&&s.request.responseJSON.errors?(a=s.request.responseJSON.errors,d.each(a,function(t){if("string"==typeof t)e.append(u("<li>").html(t));
else try{e.append(u("<li>").html('<pre class="text-success">'+JSON.stringify(t,null,"    ")+"</pre>"))}catch(t){e.append(u("<li>").html("Unable to decode error"))}}),o.append(e)):s.request.responseText&&o.append(u("<p>").text(s.request.responseText)),o.append(u("<p>").text("Details:")),e=u("<ul>"),e.append(u("<li>").html("<strong>page: </strong>"+s.settings.url)),e.append(i[s.request.status]?u("<li>").html("<strong>code: </strong>"+s.request.status+" - "+i[s.request.status]):u("<li>").html("<strong>code: </strong>"+s.request.status)),e.append(u("<li>").html("<strong>status: </strong>"+s.request.statusText)),o.append(e)),n.dialog({message:o.html(),title:'<i class="fa fa-exclamation-triangle text-danger"></i> <span class="text-danger">Error</span>',buttons:{main:{label:"Clear",className:"btn-primary",callback:function(){r.clearError()}}}})},onShow:function(){var t=this;this.clearError(),u(document).ajaxStart(function(){t.ui.spinner.css("visibility","visible")}),u(document).ajaxComplete(function(){t.ui.spinner.css("visibility","hidden")}),u(document).ajaxError(function(e,n,r){s={event:e,request:n,settings:r},t.ui.error_msg.text("Error "+n.status),i[n.status]&&t.ui.error_msg.text(t.ui.error_msg.text()+" - "+i[n.status]),t.ui.error.css("visibility","visible"),a&&clearTimeout(a),a=setTimeout(function(){t.clearError()},o)})}})})}),define("ui/header/header_controller",["app","common/server","ui/header/header_views","general/sites/sites_controller"],function(t,e,n,i){return t.module("General.Header",function(t,o,s){var a=null;log.info("Header controller instantiated"),t.Controller={show:function(){a=new i;var t=new n.MainView({model:e.getLoginInfo()});o.vent.on("error:show",function(){setTimeout(function(){t.showErrorDetails()},100)}),t.on("logout",function(){e.logout(),s.history.navigate("#login",{trigger:!0})}),t.on("change:site",function(){var t=s.history.fragment;s.history.navigate("#general/sites"),a.show(t)}),o.header.show(t)}}})}),define("text!ui/sidebar/sidebar_template_prod.html",[],function()
{return html}),function(e){jQuery.fn.extend({slimScroll:function(n){var i=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n);return this.each(function(){function o(t){if(u){t=t||window.event;var n=0;t.wheelDelta&&(n=-t.wheelDelta/120),t.detail&&(n=t.detail/3),e(t.target||t.srcTarget||t.srcElement).closest("."+i.wrapperClass).is(w.parent())&&s(n,!0),t.preventDefault&&!y&&t.preventDefault(),y||(t.returnValue=!1)}}function s(t,e,n){y=!1;var o=t,s=w.outerHeight()-x.outerHeight();e&&(o=parseInt(x.css("top"))+t*parseInt(i.wheelStep)/100*x.outerHeight(),o=Math.min(Math.max(o,0),s),o=t>0?Math.ceil(o):Math.floor(o),x.css({top:o+"px"})),m=parseInt(x.css("top"))/(w.outerHeight()-x.outerHeight()),o=m*(w[0].scrollHeight-w.outerHeight()),n&&(o=t,t=o/w[0].scrollHeight*w.outerHeight(),t=Math.min(Math.max(t,0),s),x.css({top:t+"px"})),w.scrollTop(o),w.trigger("slimscrolling",~~o),l(),c()}function a(){window.addEventListener?(this.addEventListener("DOMMouseScroll",o,!1),this.addEventListener("mousewheel",o,!1)):document.attachEvent("onmousewheel",o)}function r(){g=Math.max(w.outerHeight()/w[0].scrollHeight*w.outerHeight(),b),x.css({height:g+"px"});var t=g==w.outerHeight()?"none":"block";x.css({display:t})}function l(){r(),clearTimeout(p),m==~~m?(y=i.allowPageScroll,v!=m&&w.trigger("slimscroll",0==~~m?"top":"bottom")):y=!1,v=m,g>=w.outerHeight()?y=!0:(x.stop(!0,!0).fadeIn("fast"),i.railVisible&&C.stop(!0,!0).fadeIn("fast"))}function c(){i.alwaysVisible||(p=setTimeout(function(){i.disableFadeOut&&u||d||h||(x.fadeOut("slow"),C.fadeOut("slow"))},1e3))}var u,d,h,p,f,g,m,v,b=30,y=!1,w=e(this);if(w.parent().hasClass(i.wrapperClass)){var _=w.scrollTop(),x=w.parent().find("."+i.barClass),C=w.parent().find("."+i.railClass);if(r(),e.isPlainObject(n)){if("height"in n&&"auto"==n.height){w.parent().css("height","auto"),w.css("height","auto");var S=w.parent().parent().height();w.parent().css("height",S),w.css("height",S)}if("scrollTo"in n)_=parseInt(i.scrollTo);else if("scrollBy"in n)_+=parseInt(i.scrollBy);else if("destroy"in n)return x.remove(),C.remove(),void w.unwrap();s(_,!1,!0)}}else{i.height="auto"==n.height?w.parent().height():n.height,_=e("<div></div>").addClass(i.wrapperClass).css({position:"relative",overflow:"hidden",width:i.width,height:i.height}),w.css({overflow:"hidden",width:i.width,height:i.height});var C=e("<div></div>").addClass(i.railClass).css({width:i.size,height:"100%",position:"absolute",top:0,display:i.alwaysVisible&&i.railVisible?"block":"none","border-radius":i.railBorderRadius,background:i.railColor,opacity:i.railOpacity,zIndex:90}),x=e("<div></div>").addClass(i.barClass).css({background:i.color,width:i.size,position:"absolute",top:0,opacity:i.opacity,display:i.alwaysVisible?"block":"none","border-radius":i.borderRadius,BorderRadius:i.borderRadius,MozBorderRadius:i.borderRadius,WebkitBorderRadius:i.borderRadius,zIndex:99}),S="right"==i.position?{right:i.distance}:{left:i.distance};C.css(S),x.css(S),w.wrap(_),w.parent().append(x),w.parent().append(C),i.railDraggable&&x.bind("mousedown",function(n){var i=e(document);return h=!0,t=parseFloat(x.css("top")),pageY=n.pageY,i.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,x.css("top",currTop),s(0,x.position().top,!1)}),i.bind("mouseup.slimscroll",function(){h=!1,c(),i.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(t){return t.stopPropagation(),t.preventDefault(),!1}),C.hover(function(){l()},function(){c()}),x.hover(function(){d=!0},function(){d=!1}),w.hover(function(){u=!0,l(),c()},function(){u=!1,c()}),w.bind("touchstart",function(t){t.originalEvent.touches.length&&(f=t.originalEvent.touches[0].pageY)}),w.bind("touchmove",function(t){y||t.originalEvent.preventDefault(),t.originalEvent.touches.length&&(s((f-t.originalEvent.touches[0].pageY)/i.touchScrollStep,!0),f=t.originalEvent.touches[0].pageY)}),r(),"bottom"===i.start?(x.css({top:w.outerHeight()-x.outerHeight()}),s(0,!0)):"top"!==i.start&&(s(e(i.start).position().top,null,!0),i.alwaysVisible||x.hide()),a()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery),define("vendor/jquery.slimscroll",function(){});var ProUiApp=function(){var t,e,n,i,o,s,a,r=function(){t=$("#page-container"),e=$("#page-content"),n=$("header"),i=$("#page-content + footer"),o=$("#sidebar"),s=$("#sidebar-alt"),a=$(".sidebar-scroll"),c("init"),l(),p(),h(),$(window).resize(function(){h()}),$(window).bind("orientationchange",h)},l=function(){var t=250,e=250,n=($(".sidebar-nav a"),$(".sidebar-nav-menu")),i=$(".sidebar-nav-submenu");n.click(function(){var n=$(this);return n.parent().hasClass("active")!==!0&&(n.hasClass("open")?(n.removeClass("open").next().slideUp(t),setTimeout(h,t)):($(".sidebar-nav-menu.open").removeClass("open").next().slideUp(t),n.addClass("open").next().slideDown(e),setTimeout(h,t>e?t:e))),!1}),i.click(function(){var n=$(this);return n.parent().hasClass("active")!==!0&&(n.hasClass("open")?(n.removeClass("open").next().slideUp(t),setTimeout(h,t)):(n.closest("ul").find(".sidebar-nav-submenu.open").removeClass("open").next().slideUp(t),n.addClass("open").next().slideDown(e),setTimeout(h,t>e?t:e))),!1})},c=function(e,i){if("init"===e)(n.hasClass("navbar-fixed-top")||n.hasClass("navbar-fixed-bottom"))&&c("sidebar-scroll"),$(".sidebar-partial #sidebar").mouseenter(function(){c("close-sidebar-alt")}),$(".sidebar-alt-partial #sidebar-alt").mouseenter(function(){c("close-sidebar")});else{var o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;"toggle-sidebar"===e?o>991?(t.toggleClass("sidebar-visible-lg"),t.hasClass("sidebar-visible-lg")&&c("close-sidebar-alt"),"toggle-other"===i&&(t.hasClass("sidebar-visible-lg")||c("open-sidebar-alt"))):(t.toggleClass("sidebar-visible-xs"),t.hasClass("sidebar-visible-xs")&&c("close-sidebar-alt")):"toggle-sidebar-alt"===e?o>991?(t.toggleClass("sidebar-alt-visible-lg"),t.hasClass("sidebar-alt-visible-lg")&&c("close-sidebar"),"toggle-other"===i&&(t.hasClass("sidebar-alt-visible-lg")||c("open-sidebar"))):(t.toggleClass("sidebar-alt-visible-xs"),t.hasClass("sidebar-alt-visible-xs")&&c("close-sidebar")):"open-sidebar"===e?(t.addClass(o>991?"sidebar-visible-lg":"sidebar-visible-xs"),c("close-sidebar-alt")):"open-sidebar-alt"===e?(t.addClass(o>991?"sidebar-alt-visible-lg":"sidebar-alt-visible-xs"),c("close-sidebar")):"close-sidebar"===e?t.removeClass(o>991?"sidebar-visible-lg":"sidebar-visible-xs"):"close-sidebar-alt"===e?t.removeClass(o>991?"sidebar-alt-visible-lg":"sidebar-alt-visible-xs"):"sidebar-scroll"==e&&a.length&&!a.parent(".slimScrollDiv").length&&(a.slimScroll({height:$(window).height(),color:"#fff",size:"3px",touchScrollStep:100}),$(window).resize(u),$(window).bind("orientationchange",d))}return $(window).trigger("sidebar:toggle"),!1},u=function(){a.add(a.parent()).css("height",$(window).height())},d=function(){setTimeout(a.add(a.parent()).css("height",$(window).height()),500)},h=function(){var a=$(window).height(),r=o.outerHeight(),l=s.outerHeight(),c=n.outerHeight(),u=i.outerHeight();n.hasClass("navbar-fixed-top")||n.hasClass("navbar-fixed-bottom")||a>r&&a>l?t.hasClass("footer-fixed")?e.css("min-height",a-c+"px"):e.css("min-height",a-(c+u)+"px"):t.hasClass("footer-fixed")?e.css("min-height",(r>l?r:l)-c+"px"):e.css("min-height",(r>l?r:l)-(c+u)+"px")},p=function(){var t=$("#to-top"),e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;$(window).scroll(function(){$(this).scrollTop()>150&&e>991?t.fadeIn(100):t.fadeOut(100)}),t.click(function(){return $("html, body").animate({scrollTop:0},400),!1})},f=function(){$.extend(!0,$.fn.dataTable.defaults,{sDom:"<'row'<'col-sm-6 col-xs-5'l><'col-sm-6 col-xs-7'f>r>t<'row'<'col-sm-5 hidden-xs'i><'col-sm-7 col-xs-12 clearfix'p>>",sPaginationType:"bootstrap",oLanguage:{sLengthMenu:"_MENU_",sSearch:'<div class="input-group">_INPUT_<span class="input-group-addon"><i class="fa fa-search"></i></span></div>',sInfo:"<strong>_START_</strong>-<strong>_END_</strong> of <strong>_TOTAL_</strong>",oPaginate:{sPrevious:"",sNext:""}}})};return{init:function(){r()},sidebar:function(t,e){c(t,e)},datatables:function(){f()}}}();define("vendor/proui_app",function(){}),define("ui/sidebar/sidebar_views",["marionette","text!ui/sidebar/sidebar_template_prod.html","../../vendor/jquery.slimscroll","../../vendor/proui_app"],function(t,e){return t.ItemView.extend({template:_.template(e),events:{"click a.js-goto":"goTo"},goTo:function(t){var e=$(t.currentTarget).attr("data-href");log.debug("Sidebar.goto "+e),t.preventDefault(),Backbone.history.navigate(e,{trigger:!0})},initialize:function(){log.info("Initialize Sidebar")},onShow:function(){log.info("Initialize ProUI app"),ProUiApp.init()}})}),requirejs.config({paths:{jquery:"vendor/jquery","jquery-ui":"vendor/jquery-ui.min",underscore:"vendor/underscore",backbone:"vendor/backbone",marionette:"vendor/backbone.marionette","backbone.wreqr":"vendor/backbone.wreqr","backbone.babysitter":"vendor/backbone.babysitter",text:"vendor/require-plugins/text",templates:"../templates",models:"../models",collections:"../collections",views:"../views","backbone.basicauth":"vendor/backbone.basicauth",syphon:"vendor/backbone.syphon.min",bootstrap:"vendor/bootstrap.min",gmaps:"https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=drawing,geometry",loglevel:"vendor/loglevel",server:"common/server",entities:"common/entities",util:"common/util",wifidevice:"common/wifidevice","const":"common/const",ouiresolver:"common/ouiresolver",injectcss:"vendor/jquery.injectcss",datatables:"vendor/jquery.datatables","datatables-bootstrap":"vendor/datatables-bootstrap",markerwithlabel:"vendor/markerwithlabel_1.1.19_packed",maskedinput:"vendor/jquery.maskedinput","jquery-form":"vendor/jquery.form","jquery-rotate":"vendor/jquery.rotate",eve:"vendor/raphael/eve",raphael:"vendor/raphael/raphael.ok",raphael_free:"vendor/raphael/raphael.free_transform",dhtmlxcommon:"vendor/dhtmlxToolbar/codebase/dhtmlxcommon",dhtmlxtoolbar:"vendor/dhtmlxToolbar/codebase/dhtmlxtoolbar",sprintf:"vendor/sprintf.min",fptool:"general/floorplans/fptool_lib",bootbox:"vendor/bootbox.min","its-system-map":"its/map/its_map_lib","its-node-map":"its/nodes/its_node_map_lib"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},syphon:{deps:["backbone"],exports:"Backbone"},datatables:{deps:["jquery"]},"datatables-bootstrap":{deps:["datatables"]},eve:{exports:"eve"},raphael:{deps:["eve"],exports:"Raphael"},raphael_free:{deps:["raphael","eve"]},dhtmlxcommon:{exports:"dhtmlx"},dhtmlxtoolbar:{deps:["dhtmlxcommon"],exports:"dhtmlXToolbarObject"},fptool:{deps:["injectcss","raphael_free","dhtmlxtoolbar","sprintf"]},"its-system-map":{deps:["markerwithlabel"]},"its-node-map":{deps:["maskedinput"]},"jquery-ui":{deps:["jquery"]}}}),require(["bootstrap","app","general/general_app","its/its_app","indoors/indoors_app","navimote/navimote_app","cvtrack/cvtrack_app","vps/vps_app","general/login/login_controller","ui/header/header_controller","general/wip/wip_controller","ui/sidebar/sidebar_views","underscore","jquery","backbone","marionette"],function(t,e,n,i,o,s,a,r,l,c,u,d,h,p,f,g){var m=g.AppRouter.extend({appRoutes:{login:"login","*actions":"wip"}}),v=new u,b={login:function(){l.Controller.show()},wip:function(){v.show()}};window.app=e,p.support.cors=!0,e.router=new m({controller:b}),e.sidebar.show(new d),c.Controller.show(),e.start()}),define("main",function(){});